import{j as q,e as z,h as K,T as W,aj as P,r as V,c as x}from"./index.e0396806.js";import{u as X}from"./use-quasar.83b7c9a5.js";var k=q({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(y,{slots:M,emit:c}){let v=!1,$,D,S=null,g=null,m,A;function T(){$&&$(),$=null,v=!1,S!==null&&(clearTimeout(S),S=null),g!==null&&(clearTimeout(g),g=null),D!==void 0&&D.removeEventListener("transitionend",m),m=null}function O(i,h,p){h!==void 0&&(i.style.height=`${h}px`),i.style.transition=`height ${y.duration}ms cubic-bezier(.25, .8, .50, 1)`,v=!0,$=p}function E(i,h){i.style.overflowY=null,i.style.height=null,i.style.transition=null,T(),h!==A&&c(h)}function N(i,h){let p=0;D=i,v===!0?(T(),p=i.offsetHeight===i.scrollHeight?0:void 0):(A="hide",i.style.overflowY="hidden"),O(i,p,h),S=setTimeout(()=>{S=null,i.style.height=`${i.scrollHeight}px`,m=G=>{g=null,(Object(G)!==G||G.target===i)&&E(i,"show")},i.addEventListener("transitionend",m),g=setTimeout(m,y.duration*1.1)},100)}function I(i,h){let p;D=i,v===!0?T():(A="show",i.style.overflowY="hidden",p=i.scrollHeight),O(i,p,h),S=setTimeout(()=>{S=null,i.style.height=0,m=G=>{g=null,(Object(G)!==G||G.target===i)&&E(i,"hide")},i.addEventListener("transitionend",m),g=setTimeout(m,y.duration*1.1)},100)}return z(()=>{v===!0&&T()}),()=>K(W,{css:!1,appear:y.appear,onEnter:N,onLeave:I},M.default)}});const ee=P("allGoals",()=>{const y=V([{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}]),M=[{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}],c=X(),v=x(()=>M),$=x(()=>{let e=JSON.parse(c.localStorage.getItem("mainGoals"));return g(e)}),D=x(()=>{let e=JSON.parse(c.localStorage.getItem("subGoals"));return g(e)}),S=x(()=>JSON.parse(c.localStorage.getItem("AllDates")));function g(e){return e?[...e]:[]}function m(e,o,t,r){let l=this.getMainGoals;if(!l){console.log("umm no mainGoals...adding"),c.localStorage.set("mainGoals",JSON.stringify([{id:0,title:e,details:o,priority:r,bgcolor:t,icon:"fas fa-utensils"}]));return}let u=l.length+1;for(;l.some(f=>f.id===u);)u=Math.floor(Math.random()*1e3);return l.unshift({id:u,title:e,details:o,priority:r,bgcolor:t,icon:"fas fa-utensils"}),c.localStorage.set("mainGoals",JSON.stringify(l)),u}function A(e,o,t,r,l,u,f,a){let s=this.getSubGoals;if(!s){c.localStorage.set("subGoals",JSON.stringify([{id:0,parentGoal:e.trim(),title:o,score:t,time:r,duration:l,canMove:u,inDefaults:f,isAlternative:a}]));return}let n=s.length+1;for(;s.some(b=>b.id===n);)n=Math.floor(Math.random()*1e3);return s.unshift({id:n,parentGoal:e,title:o.trim(),score:t,time:r,duration:l,canMove:u,inDefaults:f,isAlternative:a}),c.localStorage.set("subGoals",JSON.stringify(s)),n}function T(e,o,t,r,l,u,f,a){let s=this.getSubGoals;for(var n=0;n<s.length;n++)if(s[n].id===e){s[n].title=o.trim(),s[n].score=t,s[n].time=r,s[n].duration=l,s[n].canMove=u,s[n].inDefaults=f,s[n].isAlternative=a,console.log("editSubGoal for",s[n],n);break}c.localStorage.set("subGoals",JSON.stringify(s))}function O(){c.localStorage.remove("mainGoals"),console.log("removed all mainGoal")}function E(){c.localStorage.remove("subGoals"),console.log("removed all subGoals")}function N(){c.localStorage.remove("subGoals"),c.localStorage.remove("mainGoals"),console.log("removed ALL")}function I(e,o=null,t=null){let r=this.getSubGoals;for(var l=0;l<r.length;l++)if(r[l].id===e){r[l].time=o||r[l].time,r[l].score=t||r[l].score;break}c.localStorage.set("subGoals",JSON.stringify(r))}function i(e){let o=this.getSubGoals;for(var t=0;t<o.length;t++)o[t].id===e&&(o.splice(t,1),console.log("removeSubgoal spliced!"));return c.localStorage.set("subGoals",JSON.stringify(o)),o}function h(e,o){let t=this.getMainGoals;for(var r=0;r<t.length;r++)t[r].id===e&&(t.splice(r,1),console.log("removeMaingoal spliced!"));return c.localStorage.set("mainGoals",JSON.stringify(t)),t}function p(e){let o=this.getMainGoals;for(var t=0;t<o.length;t++)if(o[t].title===e)return o[t];return null}function G(e,o=null){let t=this.getAllDates;t?o?t[`${e}`]=o:e in t?delete t[`${e}`]:console.log(`ERROR? deleting schedule of ${e} not found!`):(console.log(`Adding new schedule for ${e}`),t={},t[`${e}`]=o),c.localStorage.set("AllDates",JSON.stringify(t))}function J(e){let o=this.getAllDates;if(o)return o[`${e}`]}function R(e){let o=this.getAllDates;return o?!!o[`${e}`]:!1}function L(){const e=[];let o=function(r){return r==null?void 0:r.inDefaults},t=this.getSubGoals;return t?(t.forEach(r=>{o(r)&&e.push(r)}),e):(console.log("No subgoals to fetch defaults :("),e)}function w(e=null){let o=this.getMainGoals,t=new Set;if(e)for(var r=0;r<o.length;r++)o[r].priority==e&&t.add(o[r].priority);else o.forEach(l=>{t.add(l.priority)});return t}function F(){const e=[];let o=this.getSubGoals;return o&&o.forEach(t=>{t!=null&&t.isAlternative&&e.push(t)}),e}function H(e){const o=[];let t=function(l){const u=l.split(/on/);return u.length!=2?(console.log(`parseScore error?${l}`,u),-1):u[1]-u[0]},r=this.getSubGoals;return r&&r.forEach(l=>{if(l.score=="")console.log(`no score event added: ${l.title}`,l.score),o.push(l);else{let u=t(l.score);u>-1&&u>=e&&o.push(l)}}),o}function Y(e){const t=(e/60).toFixed(2);return parseFloat(t)}function j(){let e=this.getMainGoals,o=this.getSubGoals,t=l=>{let u=[];return o&&o.forEach(f=>{f.parentGoal==l&&u.push(f)}),u},r=[];return e.forEach(l=>{var a,s,n,b;let u={label:`${l.id} - ${l==null?void 0:l.title.trim()} (${l==null?void 0:l.priority})`,details:`${l.details}`,color:`${l==null?void 0:l.bgcolor}`,prio:l==null?void 0:l.priority,children:[]},f=t(l.id);for(let d=0;d<f.length;d++){let Q=f[d].inDefaults?"Dft":"#",B=f[d].canMove?"Mv":"#",U=f[d].isAlternative?"Alt":"#";u.children.push({label:`${f[d].id} -- ${(a=f[d])==null?void 0:a.title.trim()} (${(s=f[d])==null?void 0:s.score})`,details:`${(n=f[d])==null?void 0:n.time} for ${(b=f[d])==null?void 0:b.duration} mins :: ${Q}~${B}~${U}`,color:`${l==null?void 0:l.bgcolor}`,isChildren:!0})}r.push(u)}),r}function C(){let e=this.getAllDates;if(!e)return[];let o=this.getMainGoals,t=this.getSubGoals,r={};for(let a in e){let s=e[a];for(let n in s)r[n]||(r[n]=[]),r[n].push({date:a,logged:Y(s[n].duration)})}let l=a=>{let s=[];return t&&t.forEach(n=>{n.parentGoal==a&&s.push(n)}),s},u=(a,s=null)=>{let n={children:[],title:s?`${a.title.trim()}(${a.score})`:`${a.title.trim()} !${a.priority}!`,key:s?`${s}-${a.id}`:a.id,logged:[],expanded:!1,color:a==null?void 0:a.bgcolor,isChild:!!s};if(s){let b=r[a.id]||[];n.logged=[...b]}return n},f=[];return o.forEach(a=>{let s=u(a),n=l(a.id);for(let b=0;b<n.length;b++){let d=u(n[b],a.id);if(d.logged.length==0){console.log(`Oooh no logged for parent ${a.title}`,d);continue}s.logged.push(...d.logged),s.children.push(d)}f.push(s)}),f}return{headers:M,headerRefs:y,getHeaders:v,getMainGoals:$,getSubGoals:D,getAllDates:S,addMainGoal:m,addSubGoal:A,editSubGoal:T,getGoalByTitle:p,saveSubProp:I,saveDailySchedule:G,resetSub:E,resetMain:O,resetAll:N,removeSubgoal:i,removeMaingoal:h,getEventsForDate:J,hasEventsForDate:R,fetchAllTaskSummary:C,fetchGoalsWithMinScore:H,fetchAllPrio:w,fetchDefaults:L,fetchAlternativeEvts:F,fetchGoalsTree:j}});export{k as Q,ee as u};
