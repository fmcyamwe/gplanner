import{_ as ie}from"./index.7e234c3b.js";import"./QCalendar.2dfe44a3.js";import{a as ne,p as oe,b as se}from"./QCalendarTask.ef5cc7a0.js";import{w as R,h as re}from"./utiFunc.f569f737.js";/*! Capacitor: https://capacitorjs.com/ - MIT License */const ae=i=>{const e=new Map;e.set("web",{name:"web"});const t=i.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:e},n=(o,a)=>{t.platforms.set(o,a)},s=o=>{t.platforms.has(o)&&(t.currentPlatform=t.platforms.get(o))};return t.addPlatform=n,t.setPlatform=s,t},le=i=>i.CapacitorPlatforms=ae(i),W=le(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});W.addPlatform;W.setPlatform;var C;(function(i){i.Unimplemented="UNIMPLEMENTED",i.Unavailable="UNAVAILABLE"})(C||(C={}));class T extends Error{constructor(e,t,n){super(e),this.message=e,this.code=t,this.data=n}}const ce=i=>{var e,t;return i!=null&&i.androidBridge?"android":!((t=(e=i==null?void 0:i.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},de=i=>{var e,t,n,s,o;const a=i.CapacitorCustomPlatform||null,r=i.Capacitor||{},g=r.Plugins=r.Plugins||{},l=i.CapacitorPlatforms,S=()=>a!==null?a.name:ce(i),b=((e=l==null?void 0:l.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||S,A=()=>b()!=="web",G=((t=l==null?void 0:l.currentPlatform)===null||t===void 0?void 0:t.isNativePlatform)||A,B=c=>{const d=$.get(c);return!!(d!=null&&d.platforms.has(b())||U(c))},K=((n=l==null?void 0:l.currentPlatform)===null||n===void 0?void 0:n.isPluginAvailable)||B,z=c=>{var d;return(d=r.PluginHeaders)===null||d===void 0?void 0:d.find(N=>N.name===c)},U=((s=l==null?void 0:l.currentPlatform)===null||s===void 0?void 0:s.getPluginHeader)||z,V=c=>i.console.error(c),Q=(c,d,N)=>Promise.reject(`${N} does not have an implementation of "${d}".`),$=new Map,X=(c,d={})=>{const N=$.get(c);if(N)return console.warn(`Capacitor plugin "${c}" already registered. Cannot register plugins twice.`),N.proxy;const w=b(),O=U(c);let y;const Z=async()=>(!y&&w in d?y=typeof d[w]=="function"?y=await d[w]():y=d[w]:a!==null&&!y&&"web"in d&&(y=typeof d.web=="function"?y=await d.web():y=d.web),y),ee=(u,h)=>{var p,v;if(O){const P=O==null?void 0:O.methods.find(m=>h===m.name);if(P)return P.rtype==="promise"?m=>r.nativePromise(c,h.toString(),m):(m,L)=>r.nativeCallback(c,h.toString(),m,L);if(u)return(p=u[h])===null||p===void 0?void 0:p.bind(u)}else{if(u)return(v=u[h])===null||v===void 0?void 0:v.bind(u);throw new T(`"${c}" plugin is not implemented on ${w}`,C.Unimplemented)}},k=u=>{let h;const p=(...v)=>{const P=Z().then(m=>{const L=ee(m,u);if(L){const D=L(...v);return h=D==null?void 0:D.remove,D}else throw new T(`"${c}.${u}()" is not implemented on ${w}`,C.Unimplemented)});return u==="addListener"&&(P.remove=async()=>h()),P};return p.toString=()=>`${u.toString()}() { [capacitor code] }`,Object.defineProperty(p,"name",{value:u,writable:!1,configurable:!1}),p},j=k("addListener"),I=k("removeListener"),te=(u,h)=>{const p=j({eventName:u},h),v=async()=>{const m=await p;I({eventName:u,callbackId:m},h)},P=new Promise(m=>p.then(()=>m({remove:v})));return P.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await v()},P},J=new Proxy({},{get(u,h){switch(h){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return O?te:j;case"removeListener":return I;default:return k(h)}}});return g[c]=J,$.set(c,{name:c,proxy:J,platforms:new Set([...Object.keys(d),...O?[w]:[]])}),J},Y=((o=l==null?void 0:l.currentPlatform)===null||o===void 0?void 0:o.registerPlugin)||X;return r.convertFileSrc||(r.convertFileSrc=c=>c),r.getPlatform=b,r.handleError=V,r.isNativePlatform=G,r.isPluginAvailable=K,r.pluginMethodNoop=Q,r.registerPlugin=Y,r.Exception=T,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r.platform=r.getPlatform(),r.isNative=r.isNativePlatform(),r},fe=i=>i.Capacitor=de(i),E=fe(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{}),_=E.registerPlugin;E.Plugins;class q{constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(t);const o=this.windowListeners[e];o&&!o.registered&&this.addWindowListener(o),n&&this.sendRetainedArgumentsForEvent(e);const a=async()=>this.removeListener(e,t);return Promise.resolve({remove:a})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,n){const s=this.listeners[e];if(!s){if(n){let o=this.retainedEventArguments[e];o||(o=[]),o.push(t),this.retainedEventArguments[e]=o}return}s.forEach(o=>o(t))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:n=>{this.notifyListeners(t,n)}}}unimplemented(e="not implemented"){return new E.Exception(e,C.Unimplemented)}unavailable(e="not available"){return new E.Exception(e,C.Unavailable)}async removeListener(e,t){const n=this.listeners[e];if(!n)return;const s=n.indexOf(t);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){!e||(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];!t||(delete this.retainedEventArguments[e],t.forEach(n=>{this.notifyListeners(e,n)}))}}const F=i=>encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),M=i=>i.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class ue extends q{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(n=>{if(n.length<=0)return;let[s,o]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=M(s).trim(),o=M(o).trim(),t[s]=o}),t}async setCookie(e){try{const t=F(e.key),n=F(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,o=(e.path||"/").replace("path=",""),a=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${n||""}${s}; path=${o}; ${a};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}_("CapacitorCookies",{web:()=>new ue});const ge=async i=>new Promise((e,t)=>{const n=new FileReader;n.onload=()=>{const s=n.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},n.onerror=s=>t(s),n.readAsDataURL(i)}),he=(i={})=>{const e=Object.keys(i);return Object.keys(i).map(s=>s.toLocaleLowerCase()).reduce((s,o,a)=>(s[o]=i[e[a]],s),{})},me=(i,e=!0)=>i?Object.entries(i).reduce((n,s)=>{const[o,a]=s;let r,g;return Array.isArray(a)?(g="",a.forEach(l=>{r=e?encodeURIComponent(l):l,g+=`${o}=${r}&`}),g.slice(0,-1)):(r=e?encodeURIComponent(a):a,g=`${o}=${r}`),`${n}&${g}`},"").substr(1):null,pe=(i,e={})=>{const t=Object.assign({method:i.method||"GET",headers:i.headers},e),s=he(i.headers)["content-type"]||"";if(typeof i.data=="string")t.body=i.data;else if(s.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[a,r]of Object.entries(i.data||{}))o.set(a,r);t.body=o.toString()}else if(s.includes("multipart/form-data")||i.data instanceof FormData){const o=new FormData;if(i.data instanceof FormData)i.data.forEach((r,g)=>{o.append(g,r)});else for(const r of Object.keys(i.data))o.append(r,i.data[r]);t.body=o;const a=new Headers(t.headers);a.delete("content-type"),t.headers=a}else(s.includes("application/json")||typeof i.data=="object")&&(t.body=JSON.stringify(i.data));return t};class ye extends q{async request(e){const t=pe(e,e.webFetchExtra),n=me(e.params,e.shouldEncodeUrlParams),s=n?`${e.url}?${n}`:e.url,o=await fetch(s,t),a=o.headers.get("content-type")||"";let{responseType:r="text"}=o.ok?e:{};a.includes("application/json")&&(r="json");let g,l;switch(r){case"arraybuffer":case"blob":l=await o.blob(),g=await ge(l);break;case"json":g=await o.json();break;case"document":case"text":default:g=await o.text()}const S={};return o.headers.forEach((b,A)=>{S[A]=b}),{data:g,headers:S,status:o.status,url:o.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}_("CapacitorHttp",{web:()=>new ye});var H;(function(i){i[i.Sunday=1]="Sunday",i[i.Monday=2]="Monday",i[i.Tuesday=3]="Tuesday",i[i.Wednesday=4]="Wednesday",i[i.Thursday=5]="Thursday",i[i.Friday=6]="Friday",i[i.Saturday=7]="Saturday"})(H||(H={}));const f=_("LocalNotifications",{web:()=>ie(()=>import("./web.c08caf4a.js"),["assets/web.c08caf4a.js","assets/index.7e234c3b.js","assets/index.f80becc5.css","assets/QCalendar.2dfe44a3.js","assets/QCalendarTask.ef5cc7a0.js","assets/utiFunc.f569f737.js"]).then(i=>new i.LocalNotificationsWeb)}),x=E.getPlatform();class ve{constructor(){this.name="CapacitorNotificationsWeb",this.platforms=["web"],this.pending=[],this.deliveredNotifications=[],this.doInit(),this.seen={},this.lastSeen=null}doInit(){x!="web"?console.log("CapacitorNotificationsWeb>>ANDROID Platform",x):console.log("CapacitorNotificationsWeb>>WEB Platform",x),this.checkPermissions(),this.createChannel(),this.registerActions(),this.getPending(),this.getDeliveredNotifications()}doPrint(){console.log("CapacitorNotificationsWeb>>","ALLGOOD")}getState(){return{pending:this.pending.length,delivered:this.deliveredNotifications.length}}async checkPermissions(){let e=await f.checkPermissions();console.log("registerNotifications>>CheckP",JSON.stringify(e)),e.display==="prompt"&&(e=await f.requestPermissions(),console.log("registerNotifications::requestP",JSON.stringify(e))),e.display!=="granted"&&console.log("registerNotifications::NOPE",e.display,e.receive)}async addListeners(){await f.addListener("localNotificationReceived",e=>{console.log("localNotificationReceived>>",JSON.stringify(e)),e!==void 0?(this.deliveredNotifications.push(e),this.seen[e.id]=!0,this.lastSeen=e.id):(console.log("localNotificationReceived>>UNDEFINED...what to do?",e,JSON.stringify(this.seen),JSON.stringify(this.lastSeen)),this.lastSeen?this.lastSeen=null:console.log("localNotificationReceived>>UNDEFINED..inDeliv/pending?",JSON.stringify(this.deliveredNotifications),JSON.stringify(this.pending)))}),await f.addListener("localNotificationActionPerformed",e=>{console.log("localNotificationActionPerformed::ACtion>> ",JSON.stringify(e))})}async getDeliveredNotifications(){let e=null;f.getDeliveredNotifications().then(t=>{console.log("getDeliveredNotifications",JSON.stringify(t)),console.log(t),e=t;for(const n in e.notifications)console.log("getDeliveredNotifications::Notif...inPENDING?"+n,JSON.stringify(e.notifications[n]),JSON.stringify(this.pending)),this.deliveredNotifications.push(e.notifications[n])}).catch(t=>{console.log("getDeliveredNotifications>>ERROR",JSON.stringify(t)),console.log(t)})}async createChannel(){if(x!="web"){let e=await f.listChannels();console.log("createChannel",JSON.stringify(e));let t=await f.checkExactNotificationSetting();console.log("ExactNotificationSetting>>CheckP",JSON.stringify(t)),t.exact_alarm!=="granted"&&(t=await f.changeExactNotificationSetting(),console.log("ExactNotificationSetting::requestP",JSON.stringify(t))),t.exact_alarm!=="granted"&&console.log("ExactNotificationSetting::NOPE",t.exact_alarm);let n=!1;for(const o in e.channels)if(e.channels[o].id=="LocNotifs"){n=!0;break}if(n){console.log("createChannel>>WOO LocNotifs exists!!");return}await f.createChannel({id:"LocNotifs",name:"Notifs",description:"Blu Notifs",importance:5,visibility:1,vibration:!0});let s=await f.listChannels();console.log("createChannel>>channelz>>CREATED",JSON.stringify(s))}}async registerActions(){const e={ok:{id:"ok",title:"OK"},add:{id:"add",title:"Add3"},skip:{id:"skip",title:"Skip"},go:{id:"go",title:"Nav"}},t={id:"start",actions:[e.ok,e.skip]},n={id:"end",actions:[e.add,e.go]},s={id:"nav",actions:[e.ok,e.go]};let o={types:[t,n,s]};await f.registerActionTypes(o)}async getPending(){const e=await f.getPending();console.log("getPending",JSON.stringify(e));for(const t in e.notifications){let n=e.notifications[t],s=n.schedule.at,o=Date.parse(s),a=new Date(s);console.log("getPending:: Notif>> ",JSON.stringify(s),JSON.stringify(o),JSON.stringify(new Date(o)),JSON.stringify(a));let r=o-Date.now();r<=0?console.log("getPending:: SKIPPED oldy>> ",r,JSON.stringify(s),JSON.stringify(o),JSON.stringify(a)):f.schedule({notifications:[{...n,schedule:{at:a},actionTypeId:"start"}]})}}scheduleLater(e,t){for(const n of e){let s=ne(se(t),{minute:oe(n.start.time)-1}),o=Date.parse(`${s.date} ${s.time}`),a=new Date(o),r={title:`Scheduled at ${R(n.start.time)}`,body:n.title,largeBody:`${n.title} from ${R(n.start.time)} to ${R(n.end.time)}`,id:n.id,schedule:{at:a,allowWhileIdle:!0,repeats:!0},attachments:null,actionTypeId:"start",iconColor:re(n.bgcolor),extra:{duration:n.duration,scorey:n.score},channelId:"LocNotifs"};this.pending.push(r)}}async schedule(e){f.schedule(e).then(t=>{console.log("schedule>>good",JSON.stringify(t)),console.log(t),this.deliveredNotifications.push(...e.notifications);let n=this.pending.length;this.pending=this.pending.filter(s=>!e.notifications.find(o=>o.id===s.id)),n!=this.pending.length?console.log("schedule>>PENDING change",n,this.pending.length):console.log("schedule>>PENDING SAME",n,this.pending.length)}).catch(t=>{console.log("schedule>>ERROR",JSON.stringify(t)),console.log(t),this.pending.push(...e.notifications)})}schedulePending(){console.log("schedulePending!!",JSON.stringify(this.pending),this.deliveredNotifications.length);for(const e of this.pending)f.schedule({notifications:[e]}).then(t=>{console.log("schedulePending>>good",JSON.stringify(t)),console.log(t),this.pending=this.pending.filter(n=>n.id!==e.id)}).catch(t=>{console.log("schedulePending>>ERROR",t),console.log(t),this.cancel(e.id)})}async cancel(e){for(let t=0;t<this.pending.length;t++)e==this.pending[t].id&&(console.log("cancel>>notif",e,JSON.stringify(this.pending[t])),this.doCancel({notifications:[this.pending[t]]}),this.pending.splice(t,1))}doCancel(e){f.cancel(e)}async removeDeliveredNotifications(e){return console.log("CapacitorNotificationsWeb::removeDeliveredNotifications"),f.removeDeliveredNotifications(e)}async removeAllDeliveredNotifications(){return console.log("CapacitorNotificationsWeb::removeAllDeliveredNotifications"),f.removeAllDeliveredNotifications()}}const Oe=new ve;export{Oe as L,q as W};
