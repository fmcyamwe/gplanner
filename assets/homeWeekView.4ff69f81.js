import{_ as R,$ as A,r as v,L as q,E as c,F as T,G as r,M as m,H as i,O as f,P as H,R as b,a0 as B,a1 as x,Q as z,I as S,K as y,a2 as w,a3 as C,J as _,a4 as L,a5 as D,a6 as j,a7 as F}from"./index.f91fcb48.js";import{a as O,b as U,Q as N,c as M}from"./utiFunc.495f7aee.js";import{t as W,a as g,p as E,b as G,c as K,i as P,Q as J,d as X,e as Y}from"./QCalendarTask.11a4c494.js";import{u as Z,a as $,Q as ee}from"./goalStorage.d9ff0887.js";import{Q as te}from"./QCalendar.686c6311.js";const se={name:"weekCalendar",components:{NavigationBar:A(()=>L(()=>import("./NavigationBar.713de98f.js"),["assets/NavigationBar.713de98f.js","assets/index.f91fcb48.js","assets/index.ddf7c1e7.css"])),QCalendar:te},data(){return Z(),{store:$(),calendar:v(null),currentDate:v(W()),events:[],mostEvts:5,treeGoals:v([]),expanded:v([]),showTree:v(!1),moods:v({})}},beforeMount(){this.loadEvts(),this.constructTree()},mounted(){console.log("mounted")},computed:{storedGoalsMap(){const e=new Map;let t=this.store.getSubGoals;return t?(t.forEach(s=>{e.set(s.id,s)}),e):(console.log("GoalsMap is empty or null",t),e)},label(){return this.showTree?"Hide Legend":"Show Legend"},allEvents(){return this.store.getAllDates},parentGoalsMap(){const e=new Map;let t=this.store.getMainGoals;return t?(t.forEach(s=>{e.set(s.id,s)}),e):(console.log("parentGoalsMap is empty or null",t),e)},storedEvents(){return this.store.getSubGoals},eventsMap(){const e={};return this.events.forEach(t=>{if(e[t.date]||(e[t.date]=[]),t.sortTime=g(G(t.date),{minute:E(t.time)}),e[t.date].push(t),t.days){console.log(`eventsMap multiple days? event for ${t.date}`,t.days);let s=K(t.date),d=t.days;do s=g(s,{day:1}),e[s.date]||(e[s.date]=[]),e[s.date].push(t);while(--d>0)}}),e}},methods:{classyColor(e){return`row items-center ${e.isChildren?"text-":"text-white bg-"}${e.color} `},loadEvts(){var d,o,l;let e=this.parentGoalsMap,t=this.storedGoalsMap,s=this.allEvents;if(t&&e){if(s)for(let h in s){let u=s[h];for(let a in u){let n=t.get(parseInt(a));if(n){let k=e.get(n.parentGoal),p=g(G(h),{minute:E(u[a].time)}),V=g(p,{minute:parseInt(u[a].duration)}),I="";u[a].notes!==void 0&&((d=u[a])==null?void 0:d.notes)!==""?I=[`${p.time} - ${V.time}`,`${(o=u[a])==null?void 0:o.atScore} >> ${n.score}`,`${(l=u[a])==null?void 0:l.notes}`].join(`
\r`):I=`${p.time} - ${V.time}`,u[a].byMood!==void 0&&(this.moods[h]||(this.moods[h]=[]),this.moods[h].push(...u[a].byMood)),this.events.push({id:n.id,title:n.title,details:I,time:u[a].time,duration:u[a].duration,date:h,bgcolor:k.bgcolor})}}}}else{console.log("ERROR--no parent or goals!!REVIEW**");return}},constructTree(){this.treeGoals=this.store.fetchGoalsTree()},getEvents(e){let t=(d,o)=>{let l=X(d.sortTime,o.sortTime);if(l>0)return-1;if(l==0)return 0;if(l<0)return 1};const s=this.eventsMap[e]||[];if(s.length===1)s[0].side="full";else if(s.length===2){const d=g(G(s[0].date),{minute:E(s[0].time)}),o=g(d,{minute:s[0].duration}),l=g(G(s[1].date),{minute:E(s[1].time)}),h=g(l,{minute:s[1].duration});P(l,d,o,!0)||P(h,d,o,!0)?(s[0].side="left",s[1].side="right"):(s[0].side="full",s[1].side="full")}return s.length>this.mostEvts&&(this.mostEvts=s.length),s.sort(t)},badgeClasses(e,t){return O(e,t)},badgeStyles(e,t,s=void 0,d=void 0){return U(e,t,s,d)},scrollToEvent(e){this.$refs.calendar.scrollToTime(e.time,350)},onToday(){this.$refs.calendar.moveToToday()},onPrev(){this.doReset=!0,this.$refs.calendar.prev()},onNext(){this.$refs.calendar.next()},onClickDate(e){console.log("onClickDate",e)},onClickTime(e){console.log("onClickTime",e)},onClickInterval(e){console.log("onClickInterval",e)},onClickHeadIntervals(e){console.log("onClickHeadIntervals",e)},onClickHeadDay({scope:e,event:t}){let s=e.timestamp.date,d=this.moods[s];console.log("onClickHeadDay",s,d),d&&this.$q.notify({color:"positive",position:"top",message:`Scheduled by mood: ${d.join()}`,icon:"tag_faces"})},onChange(e){this.mostEvts=5,console.log("onChange",e)}}},Q=e=>(j("data-v-2782c070"),e=e(),F(),e),ae={class:"q-pa-md"},le={class:"row justify-center"},oe={class:"q-px-md",style:{display:"flex","max-width":"800px",width:"100%",height:"400px",overflow:"auto"}},ne={style:{display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"2px"}},ie={class:"title q-calendar__ellipsis"},de={class:"title q-calendar__ellipsis"},re={class:"lineyy"},ce={key:0,class:"q-pa-md"},ue={key:0,class:"q-pa-md bg-grey-12",style:{"max-width":"400px"}},me=Q(()=>m("div",{class:"row justify-center"}," Goals & Goal Events ",-1)),he=Q(()=>m("br",null,null,-1)),pe={class:"q-mr-sm text-weight-bold",size:"28px"},fe={key:0},_e={class:"text-weight-bold liney"},ye={key:1,class:"text-weight-light text-black liney"},ge={key:1,class:"column justify-center items-center"},ve=Q(()=>m("br",null,null,-1));function xe(e,t,s,d,o,l){const h=q("navigation-bar"),u=q("q-calendar");return c(),T(J,null,{default:r(()=>[m("div",ae,[i(h,{onToday:l.onToday,onPrev:l.onPrev,onNext:l.onNext},null,8,["onToday","onPrev","onNext"]),m("div",le,[m("div",oe,[i(u,{ref:"calendar",modelValue:o.currentDate,"onUpdate:modelValue":t[0]||(t[0]=a=>o.currentDate=a),view:"week",dark:"",animated:"",hoverable:"",bordered:"","transition-prev":"slide-right","transition-next":"slide-left","no-active-date":"","interval-minutes":30,"interval-count":48,"interval-height":o.mostEvts*3,onChange:l.onChange,onClickDate:l.onClickDate,onClickTime:l.onClickTime,onClickInterval:l.onClickInterval,onClickHeadIntervals:l.onClickHeadIntervals,onClickHeadDay:l.onClickHeadDay},{"head-day-event":r(({scope:{timestamp:a}})=>[m("div",ne,[(c(!0),f(b,null,H(l.eventsMap[a.date],n=>(c(),f(b,{key:n.id},[n.time?(c(),T(N,{key:1,class:w(l.badgeClasses(n,"header")),style:D([l.badgeStyles(n,"header"),{margin:"1px",width:"10px","max-width":"10px",height:"10px","max-height":"10px",cursor:"pointer"}]),onClick:k=>l.scrollToEvent(n)},{default:r(()=>[i(M,null,{default:r(()=>[_(y(n.time+" - "+n.title),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"])):(c(),T(N,{key:0,class:w(l.badgeClasses(n,"header")),style:D([l.badgeStyles(n,"header"),{width:"100%",cursor:"pointer",height:"12px","font-size":"10px",margin:"1px"}])},{default:r(()=>[m("div",ie,[_(y(n.title)+" ",1),i(M,null,{default:r(()=>[_(y(n.details),1)]),_:2},1024)])]),_:2},1032,["class","style"]))],64))),128))])]),"day-body":r(({scope:{timestamp:a,timeStartPos:n,timeDurationHeight:k}})=>[(c(!0),f(b,null,H(l.getEvents(a.date),p=>(c(),f(b,{key:p.id},[p.time!==void 0?(c(),f("div",{key:0,class:w(["my-event",l.badgeClasses(p,"body")]),style:D(l.badgeStyles(p,"body",n,k))},[m("span",de,[_(y(p.title)+" ",1),i(M,null,{default:r(()=>[m("div",re,y(p.details),1)]),_:2},1024)])],6)):S("",!0)],64))),128))]),_:1},8,["modelValue","interval-height","onChange","onClickDate","onClickTime","onClickInterval","onClickHeadIntervals","onClickHeadDay"])])])]),i(B,{modelValue:o.showTree,"onUpdate:modelValue":t[1]||(t[1]=a=>o.showTree=a),label:l.label,color:"teal",class:"q-pa-md"},null,8,["modelValue","label"]),i(ee,null,{default:r(()=>[o.showTree?(c(),f("div",ce,[o.treeGoals.length>0?(c(),f("div",ue,[me,i(x),he,i(Y,{nodes:o.treeGoals,"node-key":"label",expanded:o.expanded,"onUpdate:expanded":t[2]||(t[2]=a=>o.expanded=a),"no-connectors":"",dense:"",accordion:"",defaultExpandAll:o.showTree},{"default-header":r(a=>[m("div",{class:w(l.classyColor(a.node))},[a.node.isChildren?S("",!0):(c(),T(z,{key:0,name:a.node.icon||a.expanded?"expand_less":"expand_more",size:"28px",class:"q-mr-sm"},null,8,["name"])),m("div",pe,y(a.node.label),1)],2)]),"default-body":r(a=>[a.node.isChildren?(c(),f("div",fe,[m("span",_e," >> "+y(a.node.details),1)])):(c(),f("span",ye,y(a.node.details),1))]),_:1},8,["nodes","expanded","defaultExpandAll"])])):(c(),f("div",ge,[ve,i(C,null,{default:r(()=>[_(" 1. Add some Goals first. A schedulable goal is one with a parent Goal--can have multiple related goals with the same parent. ")]),_:1}),i(x),i(C,null,{default:r(()=>[_(" 2. Go to Schedule to see a daily schedule. Drag scheduled events to new timeslots or click in calendar to add an event. ")]),_:1}),i(x),i(C,null,{default:r(()=>[_(" 3. Reload a saved daily schedule or defaults or choose minimal score events to schedule. Fix any scheduling conflicts. ")]),_:1}),i(x),i(C,null,{default:r(()=>[_(" 4. Save the daily schedule (dont forget to update their score as needed!) ")]),_:1}),i(x),i(C,null,{default:r(()=>[_(" 5. Check out the summary of all goals here! ")]),_:1})]))])):S("",!0)]),_:1})]),_:1})}var Ee=R(se,[["render",xe],["__scopeId","data-v-2782c070"]]);export{Ee as default};
