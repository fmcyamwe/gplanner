import{j as st,U as lt,W as nt,r as M,c as re,w as Ge,n as rt,h as pe,k as Ne,ay as at,D as dt,g as Ye,az as ht,ad as Pe,v as ct,aA as ut,aa as ye,aC as Ve,ab as Ae,Z as ft,d as gt,_ as Xe,E as _,F as K,G as k,H as A,M as x,K as W,a1 as Ce,bs as mt,bt as St,a0 as Ze,bu as pt,N as De,a3 as yt,bq as vt,$ as se,L as ee,O as F,I as U,J as te,Q as $e,a2 as ve,bv as bt,R as ae,P as _e,a5 as ge,a4 as le,aS as Me,f as Ct,a6 as Dt,a7 as Ot}from"./index.8665c327.js";import{w as V,c as ne,p as Tt,a as Et,b as Rt,d as wt,Q as be}from"./utiFunc.28172c65.js";import{T as Nt,Q as Pt,a as At}from"./QSelect.37c6e399.js";import{c as Be,a as $t,u as _t,Q as ke}from"./goalStorage.b9726de2.js";import{t as Oe,E as He,b as Y,a as B,p as j,d as ie,U as ce,i as Fe,V as Mt,m as Ie,l as de,c as Ue,Q as Bt,e as kt}from"./QCalendarTask.b9401ec8.js";import{a as It}from"./QCalendar.cf6bf144.js";/* empty css                             */import"./touch.70a9dd44.js";import"./QItem.48326827.js";var je=st({name:"QSplitter",props:{...lt,modelValue:{type:Number,required:!0},reverse:Boolean,unit:{type:String,default:"%",validator:i=>["%","px"].includes(i)},limits:{type:Array,validator:i=>i.length!==2||typeof i[0]!="number"||typeof i[1]!="number"?!1:i[0]>=0&&i[0]<=i[1]},emitImmediately:Boolean,horizontal:Boolean,disable:Boolean,beforeClass:[Array,String,Object],afterClass:[Array,String,Object],separatorClass:[Array,String,Object],separatorStyle:[Array,String,Object]},emits:["update:modelValue"],setup(i,{slots:e,emit:t}){const{proxy:{$q:o}}=Ye(),s=nt(i,o),l=M(null),n={before:M(null),after:M(null)},r=re(()=>`q-splitter no-wrap ${i.horizontal===!0?"q-splitter--horizontal column":"q-splitter--vertical row"} q-splitter--${i.disable===!0?"disabled":"workable"}`+(s.value===!0?" q-splitter--dark":"")),d=re(()=>i.horizontal===!0?"height":"width"),c=re(()=>i.reverse!==!0?"before":"after"),p=re(()=>i.limits!==void 0?i.limits:i.unit==="%"?[10,90]:[50,1/0]);function a(h){return(i.unit==="%"?h:Math.round(h))+i.unit}const v=re(()=>({[c.value]:{[d.value]:a(i.modelValue)}}));let T,g,C,D,O;function w(h){if(h.isFirst===!0){const y=l.value.getBoundingClientRect()[d.value];T=i.horizontal===!0?"up":"left",g=i.unit==="%"?100:y,C=Math.min(g,p.value[1],Math.max(p.value[0],i.modelValue)),D=(i.reverse!==!0?1:-1)*(i.horizontal===!0?1:o.lang.rtl===!0?-1:1)*(i.unit==="%"?y===0?0:100/y:1),l.value.classList.add("q-splitter--active");return}if(h.isFinal===!0){O!==i.modelValue&&t("update:modelValue",O),l.value.classList.remove("q-splitter--active");return}const f=C+D*(h.direction===T?-1:1)*h.distance[i.horizontal===!0?"y":"x"];O=Math.min(g,p.value[1],Math.max(p.value[0],f)),n[c.value].value.style[d.value]=a(O),i.emitImmediately===!0&&i.modelValue!==O&&t("update:modelValue",O)}const m=re(()=>[[Nt,w,void 0,{[i.horizontal===!0?"vertical":"horizontal"]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function u(h,f){h<f[0]?t("update:modelValue",f[0]):h>f[1]&&t("update:modelValue",f[1])}return Ge(()=>i.modelValue,h=>{u(h,p.value)}),Ge(()=>i.limits,()=>{rt(()=>{u(i.modelValue,p.value)})}),()=>{const h=[pe("div",{ref:n.before,class:["q-splitter__panel q-splitter__before"+(i.reverse===!0?" col":""),i.beforeClass],style:v.value.before},Ne(e.before)),pe("div",{class:["q-splitter__separator",i.separatorClass],style:i.separatorStyle,"aria-disabled":i.disable===!0?"true":void 0},[at("div",{class:"q-splitter__separator-area absolute-full"},Ne(e.separator),"sep",i.disable!==!0,()=>m.value)]),pe("div",{ref:n.after,class:["q-splitter__panel q-splitter__after"+(i.reverse===!0?"":" col"),i.afterClass],style:v.value.after},Ne(e.after))];return pe("div",{class:r.value,ref:l},dt(e.default,h))}}}),Lt=ht({name:"touch-hold",beforeMount(i,e){const{modifiers:t}=e;if(t.mouse!==!0&&Pe.has.touch!==!0)return;const o={handler:e.value,noop:ct,mouseStart(l){typeof o.handler=="function"&&ut(l)===!0&&(ye(o,"temp",[[document,"mousemove","move","passiveCapture"],[document,"click","end","notPassiveCapture"]]),o.start(l,!0))},touchStart(l){if(l.target!==void 0&&typeof o.handler=="function"){const n=l.target;ye(o,"temp",[[n,"touchmove","move","passiveCapture"],[n,"touchcancel","end","notPassiveCapture"],[n,"touchend","end","notPassiveCapture"]]),o.start(l)}},start(l,n){o.origin=Ve(l);const r=Date.now();Pe.is.mobile===!0&&(document.body.classList.add("non-selectable"),Be(),o.styleCleanup=d=>{o.styleCleanup=void 0;const c=()=>{document.body.classList.remove("non-selectable")};d===!0?(Be(),setTimeout(c,10)):c()}),o.triggered=!1,o.sensitivity=n===!0?o.mouseSensitivity:o.touchSensitivity,o.timer=setTimeout(()=>{o.timer=void 0,Be(),o.triggered=!0,o.handler({evt:l,touch:n!==!0,mouse:n===!0,position:o.origin,duration:Date.now()-r})},o.duration)},move(l){const{top:n,left:r}=Ve(l);o.timer!==void 0&&(Math.abs(r-o.origin.left)>=o.sensitivity||Math.abs(n-o.origin.top)>=o.sensitivity)&&(clearTimeout(o.timer),o.timer=void 0)},end(l){Ae(o,"temp"),o.styleCleanup!==void 0&&o.styleCleanup(o.triggered),o.triggered===!0?l!==void 0&&ft(l):o.timer!==void 0&&(clearTimeout(o.timer),o.timer=void 0)}},s=[600,5,7];if(typeof e.arg=="string"&&e.arg.length>0&&e.arg.split(":").forEach((l,n)=>{const r=parseInt(l,10);r&&(s[n]=r)}),[o.duration,o.touchSensitivity,o.mouseSensitivity]=s,i.__qtouchhold=o,t.mouse===!0){const l=t.mouseCapture===!0||t.mousecapture===!0?"Capture":"";ye(o,"main",[[i,"mousedown","mouseStart",`passive${l}`]])}Pe.has.touch===!0&&ye(o,"main",[[i,"touchstart","touchStart",`passive${t.capture===!0?"Capture":""}`],[i,"touchend","noop","notPassiveCapture"]])},updated(i,e){const t=i.__qtouchhold;t!==void 0&&e.oldValue!==e.value&&(typeof e.value!="function"&&t.end(),t.handler=e.value)},beforeUnmount(i){const e=i.__qtouchhold;e!==void 0&&(Ae(e,"main"),Ae(e,"temp"),e.timer!==void 0&&clearTimeout(e.timer),e.styleCleanup!==void 0&&e.styleCleanup(),delete i.__qtouchhold)}});const xt=()=>!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);let ue,q;function Gt(){ue={},q=$t()}function Vt(){ue.pGoalsMap==null;const i=new Map;let e=et();return e?(e.forEach(t=>{i.set(t.id,t)}),ue.pGoalsMap=i,i):(console.log("Repo:: parentGoalsMap is empty or null",e),i)}function Ht(i){return q.hasEventsForDate(i)}function qe(i){return q.getEventsForDate(i)}function et(){return q.getMainGoals}function Ft(){return ue.subGoals==null&&(ue.subGoals=q.getSubGoals),ue.subGoals}function Ut(){return q.fetchAlternativeEvts()}function jt(){return q.currentBalance()}function qt(){return q.fetchGoalsTree()}function zt(){let i=q.fetchAllPrio();return!i.size>0?(console.log("ERROR...no Priority goals?",i),[]):Array.from(i.values()).sort()}function ze(i){return q.fetchGoalsUpToMaxScore(i)}function We(i,e=null,t=null){q.saveSubProp(i,e,t)}function Wt(){return q.getGoalByTitle("Misc")}function Je(i){q.setBalance(i)}function Qe(i,e){q.saveDailySchedule(i,e)}function Jt(i,e,t,o){return q.addMainGoal(i,e,t,o)}function he(i,e,t,o,s,l,n,r,d){return q.addSubGoal(i,e,t,o,s,l,n,r,d)}function Qt(i,e,t=null){let o=i,s=e.id,l=e,n=t,r=i.duration,d=i.time,c=null,p=null;return{id:s,duration:r,time:d,date:()=>c,datey:a,score:v(),atScore:o.atScore,getGoal:()=>l,getPGoal:()=>n,data:()=>o,setData:h=>o=h,setMoods:h=>p=h,getMoods:D,setNotes:h=>h,hasNote:T,setDura:h=>r=h,setTime:h=>d=h,setDate:h=>c=h,durationChanged:g,timeChanged:C,parsedScore:O,withPropsEventsTo:m,addPropsEventsTo:u};function a(){return c}function v(){return o.atScore||e.score}function T(){return i.notes!==void 0}function g(){return i.duration!==e.duration}function C(){return i.time!==e.time}function D(){return"byMood"in o&&(p=o.byMood),p}function O(){const h=v().split(/on/);return h.length!=2?-89:h[1]-h[0]}function w(h){if(!h)return"";let f=h.split(":");return parseInt(f[0])>=12?h+"PM":h+"AM"}function m(h,f=null){let b=Object.assign({},{...this});return b.bgcolor=h.bgcolor,b.jeSuis?b.details=`Of '${h.title.trim()}' :: << ${b.jeSuis.join(",")} >>`:b.details=`Of '${h.title.trim()}' :: ${w(b==null?void 0:b.time)} -> ${b==null?void 0:b.duration}min -- ${b!=null&&b.inDefaults?"Dft:":":"}${b!=null&&b.canMove?":Mv:":":"}${b!=null&&b.isAlternative?":Alt":":"}`,console.log("withProps",JSON.parse(JSON.stringify(b)),b.datey(),b.date(),b.title,b.details),b}function u(h){if(!n){console.log("addProps:: ERROR no parentGoal",this.data);return}this.data,getGoal();let f=Object.assign({},{...sav});return f.bgcolor=t.bgcolor,f.jeSuis?f.details=`Of '${t.title.trim()}' :: << ${f.jeSuis.join(",")} >>`:f.details=`Of '${t.title.trim()}' :: ${w(f==null?void 0:f.time)} -> ${f==null?void 0:f.duration}min -- ${f!=null&&f.inDefaults?"Dft:":":"}${f!=null&&f.canMove?":Mv:":":"}${f!=null&&f.isAlternative?":Alt":":"}`,console.log("addProps",JSON.parse(JSON.stringify(f)),f.datey(),f.date(),f.title,f.details),f}}class Kt{constructor(e,t){this.showReloadBtn=!1,this.showClearBtn=!1,this.showLoadDefaults=!0,this.showScoreBtn=!0,this.showPrioBtn=!0,this.showOneEachBtn=!1,this.disablePrioBtn=!0,this.disableScoreBtn=!0,this.disableSaveSchedule=!0,this.chosenScore=null,this.chosenPrio=null,this._dailyScheduled=new Map,this._endTimesSet=new Set,this._startTimesSet=new Set,this.savedRawEvts=[],this.usingMoods={},this.isDisabledScoreEdit={},this.hasStarted={},this.mobileEnableScore={},this.showMobileDialog={},this.currentDate=e,this.mobile=t,Gt()}allPGoals(){return et()}getAllEvts(){return this._dailyScheduled}showEvtNoteScoreMobile(e){return this.mobileEnableScore[e]&&this.showMobileDialog[e]}toggleEvtNoteScoreMobile(e){(this.isViewingPast()||this.isViewingToday())&&(this.showMobileDialog[e]=!0)}euhHidin(e){this.showMobileDialog[e]=!1}getCurrentSchedTimesSets(){return{endSet:this._endTimesSet,startSet:this._startTimesSet}}isViewingPast(){let e=Oe();if(this.currentDate&&this.currentDate==e)return!1;let t=He(Y(e));return!(He(Y(this.currentDate))>=t)}isViewingToday(){return Oe()==this.currentDate}toggle(){this.showReloadBtn=!this.showReloadBtn}getProps(){return{showReloadBtn:this.showReloadBtn,showClearBtn:this.showClearBtn,showLoadDefaults:this.showLoadDefaults,showScoreBtn:this.showScoreBtn,showPrioBtn:this.showPrioBtn,showOneEachBtn:this.showOneEachBtn,disablePrioBtn:this.disablePrioBtn,disableScoreBtn:this.disableScoreBtn,chosenScore:this.chosenScore,chosenPrio:this.chosenPrio}}saveBtnEnabled(){return this.disableSaveSchedule}fetchGoalsTree(){return qt()}getCurrentBalance(){return jt()}getAllPrio(){return zt()}getSubGoals(){return Ft()}getCurrentMoods(){return this.usingMoods}getSubGoalByID(e){let t=this.getSubGoals(),o=parseInt(e);for(let s=0;s<t.length;s++)if(t[s].id===o)return t[s];return null}getOriginalEvtTime(e){let t=this.getSubGoalByID(e);return t?t.time:""}getStoredRawEvt(e){return e in this.savedRawEvts?this.savedRawEvts[e]:null}getAltEvts(){return Ut()}getEventsForDate(e){return qe(e)}updateDaySchedule(e,t){Qe(e,t)}parentGoalsMap(){return Vt()}parentGoalById(e){return this.parentGoalsMap().has(e)?this.parentGoalsMap().get(e):null}findSchedEvent(e){return this._dailyScheduled.has(e)?this._dailyScheduled.get(e):null}hasEventsForDate(){return Ht(this.currentDate)}scheduledEventsMap(){const e={};return this._dailyScheduled.forEach((t,o,s)=>{let l=t.date;e[l]||(e[l]=[]),e[l].push(t)}),e}schedEvtWithProps(e,t,o){if(!e.getPGoal()){console.log("schedEvtWithProps:: ERROR no parentGoal",e.data);return}let s=e.data(),l=e.getGoal(),n=e.getPGoal(),r={...l};(e.timeChanged()||e.durationChanged())&&(r.time=s.time,r.duration=s.duration),e.setDate(this.currentDate);let d=e.getMoods();if(d){//!==
this.usingMoods[r.id]=d}r.date=this.currentDate,r.bgcolor=n.bgcolor,r.icon=n.icon,r.start=t,r.end=o;let c=`Of '${n.title.trim()}' :: ${V(r==null?void 0:r.time)} -> ${r==null?void 0:r.duration}min -- ${r!=null&&r.inDefaults?"Dft:":":"}${r!=null&&r.canMove?":Mv:":":"}${r!=null&&r.isAlternative?":Alt":":"}`;return r.jeSuis&&r.jeSuis.length>0&&(c+=d?` <>Mood:'${d}' >>${r.jeSuis.join(",")}`:` << ${r.jeSuis.join(",")} >>`),r.details=c,e.hasNote()&&(r.notes=s.notes),r}doProppy(e,t){let o=this.parentGoalById(e.parentGoal);if(!o){console.log("doProppy:: ERROR no Pgoal found ?!?",e);return}let s=B(Y(t),{minute:j(e.time)}),l=B(s,{minute:e.duration}),n=Object.assign({},{...e,date:t,bgcolor:o.bgcolor,start:s,end:l,icon:o.icon});return e.jeSuis&&e.jeSuis.length>0?n.details=`Of '${o.title.trim()}' :: << ${e.jeSuis.join(",")} >>`:n.details=`Of '${o.title.trim()}' :: ${V(e==null?void 0:e.time)} -> ${e==null?void 0:e.duration}min -- ${e!=null&&e.inDefaults?"Dft:":":"}${e!=null&&e.canMove?":Mv:":":"}${e!=null&&e.isAlternative?":Alt":":"}`,"byMood"in e&&(console.log("doProppy::BYMOOD found!! "+n.id,JSON.parse(JSON.stringify(e))),this.usingMoods[n.id]=e.byMood),n}updateDetz(e){var s,l;let o=`Of '${(l=(s=this.parentGoalById(e.parentGoal))==null?void 0:s.title)==null?void 0:l.trim()}' :: ${V(e==null?void 0:e.time)} -> ${e==null?void 0:e.duration}min -- ${e!=null&&e.inDefaults?"Dft:":":"}${e!=null&&e.canMove?":Mv:":":"}${e!=null&&e.isAlternative?":Alt":":"}`;return e.jeSuis&&e.jeSuis.length>0&&(o+=this.usingMoods[e.id]?` <> Mood:'${this.usingMoods[e.id]}' >>${e.jeSuis.join(",")}`:` << ${e.jeSuis.join(",")} >>`),e.details=o,e}massageManyToOneOverlaps(e){let t=[],o=()=>{let r=[];return e.filter(d=>{d[0]=="withID"&&r.push(d[1])}),r},s=e.filter(r=>r[0]!="withID"),l=o(),n=[];for(let r=0;r<s.length;r++){let d=s[r][0];if(l.some(p=>p==d))n.push(...s[r][1]);else if(t.find(a=>a[0]==d)){let a=t.findIndex(v=>v[0]==d);t[a]=[d,[...t[a][1],...s[r][1]]]}else t.push([d,[...s[r][1]]])}if(n.length>0){this.doLog("massageManyToOneOverlaps::ADD SAMEY",n);let r=null,d=[];for(let p=0;p<n.length;p++){let a=n[p];t.find(T=>T[0]==a.inConflict)||(a.target!=r?(t.push([a.inConflict,[a]]),d.push(a.target),r=a.target):console.log("massageManyToOneOverlaps::INCONF same current target? ERROR?",r,a))}let c=l.filter(p=>!d.some(a=>a==p));if(c.length>0){let p=0;do{let a=c[p],v=n.filter(T=>T.target==a);console.log("massageManyToOneOverlaps::ADDING",a,v),t.push([a,[...v]]),t.find(T=>T[0]=="withID")?console.log("WOAH WOAH massageManyToOneOverlaps::WITHID already present?!!ERROR ",t):t.push(["withID",a])}while(++p<c.length)}}return t}massageOneToMany(e){let t=[],o={};for(let s=0;s<e.length;s++){let l=e[s],n=t.find(r=>r[0]==l.inConflict);if(n){let r=t.findIndex(d=>d[0]==l.inConflict);t[r]=[l.inConflict,[...n[1],l]]}else if(t.push([l.inConflict,[l]]),!o[l.target])o[l.target]=[],o[l.target].push(l);else{t.pop();let r=t.pop();if(t.push([l.target,[...r[1],l]]),t.find(d=>d[0]=="withID")){let d=t.findIndex(c=>c[0]=="withID");console.log("WOAH WOAH massageOneToMany::WITHID already present?!!ERROR at "+d,t[d])}else t.push(["withID",l.target])}}return t}addGoalsToSchedule(e,t){let o=[];return e.sort(function(s,l){return j(s.time)-j(l.time)}),e.forEach(s=>{let l=this.addToSchedule(s,t,!1);l?Array.isArray(l)&&o.push(...l):console.log("addGoalsToSchedule:: ERROR Evt NOT added",l,t,s.id,s.title,s.time)}),this.massageManyToOneOverlaps(o)}addToSchedule(e,t,o=!1){if(!this._dailyScheduled.has(e.id)){let s=B(Y(this.currentDate),{minute:j(e.time)}),l=B(s,{minute:e.duration});if(t){let d=this.hasOverlappingEvent(e.id,s,l);if(d.length>0)return this.massageOneToMany(d)}let n=o?this.schedEvtWithProps(e,s,l):this.doProppy(e,this.currentDate);n.sortTime=s;let r={...n,for:n.duration,start:s,end:l};return this._dailyScheduled.set(n.id,r),this._endTimesSet.add(l.time),this._startTimesSet.add(s.time),this.enableNoteScoreEdit(n.id,s,l),!0}return!1}reAddScheduled(e){let t=this.findSchedEvent(e),o=this.getStoredRawEvt(e);console.log(`reAddScheduled for ${e} ${t?"":"ERROR NOT IN?"}`,t,o)}doSortingByTime(e){let t=(s,l)=>{let n=j(s[1].time),r=j(l[1].time);return n<r?-1:r>n?1:0};const o=[];for(let s in e)o.push([s,e[s]]);return o.sort(t),this.doLog("doSortingByTime---After",o),Object.fromEntries(o)}anotherSorting(e){return Object.entries(e).sort(([,o],[,s])=>j(o.time)-j(s.time))}enrichAddToSchedule(){let e=[],t=this.isViewingToday();console.log("enrichAddToSchedule",Object.keys(this.savedRawEvts).length,"overlapCheck:"+t);let o=this.anotherSorting(this.savedRawEvts);for(let s=0;s<o.length;s++){let l=o[s][0],n=o[s][1],r=this.getSubGoalByID(l);if(!r){console.log(`enrichAddToSchedule:: ERROR No goal found for key: ${l}...skipping!`);continue}let d=this.parentGoalById(r.parentGoal),c=Qt(n,r,d),p=this.addToSchedule(c,t,!0);p?Array.isArray(p)&&e.push(...p):console.log("enrichAddToSchedule..ERROR?!? not added",p,r)}return this.massageManyToOneOverlaps(e)}loadEvtsForDay(e){return e||this.resetSchedule(!0),this.savedRawEvts=qe(this.currentDate),this.savedRawEvts?{overlaps:this.enrichAddToSchedule(),canContinue:!1}:{overlaps:null,canContinue:!0}}onChangeViewDate(e){let t=e==this.currentDate;return this.currentDate=e,this.enableActionBtns(),this.loadEvtsForDay(t)}resetSchedule(e=!1){this.savedRawEvts=[],this._dailyScheduled=new Map,this._endTimesSet=new Set,this._startTimesSet=new Set,e&&(this.usingMoods={}),this.showReloadBtn=!1,this.showClearBtn=!1,this.disableSaveSchedule=!0}unscheduledDefaults(){return this.getSubGoals().filter(t=>(t==null?void 0:t.inDefaults)&&(t==null?void 0:t.time)!=""&&!this._dailyScheduled.has(t.id));//!this.actualEvts.find(x => x.id == evt.id))
}unscheduled(){return this.getSubGoals().filter(t=>!this._dailyScheduled.has(t.id));//!this.actualEvts.find(item => item.id == x.id)
}subGoalsOfParent(e){return this.getSubGoals().filter(o=>o.parentGoal==e)}chosenScoreLabel(){return this.chosenScore==null?"By Score":`Score <= ${this.chosenScore}`}chosenPrioLabel(){return this.chosenPrio==null?"By Priority":`Prio = ${this.chosenPrio}`}filterSchedToCurrentPrio(){let e=[];return this._dailyScheduled.forEach((t,o,s)=>{var l;((l=this.parentGoalById(t.parentGoal))==null?void 0:l.priority)==this.chosenPrio&&e.push(t)}),e}calculatePrioEvts(){let e=this.getSubGoals().filter(o=>{var s;return((s=this.parentGoalById(o.parentGoal))==null?void 0:s.priority)==this.chosenPrio}),t=e.filter(o=>!this._dailyScheduled.has(o.id));//!this.actualEvts.find(item => item.id == x.id)) //add those not scheduled
this.byPrio={prio:this.chosenPrio,toAdd:t,reset:e,filter:this.filterSchedToCurrentPrio()}}onChoosenPrio(e){let t=this.chosenPrio;t&&t==e?this.disablePrioBtn=!0:(this.chosenPrio=e,this.disablePrioBtn=!1,this.calculatePrioEvts())}scheduleSamePrio(e){const t=n=>{console.log("scheduleSamePrio::RECALCULATE?!?",n,this.chosenPrio,JSON.parse(JSON.stringify(this.byPrio)));let r=this.getSubGoals().filter(d=>{var c;return((c=this.parentGoalById(d.parentGoal))==null?void 0:c.priority)==this.chosenPrio});return n=="reset"?r:r.filter(d=>!this._dailyScheduled.has(d.id));//!this.actualEvts.find(item => item.id == x.id)
};let o=[];if(e=="filter"?(o=this.filterSchedToCurrentPrio(),this.resetSchedule()):(this.byPrio?e=="add"?o=this.byPrio.toAdd:o=this.byPrio.reset:o=t(e),e!="add"?this.resetSchedule():console.log("scheduleSamePrio::No resetSchedule",e,o.length)),o.length<1)return{overlaps:null,canContinue:!1};let s=this.addGoalsToSchedule(o,this.isViewingToday()),l=s.length;return this.updateCurrentMoods(),this.toggleActionBtns(l>0,"byPrio"),{overlaps:s,canContinue:!(l>0),added:o.length}}filterSchedToCurrentScore(){let e=[];return this._dailyScheduled.forEach((t,o,s)=>{let l=ne(t.score);l>-1&&l<=this.chosenScore&&e.push(t)}),e}calculateScoreEvts(){let e=ze(this.chosenScore),t=e.filter(o=>!this._dailyScheduled.has(o.id));//!this.actualEvts.find(item => item.id == x.id)
this.byScore={score:this.chosenScore,toAdd:t,reset:e,filter:this.filterSchedToCurrentScore()}}onChoosenScore(e){let t=this.chosenScore;t&&t==e?this.disableScoreBtn=!0:(this.chosenScore=e,this.disableScoreBtn=!1,this.calculateScoreEvts())}scheduleByScore(e){const t=n=>{console.log("scheduleByScore::RECALCULATE?!?",n,this.chosenScore,JSON.parse(JSON.stringify(this.byScore)));let r=ze(this.chosenScore);return n=="reset"?r:r.filter(d=>!this._dailyScheduled.has(d.id))};let o=[];if(e=="filter"?(o=this.filterSchedToCurrentScore(),this.resetSchedule()):(this.byScore?e=="add"?o=this.byScore.toAdd:o=this.byScore.reset:o=t(e),e!="add"&&this.resetSchedule()),o.length<1)return{overlaps:null,canContinue:!1};let s=this.addGoalsToSchedule(o,this.isViewingToday()),l=s.length;return this.updateCurrentMoods(),this.toggleActionBtns(l>0,"byScore"),{overlaps:s,canContinue:!(l>0),added:o.length}}scheduleOneEach(e,t=null){const o=d=>{let c=[];return this.parentGoalsMap().forEach((p,a,v)=>{let T=this.subGoalsOfParent(p.id);if(T.length>0){let g=null,C=T.length;if(d)g=T[Math.floor(Math.random()*C)];else{let D=0;for(;this._dailyScheduled.has(T[C].id);)if(D++,C=Math.floor(Math.random()*T.length),console.log(`selectOneFromP::index ${C} scheduled...new random> At try> `+D,T.length),D>2){console.log("selectOneFromP::random...TOO MANY TRIES..ERROR?",D,C,T.length,T);break}g=T[C],console.log("selectOneFromP::NO Random at index: "+C,D,g)}c.push(g)}else t&&t(`No Evt goal for Parent: '${p==null?void 0:p.title}'`,"warning")}),c},s=()=>{let d=this.unscheduled(),c=[];return this.parentGoalsMap().forEach((p,a,v)=>{let T=d.filter(C=>C.parentGoal==p.id),g=T.length;if(g>0){let C=T[Math.floor(Math.random()*g)];c.push(C)}else{let C=this.subGoalsOfParent(p.id).length>0,D=C?`All goals for Parent: '${p==null?void 0:p.title}' already scheduled`:`Parent: '${p==null?void 0:p.title}' has No Goals :(`;t&&t(D,C?"info":"warning")}}),c};let l=[];if(e=="add"?(l=s(),console.log("scheduleOneEach...TOADD>> "+l.length)):(this.resetSchedule(),l=o(!0)),l.length<1)return console.log("Empty for OneEach :("),{overlaps:null,canContinue:!1};let n=this.addGoalsToSchedule(l,this.isViewingToday()),r=n.length;return this.updateCurrentMoods(),this.toggleActionBtns(l.length-r>0,"oneEach"),{overlaps:n,canContinue:!(r>0),added:l.length}}scheduleByMood(e){var l;let t=[];for(let n=0;n<e.length;n++){let r=this.getSubGoalByID(e[n].id);r&&r.time!=""&&(t.push(r),this.usingMoods[e[n].id]=(l=e[n])==null?void 0:l.mood)}if(t.length<1)return this.doLog("scheduleByMood::Error? as Empty Moods with toAdd ",e),{overlaps:null,canContinue:!1};let o=this.addGoalsToSchedule(t,this.isViewingToday()),s=o.length;return s>0?console.log(`scheduleByMood overlaps!! Try reload= ${t.length} with overlaps =${s}`):this.toggleActionBtns(t.length>0,"ByMood"),{overlaps:o,canContinue:!(s>0),added:t.length}}scheduleDefaults(e){let t=null;e=="add"?t=this.unscheduledDefaults():(this.resetSchedule(),t=this.unscheduledDefaults()),this.showReloadBtn=this.hasEventsForDate(),this.showClearBtn=!this.isViewingPast()&&t.length>0;let o=this.addGoalsToSchedule(t,this.isViewingToday()),s=o.length;return this.updateCurrentMoods(),this.toggleActionBtns(t.length-s>0,"defaults"),{overlaps:o,canContinue:!(s>0)}}saveNewGoal(e,t,o,s,l){if(s=="self"){let n=this.addParentGoal(t,t,"red-14",2);return n?he(n,t,"1on5",e.time,l,!0,!1,l<30):(console.log("ERROR? no pID",n),n===0?he(n,t,"1on5",e.time,l,!0,!1,l<30):null)}else if(o){return console.log("with parentGoal "+o.id,o==null?void 0:o.title),he(o.id,t,"1on5",e.time,l,!1,!1,l<30);//!canMove and notInDefaults. isAlternative when duration<30
}else{let n=Wt();if(n)return he(n.id,t,"1on5",e.time,l,!1,!1,l<30);{let r=this.addParentGoal("Misc","Miscellaneous","grey-10",2);return r?he(r,t,"1on5",e.time,l,!0,!1,l<30):(console.log("ERROR? no pID",r),r===0?he(r,t,"1on5",e.time,l,!0,!1,l<30):null)}}}addParentGoal(e,t,o,s=2){let l=[];this.parentGoalsMap().forEach((d,c,p)=>{let a=d.bgcolor;l.push(a)});let n=Tt(),r=n.filter(d=>!l.find(c=>c==d));if(r.length>1){let d=Math.floor(Math.random()*r.length),c=r[d];console.log(`addParentGoal::bgcolor..index ${d} from ${o} to:`,c),o=c||o}else console.log("addParentGoal::NONE available",r,n);return Jt(e,t,o,s)}addMinsToEvt(e,t,o=null){const s=(a,v,T)=>{let g=a.end,C=this.updateDetz({...a,for:v,duration:v,end:T});return this._dailyScheduled.set(e,C),this._endTimesSet.delete(g.time)||console.log("ERROR endTimesSet item does not exist?!?"+g.time,a,this._endTimesSet),this._endTimesSet.add(T.time),o&&o(`addMinsToEvt::${t} Saving...`),this.saveDaySchedule(),{overlaps:null,canContinue:!0}};let l=this.findSchedEvent(e);if(!l){console.log("ERROR addMinsToEvt EVT not found!!!",e);return}let n=l.end,r=B(n,{minute:parseInt(t)}),d=parseInt(t)+l.for,c=this.hasOverlappingEvent(e,l.start,r);return c.length>0?{overlaps:this.massageOneToMany(c),canContinue:!1}:s(l,d,r)}onPickEvent(e,t,o,s,l=null){const n=()=>{s&&(this.removeFromBalance(e==null?void 0:e.duration),console.log("onPickEvent...useBalance","force?"+o));let p=this.addToSchedule({...e,time:t.time},!1);return this.isViewingPast()||s?this.saveDaySchedule():this.toggleActionBtns(!0,"onPickEvt"),{overlaps:p,canContinue:!0}};let r=B(t,{minute:e.duration}),d=this.hasOverlappingEvent(e.id,t,r),c=d.length;if(c>0){console.log("onPickEvent::OVERLAPS!!"+c,"with force "+o,JSON.parse(JSON.stringify(d)));let p=this.massageOneToMany(d),a={overlaps:p,canContinue:!1};if(c>1||!o)return a;l&&l(`onPickEvent:: ${c} OVERLAPS! Forcing...`,"info"),this.toggleActionBtns(!0,"onPickEvt");for(let v=0;v<c;v++){let T=p[v][1],g=0;do this.recurChangeTime(T[g].inConflict,e,t,!0,l);while(++g<T.length)}return s&&this.removeFromBalance(e==null?void 0:e.duration),this.isViewingPast()||s?this.saveDaySchedule():this.toggleActionBtns(!0,"onPickEvt"),{overlaps:null,canContinue:!0}}else return n()}onAdHocEvent(e,t,o,s=null){const l=c=>(o?(this.removeFromBalance(c==null?void 0:c.duration),console.log("onAdHocEvent...using Balance",c==null?void 0:c.duration),this.saveDaySchedule(),s&&s("Saving Schedule with New adHoc...","positive")):s&&s("New adHoc Evt added!! ...doSave eh","info"),{overlaps:null,canContinue:!0});let n=this.getSubGoalByID(e);if(!n)return{overlaps:null,canContinue:!1};let r=this.addToSchedule(n,!0),d=Array.isArray(r);if(!r||d){this.doLog("onAdHocEvent::Overlaps!!",r);let c={overlaps:r,canContinue:!1},p=r.length;if(d&&p>1)return c;if(d&&p==1){s&&s(`onAdHocEvent:: ${p} OVERLAPS! Forcing...`,"warning");for(let a=0;a<p;a++){let v=r[a][1],T=0;do this.recurChangeTime(v[T].inConflict,n,t,!0,s);while(++T<v.length)}return l(n)}return c}return l(n)}recurChangeTime(e,t,o,s=!1,l=null){var r,d,c,p,a,v;let n=this.findSchedEvent(e);if(n){let T=j(n.start.time)-j(o.time),g=`${T>0?"DOWN":"UP"}`,C=null;if(T>=0){C=B(o,{minute:parseInt(t.duration)+10});let u=B(o,{minute:parseInt(n.for)+10});console.log(`recurChangeTime::START>>(${e}) '${n==null?void 0:n.title}' ${n==null?void 0:n.for} mins going FORWARD ${g} for ${T} due to evt:(${t.id})${(r=t==null?void 0:t.title)==null?void 0:r.trim()} at ${o.time} 
          
 doAdd?:${s} >`,JSON.parse(JSON.stringify(C.time)),"alt:",u.time);let h=ie(u,C);if(h>0){let f=Math.floor(h/1e3/60);f<=T?console.log(`recurChangeTime::(${e}) duration:${n.for} vs evtDura:${t.duration}...USING overlappedEvtNew ${C.time}!! ${f} <= dragInterval ${T} `,u.time):(console.log(`recurChangeTime::DIFFY = ${h} and ${f} >= dragInterval ${T}...
COULD USE ALTERNATIVE as duration:${n.for} vs evtDura:${t.duration}`,C.time,u.time),T==0?C=u:console.log("recurChangeTime::NOT USING ALTERNATIVE",u.time))}}else{C=B(o,{minute:-(parseInt(n.for)+10)});let u=B(o,{minute:-(parseInt(t.duration)+10)});console.log(`recurChangeTime::START>>(${e}) '${n==null?void 0:n.title}' going BACKWARD ${g} for ${T} due to evt:(${t.id})${(d=t==null?void 0:t.title)==null?void 0:d.trim()} at ${o.time}
          
 doAdd?:${s}`,C.time,"alt:"+u.time)}let D=this.hasOverlappingEvent(e,C,B(C,{minute:n.for})),O=D.length;if(O>0){let u=0;l&&l(`${O} Cascading Overlaps handling (${e}) '${n==null?void 0:n.title}' going ${g} as ${s?"Adding":"Moving"} '${(c=t==null?void 0:t.title)==null?void 0:c.trim()}'`);do{if(console.log(`CASCADING OVERLAPPED timeChange >> ${u} (${e}) at: ${C.time} now at: ${n.start.time} till ${n.end.time}`,D[u]),D[u].inConflict==t.id){console.log(`EUUUH...ERROR::recurChangeTime::self overlap?!?OVERLAPPED:${e} ...break `+u,O,D[u].inConflict,t.id);break}this.recurChangeTime(D[u].inConflict,n,C,!1,l)}while(++u<O)}this.changeEvtTime(n,C);let w=o;if(console.log(`recurChangeTime::${s?"Adding":"Moving"} TARGET>>(${t.id})${(p=t==null?void 0:t.title)==null?void 0:p.trim()} >> ${w.time}`),!s){this.changeEvtTime(t,w);return}let m=this.addToSchedule({...t,time:w.time},this.isViewingToday());if(m.length>0){this.doLog(`recurChangeTime::EXTRA OVERLAP ${s?"Adding":"Moving"} TARGET ${(a=t==null?void 0:t.title)==null?void 0:a.trim()}`,m),l&&l(`EXTRA OVERLAPS ${s?"Adding":"Moving"} TARGET ${(v=t==null?void 0:t.title)==null?void 0:v.trim()}`),m.find(y=>y[0]=="withID")&&(m=m.filter(y=>y[0]!="withID"),this.doLog("recurChangeTime::TARGET::WITHID!!!Now>>",m.length));let h=m.length,f=0;do{let y=m[f][1],b=y.length-1;for(;b>=0;b--){if(y[b].inConflict==t.id){console.log("EUUUH...::recurChangeTime::TARGET>>OVERLAP::self overlap?!?...breaking!",y[b].inConflict,t.id,y[b].targetStart);break}this.recurChangeTime(y[b].inConflict,t,w,s,l)}}while(++f<h)}}else console.log("recurChangeTime::ERROR ERROR >> overlapped event not found!","doAdd? "+s,e,t)}hasOverlappingEvent(e,t,o){const s=[];return this._dailyScheduled.forEach((l,n,r)=>{if(n!=e){let d=this.checkOverlapByTime(t,o,l.start,l.end);d&&s.push({target:e,targetStart:t,direction:d,inConflict:n})}}),s}checkOverlapByTime(e,t,o,s){let l=this.getTimeyNumber(e),n=this.getTimeyNumber(t),r=this.getTimeyNumber(o),d=this.getTimeyNumber(s);if(l===!1||r===!1||n===!1||d===!1)return console.log("ERROR... checkOverlapByTime error",l,n,r,d),!1;let c=!1;l>r&&l<d&&(c="bas"),n>r&&n<d&&(c="haut");let p=r>=l&&n>=d,a=l>=r&&n<=d;return(p||a)&&(c="surrounding"),c}canDropEvent(e,t){let o=B(e,{minute:t.duration}),s=this.hasOverlappingEvent(t.id,e,o);return s.length>0?{overlaps:this.massageOneToMany(s),canContinue:!1}:(this.toggleActionBtns(!0,"canDropEvent"),{overlaps:null,canContinue:!0})}toggleActionBtns(e,t){this.disableSaveSchedule=!e,this.showReloadBtn=this.hasEventsForDate()&&e,this.showClearBtn=!this.isViewingPast()&&e}resetChosen(){this.chosenScore=null,this.chosenPrio=null}enableActionBtns(){let e=this.isViewingPast();this.showOneEachBtn=!e,this.showLoadDefaults=!e,this.showScoreBtn=!e,this.showPrioBtn=!e}tooClose(e,t){let o=B(e,{minute:0}),s=this.getTimeNumber(o),l=B(e,{day:1}),n=new Date(l.date);n.setHours(24),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0);let r=ce(n),d=Math.floor(ie(o,r)/1e3/60);if(d<t)return console.log("tooClose to midnight eh...:(",d),!0;let c=!1;return this._dailyScheduled.forEach((p,a,v)=>{let g=this.getTimeNumber(p.start)-s,C=ie(o,p.start);Math.floor(C/1e3/60)<=10&&g>0&&(c=a)}),c}changeEvtTime(e,t,o){return o=="ok"&&We(e.id,t.time,null),this.doUpdateSchedule(e,t),o}doUpdateSchedule(e,t){let o=this.findSchedEvent(e.id);if(!o){console.log("doUpdateSchedule-ERROR NOT found",e.id,o);return}let s=B(Y(o.date),{minute:j(t.time)}),l=B(s,{minute:o.duration});this._endTimesSet.delete(o.end.time)?this._endTimesSet.add(l.time):console.log("doUpdateSchedule-endTimesSet NOT FOUND?!?",o.id),this._startTimesSet.delete(o.start.time)?this._startTimesSet.add(s.time):console.log("doUpdateSchedule-startTimesSet NOT FOUND?!?",e.id,t),o.time=t.time,o.sortTime=s;let d=this.updateDetz({...o,time:t.time,start:s,end:l});this._dailyScheduled.set(e.id,d),this.enableNoteScoreEdit(e.id,s,l)}saveDaySchedule(){let e={};this._dailyScheduled.size<1?e=null:this._dailyScheduled.forEach((t,o,s)=>{e[o]={time:t.start.time,duration:t.for,atScore:t==null?void 0:t.atScore},this.usingMoods[o]&&(e[o].byMood=this.usingMoods[o]),t.notes!==void 0&&(t==null?void 0:t.notes)!==""&&(e[o].notes=t==null?void 0:t.notes)}),console.log("saveDaySchedule",e?Object.keys(e).length:"CLEARED"),Qe(this.currentDate,e),this.disableSaveSchedule=!0,this.showReloadBtn=!1,this.showClearBtn=e!=null&&!this.isViewingPast()}updateMinEndNowBtn(e,t,o){for(let[s,l]of this._dailyScheduled)(t?l.end.time:l.start.time)==e&&(this.hasStarted[s]=!t,this.isDisabledScoreEdit[s]=!t,this.mobile&&(console.log(`updateMinEndNowBtn..MOBILE::good?>>${o}::${t}`,e),this.showMobileDialog[s]=!t))}reduceEvtDuration(e,t){let o=this.findSchedEvent(e);if(!o){console.log("ERROR:: reduceEvtDuration Evt not found!!!",e);return}const s=ce(new Date);let l=o.start,n=o.end,r=this.updateDetz({...o,for:t,duration:t,end:s});this._dailyScheduled.set(e,r),this._endTimesSet.delete(n.time)||console.log("ERROR endTimesSet item does not exist?!?",o,this._endTimesSet),this._endTimesSet.add(s.time),this.enableNoteScoreEdit(e,l,s),this.saveDaySchedule()}canEndNow(e){let t=this.findSchedEvent(e);if(!t)return console.log("ERROR canEndNow Evt not found!!!",e),!1;const o=ce(new Date);let s=t.start,l=t.end;if(!Fe(o,s,l,!0))return console.log("umm aint in the middle of this event! Nothing to do...canEndNow::ERROR?",o.time,s.time,l.time),!1;let n=B(o,{minute:0}),r=ie(s,n),d=Math.floor(r/1e3/60);return console.log(`canEndNow:: ${e} duration from ${t.for} to: ${d}`),d<10?d:this.reduceEvtDuration(e,d)}updateNoteScore(e,t,o=""){let s=this.findSchedEvent(e);s?(s.score==t||(We(e,null,t),s.atScore=t),s.score=t,o!==""&&(s.notes=o),this.isViewingPast()?this.saveDaySchedule():this.toggleActionBtns(!0,"updateNoteScore")):console.log(`ERROR ERROR::updateNoteScore could not find event ${e}?!?`)}deleteEvtMood(e){if(this.usingMoods[e]){delete this.usingMoods[e],console.log("deleteEvtMood::>> "+e);return}}updateCurrentMoods(){for(let e in this.usingMoods)this._dailyScheduled.has(parseInt(e))||this.deleteEvtMood(e)}removeScheduledEvt(e){if(!e){console.log("ERROR removeScheduledEvt, NO evt to delete!",e);return}let t=null;if(this._dailyScheduled.has(e.id))t=this._dailyScheduled.get(e.id),this._dailyScheduled.delete(e.id);else{console.log("removeScheduledEvt:: ERROR NO evt?@? ERROR",e);return}if(t){let o=this._startTimesSet.delete(t.start.time),s=this._endTimesSet.delete(t.end.time);(!o||!s)&&console.log(`removeScheduledEvt ::> ERROR? scheduleSets has no such evt?@? start:${o}...end:${s}`,t,e.id+" "+(e==null?void 0:e.title.trim())+" "+(e==null?void 0:e.details)),this.deleteEvtMood(e.id)}}addToBalance(e){let o=this.getCurrentBalance()-parseInt(e==null?void 0:e.duration);Je(o)}removeFromBalance(e){let o=this.getCurrentBalance()+parseInt(e);Je(o)}disableEvtScoreEdit(e,t){this.isDisabledScoreEdit[e]=!t,this.mobileEnableScore[e]=t}enableNoteScoreEdit(e,t,o){const s=ce(new Date);let l=ie(s,o),n=B(s,{minute:0});this.getTimeNumber(n),l>0?(this.isDisabledScoreEdit[e]=!0,this.mobileEnableScore[e]=!1):(this.hasStarted[e]=!1,this.mobile&&(this.showMobileDialog[e]=!1),this.mobileEnableScore[e]=!0,this.isDisabledScoreEdit[e]=!1),Fe(s,t,o,!0)?this.hasStarted[e]=!0:this.hasStarted[e]=!1}getTimeyNumber(e){return e!==null?Mt(e):!1}getTimeNumber(e){return e!==null?Ie(e):!1}doLog(e,t){console.log(e,t?JSON.parse(JSON.stringify(t)):"")}}const Yt=()=>!0;function Xt(i){const e={};return i.forEach(t=>{e[t]=Yt}),e}function Le(){const{emit:i,proxy:e}=Ye(),t=M(null);function o(){t.value.show()}function s(){t.value.hide()}function l(r){i("ok",r),s()}function n(){i("hide")}return Object.assign(e,{show:o,hide:s}),{dialogRef:t,onDialogHide:n,onDialogOK:l,onDialogCancel:s}}const tt=["ok","hide"];Le.emits=tt;Le.emitsObject=Xt(tt);const Zt=gt({name:"scheduleBy",props:{title:String,message:String,options:Array,selectedO:String,showDialog:Boolean},emits:["onCancel","onOk","euhHidin","ok","hide"],data(){return{showey:this.showDialog,mess:this.message,daOptions:this.options,skipOvCheck:M(!1),optGroup:this.selectedO}},setup(){const{dialogRef:i,onDialogHide:e,onDialogOK:t,onDialogCancel:o}=Le();return{dialogRef:i,onDialogHide:e,onDialogOK:t,onCancelClick:o}},computed:{showy:{get(){return this.showey},set(i){this.showey=i}},oCheck:{get(){return this.skipOvCheck},set(i){this.skipOvCheck=i}},oChoice:{get(){return this.optGroup},set(i){this.optGroup=i}}},methods:{show(){this.$refs.dialogRef.show()},hide(){this.$refs.dialogRef.hide()},doCancel(){this.$emit("onCancel"),this.showy=!1},gonHide(){this.$emit("euhHidin")},onSave(){console.log("huh onSave?",this.oChoice,this.oCheck),this.$emit("onOk",this.oChoice,this.oCheck),this.showy=!1},onDialogHidey(){this.$emit("hide"),this.onDialogHide()},onOKyClick(){this.$emit("ok",{choice:this.oChoice,oCheck:this.oCheck}),this.hide()},onCancelyClick(){this.$emit("onCancel"),this.hide(),this.showy=!1}}}),ei={class:"q-ma-md title"},ti={class:"q-ma-md title"},ii={class:"q-gutter-sm"};function oi(i,e,t,o,s,l){return _(),K(vt,{modelValue:i.showy,"onUpdate:modelValue":e[2]||(e[2]=n=>i.showy=n),ref:"dialogRef","transition-show":"rotate","transition-hide":"rotate",onHide:i.onDialogHidey,onBeforeHide:i.gonHide},{default:k(()=>[A(yt,{class:"my-card-mobile"},{default:k(()=>[x("div",ei,W(i.title),1),A(Ce,{dark:""}),x("div",ti,W(i.mess),1),A(mt,{class:"q-gutter-md"},{default:k(()=>[x("div",ii,[A(St,{modelValue:i.oChoice,"onUpdate:modelValue":e[0]||(e[0]=n=>i.oChoice=n),options:i.daOptions},null,8,["modelValue","options"])]),A(Ze,{modelValue:i.oCheck,"onUpdate:modelValue":e[1]||(e[1]=n=>i.oCheck=n),label:"Skip O Check?","left-label":""},null,8,["modelValue"])]),_:1}),A(Ce,{dark:""}),A(pt,{class:"q-gutter-md q-mx-md inputBtn"},{default:k(()=>[A(De,{label:"Save",flat:"",dense:"",color:"positive",icon:"check_circle",onClick:i.onOKyClick},null,8,["onClick"]),A(Ce,{vertical:!0}),A(De,{label:"Cancel",flat:"",dense:"",color:"negative",icon:"delete_forever",onClick:i.onCancelyClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","onHide","onBeforeHide"])}var si=Xe(Zt,[["render",oi],["__scopeId","data-v-1bfe693d"]]);function Ke(i){return i.button===0}const li={name:"altDayCalendar",components:{NavigationBar:se(()=>le(()=>import("./NavigationBar.aca6f5b0.js"),["assets/NavigationBar.aca6f5b0.js","assets/index.8665c327.js","assets/index.4f70e4de.css"])),QCalendarDay:It,GoalyEnd:se(()=>le(()=>import("./goalyEnd.6a91e384.js"),["assets/goalyEnd.6a91e384.js","assets/goalyEnd.bf51d2cd.css","assets/index.8665c327.js","assets/index.4f70e4de.css","assets/goalStorage.b9726de2.js","assets/QSelect.37c6e399.js","assets/touch.70a9dd44.js","assets/QItem.48326827.js"])),daInstructions:se(()=>le(()=>import("./instructions.de784c71.js"),["assets/instructions.de784c71.js","assets/index.8665c327.js","assets/index.4f70e4de.css"])),schedBtn:se(()=>le(()=>import("./schedBtn.b16824b7.js"),["assets/schedBtn.b16824b7.js","assets/schedBtn.32a55c93.css","assets/index.8665c327.js","assets/index.4f70e4de.css"])),dropDwnBtn:se(()=>le(()=>import("./dropDwnBtn.64ccf517.js"),["assets/dropDwnBtn.64ccf517.js","assets/dropDwnBtn.35a7a0b5.css","assets/QItem.48326827.js","assets/index.8665c327.js","assets/index.4f70e4de.css","assets/QList.87f78a28.js","assets/QSelect.37c6e399.js","assets/touch.70a9dd44.js","assets/goalStorage.b9726de2.js"])),schedDialog:se(()=>le(()=>import("./schedDialog.a57fbaad.js"),["assets/schedDialog.a57fbaad.js","assets/schedDialog.a90aab00.css","assets/index.8665c327.js","assets/index.4f70e4de.css","assets/QSpace.298410dc.js"])),mobileNoteScore:se(()=>le(()=>import("./onScoreEditDialog.26851a3f.js"),["assets/onScoreEditDialog.26851a3f.js","assets/onScoreEditDialog.1a5ed29f.css","assets/index.8665c327.js","assets/index.4f70e4de.css"]))},data(){return _t(),M(null),M(null),M(null),M(null),M(null),{splitterPage:M(35),splitterLegend:M(40),timeStartPos:M(0),showTree:M(!1),treeGoals:M([]),expanded:M([]),filter:M([]),filterRef:M(null),calendar:M(null),showEvtDialog:M(!1),currentDate:M(Oe()),scoreOptions:M([1,2,3,4,5,6,7,8]),anchorTimestamp:M(null),otherTimestamp:M(null),mouseDown:M(!1),mobile:M(!0),daSchedule:M(null),showInstru:M(!1)}},beforeMount(){this.mobile=xt(),this.daSchedule=new Kt(this.currentDate,this.mobile),this.constructTree()},mounted(){this.adjustCurrentTime(),this.intervalId=setInterval(()=>{this.adjustCurrentTime()},6e4)},beforeUnmount(){clearInterval(this.intervalId)},computed:{chosenScoreLabel(){return this.daSchedule.chosenScoreLabel()},chosenPrioLabel(){return this.daSchedule.chosenPrioLabel()},style(){return{top:this.timeStartPos+"px"}},showSchedInstru(){return this.getDateEvents(this.currentDate).length<1},showRemInstru(){return this.getDateEvents(this.currentDate).length>0},defaultLabels(){let e=this.daSchedule.unscheduled().filter(t=>(t==null?void 0:t.inDefaults)&&(t==null?void 0:t.time)!="").length;return e>0?e+" Defaults":"Defaults"},showDefaultBtn(){return this.daSchedule.unscheduledDefaults().length>0&&!this.isViewingPast()},saveScheduleDisabled(){return this.daSchedule.saveBtnEnabled()},showTreeForm(){return this.showTree||this.constructTree(),this.showTree},filterString(){return this.filter.join()},currentBalance(){return this.daSchedule.getCurrentBalance()},selectedTimeInterval(){var i;return(i=this.targetDrop.timestamp.time)!=null?i:""},canbeScheduled(){let i=this.daSchedule.unscheduled(),e=(t,o)=>{if(t.parentGoal>o.parentGoal)return 1;if(t.parentGoal==o.parentGoal)return 0;if(t.parentGoal<o.parentGoal)return-1};if(i.length==0){let t=this.daSchedule.getSubGoals();return t.sort(e),t}return i.sort(e),i},scheduleMoodsLabel(){let i=null,e=this.daSchedule.getCurrentMoods();if(!Object.keys(e).length>0)return i;let t=new Map;for(let s in e){let l=e[s].join();t.set(s,l)}let o={};for(let[s,l]of t){let n=this.daSchedule.findSchedEvent(parseInt(s));o[s]={m:l,color:n==null?void 0:n.color,bg:n==null?void 0:n.bgcolor}}return o},startEndTimes(){const i=[];return this.anchorDayTimeIdentifier!==!1&&this.otherDayTimeIdentifier!==!1&&(this.anchorDayTimeIdentifier<=this.otherDayTimeIdentifier?i.push(de(this.anchorTimestamp),de(this.otherTimestamp)):i.push(de(this.otherTimestamp),de(this.anchorTimestamp))),i},anchorDayTimeIdentifier(){return this.anchorTimestamp!==null?Ie(this.anchorTimestamp):!1},otherDayTimeIdentifier(){return this.otherTimestamp!==null?Ie(this.otherTimestamp):!1},eventsMap(){return this.daSchedule.scheduledEventsMap()}},methods:{showEvtMobile(i){return this.daSchedule.showEvtNoteScoreMobile(i)},klikaj(i){console.log("klikaj...",this.currentDate,i)},adjustCurrentTime(){var s,l;const i=ce(new Date);if(this.currentDate!==i.date){this.timeStartPos=-10,this.currentTime="";return}this.currentDate=i.date,this.currentTime=i.time,this.timeStartPos=(l=(s=this.$refs)==null?void 0:s.calendar)==null?void 0:l.timeStartPos(i.time,!1);let e=this.daSchedule.getCurrentSchedTimesSets(),t=e.endSet&&e.endSet.has(i.time),o=e.startSet&&e.startSet.has(i.time);(t||o)&&(this.daSchedule.updateMinEndNowBtn(this.currentTime,t,o),o&&(this.scrollToTime(i,"slow"),this.doNotify("Event Starting :)","positive","top")))},hasDate(i){return this.currentDate?i.find(e=>e.date===this.currentDate):!1},getDateEvents(i){let e=(o,s)=>{let l=ie(o.sortTime,s.sortTime);if(l>0)return-1;if(l==0)return 0;if(l<0)return 1};const t=this.eventsMap[i]||[];return t.length===1?t[0].side="full":t.length,t.sort(e)},constructTree(){this.treeGoals=this.daSchedule.fetchGoalsTree()},resetGoalEvts(){return this.daSchedule.getSubGoals()},allMainGPrio(){return this.daSchedule.getAllPrio()},resetFilter(){var i;this.filter=[],(i=this.filterRef)==null||i.focus()},myFilterMethod(i,e){if(i.isChildren&&(i==null?void 0:i.moods.length)>0){const t=this.filter.map(s=>s.toLowerCase());let o=i==null?void 0:i.moods.some(s=>t.indexOf(s.toLowerCase())>-1);return i.label&&o}},labelGoals(i){let e=0;if(i=="s"){for(const o in this.treeGoals)e+=this.treeGoals[o].children.length;return`Scheduled => ${this.daSchedule.getAllEvts().size} out of ${e} 
`}return`Balance: ${this.daSchedule.getCurrentBalance()||0} 
`},badgeClasses(i,e){return Et(i,e)},styleDragLine(i,e=void 0,t=void 0){let o=e(i.time),s=t(i.duration),l=o+s;this.timeStartPos+s;const n={};return e&&t&&(n.top=l+"px",n.height=s+"px"),n["align-items"]="flex-start",n},badgeStyles(i,e,t=void 0,o=void 0){return Rt(i,e,t,o)},classyColor(i){return`row items-center ${i.isChildren?"text-":"text-white bg-"}${i.color} `},isViewingPast(){return this.daSchedule.isViewingPast()},onMoodAdd(){let i=[];const e=this.filter.map(t=>t.toLowerCase());if(this.treeGoals.filter(t=>{if(t.children.length>0)return t.children.filter(o=>{if((o==null?void 0:o.moods.length)>0&&(o==null?void 0:o.moods.some(s=>e.indexOf(s.toLowerCase())>-1))){let s=o==null?void 0:o.moods.filter(l=>{if(e.indexOf(l.toLowerCase())>-1)return l});return i.push({id:o.id,mood:s}),o}})}),i.length>0)if(i=i.filter(o=>!this.daSchedule.getAllEvts().has(o.id)),i.length>0){let o=this.daSchedule.scheduleByMood(i);if(o.canContinue)this.doNotify(`Added ${o==null?void 0:o.added} Evts by Mood...doSave eh`,"info");else{if(o.overlaps&&Object.keys(o.overlaps).length>0)return this.handleOverlaps(o.overlaps,"byMood");this.doNotify("Empty as no Mood Evts :(","warning")}}else this.doNotify(`Evts of Mood '${this.filterString}' already scheduled!`,"warning","top");else this.doNotify("Nothing to add :(","warning","top")},onScheduleOneEach(){let i=o=>{let s=this.daSchedule.scheduleOneEach(o,this.doNotify);if(s.canContinue)this.doNotify(`${s==null?void 0:s.added} Evts by Each ParentGoal...doSave eh`,"info");else{if(s.overlaps&&Object.keys(s.overlaps).length>0)return this.handleOverlaps(s.overlaps,"oneEach");this.doNotify("Empty None for OneEach :(","warning")}t>0?this.daSchedule.toggleActionBtns(!0,"oneEach"):console.log("onScheduleOneEach::no Evts and no toggling for flag>> ",o)},e=()=>{console.log("onScheduleOneEach..Aborting"),this.reset()},t=this.daSchedule.getAllEvts().size;if(t>0){let o=[{label:"Add one Evt from Each parent Goals",value:"add"},{label:"Reset schedule and add one random Evt from Each parent Goals",value:"overwrite"}];this.confirmChoiceDialog("Reload Schedule",`Current: ${this.currentDate} already have scheduled Events...`,o,"",i,e)}else i("overwrite")},onReloadSaved(){let i=this.daSchedule.hasEventsForDate(),e=()=>{console.log("Aborting reload!",this.currentDate,i)},t=()=>{let o=this.daSchedule.loadEvtsForDay(!1);o.canContinue||(o.overlaps&&Object.keys(o.overlaps).length>0?(console.log("onReloadSaved::OVERLAPS",o.overlaps),this.handleOverlaps(o.overlaps,"view")):(this.doNotify(`Reloaded schedule for ${this.currentDate}`,"positive","bottom"),(this.isViewingPast()||this.currentDate!==Oe())&&this.adjustCurrentTime())),this.reset()};if(this.daSchedule.getAllEvts().size>0&&!this.isViewingPast()){let o=i?`Reload saved schedule of: ${this.currentDate} ?`:"Reset current Schedule?";this.confirmAction("",o,"OK",t,e)}else t()},onClearDay(){let i=this.daSchedule.hasEventsForDate();if(this.isViewingPast()){this.doNotify("Editing past is no no!");return}this.daSchedule.resetSchedule(!0);let e=i?"Cleared...Can still Reload saved":"Resetting...";this.doNotify(e,"warning","top"),this.reset(),this.daSchedule.toggleActionBtns(i,"view")},onLoadDefault(){let i=e=>{let t=this.daSchedule.scheduleDefaults(e);if(t.canContinue)this.doNotify(`Defaults ${e} ...doSave eh`,"info");else{if(t.overlaps&&Object.keys(t.overlaps).length>0)return this.handleOverlaps(t.overlaps,"byDefaults");this.doNotify("Empty as No Defaults :(","warning")}};if(this.daSchedule.getAllEvts().size>0){let e=this.daSchedule.unscheduledDefaults(),t=[{label:`Add ${e==null?void 0:e.length} Default Evts to current schedule`,value:"add"},{label:"Reset and only schedule Defaults",value:"reset"}];this.confirmChoiceDialog("Schedule Defaults",`Current: ${this.currentDate} already have scheduled Events...`,t,"",function(o){i(o)},function(){console.log("onLoadDefaults::Aborting")})}else i("reset")},onChoosenPrio(i){this.daSchedule.onChoosenPrio(i)},onScheduleByPrio(){},doReloadWithPrio(){var l,n,r,d,c,p;let i=this.daSchedule.chosenPrio;if(i==null){this.doNotify("Ayo select a priority!");return}let e=()=>{this.reset()},t=a=>{let v=this.daSchedule.scheduleSamePrio(a);if(v.canContinue)this.doNotify(`${v==null?void 0:v.added} Evts with Priority == ${i} ...doSave eh`,"info");else{if(v.overlaps&&Object.keys(v.overlaps).length>0)return this.handleOverlaps(v.overlaps,"byPrio");this.doNotify(`No Evts with Priority == ${i} :(`,"warning","top")}s>0?this.daSchedule.toggleActionBtns(!0,"byPrio"):console.log("doReloadWithPrio::no Evts and no toggling for flag>> ",a)},o=this.daSchedule.byPrio,s=this.daSchedule.getAllEvts().size;if(s>0){let a=[];((l=o==null?void 0:o.filter)==null?void 0:l.length)>0?a.push({label:`Filter out of ${s} scheduled Evts to ${(n=o==null?void 0:o.filter)==null?void 0:n.length}`,value:"filter"}):console.log("doReloadWithPrio::FILTER option skipped",(r=o==null?void 0:o.filter)==null?void 0:r.length),((d=o==null?void 0:o.toAdd)==null?void 0:d.length)>0&&a.push({label:`Add ${(c=o==null?void 0:o.toAdd)==null?void 0:c.length} Evts to current schedule`,value:"add"}),a.push({label:`Reset current and schedule ${(p=o==null?void 0:o.reset)==null?void 0:p.length} Evts.`,value:"reset"});let v=`Reload Schedule by Parent's Priority == ${i}`;this.confirmChoiceDialog("",v,a,"",t,e)}else t("reset");this.daSchedule.disablePrioBtn=!0},onChoosenScore(i){this.daSchedule.onChoosenScore(i)},onScheduleByScore(i,e=!1){let t=[],o=!1,s=null;const l=this.daSchedule;let n=()=>[{label:"Keep Evt with Highest Priority",value:"opt1",color:"secondary"},{label:"Manually Choose one event",value:"opt3"}];const r=a=>this.findhighestPrio(a),d=(a,v)=>this.betterEvtLabel(a,v,!1);let c=(a,v,T)=>{this.confirmChoiceDialog("","Choose which Event to keep",a.map(g=>d(g,"default")),"",function(g){let C=a.find(D=>D.id==g);if(!C){console.log("chooseOneEvt::ERROR NOT FOUND!!",g);return}if(v.id==C.id){a.forEach(O=>{O.id!=C.id&&l.removeScheduledEvt(O)});let D=l.addToSchedule(v,!e,!1);//!skipOvCheck
console.log("chooseOneEvt::ADDED",g,T,D)}else a.forEach(D=>{v.id==D.id?console.log("chooseOneEvt,not adding target",D.id,C.id):D.id!=C.id?l.removeScheduledEvt(D):console.log("chooseOneEvt,not adding scheduled",D.id,C.id)});return T=g,T},null,function(){console.log("onScheduleByScore::onDismiss >>chooseOne",T,s),s=T})};i.sort(function(a,v){return j(a.time)-j(v.time)}),i.forEach((a,v,T)=>{let g=this.daSchedule.addToSchedule(a,!e,!1);if(g&&Array.isArray(g))if(g.length>1){console.log("onScheduleByScore::OVERLAP >> oneToMany",a,g),o=!0;let C=null;if(g.find(D=>D[0]=="withID")){g=g.filter(D=>D[0]!="withID");for(let D=0;D<g.length;D++){g[D][0];let O=g[D][1];C=O[0].targetStart,this.scrollToTime(C,"slow");let w=[],m=[],u=!1;for(;O.length;){const y=O.pop();let b=this.daSchedule.findSchedEvent(y.inConflict);w.push(`(${b==null?void 0:b.id}) '${b==null?void 0:b.title.trim()}'`),a.id!=y.target&&console.log("onScheduleByScore::ERROR ERROR:: NOT same target ID?!?",a,y),m.push(b),y.direction=="surrounding"?u=!0:u=u}m.unshift(a);let h=`Adding (${a==null?void 0:a.id}) '${a==null?void 0:a.title.trim()}' at ${V(a==null?void 0:a.time)} Conflicts with scheduled ${w.join(" and ")}. `,f=n();u||f.push({label:`Force in > '${a==null?void 0:a.title.trim()}' ?`,value:"opt4"}),this.confirmChoiceDialog("OneToMany Conflicts",h,f,"",function(y){var b;switch(y){case"opt1":let P=r(m);if(console.log("onScheduleByScore::ByPriority >> AUTO ",P.e.id,(b=P==null?void 0:P.e)==null?void 0:b.title.trim()),a.id==P.e.id){m.forEach(X=>{X.id!=P.e.id&&l.removeScheduledEvt(X)});let H=l.addToSchedule(a,!e,!1);//!skipOvCheck
console.log("onScheduleByScore::ByPriority>>ADDED",s,H)}else m.forEach(H=>{H.id!=P.e.id?l.removeScheduledEvt(H):console.log("onScheduleByScore::ByPrio,not adding target?",H.id,P.e.id)});s=y;return;case"opt4":let z=m.find(H=>H.id!=a.id);l.recurChangeTime(z.id,a,C,!0),s=y;return;default:c(m,a,s);return}},null,function(){console.log("onScheduleByScore::onDismiss >> OneToMany",s)})}}else console.log("onScheduleByScore::OVERLAP! ERROR not oneToMany?!?",g)}else t.push(...g);else g===!0||console.log("onScheduleByScore::adding...FAILED?>>",a,g)});const p=()=>{if(t.length>0)return this.doNotify("EXTRA Overlaps to fix!","negative","top"),this.handleOverlaps(this.daSchedule.massageReturnOverlaps(t),"byScore");this.doNotify("Added byScore!..doSave eh","info","top")};if(o){let a=setInterval(()=>{s&&(setTimeout(()=>{clearInterval(a)},0),p())},3e3)}else p()},doReloadWithScore(){var l,n,r,d,c,p;let i=this.daSchedule.chosenScore;if(i==null){this.doNotify("Ayo select a score!");return}let e=()=>{this.reset()},t=a=>{console.log("scheduleByScore:: ",a),a.choice!="add"&&this.daSchedule.resetSchedule(),a.choice=="add"?this.onScheduleByScore(o==null?void 0:o.toAdd,a.oCheck):a.choice=="reset"?this.onScheduleByScore(o==null?void 0:o.reset,a.oCheck):this.onScheduleByScore(o==null?void 0:o.filter,a.oCheck),s>0?this.daSchedule.toggleActionBtns(!0,"byScore"):console.log("doReloadWithScore::no Evts and no toggling for flag>> ",flag)},o=this.daSchedule.byScore,s=this.daSchedule.getAllEvts().size;if(s>0){let a=[];((l=o==null?void 0:o.filter)==null?void 0:l.length)>0?a.push({label:`Filter out of ${s} scheduled Evts to ${(n=o==null?void 0:o.filter)==null?void 0:n.length}`,value:"filter"}):console.log("doReloadWithScore::FILTER option skipped",(r=o==null?void 0:o.filter)==null?void 0:r.length),((d=o==null?void 0:o.toAdd)==null?void 0:d.length)>0&&a.push({label:`Add ${(c=o==null?void 0:o.toAdd)==null?void 0:c.length} Evts to current schedule.`,value:"add"}),a.push({label:`Reset current and schedule ${(p=o==null?void 0:o.reset)==null?void 0:p.length} Evts.`,value:"reset"});let v=`Reload Schedule by Interval Score <= ${i}`;this.scheduleByDialog("",v,a,"",t,e)}else t({choice:"reset",oCheck:this.daSchedule.isViewingToday()});this.daSchedule.disableScoreBtn=!0},doSaveSchedule(){this.daSchedule.saveDaySchedule(),this.doNotify(`Schedule saved for ${this.currentDate}`,"positive","top")},doDroppy(i,e){if(i&&e){let t=this.daSchedule.tooClose(i,e.duration);if(t&&(console.log("doDroppy::tooClose to>>",t),t===!0)){this.doNotify("Dropping event TOO close to midnight!"),this.reset();return}let o=this.daSchedule.canDropEvent(i,e),s=this.daSchedule.getOriginalEvtTime(e.id);if(o.canContinue)if((e==null?void 0:e.inDefaults)||!(e!=null&&e.canMove)){let n=e!=null&&e.inDefaults?"Default at ":"Cannot Move from ",r=[`Evt "${e.title.trim()}" ${n} ${V(s)}.`,`
Also Save Evt default time to ${V(i.time)}?`,`
Cancel or Dismiss to undo!`,`
No selection to keep at ${V(e.time)}`].join(`
`);const d=this.daSchedule,c=this.doCleanup;this.confirmTimeChange("Changing Evt's time",r,"Change","Temp.Move",function(p){d.changeEvtTime(e,i,p),c()},function(){c()},function(){console.log(`doDroppy::onDismiss..keep as is>> ${e.id})'${e.title.trim()}'`),c()})}else this.daSchedule.changeEvtTime(e,i,!1),this.doCleanup();else this.handleOverlaps(o.overlaps,"onDrop")}else{console.log("doDroppy null ERROR?",i,this.targetDrop,e,this.selectedItem);return}},canAutoSchedule(i,e){let t=i.title.trim().toLowerCase().includes(e.title.trim().toLowerCase()),o=e.title.trim().toLowerCase().includes(i.title.trim().toLowerCase()),s=this.daSchedule.parentGoalById(i.parentGoal),l=this.daSchedule.parentGoalById(e.parentGoal),n=i.title.trim().toLowerCase().includes(l.title.trim().toLowerCase()),r=e.title.trim().toLowerCase().includes(s.title.trim().toLowerCase());return(n||r)&&console.log("canAutoSchedule:: WOAH PARENT AUTO schedule?--TODO***",n&&"toAdd: "+i.title,r&&"sched: "+e.title,`
Normal AUTO>>`,t,o),t||o?{addIncSched:t,schdIncToAdd:o}:!1},movedIntoConflict(i,e,t,o=0){console.log("movedIntoConflict >>",JSON.parse(JSON.stringify(i)),"from:"+t,o);const s=(m,u)=>{if(m!=null&&m.parentGoal){let h=this.daSchedule.parentGoalById(m.parentGoal);return u?`Of '${h==null?void 0:h.title.trim()}' (${h==null?void 0:h.priority})`:`Of '${h==null?void 0:h.title.trim()}'`}return console.log("prioLabel..ERROR no PARENT found?",m),""},l=(m,u)=>{switch(u){case"score":return`${s(m,!1)} > "${m.title.trim()}" with Score:: ${m.score} = ${ne(m.score)}`;case"prio":return`"${m.title.trim()}" ${s(m,!0)}`;default:return`"${m.title.trim()}" ${s(m,!0)} && Score:: ${m.score} for ${m.duration} mins`}},n=(m,u=!1)=>{this.doNotify(m,u?"warning":"positive","top")},r=m=>{this.daSchedule.deleteEvtMood(m)},d=m=>{console.log(`movedIntoConflict::doRemove ${m.id}:${m.title}`),this.daSchedule.removeScheduledEvt(m)};let c=m=>{console.log("onDismissy::from "+t,m,O),this.doCleanup(),this.daSchedule.toggleActionBtns(!0,t)};const p=(m,u,h)=>{if(console.log(`movedIntoConflict::removeReplace >> replacing>> ${m.id}) '${m.title.trim()}' WITH ${u.id}) ${u.title.trim()}`,h,"from>"+t),e){if(console.log("movedIntoConflict::removeReplace...OVERRIDE from>>"+t),t=="onDrop"){d(m);return}console.log("movedIntoConflict::removeReplace....OVERRIDE updating..."+t),this.daSchedule.doUpdateSchedule(u,h.targetStart);return}if(d(m),t=="onDrop")console.log("movedIntoConflict::removeReplace for onDrop...just updating schedule",u.id,h.targetStart.time),this.daSchedule.doUpdateSchedule(u,h.targetStart);else{console.log("movedIntoConflict::removeReplace >>addGoalsToSchedule from "+t);let f=this.daSchedule.getStoredRawEvt(h.target);f&&(JSON.parse(JSON.stringify(u)),Object.assign(u,f,{time:h.targetStart.time}));let y=this.daSchedule.addGoalsToSchedule([{...u,time:h.targetStart.time}],!0),b=Object.keys(y).length;if(b>0)return console.log(`movedIntoConflict::removeReplace:: OVERLAPS again of size:${b} from >${t}>`+u.title,JSON.parse(JSON.stringify(y))),this.doNotify(`Extra Overlaps while removing to add '${u.title.trim()}' `,"warning","top"),this.movedIntoConflict(y,e,t+"nah")}},a=(m,u)=>{let h=this.daSchedule.findSchedEvent(u.target);if(!h){console.log("movedIntoConflict::forceAddMins>>NOT FOUND?!?",u.target);return}let f=this.daSchedule.getStoredRawEvt(u.target);if(f){let y=h.duration+parseInt(o);JSON.parse(JSON.stringify(h)),Object.assign(h,f,{duration:y})}else console.log("movedIntoConflict::forceAddMins >>NEWLY ADDED?!? Error?",h.id,h,f),Object.assign(h,{duration:newDura});this.daSchedule.recurChangeTime(m.id,h,u.targetStart,!1,this.doNotify),this.doSaveSchedule()},v=(m,u,h)=>{console.log(`movedIntoConflict::forceAdd:${t} >>${u.id})'${u.title}' at ${u.time} to ${h.targetStart.time}
          
Changing >>${m.id} from ${m.time}`);let f=this.daSchedule.getStoredRawEvt(h.target);f&&(JSON.parse(JSON.stringify(u)),Object.assign(u,f,{time:h.targetStart.time}));let y=this.daSchedule.recurChangeTime(m.id,u,h.targetStart,t!="onDrop",this.doNotify);if(y){let b=Object.keys(y).length;if(b>0)return console.log(`movedIntoConflict::forceAdd:: OVERLAPS again of size:${b} from >${t}>`+u.title,JSON.parse(JSON.stringify(y))),this.doNotify(`Extra Overlaps while adding '${u.title.trim()}'`,"negative","top"),this.movedIntoConflict(y,e,t+"nah")}c("ForceAdd")};let T=(m,u,h,f,y)=>{O.push(u),u==h.id?(p(f,h,y),n(`by ${m}, ${t=="onDrop"?"Moving":"Adding"} '${h.title.trim()}'`,!0)):(console.log(`onOkChoice::by ${m},chose scheduled ${u} ...with override?`,e,t),n(`by ${m}, Keeping '${f.title.trim()}'`),t.indexOf("byMood")>-1&&r(h.id),t=="onDrop"&&d(h))},g=(m,u)=>{if(e){if(console.log("movedIntoConflict::cancelChoice::OVERRIDE...coolios!!from:"+t,m.title.trim()),t=="onDrop"){n("Umm...not moving then...."),this.daSchedule.toggleActionBtns(!1,"view");return}d(m),n(`Keeping '${u.title.trim()}'`);return}t.indexOf("byMood")>-1&&r(m.id),this.daSchedule.toggleActionBtns(!0,"view"),n(`Keeping scheduled '${u.title.trim()}'`)};const C=(m,u,h,f)=>{if(m=="opt3"){let y="Pick one event...",b=[{label:l(u,"def"),value:u.id,color:"secondary"},{label:l(h,"def"),value:h.id}];this.confirmChoiceDialog("",y,b,"",function(P){T("Choice",P,u,h,f)},null,function(){c("resolveChoice::byEvent... dismissing")})}else if(m=="opt2"){let y="Pick event by Score",b=[{label:l(u,"score"),value:u.id,color:"secondary"},{label:l(h,"score"),value:h.id}];this.confirmChoiceDialog("",y,b,"",function(P){T("Score",P,u,h,f)},null,function(){c("resolveChoice::byScore... dismissing")})}else if(m=="opt1"){let y="Pick event by Priority",b=[{label:l(u,"prio"),value:u.id,color:"secondary"},{label:l(h,"prio"),value:h.id}];this.confirmChoiceDialog("",y,b,"",function(P){T("Priority",P,u,h,f)},null,function(){c("resolveChoice::byPriority... dismissing")})}else m=="opt0"?(console.log("resolveChoice::it's a drop?...keeping as is....",t),n("Umm...keeping as is then!"),this.doCleanup()):v(h,u,f)},D=(m,u,h,f,y)=>{f.direction!=="surrounding"&&!y&&(t.indexOf("nah")>-1?console.log("movedIntoConflict::manualSolve NOT adding Force as from "+t):m.push({label:`Force in '${u.title.trim()}'`,value:"opt4"}));let b=`${t=="onDrop"?"Moving":"Adding"} '${u.title.trim()}' at ${V(f.targetStart.time)} Overlaps with Scheduled '${h.title.trim()}' at ${V(h==null?void 0:h.time)}.
          
Cancel to keep '${h.title.trim()}' `,P=y?"Choose Auto Resolution":"Resolve Overlapping Events";this.confirmChoiceDialog(P,b,m,"opt1",function(z){C(z,u,h,f)},function(){console.log("movedIntoConflict>>manualSolve::cancelChoice? Notif?>> from: "+t,O[0]),n("Umm...keeping as is then!")})};let O=[],w=Object.keys(i).length;i.find(m=>m[0]=="withID");for(let m=0;m<w;m++){let u=i[m][0];if(u=="withID"){console.log("movedIntoConflict...skipping withID key",u,i.withID);continue}let h=i[m][1],f=[{label:"Choose one event",value:"opt3"}];t=="onDrop"?f.unshift({label:"Leave as is!",value:"opt0"},{label:"Choose by Priority",value:"opt1",color:"secondary"},{label:"Choose by Score",value:"opt2"}):f.unshift({label:"Choose by Priority",value:"opt1",color:"secondary"},{label:"Choose by Score",value:"opt2"});const y=h.pop();let b=this.daSchedule.getSubGoalByID(y.target),P=this.daSchedule.findSchedEvent(y.inConflict);if(!P||!b){console.log("movedIntoConflict...ERROR ERROR no evts found!!!",y);return}let z=this.canAutoSchedule(b,P);if(t=="onAddMins"){let H=P!=null&&P.inDefaults?"In Defaults":P!=null&&P.canMove?"":"Cannot move",X=`Adding ${o} mins to "${b.title.trim()}" Overlaps with Scheduled "${P.title.trim()}" at ${V(P.time)} as ${H}.
            
Force?
            
Cancel/Dismiss to Leave as is.`;this.confirmAction("",X,"Add",function(){a(P,y)},function(){n("Keeping as Is...")})}else if(z){console.log("movedIntoConflict:: can AUTO schedule",z.addIncSched,z.schdIncToAdd,"direction == surrounding? >>",y.direction=="surrounding"),this.scrollToTime(y==null?void 0:y.targetStart,"slow");let H=`"${b.title.trim()}" at ${V(b.time)} related to Scheduled "${P.title.trim()}" at ${V(P.time)}.
            
Auto resolve Overlap?
            
Cancel/Dismiss to manually choose.`;this.confirmAction("",H,"Auto",function(){var X;z.addIncSched?(console.log("Auto resolve::removeReplace..with TIMES>>",b.time,P.time,(X=y==null?void 0:y.targetStart)==null?void 0:X.time),p(P,b,y),n(`Removing Scheduled to Add '${b.title.trim()}'`,!0),O.push(b.id)):(console.log("Auto resolve::cancelChoice >> from: ",t),g(b,P),O.push(P.id))},function(){D(f,b,P,y,!0)},function(){c("Auto-dismiss")})}else D(f,b,P,y,!1)}},handleOverlaps(i,e=""){let t=i.length;i.reverse(),this.doLog("handleOverlaps::ORIGNL from: "+e+" >> "+t,i);let o=i.find(l=>l[0]=="withID");o&&(i=i.filter(l=>l[0]!="withID"),t=i.length);const s=wt(i);for(let l=0;l<t;l++){let n=i[l][0],r=i[l][1],d=null;l>0?d=s[l-1][1][0].targetStart:d=null,l==t-1&&(e.indexOf("nah")>-1?console.log("handleOverlaps...NO END SCROLL::FROM",e,n):this.scrollToTime(r[0].targetStart,"slow")),o&&o.find(c=>c==n)?(console.log("handleOverlaps::WITHID >> oneToMany="+r.length,"Key: "+n,d==null?void 0:d.time),this.fixConflicts(r,e,!0,[t,l],d)):this.fixConflicts(r,e,!1,[t,l],d)}},fixConflicts(i,e,t,o,s=null){var xe;const l=R=>this.daSchedule.findSchedEvent(R),n=R=>this.daSchedule.getSubGoalByID(R),r=(R,$)=>{if(!R){console.log("fixConflicts::scrollToConflict ERROR >>empty time withID="+t,$,R);return}this.scrollToTime(R,"slow")},d=R=>{this.doNotifyTimeout(R,"negative","top",1e4)},c=(R,$=!1)=>{this.doNotify(R,$?"warning":"positive","top")},p=R=>this.findhighestPrio(R);let a=R=>this.getSmallestScoreInterval(R),v=R=>{console.log("onDismissy>> ",R,h.length),h.length>0&&setTimeout(()=>{t?T(h,b):g(h,b)},0)},T=(R,$)=>{console.log(`fixConflicts::removeWithID with toKeep=${R.length} `,s==null?void 0:s.time);let N=[],E=!1;for($.forEach((S,Q,G)=>{if(R.find(L=>L.id==S.id))if(S.id==f.id){let L=u.has(S.id)?u.get(S.id):"",I=m.has(S.id)?m.get(S.id):m.get(f.id),fe=this.daSchedule.getStoredRawEvt(S.id);fe&&(JSON.parse(JSON.stringify(S)),Object.assign(S,fe,{time:I.time}));let oe=e=="onDrop"?this.daSchedule.doUpdateSchedule(S,I)||{}:this.daSchedule.addGoalsToSchedule([{...S,time:I.time}],!1);if(Object.keys(oe).length>0)console.log("fixConflicts::removeWithID::OVERLAP on add",oe,S,I.time),N.push(oe);else{let we=`${L} Adding '${S==null?void 0:S.title.trim()}' at ${V(I.time)}`;this.doNotify(we,"positive","top")}E=!0}else{console.log("fixConflicts::removeWithID....Keeping scheduled Evt!!",S.id,m.get(S.id));let L=`${u.has(S.id)?u.get(S.id):""} Keeping scheduled '${S==null?void 0:S.title.trim()}'`;this.doNotify(L,"positive","top"),this.daSchedule.reAddScheduled(S.id)}else if(S.id!=f.id){console.log("fixConflicts::removeWithID >>removing scheduled",S.id,S.title,S.time);let L=this.daSchedule.getCurrentMoods()[S.id];this.daSchedule.removeScheduledEvt(S);let I=`Removed scheduled '${S==null?void 0:S.title.trim()}'`;I=L?I+` With Moods: '${L}'`:I,this.doNotify(I,L?"negative":"warning"),E=!0}else e=="onDrop"?(console.log("fixConflicts::removeWithID >>Removing target onDrop!!",S.id,S.title,S.time),this.daSchedule.removeScheduledEvt(S)):console.log("fixConflicts::removeWithID >>NOT adding original target",f.id),this.daSchedule.deleteEvtMood(f.id),this.resetFilter()}),e=="onDrop"||E?(this.daSchedule.toggleActionBtns(!0,e),this.doCleanup()):console.log("fixConflicts::removeWithID...NO TOGGLING",e);N.length;){const S=N.pop();this.doLog(`${e}> fixConflicts::removeWithID:: OVERLAPS`,S),this.doNotify("EXTRA Overlaps to fix!","negative","top");let Q=e.indexOf("view")>-1?e:e+"nah";return this.handleOverlaps(S,Q)}s?r(s,"removeWithID"):console.log("fixConflicts::removeWithID >> NO SCROLLING after conflicts",e,s,E)},g=(R,$)=>{console.log(`fixConflicts::removeConflicts with toKeep=${R.length}`,s==null?void 0:s.time);let N=[],E=!1;for($.forEach((S,Q,G)=>{if(R.find(L=>L.id==S.id)){let L=u.has(S.id)?u.get(S.id):"",I=m.has(S.id)?m.get(S.id):null;if(S.id!=y.id){let fe=this.daSchedule.getStoredRawEvt(S.id);fe&&(JSON.parse(JSON.stringify(S)),Object.assign(S,fe,{time:I.time}));let oe=e=="onDrop"?this.daSchedule.doUpdateSchedule(S,I)||{}:this.daSchedule.addGoalsToSchedule([{...S,time:I.time}],this.daSchedule.isViewingToday());if(oe&&oe.length>0)N.push(oe),this.doNotify(`Extra Overlaps while adding '${S==null?void 0:S.title.trim()}'`,"negative","top");else{let we=`${L} Adding '${S==null?void 0:S.title.trim()}' at ${V(I.time)}`;this.doNotify(we,"positive","top")}E=!0}else this.doNotify(`${L} Keeping scheduled '${S==null?void 0:S.title.trim()}' `,"positive","top"),this.daSchedule.reAddScheduled(S.id)}else if(S.id==y.id){let L=this.daSchedule.getCurrentMoods()[S.id];this.daSchedule.removeScheduledEvt(S);let I=`Removed scheduled '${S==null?void 0:S.title.trim()}'`;I=L?I+` With Moods: '${L}'`:I,this.doNotify(I,L?"negative":"warning"),E=!0}else console.log("fixConflicts::removeConflicts >> NOT adding target ",S.id,S.title),this.daSchedule.deleteEvtMood(S.id),this.resetFilter()}),e.indexOf("view")>-1||E?this.daSchedule.toggleActionBtns(!0,e):console.log("fixConflicts::removeConflicts...NO TOGGLING",e,E);N.length;){const S=N.pop();this.doLog(`fixConflicts::removeConflicts::EXTRA OVERLAPS from ${e} `,S),this.doNotify("EXTRA Overlaps to fix","negative","top");let Q=e.indexOf("view")>-1?e:e+"nah";return this.handleOverlaps(S,Q)}s?r(s,"removeConflicts"):console.log("removeConflicts::NO SCROLLING after conflicts",s,e,E)};const C=(R,$)=>{let N=[];for(this.doLog(`fixConflicts::forceAdd of ${R.length} withID=${t}`,"allConflicts= "+$.length,s),$.forEach(E=>{if(R.find(S=>S.id==E.id)){let S=m.has(E.id)?m.get(E.id):null,Q=this.daSchedule.getStoredRawEvt(E.id);Q&&Object.assign(E,Q,{time:S.time});let G=$.find(I=>I.id!=E.id);console.log(`fixConflicts::forceAdd...NEW:${E.id} '${E.title.trim()}' dura= ${E.duration} 
 
              origAt: ${E.time} added at>>`,S==null?void 0:S.time,"from>>"+e,`
 >> USING for change `+G.id+" "+(G==null?void 0:G.title),"withID "+t);let L=this.daSchedule.recurChangeTime(G.id,E,S,e!="onDrop",d);if(L&&Object.keys(L).length>0)console.log("fixConflicts::forceAdd >>OVERLAP on add",L,E,S.time),N.push(L);else{let I=`Force Added '${E==null?void 0:E.title.trim()}' at ${V(S.time)}`;this.doNotify(I,"positive","top")}}else t?this.daSchedule.recurChangeTime(E.id,R[0],m.get(R[0].id),e!="onDrop",d):console.log("fixConflicts::forceAdd >>not WITHID >> NOTHING for scheduled",E.id,"Not onDrop: "+e!="onDrop")}),this.daSchedule.toggleActionBtns(!0,e);N.length;){const E=N.pop();return this.doLog("fixConflicts::forceAdd:: EXTRA OVERLAPS "+e,E),this.doNotify("EXTRA Overlaps to fix!","negative","top"),this.handleOverlaps(E,e+"nah")}s&&r(s,"forceAdd")};let D=(R,$)=>{switch(R){case"score":this.confirmChoiceDialog("","Choose one event by Score",$.map(N=>this.betterEvtLabel(N,"score",!1)),"",function(N){let E=$.find(S=>S.id==N);if(E)h.push(E),u.set(E.id,`By Score Interval (${E.score}),`);else{console.log("chooseOneEvt::ERROR NOT FOUND!!",N);return}return E},null,function(){v("chooseOneEvt::>>byScore...")});return;case"prio":this.confirmChoiceDialog("","Choose one event by Priority",$.map(N=>this.betterEvtLabel(N,"prio",!1)),"",function(N){let E=$.find(S=>S.id==N);if(E)h.push(E),u.set(E.id,"By Priority,");else{console.log("chooseOneEvt::ERROR NOT FOUND!!",N);return}return E},null,function(){v("chooseOneEvt::>>byPriority...")});return;default:this.confirmChoiceDialog("","Choose which Event to keep",$.map(N=>this.betterEvtLabel(N,"default",!1)),"",function(N){let E=$.find(S=>S.id==N);if(E)h.push(E),u.set(E.id,"By pick,");else{console.log("chooseOneEvt::ERROR NOT FOUND!!",N);return}return E},null,function(){v("chooseOneEvt::>>byPick...")});return}},O=(R,$,N,E,S)=>{var Q;if(R=="opt3")D("default",E);else if(R=="opt2")if(S)D("score",E);else{let G=a(E);G?(h.push(G),u.set(G.id,`By Shortest Score Interval (${G.score}),`)):(console.log("ERROR ERROR::fixConflicts >> smallestScoreInterval::No current set?",E),c("Umm...Score Error",!0),D("score",E))}else if(R=="opt1")if(S)D("prio",E);else{let G=p(E);console.log("fixConflicts::ByPriority >> AUTO "+e,G.e.id,(Q=G==null?void 0:G.e)==null?void 0:Q.title.trim()),h.push(G.e),u.set(G.e.id,`By Highest Priority (${G.prio}),`)}else R=="opt0"?(console.log("fixConflicts::AUTO:SOLVE >>",f,y,N,E),$.addIncSched?t?(h.push(f),u.set(f.id,"By Auto-Solve,")):(h.push(N[0]),u.set(N[0].id,"By Auto-Solve,")):t?(h.push(E[0]),u.set(E[0].id,"By Auto-Solve,")):(h.push(y),u.set(y.id,"By Auto-Solve,"))):C(N,E)},w=()=>{if(e=="onDrop"){c("Umm...not moving then...."),this.doCleanup();return}e.indexOf("byMood")>-1&&console.log("fixConflicts::cancelChoice >>Mood update "+e),h.push(y)},m=new Map,u=new Map,h=[],f=null,y=null,b=[],P=[],z=!1,H=[];for(;i.length;){const R=i.pop();let $=l(R.inConflict);if(!$){console.log("fixConflicts...ERROR ERROR no evts found!!!",R);return}let N=n(R.target);if(!N){console.log("fixConflicts...ERROR ERROR target evt not found!!!",R);return}m.set(R.target,R==null?void 0:R.targetStart),t?(H.push(`(${$==null?void 0:$.id}) '${$==null?void 0:$.title.trim()}'`),f?f.id!=R.target&&console.log("fixConflicts::ERROR ERROR:: oneToManyConflict >>Not same target ID?!?",f,R,P,m):(f=N,P.push(N),b.unshift(N)),b.push($)):(H.push(`(${N==null?void 0:N.id}) '${N==null?void 0:N.title.trim()}'`),y?y.id!=$.id&&console.log("fixConflicts::ERROR ERROR::manyToOneConflict Not same schedule?!?",y.id,$.id,R,P):(y=$,b.unshift($),m.set(R.inConflict,R==null?void 0:R.targetStart)),P.push(N),b.push(N)),R.direction=="surrounding"?z=!0:z=z}let X=H.join(" and "),Z=H.length<2&&o[0]<3,me=!1;H.length<2&&(me=t?this.canAutoSchedule(f,b[0]):this.canAutoSchedule(P[0],y));let J=[],Se=Z?"Pick one event via ":"Auto-Resolve to keep Evt with ";if(me?(this.doLog("fixConflicts::AUTO-RESOLVE!! "+y.id+"withID:"+t,me),J.unshift({label:"By Title Auto-resolve?",value:"opt0"}),J.push({label:"Manually Choose one event",value:"opt3"})):Z?J.push({label:"Manually Choose one event",value:"opt3"}):(J.push({label:"Manually Choose one event",value:"opt3"}),e=="byScore"?J.unshift({label:Se+`${Z?"Priority":"Highest Priority"}`,value:"opt1",color:"secondary"}):e=="byPrio"?J.unshift({label:Se+`${Z?"Score Interval":"Shortest Score Interval"}`,value:"opt2"}):J.unshift({label:Se+`${Z?"Priority":"Highest Priority"}`,value:"opt1",color:"secondary"},{label:Se+`${Z?"Score Interval":"Shortest Score Interval"}`,value:"opt2"})),!z&&!e.indexOf("nah")>-1){let R=t?`Force in > '${f==null?void 0:f.title.trim()}' ?`:`Force in > ${H.join()}`;J.push({label:R,value:"opt4"})}else z&&Z&&(e.indexOf("onPickEvt")>-1||e.indexOf("adHocEvt")>-1)&&J.push({label:"Force add ?",value:"opt4"});let Ee=e.indexOf("onDrop")>-1,Re=`${Z&&J.length<=2?"Cancel to keep scheduled":Ee?"Cancel to keep as-is":""}`,it=t?`${Ee?"Moving":"Adding"} (${f==null?void 0:f.id}) '${f==null?void 0:f.title.trim()}' at ${V((xe=m.get(f.id))==null?void 0:xe.time)} Conflicts with scheduled ${X}. 
 ${Re}`:`${Ee?"Moving":"Adding"} ${H.join()} Conflicts with scheduled (${y==null?void 0:y.id}) '${y==null?void 0:y.title.trim()}' at ${V(y==null?void 0:y.time)}. 
 ${Re}`,ot=t?`OneToMany Conflicts #${o[1]+1}`:`ManyToOne Conflicts #${o[1]}`;this.radioChoiceDialog(ot,it,J,"",function(R){O(R,me,P,b,Z)},Re!=""?w:null,function(){v("Main!")})},onPickEvent(i,e,t,o){if(this.closingDialog(),!i||!i.id){console.log("onPickEvent...ERROR nothing!",i,e,t,o),this.doNotify("No Goal selected..."),this.reset();return}let s=this.isViewingPast()?!0:e,l=o!=i.duration,n=this.daSchedule.tooClose(this.targetDrop.timestamp,l?o:i.duration);if(n){if(console.log("onPickEvent::tooClose check FAIL!",n),n===!0){this.doNotify("Picking event TOO close to midnight!"),this.reset();return}if(s)this.doNotify(`'${i.title.trim()}' TOO close Buuut..FORCING!`,"warning","top");else{this.doNotify(`'${i.title.trim()}' TOO close to a scheduled Evt--Check Force box!!`),this.reset();return}}l&&(i.duration=o);let r=this.daSchedule.onPickEvent(i,this.targetDrop.timestamp,s,t,this.doNotifyTimeout);r.canContinue?(t&&this.doNotify("What is Owed PAID! gg!","info","top"),this.reset()):r.overlaps&&Object.keys(r.overlaps).length>0?(t&&this.doNotify("Overlaps!-Balance Not Used!","negative","top"),this.handleOverlaps(r.overlaps,"onPickEvt")):this.doNotify("Error? onPickEvt :(","negative","bottom")},onAddHocEvent(i,e,t,o,s){if(this.possibleRange||(this.possibleRange=this.startEndTimes),i.trim()==""){this.doNotify("Empty Goal title..."),this.closingDialog(),this.reset();return}let l=Ue(this.possibleRange[0]),n=o>15?B(l,{minute:parseInt(o)}):B(Ue(this.possibleRange[1]),{minute:15}),r=Math.floor(ie(l,n)/1e3/60),d=this.daSchedule.tooClose(l,r);if(d){if(console.log("onAddHocEvent::tooClose check FAIL!!",d),this.closingDialog(),d===!0){this.doNotify(`'${i}' Not added as over midnight!`);return}this.doNotify(`'${i}' too close to a scheduled Evt--Forcing!!`,"warning")}this.closingDialog();let c=this.daSchedule.saveNewGoal(l,i,e,t,r);if(c===0||c){let p=this.daSchedule.onAdHocEvent(c,l,s,this.doNotifyTimeout);if(p.canContinue)this.constructTree(),this.reset(),this.doNotify("New adHoc Evt added!","positive","top"),this.daSchedule.toggleActionBtns(!0,"adHocEvt"),this.mobile&&this.adjustCurrentTime();else if(console.log("onAdHocEvent::OVERLAPS?",JSON.parse(JSON.stringify(p))),p.overlaps==null){this.doNotify("Error Adding this event :(","negative"),console.log("onAdHocEvent::ERROR not found?");return}else s&&this.doNotify("Overlaps!-Balance Not Used!","warning","top"),this.handleOverlaps(p.overlaps,"adHocEvt")}else console.log("onAdHocEvent::BOO ERROR no subID :(",c),this.doNotify("Error adding :(  Add Evt by select!","negative")},onEndNow(i){const e=()=>{let s=this.daSchedule.findSchedEvent(i);this.daSchedule.removeScheduledEvt(s),this.daSchedule.saveDaySchedule(),this.doNotify(`Removing "${s==null?void 0:s.title.trim()}" Saving Schedule...`,"positive","top")},t=s=>{console.log("onEndNow::reducing!!!",i,Number.isInteger(s)),this.daSchedule.reduceEvtDuration(i,s)};let o=this.daSchedule.canEndNow(i);o?this.confirmAction("",`Less than 10mins remove?
 Cancel to just EndNow`,"OK",e,function(){t(o)}):console.log("onEndNow...END",i,o,Number.isInteger(o))},onSaveScore(i,e,t=""){let o=ne(i);if(o<-1){o==-89?(console.log("onSaveScore parsing error",o,i),this.doNotify("Score Parsing Error... YOU FOO! ")):this.doNotify("Score Error: higher# on lower#");return}this.daSchedule.updateNoteScore(e,i,t),t!==""&&!this.isViewingPast()&&this.doNotify("Note added...do Save eh!","warning","bottom")},onAddMins(i,e){let t=this.daSchedule.addMinsToEvt(i,e,this.doNotify);if(!t.canContinue){if(t.overlaps&&Object.keys(t.overlaps).length>0)return this.doNotify("Bumped into some Evts","warning","top"),this.movedIntoConflict(t.overlaps,!0,"onAddMins",e);this.doNotify("Add ERROR:(","negative","bottom")}},removeEvtInSchedule(i,e=!0){let t=!1,o=()=>{if(this.daSchedule.removeScheduledEvt(i),t||e){e&&(this.daSchedule.addToBalance(i),this.doNotify(`Balance change after removing '${i.title}'`,"warning","top")),this.doSaveSchedule();return}this.daSchedule.toggleActionBtns(!0,"view")},s=()=>{console.log("Cancelled remove"),this.reset()};if(this.isViewingPast()){if(i.duration<30){this.doNotify("Removing from the past... Check BALANCE!"),this.daSchedule.addToBalance(i),t=!0,o();return}this.chooseAlternatives(i);return}if(!this.daSchedule.isViewingToday()&&!this.mobile){t=this.daSchedule.getCurrentMoods()[i.id],console.log("Removing future evt"),o();return}let l=`Remove "${i.title}" ?`,n=this.daSchedule.getCurrentMoods()[i.id];n&&(t=!0,l=l+` With Moods: '${n}'`),l=e?l+" (Balance affected)":l,this.confirmAction("Schedule Change",l,"Remove",o,s)},betterEvtLabel(i,e,t=null){const o=(l,n)=>{if(l!=null&&l.parentGoal){let r=this.daSchedule.parentGoalById(l.parentGoal);return n?`Of '${r==null?void 0:r.title.trim()}' (${r==null?void 0:r.priority})`:`Of '${r==null?void 0:r.title.trim()}'`}return console.log("prioLabel..ERROR no PARENT found?",l),""};let s="";switch(e){case"score":return s=`${o(i,!1)} > "${i.title.trim()}" with Score:: ${i.score} = ${ne(i.score)} `,s+=t?`@ ${V(i==null?void 0:i.time)} ++ ${i==null?void 0:i.duration} mins`:`for ${i==null?void 0:i.duration} mins`,{label:s,value:i.id};case"prio":return s=`"${i.title.trim()}" ${o(i,!1)} `,s+=t?`@ ${V(i==null?void 0:i.time)} ++ ${i==null?void 0:i.duration} mins`:`for ${i==null?void 0:i.duration} mins`,{label:s,value:i.id};default:return s=`"${i.title.trim()}" ${o(i,!0)} && Score:: ${i.score} = ${ne(i.score)} ${t?` @ ${V(i==null?void 0:i.time)} ++ ${i==null?void 0:i.duration} mins`:`for ${i.duration} mins`}`,{label:s,value:i.id}}},getLargestScoreInterval(i){let e=0,t=null;for(let o of i){let s=ne(o.score);s>-1&&s>=e&&(e=s,t=o)}return t},getSmallestScoreInterval(i){let e=9,t=null;for(let o of i){let s=ne(o.score);s>-1&&s<=e&&(e=s,t=o)}return t},findhighestPrio(i){let e=0,t=null;for(let o of i)if(o.parentGoal){let s=this.daSchedule.parentGoalById(o.parentGoal);s?s.priority>e&&(e=s.priority,t=o):console.log("findhighestPrio::ERROR no PARENT found?",o)}else console.log("findhighestPrio::ERROR EVT not found?",o);return{e:t,prio:e}},chooseAlternatives(i){let e=(a,v)=>{if(a.parentGoal>v.parentGoal)return 1;if(a.parentGoal==v.parentGoal)return 0;if(a.parentGoal<v.parentGoal)return-1},t=this.daSchedule.getAltEvts().sort(e),o=ce(new Date),s=i.time,l=o.date,n=i.title;const r=a=>a.filter(v=>!this.daSchedule.getAllEvts().has(v.id)),d=a=>{let v=B(Y(l),{day:0}),T=B(Y(v.date),{day:1}),g=this.daSchedule.getEventsForDate(v.date),C={},D=null;g?C=g:console.log("chooseAlternatives::addInFutur EMPTY for >>...",v.date),a.forEach(O=>{if(D=this.daSchedule.getSubGoalByID(O),C[O]){console.log("addInFutur...ALREADY PRESENT",O,v.date,D==null?void 0:D.title.trim()),this.doNotify(`Alternative '${D==null?void 0:D.title.trim()}' already present on ${v.date}. Moving it to next day`,"warning");let w=this.daSchedule.getEventsForDate(T.date);if(w)if(!w[O])w[O]={duration:D==null?void 0:D.duration,time:s,notes:`Alt replace for '${n}'`};else{console.log("addInFutur...STILL PRESENT in next day:"+T.date,D.title.trim()),this.doNotify(`Booo! Alt '${D==null?void 0:D.title.trim()}' also present on ${T.date} :(( ...Check BALANCE!`),this.daSchedule.addToBalance(D);return}else w={},w[O]={duration:D.duration,time:s,notes:`Alt replace for '${n}'`};this.daSchedule.updateDaySchedule(T.date,w),this.doNotify(`Saving ${D.title} in ${T.date}`,"info","bottom")}else C[O]={duration:D.duration,time:s,notes:`Alt replace for '${n}'`}}),this.daSchedule.updateDaySchedule(v.date,C)},c=a=>{this.daSchedule.removeScheduledEvt(i);let v=t.find(C=>C.id==a);console.log("remReplace...Add at:",s,v.title,"usually at:"+v.time);let T=this.daSchedule.addGoalsToSchedule([{...v,time:s,notes:`Alt replace for '${n}'`}],!0),g=Object.keys(T).length;if(g>0)return console.log(`chooseAlternatives::removeReplace:: OVERLAPS again from ${v.length} overlaps =${g}`,v,T),this.doNotify(`Extra Overlaps while adding ${v[0].title.trim()}`,"negative"),this.handleOverlaps(T,"alts");this.daSchedule.saveDaySchedule(),this.doNotify(`Added Alt replacement '${v==null?void 0:v.title}' at ${s}`,"info")},p=a=>{this.doNotify(a)};if(t=r(t),t.length==0){p("Removing not allowed! Alternatives already present!");return}this.checkBoxDialog("Gotta pick alternative!","Select the first Evt to replace Removed + an Extra evt for next day (today)!",t.map(a=>this.betterEvtLabel(a,"default",!1)),t[0].id,function(a){console.log("chooseAlternatives::opt",a),c(a.shift()),a.length>0?d(a):(console.log("chooseAlternatives::onOk...nothing to add?!?",t.length,a.length,t.length-a.length),p("No Alternative scheduled later :("))},function(){console.log("chooseAlternatives::onCancel")})},reset(){this.selectedItem=null,this.targetDrop=null,this.touchedItem=null,this.daSchedule.resetChosen(),this.possibleRange=null},doCleanup(){console.log("doCleanup",this.lastTarget),this.lastTarget&&(this.lastTarget.style.background="",this.lastTarget=null)},closeDialogWithReset(){this.showEvtDialog=!1,this.reset(),this.doCleanup()},closingDialog(){this.showEvtDialog=!1},doLog(i,e){console.log(i,JSON.parse(JSON.stringify(e)))},onPrev(){let i=()=>{this.$refs.calendar.prev(),this.adjustCurrentTime()},e=()=>{setTimeout(i,1e3),this.doSaveSchedule()};this.saveScheduleDisabled?i():this.confirmAction("",`Save day: ${this.currentDate} changes?`,"Save",e,i)},onToday(){let i=()=>{this.$refs.calendar.moveToToday(),this.adjustCurrentTime()},e=()=>{setTimeout(i,1e3),this.doSaveSchedule()};this.saveScheduleDisabled?i():this.confirmAction("",`Save day: ${this.currentDate} changes?`,"Save",e,i)},onNext(){let i=()=>{this.$refs.calendar.next(),this.adjustCurrentTime()},e=()=>{setTimeout(i,1e3),this.doSaveSchedule()};this.saveScheduleDisabled?i():this.confirmAction("",`Save day: ${this.currentDate} changes?`,"Save",e,i)},onChange(){let i=this.daSchedule.onChangeViewDate(this.currentDate);if(!i.canContinue){if(i.overlaps&&i.overlaps.length>0)return this.handleOverlaps(i.overlaps,"view");this.doNotify(`Loaded schedule for ${this.currentDate}`,"positive","bottom"),this.adjustCurrentTime()}},onDragStart(i,e){if(this.isViewingPast()){this.doNotify("Editing past is no no!"),i.preventDefault();return}this.selectedItem=e},onDragEnter(i,e,t){if(e==="goal-item")i.preventDefault();else{if(this.targetDrop&&this.targetDrop.timestamp.time==t.timestamp.time)console.log("onDragEnter...calendar,SAME",this.targetDrop.timestamp.time);else{let o=i.target;o.style.background=this.selectedItem.bgcolor.includes("-")?"grey":this.selectedItem.bgcolor,this.lastTarget=o}this.targetDrop=t,i.preventDefault()}return!0},onDragOver(i,e,t){return i.preventDefault(),!0},onDragLeave(i,e,t){let o=i.target;return o.style.background="",!1},onDragEnd(i){},onDrop(i,e,t){let o=this.daSchedule.findSchedEvent(this.selectedItem.id);if(!o){console.log("onDrop ERROR",o,this.selectedItem);return}let s=null;if(e==="interval")s=t.timestamp;else if(e==="goal-item"&&this.targetDrop)s=this.targetDrop.timestamp;else{console.log("Cannot drop here YO!!",i,e,t,this.targetDrop);return}if(!s){console.log("ERROR...no timestamp YO!!",i,e,t,this.targetDrop);return}this.doDroppy(s,this.selectedItem)},onClickTime(i){this.targetDrop=i.scope,this.showEvtDialog=!0},onClickDate(i){console.log("onClickDate",i)},onClickInterval(i){console.log("onClickInterval",i)},onClickHeadIntervals(i){console.log("onClickHeadIntervals",i)},onClickHeadDay(i){console.log("onClickHeadDay",i)},onMouseDownTime({scope:i,event:e}){if(Ke(e)){if(this.mobile===!0&&this.anchorTimestamp!==null&&this.otherTimestamp!==null&&de(this.anchorTimestamp)===de(this.otherTimestamp)){this.otherTimestamp=i.timestamp,this.mouseDown=!1;return}this.mouseDown=!0,this.anchorTimestamp=i.timestamp,this.otherTimestamp=i.timestamp}},onMouseUpTime({scope:i,event:e}){if(this.mobile!==!0&&Ke(e)&&(this.otherTimestamp=i.timestamp,this.mouseDown=!1),!this.mousedown){let t=this.startEndTimes;if(t[1]==t[0])return;this.possibleRange=t,console.log("onMouseUpTime range change",this.possibleRange)}},onMouseMoveTime({scope:i,event:e}){this.mobile!==!0&&this.mouseDown===!0&&(this.otherTimestamp=i.timestamp)},onDblClickEvent(i,e){if(this.isViewingPast()){if(console.log("onDblClickEvent::ERROR?",e),e.duration<30){console.log("onDblClickEvent..baah too smoll smoll",e.title,e.duration),this.doNotify("umm Removing from the past..Soo Check BALANCE!"),this.daSchedule.addToBalance(e),this.daSchedule.removeScheduledEvt(e);return}this.chooseAlternatives(e),i.preventDefault();return}this.removeEvtInSchedule(e,!1),i.preventDefault()},onTouchStart(i,e){if(i.type=="touchstart"){this.selectedItem=e;let t=document.elementFromPoint(i.changedTouches[0].clientX,i.changedTouches[0].clientY);if(t.parentNode.classList.contains("my-event"))t.parentNode.classList.add("my-event-drag"),this.touchedItem=t;else if(t.closest(".my-event"),t=t.parentNode,t.parentNode.classList.contains("my-event"))t.parentNode.classList.add("my-event-drag"),this.touchedItem=t;else{this.touchedItem=!1;return}return i.preventDefault(),!0}console.log("onTouchStart::ERROR...UNKNOWN",i)},onTouchEvt(i,e){const t=s=>{let l=s.split(" "),n=l[l.length-2],r=B(Y(this.currentDate),{minute:j(n)});return l[l.length-1]=="PM"?r.hour==12?r:B(Y(this.currentDate),{hour:12,minute:j(n)}):r.hour==12?B(Y(this.currentDate),{hour:-12,minute:j(n)}):r};let o=s=>{let l=s.closest(".my-event");l.classList.contains("my-event-drag")&&l.classList.toggle("my-event-drag")};if(this.selectedItem||(console.log("onTouchEvt NULL Item >>ERROR?!? "+i.type,this.selectedItem,this.touchedItem),e=this.selectedItem),this.isViewingPast()){this.doNotify("Editing past is no no!"),o(this.touchedItem),i.preventDefault(),i.stopPropagation();return}if(i.type=="touchmove"){let s=document.elementFromPoint(i.changedTouches[0].clientX,i.changedTouches[0].clientY);if(s.ariaLabel){let l=t(s.ariaLabel);if(this.targetDrop){let n=ie(this.targetDrop,l);if(JSON.stringify(this.targetDrop)===JSON.stringify(l)&&n==0)return;this.lastTarget?(this.lastTarget.style.background="",s.style.background=this.selectedItem.bgcolor.includes("-")?"grey":this.selectedItem.bgcolor,this.lastTarget=s):(this.lastTarget=s,s.style.background=this.selectedItem.bgcolor.includes("-")?"grey":this.selectedItem.bgcolor)}this.targetDrop=l,i.preventDefault();return}return}if(i.type=="touchend"){let s=document.elementFromPoint(i.changedTouches[0].clientX,i.changedTouches[0].clientY);if(!this.touchedItem)return;if(s.parentNode.classList.contains("my-event-drag"))console.log("onTouchEvt::END >>removing my-event-drag","isDisabledScoreEdit>> "+this.daSchedule.isDisabledScoreEdit[e.id],"mobileEnableScore>> "+this.daSchedule.mobileEnableScore[e.id]),s.parentNode.classList.remove("my-event-drag");else{let l=this.touchedItem.parentNode.classList.contains("my-event-drag");l?this.touchedItem.parentNode.classList.remove("my-event-drag"):console.log("onTouchEvt::END...target NO my-event-drag?",l,s,s.parentNode)}if(s.ariaLabel){let l=t(s.ariaLabel);this.targetDrop=l,this.doDroppy(this.targetDrop,this.selectedItem)}else(s.classList.contains("title")||s.classList.contains("my-event"))&&this.targetDrop&&this.doDroppy(this.targetDrop,this.selectedItem);i.preventDefault(),i.stopPropagation();return}console.log("onTouchEvt::UNKNOWN",i)},onTouchHold({evt:i,...e},t){if(!this.mobile)return console.log("onTouchHold>>NOT MOBILE",i.type,"mobileEnableScore>> "+this.daSchedule.mobileEnableScore[t.id]),!0;let o=document.elementFromPoint(i.changedTouches[0].clientX,i.changedTouches[0].clientY);this.daSchedule.toggleEvtNoteScoreMobile(t.id);let s=o.closest(".my-event");o.classList.contains("title")&&o.parentNode.classList.contains("my-event-drag")?(console.log("onTouchHold...REMOVING my-event-drag"),o.parentNode.classList.remove("my-event-drag")):s&&s.classList.contains("my-event-drag")?s.classList.toggle("my-event-drag"):this.touchedItem&&(s=this.touchedItem.closest(".my-event"),s&&s.classList.contains("my-event-drag")?s.classList.toggle("my-event-drag"):console.log("ERROR...onTouchHold--class not found on Target!!",o,this.touchedItem)),this.daSchedule.isDisabledScoreEdit[t.id]&&!this.daSchedule.mobileEnableScore[t.id]&&this.onDblClickEvent(i,t)},scrollToEvent(i){this.$refs.calendar.scrollToTime(i.time,350)},scrollToTime(i,e=null){var t;if(this.$refs.calendar){let o=B(i,{minute:-10});(t=this.$refs.calendar)==null||t.scrollToTime(o.time,e?e=="fast"?400:1e3:500)}else setTimeout(()=>{console.log("scrollToTime::NO SCROLLY at",i.time,"Trying again...."),this.scrollToTime(i,"slow")},1e3)},confirmTimeChange(i,e,t,o,s,l,n=null){this.$q.dialog({title:i,message:e,cancel:!1,ok:t,options:{type:"radio",model:"",items:[{label:t+" and "+o,value:"ok"},{label:o,value:"alt"}]},class:"overflow-wrap: break-word;",style:""}).onOk(r=>{if(r==""){console.log("confirmTimeChange onOk with no selection >>onDismiss"),this.doNotify("No selection made...Leaving as is","info"),n?n():console.log("confirmTimeChange:: No Dismiss func to execute!");return}return s(r)}).onCancel(()=>{l()})},radioChoiceDialog(i,e,t,o,s=null,l=null,n=null){this.$q.dialog({title:i,cancel:!!l,persistent:!0,message:e,seamless:!0,options:{type:"radio",model:o,items:t}}).onOk(r=>{s&&(r==""?this.radioChoiceDialog(i,e,t,o,s,l,n):s(r))}).onCancel(()=>{l&&l()}).onDismiss(()=>{n&&n()})},checkBoxDialog(i,e,t,o,s=null,l=null,n=null){let r=t.length,d=r>2?2:r;this.$q.dialog({title:i,message:e,options:{type:"checkbox",model:[],isValid:c=>c.length>0&&c.length>=d,items:t},cancel:!0,persistent:!0}).onOk(c=>{s(c)}).onCancel(()=>{l&&l()}).onDismiss(()=>{n&&n()})},confirmChoiceDialog(i,e,t,o,s=null,l=null,n=null){this.$q.dialog({title:i,cancel:!!l,persistent:!0,message:e,options:{type:"radio",model:o,items:t}}).onOk(r=>{s&&(r==""?this.confirmChoiceDialog(i,e,t,o,s,l,n):s(r))}).onCancel(()=>{l&&l()}).onDismiss(()=>{n&&n()})},scheduleByDialog(i,e,t,o,s=null,l=null,n=null){this.$q.dialog({component:si,componentProps:{title:i,message:e,options:t,selectedO:o,showDialog:!0}}).onOk(r=>{s&&(r==""?this.scheduleByDialog(i,e,t,o,s,l,n):s(r))}).onCancel(()=>{l&&l()}).onDismiss(()=>{n&&n()})},confirmAction(i,e,t,o,s,l=null){this.$q.dialog({title:i,cancel:!0,ok:t,message:e}).onOk(()=>{o()}).onCancel(()=>{s()}).onDismiss(()=>{if(l){l();return}})},doNotifyTimeout(i,e=void 0,t="top",o=null){this.$q.notify({color:e!==void 0?e:"negative",position:t,message:i,icon:e==null?"report_problem":"thumb_up",timeout:o||5e3,multiLine:!0})},doNotify(i,e=void 0,t="top"){this.$q.notify({color:e!==void 0?e:"negative",position:t,message:i,multiLine:!0,icon:e==null?"report_problem":"thumb_up"})},withDismissNotify(i,e=void 0,t="top",o=null,s=null){this.$q.notify({color:e!==void 0?e:"negative",position:t,message:i,icon:e==null?"report_problem":"thumb_up",timeout:o!=null?o:5e3,closeBtn:"Okey",onDismiss:s})}}},Te=i=>(Dt("data-v-60839718"),i=i(),Ot(),i),ni={class:"subcontent"},ri={class:"q-px-md boxy"},ai={key:0},di={key:1},hi={key:2},ci={key:3},ui={key:4},fi={key:5},gi={class:"row justify-center"},mi=Te(()=>x("br",null,null,-1)),Si=Te(()=>x("br",null,null,-1)),pi={key:0,class:"q-pa-sm bg-grey-12",style:{"max-width":"400px"}},yi={class:"q-pa-sm row justify-center"},vi={class:"row justify-center"},bi=Te(()=>x("br",null,null,-1)),Ci={key:0,class:"q-gutter-md"},Di={class:"q-mr-sm text-weight-bold",size:"28px"},Oi={key:0},Ti={class:"text-weight-bold"},Ei={key:1,class:"text-weight-light text-black"},Ri={key:1,class:"q-pa-md q-gutter-sm bg-grey-12",style:{"max-width":"400px"}},wi={class:"instru"},Ni={key:0,class:"row q-px-md"},Pi={class:"row justify-center"},Ai={class:"q-gutter-md",style:{display:"flex","max-width":"800px",width:"100%",height:"600px"}},$i={style:{display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"2px"}},_i={class:"heady q-calendar__ellipsis"},Mi=["onDblclick","onDragstart","onTouchstart","onTouchmove","onTouchend"],Bi=Te(()=>x("br",null,null,-1));function ki(i,e,t,o,s,l){const n=ee("sched-btn"),r=ee("drop-dwn-btn"),d=ee("da-instructions"),c=ee("navigation-bar"),p=ee("goaly-end"),a=ee("mobileNoteScore"),v=ee("q-calendar-day"),T=ee("sched-dialog");return _(),K(Bt,{padding:""},{default:k(()=>[x("div",ni,[A(je,{modelValue:s.splitterPage,"onUpdate:modelValue":e[10]||(e[10]=g=>s.splitterPage=g),limits:[30,70]},{before:k(()=>[A(je,{modelValue:s.splitterLegend,"onUpdate:modelValue":e[3]||(e[3]=g=>s.splitterLegend=g),horizontal:"",limits:[20,80],style:{height:"100%"}},{before:k(()=>[x("div",ri,[s.daSchedule.getProps().showReloadBtn?(_(),F("div",ai,[A(n,{"text-label":"Reload",class:"sched-btn","text-color":"green",onDoBtnAction:l.onReloadSaved},null,8,["onDoBtnAction"])])):U("",!0),s.daSchedule.getProps().showClearBtn?(_(),F("div",di,[A(n,{"text-label":"Clear",class:"sched-btn","text-color":"lime-5",onDoBtnAction:l.onClearDay},null,8,["onDoBtnAction"])])):U("",!0),l.showDefaultBtn?(_(),F("div",hi,[A(n,{textLabel:l.defaultLabels,class:"sched-btn","text-color":"blue",onDoBtnAction:l.onLoadDefault},null,8,["textLabel","onDoBtnAction"])])):U("",!0),s.daSchedule.getProps().showScoreBtn?(_(),F("div",ci,[A(r,{class:"sched-drop-btn","text-color":"teal",disableBtn:s.daSchedule.disableScoreBtn,optionLabel:l.chosenScoreLabel,daOptions:s.scoreOptions,onDoReload:l.doReloadWithScore,onChooseOption:l.onChoosenScore},null,8,["disableBtn","optionLabel","daOptions","onDoReload","onChooseOption"])])):U("",!0),s.daSchedule.getProps().showPrioBtn?(_(),F("div",ui,[A(r,{class:"sched-drop-btn","text-color":"teal",disableBtn:s.daSchedule.getProps().disablePrioBtn,optionLabel:l.chosenPrioLabel,daOptions:l.allMainGPrio(),onDoReload:l.doReloadWithPrio,onChooseOption:l.onChoosenPrio},null,8,["disableBtn","optionLabel","daOptions","onDoReload","onChooseOption"])])):U("",!0),s.daSchedule.getProps().showOneEachBtn?(_(),F("div",fi,[A(n,{"text-label":"One Each",class:"sched-btn","text-color":"brown",onDoBtnAction:l.onScheduleOneEach},null,8,["onDoBtnAction"])])):U("",!0)]),x("div",gi,[A(De,{class:"q-mt-md","text-color":l.saveScheduleDisabled?"grey":"blue",elevated:"",push:"",align:"evenly",label:"SaveSchedule",disable:l.saveScheduleDisabled,onClick:l.doSaveSchedule,"no-caps":""},null,8,["text-color","disable","onClick"]),A(De,{class:"q-mt-md","text-color":"green",elevated:"",push:"",align:"evenly",label:s.showTree?"HideTree":"ShowTree",onClick:e[0]||(e[0]=g=>s.showTree=!s.showTree),"no-caps":""},null,8,["label"])]),mi]),after:k(()=>[Si,s.treeGoals.length>0?(_(),F("div",pi,[x("div",yi,W(l.labelGoals("s")),1),x("div",vi,[A(be,{color:"secondary","multi-line":""},{default:k(()=>[te(W(l.labelGoals("b"))+" mins ",1)]),_:1})]),A(Ce),bi,l.showTreeForm?(_(),F("div",Ci,[A(Pt,{label:"'je-suis'",hint:"Keyword >> Enter","hide-hint":"",ref:"filterRef",modelValue:s.filter,"onUpdate:modelValue":e[1]||(e[1]=g=>s.filter=g),"use-input":"","use-chips":"",multiple:"",disable:l.isViewingPast(),"hide-dropdown-icon":"","input-debounce":"0","new-value-mode":"add-unique",class:"q-gutter-sm"},{"selected-item":k(g=>[A(At,{removable:"",dense:"",onRemove:C=>g.removeAtIndex(g.index),tabindex:g.tabindex,"text-color":"black",class:"q-ma-none",style:{width:"80px"}},{default:k(()=>[te(W(g.opt),1)]),_:2},1032,["onRemove","tabindex"])]),append:k(()=>[s.filter.length>0?(_(),K($e,{key:0,name:"clear",class:"cursor-pointer",onClick:l.resetFilter},null,8,["onClick"])):U("",!0)]),_:1},8,["modelValue","disable"]),A(kt,{nodes:s.treeGoals,"node-key":"label",filter:l.filterString,"filter-method":l.myFilterMethod,expanded:s.expanded,"onUpdate:expanded":e[2]||(e[2]=g=>s.expanded=g),"no-connectors":"",dense:""},{"default-header":k(g=>[x("div",{class:ve(l.classyColor(g.node))},[g.node.isChildren?U("",!0):(_(),K($e,{key:0,name:g.expanded?"expand_less":"expand_more",size:"28px",right:""},null,8,["name"])),x("div",Di,W(g.node.label),1),A($e,{name:g.node.icon},null,8,["name"])],2)]),"default-body":k(g=>[g.node.isChildren?(_(),F("div",Oi,[x("span",Ti," >> "+W(g.node.details),1),g.node.moods.length>0?(_(),K(ke,{key:0},{default:k(()=>[te(W("Moods::> "+g.node.moods.join(",")),1)]),_:2},1024)):U("",!0)])):(_(),F("span",Ei,W(g.node.details),1))]),_:1},8,["nodes","filter","filter-method","expanded"])])):U("",!0),s.filter.length>0?(_(),F("div",Ri,[A(n,{"text-label":"Add Mood Evts",class:"q-mt-xl sched-btn","text-color":"red",onDoBtnAction:l.onMoodAdd},null,8,["onDoBtnAction"])])):U("",!0)])):U("",!0)]),_:1},8,["modelValue"]),x("div",wi,[A(Ze,{modelValue:s.showInstru,"onUpdate:modelValue":e[4]||(e[4]=g=>s.showInstru=g),label:s.showInstru?"Hide Instructions":"Show Instructions",color:"teal",class:"q-pa-md q-mx-xl",align:"center"},null,8,["modelValue","label"]),s.showInstru?(_(),K(d,{key:0,showRemInstru:l.showRemInstru,showSchedInstru:l.showSchedInstru},null,8,["showRemInstru","showSchedInstru"])):U("",!0)])]),separator:k(()=>[A(bt,{color:"primary",class:"q-px-md","text-color":"white",size:"40px",icon:"drag_indicator",style:{position:"relative",top:"70%"}})]),after:k(()=>[A(c,{onToday:l.onToday,onPrev:l.onPrev,onNext:l.onNext},null,8,["onToday","onPrev","onNext"]),l.scheduleMoodsLabel?(_(),F("div",Ni,[te(" By moods: "),(_(!0),F(ae,null,_e(l.scheduleMoodsLabel,(g,C)=>(_(),K(be,{key:C,color:g.color,"multi-line":"",rounded:""},{default:k(()=>[te(W(g.m),1)]),_:2},1032,["color"]))),128))])):U("",!0),x("div",Pi,[x("div",Ai,[A(v,{ref:"calendar",view:"day",modelValue:s.currentDate,"onUpdate:modelValue":e[9]||(e[9]=g=>s.currentDate=g),"drag-enter-func":l.onDragEnter,"drag-over-func":l.onDragOver,"drag-leave-func":l.onDragLeave,"drop-func":l.onDrop,animated:"",bordered:"",hoverable:"","no-active-date":"","transition-next":"slide-left","transition-prev":"slide-right","time-clicks-clamped":"","interval-minutes":15,"interval-count":96,"interval-height":28,"selected-start-end-dates":l.startEndTimes,onChange:l.onChange,onClickDate:l.onClickDate,onClickTime:l.onClickTime,onClickInterval:l.onClickInterval,onClickHeadIntervals:l.onClickHeadIntervals,onClickHeadDay:l.onClickHeadDay,onMousedownTime:l.onMouseDownTime,onMouseupTime:l.onMouseUpTime,onMousemoveTime:l.onMouseMoveTime},{"head-day-event":k(({scope:{timestamp:g}})=>[x("div",$i,[(_(!0),F(ae,null,_e(l.eventsMap[g.date],C=>(_(),F(ae,{key:C.id},[C.time?(_(),K(be,{key:1,class:ve(l.badgeClasses(C,"header")),style:ge([l.badgeStyles(C,"header"),{margin:"1px",width:"10px","max-width":"10px",height:"10px","max-height":"10px",cursor:"pointer"}]),onClick:D=>l.scrollToEvent(C)},{default:k(()=>[A(ke,null,{default:k(()=>[te(W("("+C.id+") "+C.title+" - "+C.time+" ("+C.duration+"min) >> "+C.end.time),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"])):(_(),K(be,{key:0,class:ve(l.badgeClasses(C,"header")),style:ge([l.badgeStyles(C,"header"),{width:"100%",cursor:"pointer",height:"12px","font-size":"10px",margin:"1px"}])},{default:k(()=>[x("div",_i,[te(W(C.title)+" ",1),A(ke,null,{default:k(()=>[te(W(C.details),1)]),_:2},1024)])]),_:2},1032,["class","style"]))],64))),128))])]),"day-container":k(({scope:{days:g}})=>[l.hasDate(g)?(_(),F(ae,{key:0},[x("div",{class:"day-view-current-time-indicator",style:ge(l.style)},null,4),x("div",{class:"day-view-current-time-line",style:ge(l.style)},null,4)],64)):U("",!0)]),"day-body":k(({scope:{timestamp:g,timeStartPos:C,timeDurationHeight:D}})=>[(_(!0),F(ae,null,_e(l.getDateEvents(g.date),O=>(_(),F(ae,{key:O.id},[O.time!==void 0?(_(),F("div",{key:0,class:ve(["my-event",l.badgeClasses(O,"body")]),style:ge(l.badgeStyles(O,"body",C,D)),draggable:!0,onDblclick:Me(w=>l.onDblClickEvent(w,O),["prevent"]),onDragstart:Me(w=>l.onDragStart(w,O),["stop"]),onDragend:e[5]||(e[5]=Me((...w)=>l.onDragEnd&&l.onDragEnd(...w),["stop"])),onDrop:e[6]||(e[6]=w=>l.onDrop(w,"goal-item",i.scope)),onDragenter:e[7]||(e[7]=w=>l.onDragEnter(w,"goal-item",i.scope)),onDragover:e[8]||(e[8]=w=>l.onDragOver(w,"goal-item",i.scope)),onTouchstart:w=>l.onTouchStart(w,O),onTouchmove:w=>l.onTouchEvt(w,O),onTouchend:w=>l.onTouchEvt(w,O)},[Ct(A(p,{disabledScore:s.daSchedule.isDisabledScoreEdit[O.id],title:O.title,id:O.id,startTime:O.time,score:O.score,details:O.details,notes:O.notes,icon:O.icon,happeningNow:s.daSchedule.hasStarted[O.id]?s.daSchedule.hasStarted[O.id]:!1,onEndNow:l.onEndNow,onSaveScore:l.onSaveScore,onAddMins:l.onAddMins,onDeleteNow:w=>l.removeEvtInSchedule(O)},null,8,["disabledScore","title","id","startTime","score","details","notes","icon","happeningNow","onEndNow","onSaveScore","onAddMins","onDeleteNow"]),[[Lt,w=>l.onTouchHold(w,O),"400:12:15"]]),l.showEvtMobile(O.id)?(_(),K(a,{key:0,title:O.title,id:O.id,startTime:O.time,score:O.score,details:O.details,notes:O.notes,"show-dialog":l.showEvtMobile(O.id),onSaveScore:l.onSaveScore,onDeleteNow:w=>l.removeEvtInSchedule(O),onEuhHidin:w=>s.daSchedule.euhHidin(O.id)},null,8,["title","id","startTime","score","details","notes","show-dialog","onSaveScore","onDeleteNow","onEuhHidin"])):U("",!0)],46,Mi)):U("",!0)],64))),128))]),_:1},8,["modelValue","drag-enter-func","drag-over-func","drag-leave-func","drop-func","selected-start-end-dates","onChange","onClickDate","onClickTime","onClickInterval","onClickHeadIntervals","onClickHeadDay","onMousedownTime","onMouseupTime","onMousemoveTime"])])]),Bi]),_:1},8,["modelValue"]),s.showEvtDialog?(_(),K(T,{key:0,parentGoals:s.daSchedule.allPGoals(),canBeScheduled:l.canbeScheduled,balance:l.currentBalance,selectedTime:l.selectedTimeInterval,onAdHocEvent:l.onAddHocEvent,onOnPickEvent:l.onPickEvent,onEuhHidin:l.closingDialog},null,8,["parentGoals","canBeScheduled","balance","selectedTime","onAdHocEvent","onOnPickEvent","onEuhHidin"])):U("",!0)])]),_:1})}var qi=Xe(li,[["render",ki],["__scopeId","data-v-60839718"]]);export{qi as default};
