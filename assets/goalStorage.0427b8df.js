import{j as V,e as X,h as Z,T as _,al as k,r as ee,c as N}from"./index.2925efaa.js";import{u as te}from"./use-quasar.1a5a105b.js";var oe=V({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup($,{slots:O,emit:c}){let v=!1,M,A,S=null,g=null,m,T;function D(){M&&M(),M=null,v=!1,S!==null&&(clearTimeout(S),S=null),g!==null&&(clearTimeout(g),g=null),A!==void 0&&A.removeEventListener("transitionend",m),m=null}function E(f,h,p){h!==void 0&&(f.style.height=`${h}px`),f.style.transition=`height ${$.duration}ms cubic-bezier(.25, .8, .50, 1)`,v=!0,M=p}function x(f,h){f.style.overflowY=null,f.style.height=null,f.style.transition=null,D(),h!==T&&c(h)}function I(f,h){let p=0;A=f,v===!0?(D(),p=f.offsetHeight===f.scrollHeight?0:void 0):(T="hide",f.style.overflowY="hidden"),E(f,p,h),S=setTimeout(()=>{S=null,f.style.height=`${f.scrollHeight}px`,m=G=>{g=null,(Object(G)!==G||G.target===f)&&x(f,"show")},f.addEventListener("transitionend",m),g=setTimeout(m,$.duration*1.1)},100)}function J(f,h){let p;A=f,v===!0?D():(T="show",f.style.overflowY="hidden",p=f.scrollHeight),E(f,p,h),S=setTimeout(()=>{S=null,f.style.height=0,m=G=>{g=null,(Object(G)!==G||G.target===f)&&x(f,"hide")},f.addEventListener("transitionend",m),g=setTimeout(m,$.duration*1.1)},100)}return X(()=>{v===!0&&D()}),()=>Z(_,{css:!1,appear:$.appear,onEnter:I,onLeave:J},O.default)}});const ie=k("allGoals",()=>{const $=ee([{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}]),O=[{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}],c=te(),v=N(()=>O),M=N(()=>{let t=JSON.parse(c.localStorage.getItem("mainGoals"));return g(t)}),A=N(()=>{let t=JSON.parse(c.localStorage.getItem("subGoals"));return g(t)}),S=N(()=>JSON.parse(c.localStorage.getItem("AllDates")));function g(t){return t?[...t]:[]}function m(t,l,e,o){let n=this.getMainGoals;if(!n){console.log("umm no mainGoals...adding"),c.localStorage.set("mainGoals",JSON.stringify([{id:0,title:t.trim(),details:l,priority:o,bgcolor:e,icon:"fas fa-utensils"}]));return}let a=n.length+1;for(;n.some(i=>i.id===a);)a=Math.floor(Math.random()*1e3);return n.unshift({id:a,title:t.trim(),details:l,priority:o,bgcolor:e,icon:"fas fa-utensils"}),c.localStorage.set("mainGoals",JSON.stringify(n)),a}function T(t,l,e,o,n){let a=this.getMainGoals;for(var i=0;i<a.length;i++)if(a[i].id===t){a[i].title=l.trim(),a[i].details=e,a[i].bgcolor=o,a[i].priority=n;break}c.localStorage.set("mainGoals",JSON.stringify(a))}function D(t,l,e,o,n,a,i,s){let r=this.getSubGoals;if(!r){c.localStorage.set("subGoals",JSON.stringify([{id:0,parentGoal:t,title:l.trim(),score:e,time:o,duration:n,canMove:a,inDefaults:i,isAlternative:s}]));return}let u=r.length+1;for(;r.some(b=>b.id===u);)u=Math.floor(Math.random()*1e3);return r.unshift({id:u,parentGoal:t,title:l.trim(),score:e,time:o,duration:n,canMove:a,inDefaults:i,isAlternative:s}),c.localStorage.set("subGoals",JSON.stringify(r)),u}function E(t,l,e,o,n,a,i,s){let r=this.getSubGoals;for(var u=0;u<r.length;u++)if(r[u].id===t){r[u].title=l.trim(),r[u].score=e,r[u].time=o,r[u].duration=n,r[u].canMove=a,r[u].inDefaults=i,r[u].isAlternative=s;break}c.localStorage.set("subGoals",JSON.stringify(r))}function x(){c.localStorage.remove("mainGoals"),console.log("removed all mainGoal")}function I(){c.localStorage.remove("subGoals"),console.log("removed all subGoals")}function J(){c.localStorage.remove("subGoals"),c.localStorage.remove("mainGoals"),c.localStorage.remove("AllDates"),console.log("removed ALL")}function f(t,l=null,e=null){let o=this.getSubGoals;for(var n=0;n<o.length;n++)if(o[n].id===t){o[n].time=l||o[n].time,o[n].score=e||o[n].score;break}c.localStorage.set("subGoals",JSON.stringify(o))}function h(t){let l=this.getSubGoals;for(var e=0;e<l.length;e++)l[e].id===t&&(l.splice(e,1),console.log("removeSubgoal spliced!"));return c.localStorage.set("subGoals",JSON.stringify(l)),l}function p(t,l){let e=this.getMainGoals;for(var o=0;o<e.length;o++)e[o].id===t&&(e.splice(o,1),console.log("removeMaingoal spliced!"));return c.localStorage.set("mainGoals",JSON.stringify(e)),e}function G(t){var o;let l=this.getMainGoals;for(var e=0;e<l.length;e++)if(((o=l[e])==null?void 0:o.title.trim())===t)return l[e];return null}function F(t,l=null){let e=this.getAllDates;e?l?e[`${t}`]=l:t in e?delete e[`${t}`]:console.log(`ERROR? deleting schedule of ${t} not found!`):(console.log(`Adding new schedule for ${t}`),e={},e[`${t}`]=l),c.localStorage.set("AllDates",JSON.stringify(e))}function C(t){let l=this.getAllDates;if(l)return l[`${t}`]}function H(t){let l=this.getAllDates;return l?!!l[`${t}`]:!1}function Y(){const t=[];let l=function(o){return o==null?void 0:o.inDefaults},e=this.getSubGoals;return e?(e.forEach(o=>{l(o)&&t.push(o)}),t):(console.log("No subgoals to fetch defaults :("),t)}function Q(t=null){let l=this.getMainGoals,e=new Set;if(t)for(var o=0;o<l.length;o++)l[o].priority==t&&e.add(l[o].priority);else l.forEach(n=>{e.add(n.priority)});return e}function j(){const t=[];let l=this.getSubGoals;return l&&l.forEach(e=>{e!=null&&e.isAlternative&&t.push(e)}),t}function B(t){const l=[];let e=function(n){const a=n.split(/on/);return a.length!=2?(console.log(`parseScore error?${n}`,a),-1):a[1]-a[0]},o=this.getSubGoals;return o&&o.forEach(n=>{if(n.score=="")console.log(`no score event added: ${n.title}`,n.score),l.push(n);else{let a=e(n.score);a>-1&&a>=t&&l.push(n)}}),l}function U(t){const e=(t/60).toFixed(2);return parseFloat(e)}function P(){let t=this.getMainGoals,l=this.getSubGoals,e=(i,s)=>{if(i.id>s.id)return 1;if(i.id==s.id)return 0;if(i.id<s.id)return-1},o=i=>{if(!i)return"";let s=i.split(":");return parseInt(s[0])>=12?"PM":"AM"},n=i=>{let s=[];return l&&l.forEach(r=>{r.parentGoal==i&&s.push(r)}),s},a=[];return t.forEach(i=>{var b,y,R,w,L;let s={id:i.id,label:`${i.id}) ${i==null?void 0:i.title.trim()}`,details:`${i.details} ==> Prio:${i==null?void 0:i.priority}`,color:`${i==null?void 0:i.bgcolor}`,prio:i==null?void 0:i.priority,children:[]},r=n(i.id);for(let d=0;d<r.length;d++){let z=r[d].inDefaults?"Dft":"#",K=r[d].canMove?"Mv":"#",W=r[d].isAlternative?"Alt":"#";s.children.push({id:r[d].id,label:`${r[d].id} -- ${(b=r[d])==null?void 0:b.title.trim()} (${(y=r[d])==null?void 0:y.score})`,details:`${(R=r[d])==null?void 0:R.time}${o((w=r[d])==null?void 0:w.time)} for ${(L=r[d])==null?void 0:L.duration} mins :: ${z}~${K}~${W}`,color:`${i==null?void 0:i.bgcolor}`,isChildren:!0})}let u=s.children;u.sort(e),s.children=u,a.push(s)}),a.sort(e),a}function q(){let t=this.getAllDates;if(!t)return[];let l=this.getMainGoals,e=this.getSubGoals,o={};for(let s in t){let r=t[s];for(let u in r)o[u]||(o[u]=[]),o[u].push({date:s,logged:U(r[u].duration)})}let n=s=>{let r=[];return e&&e.forEach(u=>{u.parentGoal==s&&r.push(u)}),r},a=(s,r=null)=>{let u={children:[],title:r?`${s.title.trim()}(${s.score})`:`${s.title.trim()} !${s.priority}!`,key:r?`${r}-${s.id}`:s.id,logged:[],expanded:!1,color:s==null?void 0:s.bgcolor,isChild:!!r};if(r){let b=o[s.id]||[];u.logged=[...b]}return u},i=[];return l.forEach(s=>{let r=a(s),u=n(s.id);for(let b=0;b<u.length;b++){let y=a(u[b],s.id);if(y.logged.length==0){console.log(`Oooh no logged for parent ${s.title}`,y);continue}r.logged.push(...y.logged),r.children.push(y)}i.push(r)}),i}return{headers:O,headerRefs:$,getHeaders:v,getMainGoals:M,getSubGoals:A,getAllDates:S,addMainGoal:m,addSubGoal:D,editSubGoal:E,editMainGoal:T,getGoalByTitle:G,saveSubProp:f,saveDailySchedule:F,resetSub:I,resetMain:x,resetAll:J,removeSubgoal:h,removeMaingoal:p,getEventsForDate:C,hasEventsForDate:H,fetchAllTaskSummary:q,fetchGoalsWithMinScore:B,fetchAllPrio:Q,fetchDefaults:Y,fetchAlternativeEvts:j,fetchGoalsTree:P}});export{oe as Q,ie as u};
