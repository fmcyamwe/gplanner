import{_ as j,$ as z,r as x,L as N,E as c,F as b,G as n,M as u,H as i,O as m,P,R as C,a0 as A,a1 as w,Q as B,I as k,K as f,a2 as E,J as h,a3 as T,a4 as H,a5 as V,a6 as O,a7 as F}from"./index.ce87ae0d.js";import{u as U,a as W,b as K,c as J,Q as X,d as M,e as Y}from"./goalStorage.e6c3c0d6.js";import{Q as L}from"./QBadge.5c080bb8.js";import{t as Z,i as $,a as v,p as G,b as S,c as ee,d as R,e as te,Q as se}from"./isMobile.a3ad7785.js";import{Q as ae}from"./QCalendar.c264367b.js";const oe={name:"weekCalendar",components:{NavigationBar:z(()=>H(()=>import("./NavigationBar.c517621c.js"),["assets/NavigationBar.c517621c.js","assets/NavigationBar.bf3d18d0.css","assets/index.ce87ae0d.js","assets/index.4f70e4de.css"])),QCalendar:ae},data(){return U(),{store:W(),calendar:x(null),currentDate:x(Z()),events:[],mostEvts:5,treeGoals:x([]),expanded:x([]),showTree:x(!1),moods:x({}),mobile:x(!1)}},beforeMount(){this.mobile=$(),this.loadEvts(),this.constructTree()},mounted(){console.log("mounted")},computed:{storedGoalsMap(){const t=new Map;let s=this.store.getSubGoals;return s?(s.forEach(e=>{t.set(e.id,e)}),t):(console.log("GoalsMap is empty or null",s),t)},label(){return this.showTree?"Hide Legend":"Show Legend"},allEvents(){return this.store.getAllDates},parentGoalsMap(){const t=new Map;let s=this.store.getMainGoals;return s?(s.forEach(e=>{t.set(e.id,e)}),t):(console.log("parentGoalsMap is empty or null",s),t)},eventsMap(){const t={};return this.events.forEach(s=>{if(t[s.date]||(t[s.date]=[]),s.sortTime=v(S(s.date),{minute:G(s.time)}),t[s.date].push(s),s.days){console.log(`eventsMap multiple days? event for ${s.date}`,s.days);let e=ee(s.date),r=s.days;do e=v(e,{day:1}),t[e.date]||(t[e.date]=[]),t[e.date].push(s);while(--r>0)}}),t}},methods:{classyColor(t){return`row items-center ${t.isChildren?"text-":"text-white bg-"}${t.color} `},loadEvts(){var r,d,o,p;let t=this.parentGoalsMap,s=this.storedGoalsMap,e=this.allEvents;if(s&&t){if(e)for(let y in e){let a=e[y];for(let l in a){let _=s.get(parseInt(l));if(_){let g=t.get(_.parentGoal),D=v(S(y),{minute:G(a[l].time)}),I=v(D,{minute:parseInt(a[l].duration)}),q="";a[l].notes!==void 0&&((r=a[l])==null?void 0:r.notes)!==""?q=[`${D.time} - ${I.time}`,`${(o=(d=a[l])==null?void 0:d.atScore)!=null?o:""} >> ${_.score}`,`${(p=a[l])==null?void 0:p.notes}`].join(`
\r`):q=`${D.time} - ${I.time}`,a[l].byMood!==void 0&&(this.moods[y]||(this.moods[y]=[]),this.moods[y].push(...a[l].byMood)),this.events.push({id:_.id,title:_.title,details:q,time:a[l].time,duration:a[l].duration,date:y,bgcolor:g.bgcolor})}}}}else{console.log("ERROR--no parent or goals!!REVIEW**");return}},constructTree(){this.treeGoals=this.store.fetchGoalsTree()},getEvents(t){let s=(r,d)=>{let o=te(r.sortTime,d.sortTime);if(o>0)return-1;if(o==0)return 0;if(o<0)return 1};const e=this.eventsMap[t]||[];if(e.length===1)e[0].side="full";else if(e.length===2){const r=v(S(e[0].date),{minute:G(e[0].time)}),d=v(r,{minute:e[0].duration}),o=v(S(e[1].date),{minute:G(e[1].time)}),p=v(o,{minute:e[1].duration});R(o,r,d,!0)||R(p,r,d,!0)?(e[0].side="left",e[1].side="right"):(e[0].side="full",e[1].side="full")}return e.length>this.mostEvts&&(this.mostEvts=this.mobile?e.length+5:e.length),e.sort(s)},badgeClasses(t,s){return K(t,s)},badgeStyles(t,s,e=void 0,r=void 0){return J(t,s,e,r)},scrollToEvent(t){this.$refs.calendar.scrollToTime(t.time,350)},onToday(){this.$refs.calendar.moveToToday()},onPrev(){this.$refs.calendar.prev()},onNext(){this.$refs.calendar.next()},onClickHeadDay({scope:t,event:s}){var o,p;let e=t.timestamp.date,r=this.moods[e],d=(p=(o=this.eventsMap[e])==null?void 0:o.length)!=null?p:0;r?this.$q.notify({color:"positive",position:"top",message:`${d} Scheduled with Moods: ${r.join()}`,icon:"tag_faces",multiLine:!0}):this.$q.notify({color:"white",textColor:"black",position:"top",message:d>0?`${d} Scheduled without Any Mood!`:"Empty and NO mood!!",icon:d>0?"mood":"sentiment_neutral",iconColor:d>0?"positive":"red",multiLine:!0})},onChange(t){this.mostEvts=5,console.log("onChange",t)}}},Q=t=>(O("data-v-fd6bd22e"),t=t(),F(),t),le={class:"q-px-md"},de=Q(()=>u("i",{class:"row justify-center q-pa-sm"},"Click on Day header for that day's Moods ",-1)),ie={class:"row justify-center"},ne={class:"q-px-md",style:{display:"flex","max-width":"800px",width:"100%",height:"500px",overflow:"auto"}},re={style:{display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"2px"}},ce={class:"title q-calendar__ellipsis"},ue={class:"title q-calendar__ellipsis"},me={class:"lineyy"},he={key:0,class:"q-pa-md"},pe={key:0,class:"q-pa-md bg-grey-12",style:{"max-width":"400px"}},fe=Q(()=>u("div",{class:"row justify-center"}," Goals & Goal Events ",-1)),ye=Q(()=>u("br",null,null,-1)),_e={class:"q-mr-sm text-weight-bold",size:"28px"},ge={key:0},ve={class:"text-weight-bold liney"},xe={key:1,class:"text-weight-light text-black liney"},be={key:1,class:"column justify-center items-center"},we=Q(()=>u("br",null,null,-1));function Te(t,s,e,r,d,o){const p=N("navigation-bar"),y=N("q-calendar");return c(),b(X,{padding:""},{default:n(()=>[u("div",le,[i(p,{onToday:o.onToday,onPrev:o.onPrev,onNext:o.onNext},null,8,["onToday","onPrev","onNext"]),de,u("div",ie,[u("div",ne,[i(y,{ref:"calendar",modelValue:d.currentDate,"onUpdate:modelValue":s[0]||(s[0]=a=>d.currentDate=a),view:"week",dark:"",animated:"",hoverable:"",bordered:"","transition-prev":"slide-right","transition-next":"slide-left","no-active-date":"","interval-minutes":30,"interval-count":48,"interval-height":d.mostEvts*3,onChange:o.onChange,onClickHeadDay:o.onClickHeadDay},{"head-day-event":n(({scope:{timestamp:a}})=>[u("div",re,[(c(!0),m(C,null,P(o.eventsMap[a.date],l=>(c(),m(C,{key:l.id},[l.time?(c(),b(L,{key:1,class:E(o.badgeClasses(l,"header")),style:V([o.badgeStyles(l,"header"),{margin:"1px",width:"10px","max-width":"10px",height:"10px","max-height":"10px",cursor:"pointer"}]),onClick:_=>o.scrollToEvent(l)},{default:n(()=>[i(M,null,{default:n(()=>[h(f(l.time+" - "+l.title),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"])):(c(),b(L,{key:0,class:E(o.badgeClasses(l,"header")),style:V([o.badgeStyles(l,"header"),{width:"100%",cursor:"pointer",height:"12px","font-size":"10px",margin:"1px"}])},{default:n(()=>[u("div",ce,[h(f(l.title)+" ",1),i(M,null,{default:n(()=>[h(f(l.details),1)]),_:2},1024)])]),_:2},1032,["class","style"]))],64))),128))])]),"day-body":n(({scope:{timestamp:a,timeStartPos:l,timeDurationHeight:_}})=>[(c(!0),m(C,null,P(o.getEvents(a.date),g=>(c(),m(C,{key:g.id},[g.time!==void 0?(c(),m("div",{key:0,class:E(["my-event",o.badgeClasses(g,"body")]),style:V(o.badgeStyles(g,"body",l,_))},[u("span",ue,[h(f(g.title)+" ",1),i(M,null,{default:n(()=>[u("div",me,f(g.details),1)]),_:2},1024)])],6)):k("",!0)],64))),128))]),_:1},8,["modelValue","interval-height","onChange","onClickHeadDay"])])])]),i(A,{modelValue:d.showTree,"onUpdate:modelValue":s[1]||(s[1]=a=>d.showTree=a),label:o.label,color:"teal",class:"q-pa-md"},null,8,["modelValue","label"]),i(Y,null,{default:n(()=>[d.showTree?(c(),m("div",he,[d.treeGoals.length>0?(c(),m("div",pe,[fe,i(w),ye,i(se,{nodes:d.treeGoals,"node-key":"label",expanded:d.expanded,"onUpdate:expanded":s[2]||(s[2]=a=>d.expanded=a),"no-connectors":"",dense:"",accordion:""},{"default-header":n(a=>[u("div",{class:E(o.classyColor(a.node))},[a.node.isChildren?k("",!0):(c(),b(B,{key:0,name:a.expanded?"expand_less":"expand_more",size:"28px",class:"q-mr-sm"},null,8,["name"])),u("div",_e,f(a.node.label),1),i(B,{name:a.node.icon},null,8,["name"])],2)]),"default-body":n(a=>[a.node.isChildren?(c(),m("div",ge,[u("span",ve," >> "+f(a.node.details),1),a.node.moods.length>0?(c(),b(M,{key:0},{default:n(()=>[h(f("Moods::> "+a.node.moods.join(",")),1)]),_:2},1024)):k("",!0)])):(c(),m("span",xe,f(a.node.details),1))]),_:1},8,["nodes","expanded"])])):(c(),m("div",be,[we,i(T,null,{default:n(()=>[h(" 1. Add some Goals first. A schedulable goal is one with a parent Goal--can have multiple related goals with the same parent. ")]),_:1}),i(w),i(T,null,{default:n(()=>[h(" 2. Go to Schedule to see a daily schedule. Drag scheduled events to new timeslots or click in calendar to add an event. ")]),_:1}),i(w),i(T,null,{default:n(()=>[h(" 3. Reload a saved daily schedule or defaults or choose minimal score events to schedule. Fix any scheduling conflicts. ")]),_:1}),i(w),i(T,null,{default:n(()=>[h(" 4. Save the daily schedule (dont forget to update their score as needed!) ")]),_:1}),i(w),i(T,null,{default:n(()=>[h(" 5. Check out the summary of all goals here! ")]),_:1})]))])):k("",!0)]),_:1})]),_:1})}var Se=j(oe,[["render",Te],["__scopeId","data-v-fd6bd22e"]]);export{Se as default};
