import{j as W,e as V,h as X,T as Z,al as _,r as k,c as N}from"./index.a6f70d05.js";import{u as ee}from"./use-quasar.b68b184f.js";var re=W({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup($,{slots:O,emit:c}){let v=!1,A,D,p=null,g=null,m,T;function M(){A&&A(),A=null,v=!1,p!==null&&(clearTimeout(p),p=null),g!==null&&(clearTimeout(g),g=null),D!==void 0&&D.removeEventListener("transitionend",m),m=null}function E(u,h,S){h!==void 0&&(u.style.height=`${h}px`),u.style.transition=`height ${$.duration}ms cubic-bezier(.25, .8, .50, 1)`,v=!0,A=S}function x(u,h){u.style.overflowY=null,u.style.height=null,u.style.transition=null,M(),h!==T&&c(h)}function I(u,h){let S=0;D=u,v===!0?(M(),S=u.offsetHeight===u.scrollHeight?0:void 0):(T="hide",u.style.overflowY="hidden"),E(u,S,h),p=setTimeout(()=>{p=null,u.style.height=`${u.scrollHeight}px`,m=G=>{g=null,(Object(G)!==G||G.target===u)&&x(u,"show")},u.addEventListener("transitionend",m),g=setTimeout(m,$.duration*1.1)},100)}function J(u,h){let S;D=u,v===!0?M():(T="show",u.style.overflowY="hidden",S=u.scrollHeight),E(u,S,h),p=setTimeout(()=>{p=null,u.style.height=0,m=G=>{g=null,(Object(G)!==G||G.target===u)&&x(u,"hide")},u.addEventListener("transitionend",m),g=setTimeout(m,$.duration*1.1)},100)}return V(()=>{v===!0&&M()}),()=>X(Z,{css:!1,appear:$.appear,onEnter:I,onLeave:J},O.default)}});const oe=_("allGoals",()=>{const $=k([{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}]),O=[{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}],c=ee(),v=N(()=>O),A=N(()=>{let t=JSON.parse(c.localStorage.getItem("mainGoals"));return g(t)}),D=N(()=>{let t=JSON.parse(c.localStorage.getItem("subGoals"));return g(t)}),p=N(()=>JSON.parse(c.localStorage.getItem("AllDates")));function g(t){return t?[...t]:[]}function m(t,l,e,o){let n=this.getMainGoals;if(!n){console.log("umm no mainGoals...adding"),c.localStorage.set("mainGoals",JSON.stringify([{id:0,title:t.trim(),details:l,priority:o,bgcolor:e,icon:"fas fa-utensils"}]));return}let f=n.length+1;for(;n.some(s=>s.id===f);)f=Math.floor(Math.random()*1e3);return n.unshift({id:f,title:t.trim(),details:l,priority:o,bgcolor:e,icon:"fas fa-utensils"}),c.localStorage.set("mainGoals",JSON.stringify(n)),f}function T(t,l,e,o,n,f,s,i){let r=this.getSubGoals;if(!r){c.localStorage.set("subGoals",JSON.stringify([{id:0,parentGoal:t,title:l.trim(),score:e,time:o,duration:n,canMove:f,inDefaults:s,isAlternative:i}]));return}let a=r.length+1;for(;r.some(b=>b.id===a);)a=Math.floor(Math.random()*1e3);return r.unshift({id:a,parentGoal:t,title:l.trim(),score:e,time:o,duration:n,canMove:f,inDefaults:s,isAlternative:i}),c.localStorage.set("subGoals",JSON.stringify(r)),a}function M(t,l,e,o,n,f,s,i){let r=this.getSubGoals;for(var a=0;a<r.length;a++)if(r[a].id===t){r[a].title=l.trim(),r[a].score=e,r[a].time=o,r[a].duration=n,r[a].canMove=f,r[a].inDefaults=s,r[a].isAlternative=i;break}c.localStorage.set("subGoals",JSON.stringify(r))}function E(){c.localStorage.remove("mainGoals"),console.log("removed all mainGoal")}function x(){c.localStorage.remove("subGoals"),console.log("removed all subGoals")}function I(){c.localStorage.remove("subGoals"),c.localStorage.remove("mainGoals"),c.localStorage.remove("AllDates"),console.log("removed ALL")}function J(t,l=null,e=null){let o=this.getSubGoals;for(var n=0;n<o.length;n++)if(o[n].id===t){o[n].time=l||o[n].time,o[n].score=e||o[n].score;break}c.localStorage.set("subGoals",JSON.stringify(o))}function u(t){let l=this.getSubGoals;for(var e=0;e<l.length;e++)l[e].id===t&&(l.splice(e,1),console.log("removeSubgoal spliced!"));return c.localStorage.set("subGoals",JSON.stringify(l)),l}function h(t,l){let e=this.getMainGoals;for(var o=0;o<e.length;o++)e[o].id===t&&(e.splice(o,1),console.log("removeMaingoal spliced!"));return c.localStorage.set("mainGoals",JSON.stringify(e)),e}function S(t){var o;let l=this.getMainGoals;for(var e=0;e<l.length;e++)if(((o=l[e])==null?void 0:o.title.trim())===t)return l[e];return null}function G(t,l=null){let e=this.getAllDates;e?l?e[`${t}`]=l:t in e?delete e[`${t}`]:console.log(`ERROR? deleting schedule of ${t} not found!`):(console.log(`Adding new schedule for ${t}`),e={},e[`${t}`]=l),c.localStorage.set("AllDates",JSON.stringify(e))}function F(t){let l=this.getAllDates;if(l)return l[`${t}`]}function C(t){let l=this.getAllDates;return l?!!l[`${t}`]:!1}function H(){const t=[];let l=function(o){return o==null?void 0:o.inDefaults},e=this.getSubGoals;return e?(e.forEach(o=>{l(o)&&t.push(o)}),t):(console.log("No subgoals to fetch defaults :("),t)}function Y(t=null){let l=this.getMainGoals,e=new Set;if(t)for(var o=0;o<l.length;o++)l[o].priority==t&&e.add(l[o].priority);else l.forEach(n=>{e.add(n.priority)});return e}function Q(){const t=[];let l=this.getSubGoals;return l&&l.forEach(e=>{e!=null&&e.isAlternative&&t.push(e)}),t}function j(t){const l=[];let e=function(n){const f=n.split(/on/);return f.length!=2?(console.log(`parseScore error?${n}`,f),-1):f[1]-f[0]},o=this.getSubGoals;return o&&o.forEach(n=>{if(n.score=="")console.log(`no score event added: ${n.title}`,n.score),l.push(n);else{let f=e(n.score);f>-1&&f>=t&&l.push(n)}}),l}function B(t){const e=(t/60).toFixed(2);return parseFloat(e)}function U(){let t=this.getMainGoals,l=this.getSubGoals,e=(s,i)=>{if(s.id>i.id)return 1;if(s.id==i.id)return 0;if(s.id<i.id)return-1},o=s=>{if(!s)return"";let i=s.split(":");return parseInt(i[0])>=12?"PM":"AM"},n=s=>{let i=[];return l&&l.forEach(r=>{r.parentGoal==s&&i.push(r)}),i},f=[];return t.forEach(s=>{var b,y,R,w,L;let i={id:s.id,label:` ${s==null?void 0:s.title.trim()} (${s==null?void 0:s.priority})`,details:`${s.id}. ${s.details}`,color:`${s==null?void 0:s.bgcolor}`,prio:s==null?void 0:s.priority,children:[]},r=n(s.id);for(let d=0;d<r.length;d++){let z=r[d].inDefaults?"Dft":"#",K=r[d].canMove?"Mv":"#",P=r[d].isAlternative?"Alt":"#";i.children.push({id:r[d].id,label:`${r[d].id} -- ${(b=r[d])==null?void 0:b.title.trim()} (${(y=r[d])==null?void 0:y.score})`,details:`${(R=r[d])==null?void 0:R.time}${o((w=r[d])==null?void 0:w.time)} for ${(L=r[d])==null?void 0:L.duration} mins :: ${z}~${K}~${P}`,color:`${s==null?void 0:s.bgcolor}`,isChildren:!0})}let a=i.children;a.sort(e),i.children=a,f.push(i)}),f.sort(e),f}function q(){let t=this.getAllDates;if(!t)return[];let l=this.getMainGoals,e=this.getSubGoals,o={};for(let i in t){let r=t[i];for(let a in r)o[a]||(o[a]=[]),o[a].push({date:i,logged:B(r[a].duration)})}let n=i=>{let r=[];return e&&e.forEach(a=>{a.parentGoal==i&&r.push(a)}),r},f=(i,r=null)=>{let a={children:[],title:r?`${i.title.trim()}(${i.score})`:`${i.title.trim()} !${i.priority}!`,key:r?`${r}-${i.id}`:i.id,logged:[],expanded:!1,color:i==null?void 0:i.bgcolor,isChild:!!r};if(r){let b=o[i.id]||[];a.logged=[...b]}return a},s=[];return l.forEach(i=>{let r=f(i),a=n(i.id);for(let b=0;b<a.length;b++){let y=f(a[b],i.id);if(y.logged.length==0){console.log(`Oooh no logged for parent ${i.title}`,y);continue}r.logged.push(...y.logged),r.children.push(y)}s.push(r)}),s}return{headers:O,headerRefs:$,getHeaders:v,getMainGoals:A,getSubGoals:D,getAllDates:p,addMainGoal:m,addSubGoal:T,editSubGoal:M,getGoalByTitle:S,saveSubProp:J,saveDailySchedule:G,resetSub:x,resetMain:E,resetAll:I,removeSubgoal:u,removeMaingoal:h,getEventsForDate:F,hasEventsForDate:C,fetchAllTaskSummary:q,fetchGoalsWithMinScore:j,fetchAllPrio:Y,fetchDefaults:H,fetchAlternativeEvts:Q,fetchGoalsTree:U}});export{re as Q,oe as u};
