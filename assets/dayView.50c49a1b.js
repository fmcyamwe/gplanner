import{j as Q,c as q,h as C,k as Se,af as Ee,a2 as Re,r as c,ag as ke,ah as Pe,w as te,b as Oe,ai as Ne,Q as D,g as be,aj as $e,ak as Me,al as Be,am as Ve,W as Ae,an as qe,n as Ge,ao as _e,_ as Z,F as p,M as E,J as M,S as O,I as u,H as v,R as A,ap as ye,aq as Ie,K as w,U as k,ar as oe,ad as we,ae as De,d as He,E as _,as as le,O as R,N as I,f as se,G as B,P as K,at as j,au as ie,av as ne,ac as x,aa as Fe}from"./index.7efdc94b.js";import{Q as Te,a as Ce,b as Le,c as We,d as ae,e as re,f as de,g as ue,h as he}from"./viewAllGoals.331dcd6c.js";import{Q as X}from"./QTooltip.067a98a8.js";import{c as Qe,a as Ue,b as ze}from"./utiFunc.a56b0dc0.js";import{N as Ke,t as H,p as Y,a as b,j as V,k as J,C as ce,c as P,T as N,b as $,U as fe,i as W}from"./NavigationBar.a2a961b5.js";/* empty css                             */import{u as je}from"./goalStorage.4f6f1c12.js";import{u as xe}from"./use-quasar.711ed255.js";const Ye=()=>!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);var Je=Q({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:t}){const o=q(()=>{const l=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(s=>e[s]===!0).map(s=>`q-btn-group--${s}`).join(" ");return`q-btn-group row no-wrap${l.length>0?" "+l:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>C("div",{class:o.value},Se(t.default))}});const Xe=Object.keys(Ee),Ze=e=>Xe.reduce((t,o)=>{const l=e[o];return l!==void 0&&(t[o]=l),t},{});var me=Q({name:"QBtnDropdown",props:{...Ee,...Re,modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String},emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(e,{slots:t,emit:o}){const{proxy:l}=be(),s=c(e.modelValue),i=c(null),n=ke(),a=q(()=>{const f={"aria-expanded":s.value===!0?"true":"false","aria-haspopup":"true","aria-controls":n,"aria-label":e.toggleAriaLabel||l.$q.lang.label[s.value===!0?"collapse":"expand"](e.label)};return(e.disable===!0||e.split===!1&&e.disableMainBtn===!0||e.disableDropdown===!0)&&(f["aria-disabled"]="true"),f}),r=q(()=>"q-btn-dropdown__arrow"+(s.value===!0&&e.noIconAnimation===!1?" rotate-180":"")+(e.split===!1?" q-btn-dropdown__arrow-container":"")),m=q(()=>Pe(e)),g=q(()=>Ze(e));te(()=>e.modelValue,f=>{i.value!==null&&i.value[f?"show":"hide"]()}),te(()=>e.split,G);function d(f){s.value=!0,o("beforeShow",f)}function h(f){o("show",f),o("update:modelValue",!0)}function T(f){s.value=!1,o("beforeHide",f)}function S(f){o("hide",f),o("update:modelValue",!1)}function y(f){o("click",f)}function U(f){$e(f),G(),o("click",f)}function z(f){i.value!==null&&i.value.toggle(f)}function L(f){i.value!==null&&i.value.show(f)}function G(f){i.value!==null&&i.value.hide(f)}return Object.assign(l,{show:L,hide:G,toggle:z}),Oe(()=>{e.modelValue===!0&&L()}),()=>{const f=[C(Ne,{class:r.value,name:e.dropdownIcon||l.$q.iconSet.arrow.dropdown})];return e.disableDropdown!==!0&&f.push(C(Te,{ref:i,id:n,class:e.contentClass,style:e.contentStyle,cover:e.cover,fit:!0,persistent:e.persistent,noRouteDismiss:e.noRouteDismiss,autoClose:e.autoClose,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,separateClosePopup:!0,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,onBeforeShow:d,onShow:h,onBeforeHide:T,onHide:S},t.default)),e.split===!1?C(D,{class:"q-btn-dropdown q-btn-dropdown--simple",...g.value,...a.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:y},{default:()=>Se(t.label,[]).concat(f),loading:t.loading}):C(Je,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:e.rounded,square:e.square,...m.value,glossy:e.glossy,stretch:e.stretch},()=>[C(D,{class:"q-btn-dropdown--current",...g.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:U},{default:t.label,loading:t.loading}),C(D,{class:"q-btn-dropdown__arrow-container q-anchor--skip",...a.value,...m.value,disable:e.disable===!0||e.disableDropdown===!0,rounded:e.rounded,color:e.color,textColor:e.textColor,dense:e.dense,size:e.size,padding:e.padding,ripple:e.ripple},()=>f)])}}});function ge(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const t=parseInt(e,10);return isNaN(t)?0:t}var ve=Me({name:"close-popup",beforeMount(e,{value:t}){const o={depth:ge(t),handler(l){o.depth!==0&&setTimeout(()=>{const s=Be(e);s!==void 0&&Ve(s,l,o.depth)})},handlerKey(l){Ae(l,13)===!0&&o.handler(l)}};e.__qclosepopup=o,e.addEventListener("click",o.handler),e.addEventListener("keyup",o.handlerKey)},updated(e,{value:t,oldValue:o}){t!==o&&(e.__qclosepopup.depth=ge(t))},beforeUnmount(e){const t=e.__qclosepopup;e.removeEventListener("click",t.handler),e.removeEventListener("keyup",t.handlerKey),delete e.__qclosepopup}});function F(e,t=new WeakMap){if(Object(e)!==e)return e;if(t.has(e))return t.get(e);const o=e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):e instanceof Set?new Set:e instanceof Map?new Map:typeof e.constructor!="function"?Object.create(null):e.prototype!==void 0&&typeof e.prototype.constructor=="function"?e:new e.constructor;if(typeof e.constructor=="function"&&typeof e.valueOf=="function"){const l=e.valueOf();if(Object(l)!==l){const s=new e.constructor(l);return t.set(e,s),s}}return t.set(e,o),e instanceof Set?e.forEach(l=>{o.add(F(l,t))}):e instanceof Map&&e.forEach((l,s)=>{o.set(s,F(l,t))}),Object.assign(o,...Object.keys(e).map(l=>({[l]:F(e[l],t)})))}var et=Q({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","beforeShow","show","beforeHide","hide"],setup(e,{slots:t,emit:o}){const{proxy:l}=be(),{$q:s}=l,i=c(null),n=c(""),a=c("");let r=!1;const m=q(()=>qe({initialValue:n.value,validate:e.validate,set:g,cancel:d,updatePosition:h},"value",()=>a.value,f=>{a.value=f}));function g(){e.validate(a.value)!==!1&&(T()===!0&&(o("save",a.value,n.value),o("update:modelValue",a.value)),S())}function d(){T()===!0&&o("cancel",a.value,n.value),S()}function h(){Ge(()=>{i.value.updatePosition()})}function T(){return _e(a.value,n.value)===!1}function S(){r=!0,i.value.hide()}function y(){r=!1,n.value=F(e.modelValue),a.value=F(e.modelValue),o("beforeShow")}function U(){o("show")}function z(){r===!1&&T()===!0&&(e.autoSave===!0&&e.validate(a.value)===!0?(o("save",a.value,n.value),o("update:modelValue",a.value)):o("cancel",a.value,n.value)),o("beforeHide")}function L(){o("hide")}function G(){const f=t.default!==void 0?[].concat(t.default(m.value)):[];return e.title&&f.unshift(C("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},e.title)),e.buttons===!0&&f.push(C("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[C(D,{flat:!0,color:e.color,label:e.labelCancel||s.lang.label.cancel,onClick:d}),C(D,{flat:!0,color:e.color,label:e.labelSet||s.lang.label.set,onClick:g})])),f}return Object.assign(l,{set:g,cancel:d,show(f){i.value!==null&&i.value.show(f)},hide(f){i.value!==null&&i.value.hide(f)},updatePosition:h}),()=>{if(e.disable!==!0)return C(Te,{ref:i,class:"q-popup-edit",cover:e.cover,onBeforeShow:y,onShow:U,onBeforeHide:z,onHide:L,onEscapeKey:d},G)}}});const tt={name:"GoalyEnd",props:{disabledScore:Boolean,title:String,id:Number,startTime:String,details:String,score:String,happeningNow:Boolean},emits:["saveScore","endNow"],computed:{aScore:{get(){return this.score},set(e){console.log("aScore getting set",e,this.id),this.$emit("saveScore",e,this.id)}},overdueIconStyle(){return{color:this.daysOver===0?"inherit":"red","max-width":"25px","min-width":"25px"}},userIconStyle(){return{color:this.disabledScore===!0?"red":"blue",cursor:"pointer"}},endNowBtnStyle(){return{display:this.disabledScore===!0&&this.happeningNow===!0?"block":"none","margin-left":"32em",height:"100%"}}},watch:{title(e){console.log("titleValue:",e)}},methods:{onClicked(){console.log("huh a click doing nothing"),this.$emit("update:model-value",!this.disabledScore)},wannaEnd(){console.log("eeeuh wish to end for",this.id,this.disabledScore,this.happeningNow),this.$emit("endNow",this.id)}}},ot={class:"title q-calendar__ellipsis"};function lt(e,t,o,l,s,i){return p(),E("div",ot,[M(O(o.title+" : "+o.score)+" ",1),u(X,null,{default:v(()=>[M(O(o.details+" at: "+o.startTime),1)]),_:1}),u(D,{"no-caps":"",class:"button",label:"End-Now",style:A(i.endNowBtnStyle),onClick:i.wannaEnd},null,8,["style","onClick"]),u(et,{modelValue:i.aScore,"onUpdate:modelValue":t[0]||(t[0]=n=>i.aScore=n),disable:o.disabledScore,"auto-save":""},{default:v(n=>[u(ye,{modelValue:n.value,"onUpdate:modelValue":a=>n.value=a,dense:"",autofocus:"",onKeyup:Ie(n.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue","disable"])])}var st=Z(tt,[["render",lt],["__scopeId","data-v-5d2081d6"]]);const it=C("div",{class:"q-space"});var nt=Q({name:"QSpace",setup(){return()=>it}});const at={name:"adHocEvent",props:{mainGoals:Array},data(){return{aTitle:"",daP:null,own:"misc"}},emits:["saveEvent"],computed:{pGoals:{get(){return this.mainGoals}},evName:{get(){return this.aTitle},set(e){this.aTitle=e}}},methods:{onClicked(){this.$emit("saveEvent",this.aTitle,this.daP,this.own)}}},rt=e=>(we("data-v-b45cdc74"),e=e(),De(),e),dt={class:"q-calendar__ellipsis"},ut=rt(()=>w("div",{class:"text-h6"},"adHocEvent",-1)),ht={class:"q-ml-md q-gutter-md"},ct={key:0},ft={class:"radio-select"},mt={style:{"text-align":"center"}};function gt(e,t,o,l,s,i){return p(),E("div",dt,[ut,w("div",ht,[u(ye,{modelValue:i.evName,"onUpdate:modelValue":t[0]||(t[0]=n=>i.evName=n),filled:"",label:"A Goal","lazy-rules":"","item-aligned":"",rules:[n=>n&&n.length>0||"Please type a goal"]},null,8,["modelValue","rules"])]),i.pGoals?(p(),E("div",ct,[u(Ce,{class:"q-ml-md",modelValue:s.daP,"onUpdate:modelValue":t[1]||(t[1]=n=>s.daP=n),options:i.pGoals,"option-value":"id","option-label":"title",label:"Parent Goal"},null,8,["modelValue","options"])])):k("",!0),w("div",ft,[u(oe,{modelValue:s.own,"onUpdate:modelValue":t[2]||(t[2]=n=>s.own=n),val:"misc",label:"Misc"},null,8,["modelValue"]),u(nt),u(oe,{modelValue:s.own,"onUpdate:modelValue":t[3]||(t[3]=n=>s.own=n),val:"self",label:"Self"},null,8,["modelValue"])]),w("div",mt,[u(D,{flat:"",label:"Add",color:"primary",onClick:i.onClicked},null,8,["onClick"])])])}var vt=Z(at,[["render",gt],["__scopeId","data-v-b45cdc74"]]);function pe(e){return e.button===0}const pt=He({name:"dayCalendar",components:{NavigationBar:Ke,QCalendarDay:Qe,addGoalForm:Le,GoalyEnd:st,adHocEvent:vt},data(){return c(null),c(null),c(null),c(null),xe(),{currentDate:c(H()),scoreOptions:c([1,2,3,4,5]),chosenScore:c(null),chosenPrio:c(null),scheduledEvents:[],dailyScheduled:c(new Map),endTimesSet:c(new Set),startTimesSet:c(new Set),disablePrioBtn:c(!0),disableScoreBtn:c(!0),calendar:c(null),store:je(),anchorTimestamp:c(null),otherTimestamp:c(null),mouseDown:c(!1),mobile:c(!0),timeStartPos:c(0),showGoalForm:c(!1),pickEventDialog:c(!1),addEventDialog:c(!1),adHocEventDialog:c(!0),conflictReso:c(!1),resoType:c(""),toAddE:c(null),disabledScoreEvts:c({}),hasStarted:c({}),disableSaveSchedule:c(!0),showReloadBtn:c(!1),loadDefault:c(!0),scoreSchedule:c(!1),showPrio:c(!1)}},beforeMount(){this.mobile=Ye(),this.resetGoalEvts(!0)},beforeUnmount(){clearInterval(this.intervalId)},mounted(){this.adjustCurrentTime(),this.intervalId=setInterval(()=>{this.adjustCurrentTime()},6e4)},computed:{chosenScoreLabel(){return this.chosenScore==null?"Score Schedule":`Score > ${this.chosenScore}`},chosenPrioLabel(){return this.chosenPrio==null?"Priority Schedule":`Prio = ${this.chosenPrio}`},showForm(){return this.showGoalForm},doDisableSaveSchedule(){return this.disableSaveSchedule},hasEventsForDate(){return this.store.hasEventsForDate(this.currentDate)},eventsMap(){const e={};return this.scheduledEvents.forEach(t=>{if(e[t.date]||(e[t.date]=[]),e[t.date].push(t),t.days){console.log(`eventsMap multiple days? event for ${t.date}`,t.days);let o=Y(t.date),l=t.days;do o=b(o,{day:1}),e[o.date]||(e[o.date]=[]),e[o.date].push(t);while(--l>0)}}),e},parentGoalsMap(){const e=new Map;let t=this.storedMainG;return t?(t.forEach(o=>{e.set(o.id,o)}),e):(console.log("parentGoalsMap is empty or null",t),e)},canbeScheduled(){let e=this.deepCopy(this.storedEvents),t=e.filter(o=>!this.scheduledEvents.find(l=>l.id==o.id));return t.length==0?e:t},storedEvents(){return this.store.getSubGoals},storedMainG(){return this.store.getMainGoals},style(){return{top:this.timeStartPos+"px"}},startEndTimes(){const e=[];return this.anchorDayTimeIdentifier!==!1&&this.otherDayTimeIdentifier!==!1&&(this.anchorDayTimeIdentifier<=this.otherDayTimeIdentifier?e.push(V(this.anchorTimestamp),V(this.otherTimestamp)):e.push(V(this.otherTimestamp),V(this.anchorTimestamp))),e},anchorDayTimeIdentifier(){return this.anchorTimestamp!==null?J(this.anchorTimestamp):!1},otherDayTimeIdentifier(){return this.otherTimestamp!==null?J(this.otherTimestamp):!1}},methods:{badgeClasses(e,t){return Ue(e,t)},badgeStyles(e,t,o=void 0,l=void 0){return ze(e,t,o,l)},getTimeNumber(e){return e!==null?J(e):!1},hasUncompletedEvents(){for(let e in this.disabledScoreEvts)if(this.disabledScoreEvts[e])return!0;return!1},hasDate(e){return this.currentDate?e.find(t=>t.date===this.currentDate):!1},getEventsForDate(e){return this.store.getEventsForDate(e)},isViewingToday(){return H()==this.currentDate},isViewingPast(){let e=H();if(this.currentDate&&this.currentDate==e)return!1;let t=ce(P(e));return!(ce(P(this.currentDate))>=t)},adjustCurrentTime(){const e=N(new Date);if(this.currentDate!==e.date){this.timeStartPos=-10,this.currentTime="";return}this.currentDate=e.date,this.currentTime=e.time,this.timeStartPos=this.$refs.calendar.timeStartPos(e.time,!1),(this.endTimesSet&&this.endTimesSet.has(e.time)||this.startTimesSet&&this.startTimesSet.has(e.time))&&console.log("sameStart/END..FOUND",this.currentTime)},setGoalsPrio(){let e=this.store.fetchAllPrio();return!e.size>0&&console.log("ERROR...no Priority goals?",e),e.values()},resetGoalEvts(e=!1){if(this.scheduledEvents===this.allEvents&&console.log("resetGoalEvts SAME"),e){let t=this.deepCopy(this.storedEvents);return this.allEvents=[...t],t}return this.allEvents},getLocalEvt(e){for(let t=0;t<this.allEvents.length;t++)if(this.allEvents[t].id===e)return this.allEvents[t];return null},getScheduledEvent(e){for(let t=0;t<this.scheduledEvents.length;t++)if(this.scheduledEvents[t].id==e)return this.scheduledEvents[t];return null},addEvtToSchedule(e){this.scheduledEvents.push(e);let t=b(P(e.date),{minute:$(e.time)}),o=b(t,{minute:e.duration});this.dailyScheduled.set(e.id,{start:t,end:o,on:e.date,originalAt:e.time,for:e.duration,score:e.score}),this.endTimesSet.add(o.time),this.startTimesSet.add(t.time)},addAnEvent(e){this.addPropsEventsTo(this.currentDate,[e]),this.addEvtToSchedule(e)},addPropsEventsTo(e,t){let o=this.parentGoalsMap;return t?(t.forEach(l=>{l.date=e!=null?e:l.date;let s=o.get(l.parentGoal);s?(l.bgcolor=s.bgcolor,l.details="from: "+s.title.trim()+` (${s==null?void 0:s.priority})  (${l==null?void 0:l.duration}min)`):(console.log("no parent goal for:",l),l.bgcolor="grey",l.details="unknown")}),t):(this.doNotify("addPropsEventsTo BUT no goals to schedule..."),[])},updateCurrentSchedule(){const e=new Map;let t=new Set,o=new Set,l=new Set;return this.scheduledEvents.length<1?(this.dailyScheduled=e,this.endTimesSet=t,this.startTimesSet=l,o):(this.scheduledEvents.forEach(s=>{let i=b(P(s.date),{minute:$(s.time)}),n=b(i,{minute:s.duration});e.set(s.id,{start:i,end:n,on:s.date,originalAt:s.time,for:s.duration,score:s.score}),t.add(n.time),l.has(i.time)?o.add({at:i.time,id:s.id}):l.add(i.time)}),this.dailyScheduled=e,this.endTimesSet=t,this.startTimesSet=l,console.log("done updateCurrentSchedule",l,o,this.scheduledEvents.length,this.dailyScheduled),o)},evtStartedOrPassed(e){const t=[];let o=b(e,{minute:0}),l=this.getTimeNumber(o);return this.dailyScheduled.forEach((s,i,n)=>{let a=this.getTimeNumber(s.start),r=this.getTimeNumber(s.end);if(a!==!1&&r!==!1){let m=l>=a&&l<r,g=l>=r;(m||g)&&t.push(i),m&&(this.hasStarted[i]=!0),this.enableEvtScoreEdit(i,g)}else console.log(`ERROR?!:${i} has no start/end?.`,s)}),t},allowScoreEdit(e){this.dailyScheduled.forEach((t,o,l)=>{this.disabledScoreEvts[o]=!e})},enableEvtScoreEdit(e,t){this.disabledScoreEvts[e]=!t},canEnableEditScore(e,t){const o=N(new Date);fe(o,t)>0?this.disabledScoreEvts[e]=!0:(this.disabledScoreEvts[e]=!1,this.hasStarted[e]=!1)},enableEndNowBtn(e,t,o){const l=P(this.currentDate);W(l,t,o,!0)&&(this.hasStarted[e]=!0)},getDateEvents(e){const t=this.eventsMap[e]||[];if(t.length===1)t[0].side="full";else if(t.length===2){const o=b(P(t[0].date),{minute:$(t[0].time)}),l=b(o,{minute:t[0].duration}),s=b(P(t[1].date),{minute:$(t[1].time)}),i=b(s,{minute:t[1].duration});W(s,o,l,!0)||W(i,o,l,!0)?(t[0].side="left",t[1].side="right"):(t[0].side="full",t[1].side="full")}return t},overlapOtherEvent(e,t,o){const l=[];let s=b(t,{minute:0}),i=b(s,{minute:o}),n=this.getTimeNumber(s),a=this.getTimeNumber(i);return n===!1||a===!1?(console.log("ERROR... overlapOtherEvent targetTimestamp error",t),l):(this.dailyScheduled.forEach((r,m,g)=>{if(m!=e){let d=this.getTimeNumber(r.start),h=this.getTimeNumber(r.end);if(d!==!1&&h!==!1){let T=n>=d&&n<h||a>=d&&a<=h,S=d>=n&&a>=h;(T||S)&&(console.log(`Key:${m} overlaping added. Tween:${T}, TotalOverlap:${S}`),l.push(m))}else console.log("ERROR... overlapOtherEvent eventTimestamp error",r)}}),l)},recurChangeTime(e,t,o,l=!1){let s=this.dailyScheduled.get(e);if(s){console.log(`dragDirection...target>>${o.time}`);let i=$(o.time)-$(t.time);console.log(`dragDirection...${l}: ${i>0?"DOWN":"UP"}`);let n=null;i>0||l?n=b(o,{minute:parseInt(t.duration)+10}):n=b(o,{minute:-(parseInt(t.duration)+10)});let a=this.overlapOtherEvent(e,n,s.for);if(a.length>0){console.log("WARNING...more overlaps",a,n.time);let T=0,S=a.length,y=this.getScheduledEvent(e);do console.log("CASCADE recurChangeTime:",a[T],n.time,y.title),this.recurChangeTime(a[T],y,n,l);while(++T<S)}let[r,m]=this.changeEvtSchedule(e,n,!0);console.log("overlappedEvtNew..",r,m,e,n);let g=i>0?b(o,{minute:0}):b(o,{minute:0}),[d,h]=this.changeEvtSchedule(t.id,g,!0);console.log("recurChangeTime complete",d,h,t.id,g)}else console.log("ERROR overlapped event not found!",e)},changeEvtSchedule(e,t,o=!1){let l=this.changeEvtTime(e,t,o),s=this.updateEvtInScheduleMaps(e,t);return[l,s]},retrieveSameStart(e){let t=[];for(let[o,l]of this.dailyScheduled)l.start.time==e&&t.push(o);return t},retrieveSameEnd(e){let t=[];for(let[o,l]of this.dailyScheduled)l.end.time==e&&(console.log("retrieveSameEnd...FOUND",o,l),t.push(o));return t},updateEvtInScheduleMaps(e,t){if(this.dailyScheduled.has(e)){let o=this.dailyScheduled.get(e),l=o.for,s=o.originalAt,i=o.start,n=o.end,a=b(t,{minute:l}),r=o.score;return this.dailyScheduled.set(e,{on:t.date,originalAt:s,for:l,start:t,end:a,score:r}),this.endTimesSet.delete(n.time)?this.endTimesSet.add(a.time):console.log("updateEvtInScheduleMaps-endTimesSet NOT FOUND?!?"),this.startTimesSet.delete(i.time)?this.startTimesSet.add(t.time):console.log("updateEvtInScheduleMaps-startTimesSet NOT FOUND?!?"),this.currentDate==H()&&(this.canEnableEditScore(e,a),this.enableEndNowBtn(e,t,a)),!0}else return console.log("updateEvtInScheduleMaps--euh not found?ERROR?",e,t),!1},changeEvtTime(e,t,o=!1){console.log("changeEventTime",e,t.time,this.scheduledEvents.length);let l=this.getScheduledEvent(e);if(l){if(l.canMove){if(!o){let s=l.time,i=`"${l.title}" default at ${s}. Make ${t.time} it's default time?`;this.$q.dialog({title:"Time change...",cancel:"No",message:i}).onOk(()=>{this.store.saveSubProp(e,t.time,null)}).onCancel(()=>{console.log("Nope cool, coolios")})}l.time=t.time}else{let s=`"${l.title}" does Not move from default: ${l.time} ! 
 Temp set to ${t.time} ?`;this.confirmAction(s,function(){l.time=t.time,console.log("Moved to",l.time)},function(){console.log(`Keeping ${l.time}`)})}return!0}return console.log("ERROR not found?",l,e,t),!1},confirmAction(e,t,o){this.$q.dialog({title:"Warning",cancel:!0,message:e}).onOk(()=>{t()}).onCancel(()=>{o()})},doRemove(e){let t=this.scheduledEvents.length;for(var o=0;o<t;o++)if(this.scheduledEvents[o].id===e.id){this.scheduledEvents.splice(o,1);let l=null;if(this.dailyScheduled.has(e.id)?(l=this.dailyScheduled.get(e.id),this.dailyScheduled.delete(e.id)):console.log("ERROR doRemove, dailyScheduled has no such item?@? ",e),l){let s=this.startTimesSet.delete(l.start.time),i=this.endTimesSet.delete(l.end.time);(!s||!i)&&console.log("ERROR doRemove scheduleSets has no such item?@? ",l,e)}break}else console.log("ERROR doRemove, NO item to delete?@? ",e);return this.updateCurrentSchedule()},reset(){this.draggedItem=null,this.targetDrop=null,this.toAddE=null,this.chosenScore=null,this.chosenPrio=null,this.possibleRange=null},doNotify(e,t=void 0,o="top"){this.$q.notify({color:t!==void 0?t:"negative",position:o,message:e,icon:t==null?"report_problem":"thumb_up"})},updateButtons(e=null,t=null,o=null){this.loadDefault=e!=null?e:this.loadDefault,this.scoreSchedule=t!=null?t:this.scoreSchedule,this.showPrio=o!=null?o:this.showPrio},resetButtons(e,t){this.updateButtons(!e,!t,!t)},reloadEvtsTo(e,t){let o=this.allEvents,l=[];return o.forEach(s=>{let i=t[s.id];i&&(s.date=e,s.time=i.time,s.duration=i.duration,l.push(s))}),l},scheduleSavedEvents(e){let t=this.getEventsForDate(e);if(!t){console.log(`ERROR no evts found for ${e}...`,t);return}console.log(`evts for ${e}`,t,this.scheduledEvents,this.dailyScheduled,this.startTimesSet);let o=this.reloadEvtsTo(e,t);return this.scheduledEvents=this.addPropsEventsTo(null,o),this.updateCurrentSchedule()},fixConflicts(e){console.log("fixConflicts...Start",e);const t=l=>{let s=0,i=null;for(let n of l){let a=this.getScheduledEvent(n);if(a){let r=this.parentGoalsMap.get(a.parentGoal);r?r.priority>s&&(s=r.priority,i=a):console.log("findhigherPrio..ERROR no PARENT found?",a)}else console.log("findhigherPrio..ERROR not found?",n)}return console.log("findhigherPrio..Highest priority be",i,s),i},o=l=>({label:l.title+" at "+l.score,value:l.id});for(let l of e){let s=null,i=this.retrieveSameStart(l.at);console.log("fixConflicts...results",i,l);let n=[],a="";for(let r of i){let m=this.getScheduledEvent(r);m?(n.push(m),a+=m.title+","):console.log("fixConflicts...ERROR not found?",r)}this.$q.dialog({title:"Alert",cancel:!1,persistent:!0,message:`${a} are conflicting.
 Choose how to solve this...`,options:{type:"radio",model:"opt1",items:[{label:"Resolve by Highest Priority",value:"opt1",color:"secondary"},{label:"Resolve by lowest Score",value:"opt2"},{label:"Pick event",value:"opt3"}]}}).onOk(r=>{if(r=="opt3"){this.$q.dialog({title:"Alert",cancel:!1,persistent:!0,message:"Choose the event to schedule",options:{type:"radio",model:"",items:n.map(o)}}).onOk(g=>{console.log("Chosen Manually",g);let d=this.getScheduledEvent(g);d?s=d:console.log("ERROR...Manually choice not find",g)}).onCancel(()=>{console.log("Cancelled loading..HUH?!?")}).onDismiss(()=>{console.log("oooh dismissed inner...",s),this.pickConflictReso(s,n)});let m=this.updateCurrentSchedule();console.log("fixConflicts inner...after conflicts?",m),this.updateButtons(!0,null,null)}else if(r=="opt2"){console.log(">>>> OK, Option Score",r);let m=0,g=null;for(let d of n){let h=this.parseScore(d.score);h>-1&&h>=m?(m=h,g=d):console.log("ERROR...parseScore?",h,d)}g&&(console.log("Option Score Chosen",g),s=g)}else s=t(i),console.log(">>>> OK, Higher prio",r,s);console.log("Pick be",s)}).onCancel(()=>{console.log("Cancelled loading...HUH?!?")}).onDismiss(()=>{if(console.log("Dismissing...",s),s){this.pickConflictReso(s,n);let r=this.updateCurrentSchedule();console.log("fixConflicts outer...after conflicts?",r),this.updateButtons(!0,null,null),this.disableSaveSchedule=!1}})}return!0},parseScore(e){const t=e.split(/on/);return t.length!=2?(console.log(`parseScore error?${e}`,t),-1):t[1]-t[0]},pickConflictReso(e,t){for(let o of t)o.id==e.id?console.log("Skipping choice!",o):(console.log("Removing conflict event!",o),this.doRemove(o))},showChoiceDialog(e,t,o=null,l=null){this.$q.dialog({title:e,cancel:!!l,persistent:!0,options:{type:"radio",model:"",items:t}}).onOk(s=>{o&&(s==""?this.showChoiceDialog(e,t,o,l):o(s))}).onCancel(()=>{l&&l()}).onDismiss(()=>{console.log("showChoiceDialog dismissed")})},handleOverlaps(e){const t=i=>{if(i!=null&&i.parentGoal){let n=this.parentGoalsMap.get(i.parentGoal);return n==null?void 0:n.priority}return console.log("findhigherPrio..ERROR no PARENT found?",i),null},o=i=>i.title.trim()+" Priority = "+t(i)+" && Score:: "+i.score,l=(i,n)=>{this.doRemove(i),this.addAnEvent(n)},s=(i,n,a=null,r=null)=>{this.$q.dialog({title:i,cancel:!!r,persistent:!0,options:{type:"radio",model:"",items:n}}).onOk(m=>{a&&(m==""?(console.log("choiceDialog EMPTY?!?..redoin"),s(i,n,a,r)):a(m))}).onCancel(()=>{r&&r()}).onDismiss(()=>{})};for(let i in e){let n=this.getScheduledEvent(i),a=e[i],r=null;if(a)r=this.getLocalEvt(a.id);else{console.log("handleOverlaps...ERROR not found",i,e);return}this.$q.dialog({title:"Overlap Warning",cancel:!0,persistent:!0,message:`Event: '${r.title.trim()}' Overlaps with Scheduled '${n.title.trim()}'

                Resolve or Cancel to keep '${n.title.trim()}'`,options:{type:"radio",model:"opt1",items:[{label:"Resolve by Priority",value:"opt1",color:"secondary"},{label:"Resolve by Score",value:"opt2"},{label:"Pick event",value:"opt3"}]}}).onOk(m=>{if(m=="opt3"){let g="Choose one event to keep...",d=[{label:o(r),value:r.id},{label:o(n),value:n.id}];s(g,d,function(h){h==r.id?l(n,r):console.log("OK OPT3, chose scheduled",h)},function(){console.log("CANCEL OPT3")})}else if(m=="opt2"){let g="Pick event by Score",d=[{label:`"${r.title.trim()}" with Score:: ${r.score} >> ${this.parseScore(r.score)}`,value:r.id},{label:`"${n.title.trim()}" with Score:: ${n.score} >> ${this.parseScore(n.score)}`,value:n.id}];s(g,d,function(h){h==r.id?l(n,r):console.log("OK OPT2, chose scheduled",h)},function(){console.log("CANCEL OPT2")})}else{let g="Pick event by Priority",d=[{label:`"${r.title.trim()}" with Priority = ${t(r)}`,value:r.id},{label:`"${n.title.trim()}" with Priority = ${t(n)}`,value:n.id}];s(g,d,function(h){h==r.id?l(n,r):console.log("OK OPT1, chose scheduled",h)},function(){console.log("CANCEL OPT1")})}}).onCancel(()=>{console.log("Nope coolios, keeping scheduled...",this.scheduledEvents)}).onDismiss(()=>{})}},loadWithOverlapCheck(e){let t=this.getEventsForDate(e);if(!t){console.log(`ERROR no evts found for today:${e} ?!?`,t);return}console.log(`evts loadWithOverlapCheck ${e}`,t);let o=this.reloadEvtsTo(e,t);const l={};for(let s=0;s<o.length;s++){let i=o[s],n=b(P(i.date),{minute:$(i.time)}),a=this.overlapOtherEvent(i.id,n,i.duration);if(a.length>0){let r=0;do l[a[r]]=i,r>0&&console.log("WOAH WOAH, multiple overlaps with same obj!",r);while(++r<a.length)}else this.addPropsEventsTo(e,[i]),this.addEvtToSchedule(i)}return Object.keys(l).length>0?this.doNotify(`${e} with Some overlaps to fix!`,"warning","bottom"):this.doNotify(`Loaded schedule for ${e}`,"positive","bottom"),l},loadForDate(e,t,o){let l=()=>{let s=this.scheduleSavedEvents(e);s.size>0&&!o?(console.log("loadForDate..REVIEW overlaps!!",s,e,o),this.fixConflicts(s)):(this.showReloadBtn=!1,this.disableSaveSchedule=!0,this.doNotify(`Loaded schedule for ${e}`,"positive","bottom"))};if(t)if(this.isViewingToday()){let s=this.loadWithOverlapCheck(e);s.size>0&&(console.log("handle overlaps >>",s),this.handleOverlaps(s),this.showReloadBtn=!0,this.disableSaveSchedule=!1);let i=this.evtStartedOrPassed(N(new Date));console.log("loadForDate:enabledScoreEdit",i)}else l(),this.allowScoreEdit(o);else this.scheduledEvents=[],this.updateCurrentSchedule(),this.showReloadBtn=!1,this.disableSaveSchedule=!0;(o||e!==H())&&this.adjustCurrentTime(),this.reset(),this.resetButtons(t,o)},loadDefaultEvts(){this.scheduledEvents=[];let e=this.deepCopy(this.store.fetchDefaults());console.log("doLoadDefault:",this.currentDate,e),this.scheduledEvents=this.addPropsEventsTo(this.currentDate,e);let t=this.isViewingPast(),o=this.updateCurrentSchedule();if(t)console.log("doLoadDefault > enabling scoreEdit in past",this.currentDate,o),this.allowScoreEdit(!0);else if(o.size>0&&(console.log("doLoadDefault:..REVIEW overlaps!!",o,this.currentDate),this.fixConflicts(o)),this.isViewingToday()){let s=this.evtStartedOrPassed(N(new Date));console.log("doLoadDefault:enabledScoreEdit",s)}else console.log("doLoadDefault > disabling scoreEdit in future",this.currentDate,o),this.allowScoreEdit(!1);this.showReloadBtn=this.hasEventsForDate,this.resetButtons(!0,t),this.disableSaveSchedule=!1,this.reset()},deepCopy(e){if(e===null||typeof e!="object")return e;if(Array.isArray(e))return e.map(o=>this.deepCopy(o));const t={};for(let o in e)e.hasOwnProperty(o)&&(t[o]=this.deepCopy(e[o]));return t},onRefresh(e){setTimeout(()=>{this.loadForDate(this.currentDate,this.hasEventsForDate,this.isViewingPast()),console.log("Refreshing...",this.currentDate),e()},1e3)},doSaveSchedule(){console.log(`doSaveSchedule for ${this.currentDate}`,this.dailyScheduled);let e={};this.dailyScheduled.size<1?e=null:this.dailyScheduled.forEach((t,o,l)=>{e[o]={duration:t.for,time:t.start.time}}),this.store.saveDailySchedule(this.currentDate,e),this.disableSaveSchedule=!0,this.doNotify(`doSaveSchedule for ${this.currentDate}`,"positive","top")},onAddNewEvent(e,t,o){console.log("Adding Event eh...",e,t,o,this.possibleRange),this.possibleRange||(this.possibleRange=this.startEndTimes);let l=Y(this.possibleRange[0]),s=b(Y(this.possibleRange[1]),{minute:15}),i=Math.floor(fe(l,s)/1e3/60),n=null;if(o=="self"){let a=this.store.addMainGoal(e,"","orange",2);a?(console.log("wooh parent created",a),n=this.store.addSubGoal(a,e,"1on5",l.time,i,!1)):console.log("ERROR? no pID",a)}else if(t)n=this.store.addSubGoal(t.id,e,"1on5",l.time,i,!1);else{let a=this.store.getGoalByTitle("Misc");if(a)console.log("Woo found Misc pgoal",a),n=this.store.addSubGoal(a.id,e,"1on5",l.time,i,!1);else{console.log("ERROR? no Misc pgoal",this.storedMainG);let r=this.store.addMainGoal("Misc","","purple",2);n=this.store.addSubGoal(r,e,"1on5",l.time,i,!1)}}n?(this.addAnEvent({id:n,time:l.time,score:"1on5",duration:i,canMove:!!t}),this.disableSaveSchedule=!1):(console.log("BOO ERROR no subID:(",n),this.doNotify("Error adding this event :(","negative")),this.addEventDialog=!1,this.reset()},onChooseEvent(){this.addEventDialog=!1,this.pickEventDialog=!0},onPickEvent(){console.log("I be picking",this.toAddE,this.targetDrop,this.currentDate,this.isViewingPast()),this.pickEventDialog=!1,this.draggedItem=this.toAddE;let e=this.getScheduledEvent(this.toAddE.id),t=!1;e||(console.log("onPickEvent...NEW",e,this.toAddE),e=this.toAddE,t=!0,this.addAnEvent(this.toAddE));let o=this.overlapOtherEvent(e.id,this.targetDrop.timestamp,e.duration);console.log("AddEvent anyOverlap",o);let l=o.length;if(l>0){let s=0;do this.recurChangeTime(o[s],e,this.targetDrop.timestamp,!0);while(++s<l)}else if(this.dailyScheduled.has(e.id)){let[s,i]=this.changeEvtSchedule(e.id,this.targetDrop.timestamp,!t);console.log("AddEvent complete",s,i,e.id,t)}else console.log("ERROR ERROR NEW event with current events as:",this.scheduledEvents);this.disableSaveSchedule=!1,this.reset()},onEndNow(e){const t=N(new Date);if(console.log("oooh doEndNow!!!",e,t.time),this.dailyScheduled.has(e)){let o=this.dailyScheduled.get(e),l=o.start,s=o.end;if(W(t,l,s,!0)){let i=this.getTimeNumber(s)-this.getTimeNumber(l),n=this.getTimeNumber(t)-this.getTimeNumber(l);console.log("end data be:",s,l,o),console.log("Great, REDUCING duration to:",i,n);for(let a=0;a<this.scheduledEvents.length;a++){let r=this.scheduledEvents[a];r.id===e&&(r.duration=n)}this.dailyScheduled.set(e,{...o,for:n,end:t}),this.endTimesSet.delete(s.time)||console.log("ERROR endTimesSet item does not exist?!?",o,this.endTimesSet),this.endTimesSet.add(t.time)}else console.log("umm aint in the middle of this event! Nothing to do...",t.time,l.time,s.time)}else{console.log("ERROR doEndNow not found!!!",e);return}this.disabledScoreEvts[e]=!1},onSaveScore(e,t){let o=this.dailyScheduled.get(t);if(o){o.score=e,this.store.saveSubProp(t,null,e);let s=(i=>this.scheduledEvents.find(n=>n.id==i))(t);s?s.score=e:console.log("onSaveScore ERROR not found",s,t)}else console.log(`ERROR onSaveScore could not find event ${t}?!?`)},onReloadSaved(e=null){let t=this.hasEventsForDate;console.log("doReloadSaved:",this.currentDate,e,t);let o=()=>{console.log("Aborting",this.currentDate,this.scheduledEvents),this.showReloadBtn=!this.isViewingPast()||t},l=()=>{this.scheduledEvents=[],this.updateCurrentSchedule(),this.loadForDate(this.currentDate,t,this.isViewingPast())};this.scheduledEvents.length>0?this.confirmAction("Overwrite current Evts?",l,o):l(),this.showReloadBtn=!1},onLoadDefault(){let e=()=>{console.log("Aborting",this.currentDate,this.scheduledEvents)},t=()=>{this.scheduledEvents=[],this.updateCurrentSchedule(),this.loadDefaultEvts()};this.scheduledEvents.length>0?this.confirmAction("Overwrite current Evts?",t,e):this.loadDefaultEvts()},choosePrio(e){console.log("choosePrio",e,this.chosenPrio);let t=this.chosenPrio;t&&t==e?this.disablePrioBtn=!0:(this.chosenPrio=e,this.disablePrioBtn=!1)},onReloadWithPrio(){if(this.chosenPrio==null){this.doNotify("Ayo select a priority!");return}const e=()=>this.scheduledEvents.filter(l=>{var s;return((s=this.parentGoalsMap.get(l.parentGoal))==null?void 0:s.priority)==this.chosenPrio}),t=l=>{let s=[];if(l=="overwrite"){let n=this.deepCopy(this.storedEvents);console.log("findSamePrio..overwriting!!",this.chosenPrio,l);for(let a of n){let r=this.parentGoalsMap.get(a.parentGoal);(r==null?void 0:r.priority)==this.chosenPrio&&s.push(a)}}else s=e(),console.log("findSamePrio..filtering!!",this.chosenPrio,s);this.scheduledEvents=this.addPropsEventsTo(this.currentDate,s);let i=this.updateCurrentSchedule();if(!this.scheduledEvents.length>0){this.doNotify(`Empty for Priority =${this.chosenPrio} :(`,"warning","bottom"),this.disableSaveSchedule=!0;return}if(i.size>0&&(console.log("onReloadWithPrio..REVIEW overlaps!!",i,this.currentDate),this.fixConflicts(i)),this.isViewingToday()){let n=this.evtStartedOrPassed(N(new Date));console.log("onReloadWithPrio:enabledScoreEdit",n)}else this.allowScoreEdit(!1);this.disableSaveSchedule=!1};let o=()=>{console.log("onReloadWithPrio..cancelling",this.scheduledEvents)};if(this.scheduledEvents.length>0){let l=[{label:`Filter current by priority = ${this.chosenPrio}`,value:"filter"},{label:`Overwrite and schedule by priority = ${this.chosenPrio}`,value:"overwrite"}];this.showChoiceDialog("Choose Resolution...",l,function(s){console.log("OK ReloadWithPrio",s),t(s)},o)}else t("overwrite");this.resetButtons(this.hasEventsForDate,this.isViewingPast()),this.disablePrioBtn=!0},chooseScore(e){let t=this.chosenScore;t&&t==e?this.disableScoreBtn=!0:(this.chosenScore=e,this.disableScoreBtn=!1)},onReloadWithScore(){if(this.chosenScore==null){this.doNotify("Ayo select a score!");return}const e=()=>{let l=[];return this.scheduledEvents.forEach(s=>{let i=this.parseScore(s.score);i>-1&&i>=this.chosenScore&&l.push(s)}),l},t=l=>{let s=[];l=="overwrite"?s=this.store.fetchGoalsWithMinScore(this.chosenScore):(console.log("filtering by score:",this.chosenScore,l),s=e()),console.log("onReloadWithScore",this.currentDate,this.chosenScore,s),this.scheduledEvents=this.addPropsEventsTo(this.currentDate,s);let i=this.updateCurrentSchedule();if(!this.scheduledEvents.length>0){this.doNotify(`Empty for Score >=${this.chosenScore} :(`,"warning","bottom"),this.disableSaveSchedule=!0;return}if(i.size>0&&(console.log("onReloadWithScore..REVIEW overlaps!!",i,this.chosenScore),this.fixConflicts(i)),this.isViewingToday()){let n=this.evtStartedOrPassed(N(new Date));console.log("onReloadWithScore:enabledScoreEdit",n)}else this.allowScoreEdit(!1);this.disableSaveSchedule=!1,this.showReloadBtn=this.hasEventsForDate};let o=()=>{console.log("onReloadWithScore..cancelling",this.scheduledEvents)};if(this.scheduledEvents.length>0){let l=[{label:`Filter current by Interval Score > ${this.chosenScore}`,value:"filter"},{label:`Overwrite and schedule by Interval Score > ${this.chosenScore}`,value:"overwrite"}];this.showChoiceDialog("Choose Resolution...",l,function(s){t(s)},o)}else t("overwrite");this.resetButtons(this.hasEventsForDate,this.isViewingPast()),this.disableScoreBtn=!0},onChange(e){let t=this.hasEventsForDate,o=e.start;this.loadForDate(o,t,this.isViewingPast())},onDragStart(e,t){if(console.log("onDragStart",e,t,this.currentDate),this.isViewingPast()){this.doNotify("Editing past is no no!"),e.preventDefault();return}this.draggedItem=t},onDragEnter(e,t,o){return t==="goal-item"?(console.log("onDragEnter..goal-item",e,o),e.preventDefault()):(this.targetDrop=o,e.preventDefault()),!0},onDragOver(e,t,o){return e.preventDefault(),!0},onDragLeave(e,t,o){return!1},onDragEnd(e){console.log("onDragEnd",this.endTimesSet,this.startTimesSet)},onDrop(e,t,o){console.log("onDrop",e,t,o);let l=this.getScheduledEvent(this.draggedItem.id);if(!l){console.log("onDrop ERROR",l,this.draggedItem);return}let s=null;if(t==="interval")console.log("onDrop...normal move with scope",o.timestamp),s=o.timestamp;else if(t==="goal-item"&&this.targetDrop)console.log("Dropping goal-item!!",e,t,this.targetDrop.timestamp),s=this.targetDrop.timestamp;else{console.log("Cannot drop here YO!!",e,t,o,this.targetDrop);return}if(!s){console.log("ERROR...no timestamp YO!!",e,t,o,this.targetDrop);return}let i=this.overlapOtherEvent(l.id,s,l.duration),n=i.length;if(n>0){console.log("WOAH WOAH onDrop...overlapp!",i);let a=0;do this.recurChangeTime(i[a],l,s);while(++a<n)}else{let[a,r]=this.changeEvtSchedule(l.id,s,!1);console.log("onDrop no overlap complete",a,r,l.id)}this.disableSaveSchedule=!1},onDblClickEvent(e,t){if(this.isViewingPast()){this.doNotify("Removing from the past is a no no!"),e.preventDefault();return}this.$q.dialog({title:"Alert",cancel:!0,message:`Sure to remove evt: ${t.title} from today?`}).onOk(()=>{this.doRemove(t),this.disableSaveSchedule=!1,this.showReloadBtn=!0}).onCancel(()=>{console.log("Cancelled remove")})},onClickDate(e){console.log("onClickDate",e)},onClickTime(e){console.log("onClickTime..event",e),this.isViewingPast(),this.addEventDialog=!0,this.targetDrop=e.scope},onClickInterval(e){console.log("onClickInterval",e)},onClickHeadIntervals(e){console.log("onClickHeadIntervals",e)},onClickHeadDay(e){console.log("onClickHeadDay",e)},onMouseEnter(e){console.log("onMouseAt",e)},onMouseLeave(e){console.log("onMouseLeave",JSON.stringify(e))},onMouseDownTime({scope:e,event:t}){if(console.log("onMouseDownTime",{scope:e,event:t}),pe(t)){if(console.log("onMouseDownTime and its a leftClick event"),this.mobile===!0&&this.anchorTimestamp!==null&&this.otherTimestamp!==null&&V(this.anchorTimestamp)===V(this.otherTimestamp)){this.otherTimestamp=e.timestamp,this.mouseDown=!1;return}this.mouseDown=!0,this.anchorTimestamp=e.timestamp,this.otherTimestamp=e.timestamp}},onMouseUpTime({scope:e,event:t}){if(console.log("onMouseUpTime",{scope:e,event:t}),this.mobile!==!0&&pe(t)&&(this.otherTimestamp=e.timestamp,this.mouseDown=!1),!this.mousedown){let o=this.startEndTimes;if(o[1]==o[0])return;this.possibleRange=o,console.log("onMouseUpTime range change",this.possibleRange)}},onMouseMoveTime({scope:e,event:t}){this.mobile!==!0&&this.mouseDown===!0&&(this.otherTimestamp=e.timestamp)},scrollToEvent(e){this.$refs.calendar.scrollToTime(e.time,350)},onToday(){let e=()=>{this.$refs.calendar.moveToToday()};this.disableSaveSchedule?e():this.confirmAction("Save schedule changes?",this.doSaveSchedule,e)},onPrev(){console.log("onPrev",this.currentDate);let e=()=>{this.$refs.calendar.prev()};this.disableSaveSchedule?e():this.confirmAction("Save schedule changes?",this.doSaveSchedule,e)},onNext(){let e=()=>{this.$refs.calendar.next()};this.disableSaveSchedule?e():this.confirmAction("Save schedule changes?",this.doSaveSchedule,e)}}}),ee=e=>(we("data-v-050adfd4"),e=e(),De(),e),St={key:0,class:"q-gutter-md"},Et={key:1,class:"subcontent"},bt={class:"float-right"},yt={key:0},wt={key:1},Dt={key:2},Tt={key:3},Ct={class:"row justify-center"},Rt={style:{display:"flex","max-width":"800px",width:"100%",height:"400px"}},kt={style:{display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"2px"}},Pt={class:"title q-calendar__ellipsis"},Ot=["onDblclick","onDragstart"],Nt=ee(()=>w("div",{class:"text-h6"},"Ad hoc or Existing event",-1)),$t={class:"q-ml-md event-select"},Mt=ee(()=>w("div",{class:"text-h3"},"Pick event",-1)),Bt={class:"q-ml-md event-select"},Vt={class:"row justify-center"},At=ee(()=>w("br",null,null,-1)),qt={class:"scroll overflow-auto",style:{height:"360px",width:"100%"}};function Gt(e,t,o,l,s,i){const n=_("add-goal-form"),a=_("navigation-bar"),r=_("goaly-end"),m=_("q-calendar-day"),g=_("ad-hoc-event");return p(),E(R,null,[e.showForm?(p(),E("div",St,[u(D,{class:"q-pl-xl justify-center",color:"","text-color":"green",elevated:"",label:"HideForm",onClick:t[0]||(t[0]=d=>e.showGoalForm=!e.showGoalForm),"no-caps":""}),u(n)])):k("",!0),e.showForm?k("",!0):(p(),E("div",Et,[u(We,{onRefresh:e.onRefresh},{default:v(()=>[u(a,{onToday:e.onToday,onPrev:e.onPrev,onNext:e.onNext},null,8,["onToday","onPrev","onNext"]),w("div",bt,[e.showReloadBtn?(p(),E("div",yt,[u(D,{class:"q-mt-xl",color:"","text-color":"green",elevated:"",label:"Load Saved",onClick:e.onReloadSaved,"no-caps":""},null,8,["onClick"])])):k("",!0),e.loadDefault?(p(),E("div",wt,[u(D,{class:"q-mt-xl",color:"","text-color":"blue",elevated:"",label:"Defaults",onClick:e.onLoadDefault,"no-caps":""},null,8,["onClick"])])):k("",!0),e.scoreSchedule?(p(),E("div",Dt,[u(me,{split:"",color:"",class:"q-mt-xl","text-color":"teal",elevated:"","disable-main-btn":e.disableScoreBtn,label:e.chosenScoreLabel,onClick:e.onReloadWithScore,"no-caps":""},{default:v(()=>[u(ae,null,{default:v(()=>[(p(!0),E(R,null,I(e.scoreOptions,d=>se((p(),B(ue,{key:d.id,clickable:"",onClick:h=>e.chooseScore(d)},{default:v(()=>[u(re,null,{default:v(()=>[u(de,null,{default:v(()=>[M(O(d),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[ve]])),128))]),_:1})]),_:1},8,["disable-main-btn","label","onClick"])])):k("",!0),e.showPrio?(p(),E("div",Tt,[u(me,{split:"",color:"",class:"q-mt-xl","text-color":"teal",elevated:"","disable-main-btn":e.disablePrioBtn,label:e.chosenPrioLabel,onClick:e.onReloadWithPrio,"no-caps":""},{default:v(()=>[u(ae,null,{default:v(()=>[(p(!0),E(R,null,I(e.setGoalsPrio(),d=>se((p(),B(ue,{key:d,clickable:"",onClick:h=>e.choosePrio(d)},{default:v(()=>[u(re,null,{default:v(()=>[u(de,null,{default:v(()=>[M(O(d),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[ve]])),128))]),_:1})]),_:1},8,["disable-main-btn","label","onClick"])])):k("",!0)])]),_:1},8,["onRefresh"]),w("div",Ct,[w("div",Rt,[u(m,{ref:"calendar",view:"day",modelValue:e.currentDate,"onUpdate:modelValue":t[5]||(t[5]=d=>e.currentDate=d),"drag-enter-func":e.onDragEnter,"drag-over-func":e.onDragOver,"drag-leave-func":e.onDragLeave,"drop-func":e.onDrop,animated:"",bordered:"",hoverable:"","no-active-date":"","transition-next":"slide-left","transition-prev":"slide-right","time-clicks-clamped":"","interval-minutes":15,"interval-count":96,"interval-height":28,"selected-start-end-dates":e.startEndTimes,onChange:e.onChange,onClickDate:e.onClickDate,onClickTime:e.onClickTime,onClickInterval:e.onClickInterval,onClickHeadIntervals:e.onClickHeadIntervals,onClickHeadDay:e.onClickHeadDay,onMousedownTime:e.onMouseDownTime,onMouseupTime:e.onMouseUpTime,onMousemoveTime:e.onMouseMoveTime},{"head-day-event":v(({scope:{timestamp:d}})=>[w("div",kt,[(p(!0),E(R,null,I(e.eventsMap[d.date],h=>(p(),E(R,{key:h.id},[h.time?(p(),B(he,{key:1,class:K(e.badgeClasses(h,"header")),style:A([e.badgeStyles(h,"header"),{margin:"1px",width:"10px","max-width":"10px",height:"10px","max-height":"10px",cursor:"pointer"}]),onClick:T=>e.scrollToEvent(h)},{default:v(()=>[u(X,null,{default:v(()=>[M(O(h.time+" - "+h.title),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"])):(p(),B(he,{key:0,class:K(e.badgeClasses(h,"header")),style:A([e.badgeStyles(h,"header"),{width:"100%",cursor:"pointer",height:"12px","font-size":"10px",margin:"1px"}])},{default:v(()=>[w("div",Pt,[M(O(h.title)+" ",1),u(X,null,{default:v(()=>[M(O(h.details),1)]),_:2},1024)])]),_:2},1032,["class","style"]))],64))),128))])]),"day-container":v(({scope:{days:d}})=>[e.hasDate(d)?(p(),E(R,{key:0},[w("div",{class:"day-view-current-time-indicator",style:A(e.style)},null,4),w("div",{class:"day-view-current-time-line",style:A(e.style)},null,4)],64)):k("",!0)]),"day-body":v(({scope:{timestamp:d,timeStartPos:h,timeDurationHeight:T}})=>[(p(!0),E(R,null,I(e.getDateEvents(d.date),S=>(p(),E(R,{key:S.id},[S.time!==void 0?(p(),E("div",{key:0,class:K(["my-event",e.badgeClasses(S,"body")]),style:A(e.badgeStyles(S,"body",h,T)),draggable:!0,onDblclick:j(y=>e.onDblClickEvent(y,S),["prevent"]),onDragstart:j(y=>e.onDragStart(y,S),["stop"]),onDragend:t[1]||(t[1]=j((...y)=>e.onDragEnd&&e.onDragEnd(...y),["stop"])),onDrop:t[2]||(t[2]=y=>e.onDrop(y,"goal-item",e.scope)),onDragenter:t[3]||(t[3]=y=>e.onDragEnter(y,"goal-item",e.scope)),onDragover:t[4]||(t[4]=y=>e.onDragOver(y,"goal-item",e.scope))},[u(r,{disabledScore:e.disabledScoreEvts[S.id],title:S.title,id:S.id,startTime:S.time,score:S.score,details:S.details,happeningNow:e.hasStarted[S.id]?e.hasStarted[S.id]:!1,onEndNow:e.onEndNow,onSaveScore:e.onSaveScore},null,8,["disabledScore","title","id","startTime","score","details","happeningNow","onEndNow","onSaveScore"])],46,Ot)):k("",!0)],64))),128))]),_:1},8,["modelValue","drag-enter-func","drag-over-func","drag-leave-func","drop-func","selected-start-end-dates","onChange","onClickDate","onClickTime","onClickInterval","onClickHeadIntervals","onClickHeadDay","onMousedownTime","onMouseupTime","onMousemoveTime"])]),u(le,{modelValue:e.addEventDialog,"onUpdate:modelValue":t[8]||(t[8]=d=>e.addEventDialog=d),"transition-show":"rotate","transition-hide":"rotate"},{default:v(()=>[e.adHocEventDialog?(p(),B(x,{key:0},{default:v(()=>[u(ie,null,{default:v(()=>[Nt]),_:1}),u(ne,{align:"center"},{default:v(()=>[u(D,{flat:"",label:"Add hoc",color:"primary",onClick:t[6]||(t[6]=d=>e.adHocEventDialog=!e.adHocEventDialog)}),u(D,{flat:"",label:"Existing",color:"primary",onClick:e.onChooseEvent},null,8,["onClick"])]),_:1})]),_:1})):(p(),B(x,{key:1},{default:v(()=>[w("div",$t,[u(g,{mainGoals:e.storedMainG,onSaveEvent:e.onAddNewEvent},null,8,["mainGoals","onSaveEvent"]),u(D,{flat:"",label:"Cancel",color:"primary",onClick:t[7]||(t[7]=d=>e.adHocEventDialog=!e.adHocEventDialog)})])]),_:1}))]),_:1},8,["modelValue"]),u(le,{modelValue:e.pickEventDialog,"onUpdate:modelValue":t[10]||(t[10]=d=>e.pickEventDialog=d),"transition-show":"rotate","transition-hide":"rotate"},{default:v(()=>[u(x,null,{default:v(()=>[u(ie,null,{default:v(()=>[Mt]),_:1}),u(Fe),w("div",Bt,[u(Ce,{modelValue:e.toAddE,"onUpdate:modelValue":t[9]||(t[9]=d=>e.toAddE=d),options:e.canbeScheduled,"option-value":"id","option-label":"title",label:"Sub Goal","item-aligned":""},null,8,["modelValue","options"])]),u(ne,{align:"right"},{default:v(()=>[u(D,{flat:"",label:"Add",color:"primary",onClick:e.onPickEvent},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),w("div",Vt,[u(D,{class:"q-mt-xl",color:"Green","text-color":"blue",elevated:"",label:"SaveSchedule",disable:e.doDisableSaveSchedule,onClick:e.doSaveSchedule,"no-caps":""},null,8,["disable","onClick"]),u(D,{class:"q-mt-xl",color:"","text-color":"green",elevated:"",label:"ShowForm",onClick:t[11]||(t[11]=d=>e.showGoalForm=!e.showGoalForm),"no-caps":""})]),At,w("div",qt,[(p(!0),E(R,null,I(e.storedEvents,(d,h)=>(p(),E("div",{key:h,class:"col-12",style:{"font-size":"10px","line-height":"10px","max-height":"14px","min-height":"14px",padding:"2px 2px","white-space":"nowrap"}},O(d),1))),128))])]))],64)}var zt=Z(pt,[["render",Gt],["__scopeId","data-v-050adfd4"]]);export{zt as default};
