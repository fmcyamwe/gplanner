import{ab as k,r as q,c as d}from"./index.8b819cea.js";import{u as B}from"./use-quasar.2197fd2b.js";const K=k("allGoals",()=>{const b=q([{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}]),h=[{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}],i=B(),G=d(()=>h),m=d(()=>{let e=JSON.parse(i.localStorage.getItem("mainGoals"));return S(e)}),p=d(()=>{let e=JSON.parse(i.localStorage.getItem("subGoals"));return S(e)}),v=d(()=>JSON.parse(i.localStorage.getItem("AllDates")));function S(e){return e?[...e]:[]}function y(e,l,t,o){let s=this.getMainGoals;if(!s){console.log("umm no mainGoals...adding"),i.localStorage.set("mainGoals",JSON.stringify([{id:0,title:e,details:l,priority:o,bgcolor:t,icon:"fas fa-utensils"}]));return}let n=s.length+1;for(;s.some(f=>f.id===n);)n=Math.floor(Math.random()*1e3);return s.unshift({id:n,title:e,details:l,priority:o,bgcolor:t,icon:"fas fa-utensils"}),i.localStorage.set("mainGoals",JSON.stringify(s)),n}function D(e,l,t,o,s,n,f){console.log(e+" "+l+" "+t+" "+o+" "+s+" "+n+" "+f);let r=this.getSubGoals;if(!r){i.localStorage.set("subGoals",JSON.stringify([{id:0,parentGoal:e,title:l,score:t,time:o,duration:s,canMove:n,inDefaults:f}]));return}let a=r.length+1;for(;r.some(u=>u.id===a);)a=Math.floor(Math.random()*1e3);return r.unshift({id:a,parentGoal:e,title:l,score:t,time:o,duration:s,canMove:n,inDefaults:f}),i.localStorage.set("subGoals",JSON.stringify(r)),a}function O(e,l,t,o,s,n,f){let r=this.getSubGoals;for(var a=0;a<r.length;a++)if(r[a].id===e){r[a].title=l,r[a].score=t,r[a].time=o,r[a].duration=s,r[a].canMove=n,r[a].inDefaults=f,console.log("editSubGoal for",r[a],a);break}i.localStorage.set("subGoals",JSON.stringify(r))}function $(){i.localStorage.remove("mainGoals"),console.log("removed all mainGoal")}function x(){i.localStorage.remove("subGoals"),console.log("removed all subGoals")}function M(){i.localStorage.remove("subGoals"),i.localStorage.remove("mainGoals"),console.log("removed ALL")}function A(e,l=null,t=null){let o=this.getSubGoals;for(var s=0;s<o.length;s++)if(o[s].id===e){o[s].time=l||o[s].time,o[s].score=t||o[s].score;break}i.localStorage.set("subGoals",JSON.stringify(o))}function N(e){let l=this.getSubGoals;for(var t=0;t<l.length;t++)l[t].id===e&&(l.splice(t,1),console.log("removeSubgoal spliced!"));return i.localStorage.set("subGoals",JSON.stringify(l)),l}function I(e,l){let t=this.getMainGoals;for(var o=0;o<t.length;o++)t[o].id===e&&(t.splice(o,1),console.log("removeMaingoal spliced!"));return i.localStorage.set("mainGoals",JSON.stringify(t)),t}function J(e){let l=this.getMainGoals;for(var t=0;t<l.length;t++)if(l[t].title===e)return l[t];return null}function T(e,l=null){let t=this.getAllDates;t?l?t[`${e}`]=l:e in t?delete t[`${e}`]:console.log(`ERROR? deleting schedule of ${e} not found!`):(console.log(`Adding new schedule for ${e}`),t={},t[`${e}`]=l),i.localStorage.set("AllDates",JSON.stringify(t))}function E(e){let l=this.getAllDates;if(l)return l[`${e}`]}function R(e){let l=this.getAllDates;return l?!!l[`${e}`]:!1}function F(){const e=[];let l=function(o){return o==null?void 0:o.inDefaults},t=this.getSubGoals;return t?(t.forEach(o=>{l(o)&&e.push(o)}),e):(console.log("No subgoals to fetch defaults :("),e)}function L(e=null){let l=this.getMainGoals,t=new Set;if(e)for(var o=0;o<l.length;o++)l[o].priority==e&&t.add(l[o].priority);else l.forEach(s=>{t.add(s.priority)});return t}function w(e){const l=[];let t=function(s){const n=s.split(/on/);return n.length!=2?(console.log(`parseScore error?${s}`,n),-1):n[1]-n[0]},o=this.getSubGoals;return o&&o.forEach(s=>{if(s.score=="")console.log(`no score event added: ${s.title}`,s.score),l.push(s);else{let n=t(s.score);n>-1&&n>=e&&l.push(s)}}),l}function U(e){const t=(e/60).toFixed(2);return parseFloat(t)}function Y(){let e=this.getAllDates;if(!e)return[];let l=this.getMainGoals,t=this.getSubGoals,o={};for(let r in e){let a=e[r];for(let u in a)o[u]||(o[u]=[]),o[u].push({date:r,logged:U(a[u].duration)})}let s=r=>{let a=[];return t&&t.forEach(u=>{u.parentGoal==r&&a.push(u)}),a},n=(r,a=null)=>{let u={children:[],title:a?`${r.title.trim()}(${r.score})`:`${r.title.trim()} !${r.priority}!`,key:a?`${a}-${r.id}`:r.id,logged:[],expanded:!1};if(a){let c=o[r.id]||[];u.logged=[...c]}return u},f=[];return l.forEach(r=>{let a=n(r),u=s(r.id);for(let c=0;c<u.length;c++){let g=n(u[c],r.id);if(g.logged.length==0){console.log(`Oooh no logged for parent ${r.title}`,g);continue}a.logged.push(...g.logged),a.children.push(g)}f.push(a)}),f}return{headers:h,headerRefs:b,getHeaders:G,getMainGoals:m,getSubGoals:p,getAllDates:v,addMainGoal:y,addSubGoal:D,editSubGoal:O,getGoalByTitle:J,saveSubProp:A,saveDailySchedule:T,resetSub:x,resetMain:$,resetAll:M,removeSubgoal:N,removeMaingoal:I,getEventsForDate:E,hasEventsForDate:R,fetchAllTaskSummary:Y,fetchGoalsWithMinScore:w,fetchAllPrio:L,fetchDefaults:F}});export{K as u};
