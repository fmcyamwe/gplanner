import{j as be,r as $,c as X,aj as Ie,n as _e,at as Fe,h as L,g as Ne,Q as M,d as oe,_ as U,F as P,M as B,K as A,V as G,I as b,H as R,J as I,P as Z,W as Y,as as te,au as he,av as Se,aw as ce,ax as de,G as V,k as Be,ay as Me,a5 as xe,az as qe,aA as He,w as Oe,b as Je,S as ve,ao as We,al as ze,aB as Ue,aC as je,Z as Qe,N as ye,O as W,f as Ke,aD as $e,U as k,X as ue,Y as fe,ah as De,E as H,aE as Ye,R as ne}from"./index.68c4a473.js";import{c as Ee,a as Xe,b as Ze,p as et,Q as ae}from"./utiFunc.b0967b73.js";import{Q as ke,a as tt,b as Ge,c as Ve,d as it,e as we,f as Ce,g as ot,h as st,i as lt,j as nt}from"./goalForm.c51222ea.js";import{N as at,t as z,p as me,a as N,j as Q,k as pe,T as rt,b as J,c as x,i as re,C as Re,U as q,V as K,Q as dt}from"./NavigationBar.34308e33.js";import{u as ht,Q as Te}from"./goalStorage.b22a529b.js";import{a as ct}from"./QCalendar.eea57702.js";/* empty css                             */import{u as ut}from"./use-quasar.54710391.js";const ft=()=>!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);function ie(t,i=new WeakMap){if(Object(t)!==t)return t;if(i.has(t))return i.get(t);const o=t instanceof Date?new Date(t):t instanceof RegExp?new RegExp(t.source,t.flags):t instanceof Set?new Set:t instanceof Map?new Map:typeof t.constructor!="function"?Object.create(null):t.prototype!==void 0&&typeof t.prototype.constructor=="function"?t:new t.constructor;if(typeof t.constructor=="function"&&typeof t.valueOf=="function"){const l=t.valueOf();if(Object(l)!==l){const s=new t.constructor(l);return i.set(t,s),s}}return i.set(t,o),t instanceof Set?t.forEach(l=>{o.add(ie(l,i))}):t instanceof Map&&t.forEach((l,s)=>{o.set(s,ie(l,i))}),Object.assign(o,...Object.keys(t).map(l=>({[l]:ie(t[l],i)})))}var gt=be({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","beforeShow","show","beforeHide","hide"],setup(t,{slots:i,emit:o}){const{proxy:l}=Ne(),{$q:s}=l,n=$(null),a=$(""),r=$("");let c=!1;const d=X(()=>Ie({initialValue:a.value,validate:t.validate,set:u,cancel:p,updatePosition:y},"value",()=>r.value,h=>{r.value=h}));function u(){t.validate(r.value)!==!1&&(E()===!0&&(o("save",r.value,a.value),o("update:modelValue",r.value)),D())}function p(){E()===!0&&o("cancel",r.value,a.value),D()}function y(){_e(()=>{n.value.updatePosition()})}function E(){return Fe(r.value,a.value)===!1}function D(){c=!0,n.value.hide()}function T(){c=!1,a.value=ie(t.modelValue),r.value=ie(t.modelValue),o("beforeShow")}function w(){o("show")}function v(){c===!1&&E()===!0&&(t.autoSave===!0&&t.validate(r.value)===!0?(o("save",r.value,a.value),o("update:modelValue",r.value)):o("cancel",r.value,a.value)),o("beforeHide")}function m(){o("hide")}function f(){const h=i.default!==void 0?[].concat(i.default(d.value)):[];return t.title&&h.unshift(L("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},t.title)),t.buttons===!0&&h.push(L("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[L(M,{flat:!0,color:t.color,label:t.labelCancel||s.lang.label.cancel,onClick:p}),L(M,{flat:!0,color:t.color,label:t.labelSet||s.lang.label.set,onClick:u})])),h}return Object.assign(l,{set:u,cancel:p,show(h){n.value!==null&&n.value.show(h)},hide(h){n.value!==null&&n.value.hide(h)},updatePosition:y}),()=>{if(t.disable!==!0)return L(ke,{ref:n,class:"q-popup-edit",cover:t.cover,onBeforeShow:T,onShow:w,onBeforeHide:v,onHide:m,onEscapeKey:p},f)}}});const mt=oe({name:"GoalyEnd",props:{disabledScore:Boolean,title:String,id:Number,startTime:String,details:String,score:String,happeningNow:Boolean},data(){const t=$(""),i=$(!1);let o=$("");return{errorMessageScore:t,errorScore:i,note:o,daScore:this.score}},emits:["saveScore","endNow","deleteNow","addMins"],computed:{aScore:{get(){return this.daScore},set(t){this.aScorey(t)&&(this.daScore=t)},cancel(){console.log("aScore remove?",this.id)}},aNote:{get(){return this.note},set(t){this.note=t}},userIconStyle(){return{color:this.disabledScore===!0?"red":"blue",cursor:"pointer"}},endNowBtnStyle(){return{display:this.disabledScore===!0&&this.happeningNow===!0?"flex":"none","text-align":"center","margin-left":"32em",height:"auto"}}},watch:{title(t){console.log("titleValue:",t)}},methods:{onDelete(){this.$emit("deleteNow")},onSave(){this.$emit("saveScore",this.aScore,this.id,this.aNote)},wannaEnd(){this.$emit("endNow",this.id)},wannaAdd(t){this.$emit("addMins",this.id,t)},aScorey(t){return t.length<4||!t.includes("on")?(this.errorScore=!0,this.errorMessageScore=`Error: ${t} Unsaved.Must format as: #on#`,!1):(this.errorScore=!1,this.errorMessageScore="",!0)}}}),pt={class:"title q-calendar__ellipsis"},St={class:"q-pl-md"},vt={class:"title"};function yt(t,i,o,l,s,n){return P(),B("div",pt,[A("div",St,G(` ${t.title} (${t.score})`),1),b(Ee,null,{default:R(()=>[I(G("("+t.id+") "+t.details),1)]),_:1}),A("div",{style:Y(t.endNowBtnStyle)},[b(M,{"no-caps":"",label:"Add5",onClick:i[0]||(i[0]=a=>t.wannaAdd(5))}),b(M,{"no-caps":"",label:"Add10",class:"q-mx-md",onClick:i[1]||(i[1]=a=>t.wannaAdd(10))}),b(Z,{vertical:!0}),b(M,{"no-caps":"",label:"End-Now",onClick:t.wannaEnd},null,8,["onClick"])],4),b(gt,{modelValue:t.aScore,"onUpdate:modelValue":i[3]||(i[3]=a=>t.aScore=a),disable:t.disabledScore,"auto-save":""},{default:R(a=>[b(te,{class:"my-card bg-secondary text-white"},{default:R(()=>[A("div",vt," NoteyOnScore :: "+G(t.title),1),b(he,{class:"q-gutter-md"},{default:R(()=>[b(Se,{modelValue:a.value,"onUpdate:modelValue":r=>a.value=r,dense:"",hint:"format: #on#",error:t.errorScore,"error-message":t.errorMessageScore},null,8,["modelValue","onUpdate:modelValue","error","error-message"])]),_:2},1024),b(he,{class:"q-gutter-md"},{default:R(()=>[b(Se,{filled:"",modelValue:t.aNote,"onUpdate:modelValue":i[2]||(i[2]=r=>t.aNote=r),label:"Note",autogrow:"","lazy-rules":"","item-aligned":"",rules:[r=>r&&r.length>0||"Add a note..."]},null,8,["modelValue","rules"])]),_:1}),b(Z,{dark:""}),b(ce,{class:"q-gutter-md q-mx-md inputBtn"},{default:R(()=>[b(M,{label:"Save",flat:"",dense:"",color:"positive",icon:"check_circle",onClick:[de(a.set,["stop","prevent"]),t.onSave]},null,8,["onClick"]),b(Z,{vertical:!0}),b(M,{label:"Del",flat:"",dense:"",color:"negative",icon:"delete_forever",onClick:t.onDelete},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue","disable"])])}var Et=U(mt,[["render",yt],["__scopeId","data-v-6817ef91"]]);const bt=oe({name:"schedBtn",props:{textLabel:String},emits:["doBtnAction"],methods:{onClicked(){this.$emit("doBtnAction")}}});function wt(t,i,o,l,s,n){return P(),V(M,{color:"",align:"evenly",elevated:"",dense:"",nowrap:"",onClick:t.onClicked,"no-caps":""},{default:R(()=>[A("div",null,G(t.textLabel),1)]),_:1},8,["onClick"])}var Ct=U(bt,[["render",wt],["__scopeId","data-v-88412af4"]]),Ot=be({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(t,{slots:i}){const o=X(()=>{const l=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(s=>t[s]===!0).map(s=>`q-btn-group--${s}`).join(" ");return`q-btn-group row no-wrap${l.length>0?" "+l:""}`+(t.spread===!0?" q-btn-group--spread":" inline")});return()=>L("div",{class:o.value},Be(i.default))}});const $t=Object.keys(Me),Dt=t=>$t.reduce((i,o)=>{const l=t[o];return l!==void 0&&(i[o]=l),i},{});var Rt=be({name:"QBtnDropdown",props:{...Me,...xe,modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String},emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(t,{slots:i,emit:o}){const{proxy:l}=Ne(),s=$(t.modelValue),n=$(null),a=qe(),r=X(()=>{const h={"aria-expanded":s.value===!0?"true":"false","aria-haspopup":"true","aria-controls":a,"aria-label":t.toggleAriaLabel||l.$q.lang.label[s.value===!0?"collapse":"expand"](t.label)};return(t.disable===!0||t.split===!1&&t.disableMainBtn===!0||t.disableDropdown===!0)&&(h["aria-disabled"]="true"),h}),c=X(()=>"q-btn-dropdown__arrow"+(s.value===!0&&t.noIconAnimation===!1?" rotate-180":"")+(t.split===!1?" q-btn-dropdown__arrow-container":"")),d=X(()=>He(t)),u=X(()=>Dt(t));Oe(()=>t.modelValue,h=>{n.value!==null&&n.value[h?"show":"hide"]()}),Oe(()=>t.split,f);function p(h){s.value=!0,o("beforeShow",h)}function y(h){o("show",h),o("update:modelValue",!0)}function E(h){s.value=!1,o("beforeHide",h)}function D(h){o("hide",h),o("update:modelValue",!1)}function T(h){o("click",h)}function w(h){We(h),f(),o("click",h)}function v(h){n.value!==null&&n.value.toggle(h)}function m(h){n.value!==null&&n.value.show(h)}function f(h){n.value!==null&&n.value.hide(h)}return Object.assign(l,{show:m,hide:f,toggle:v}),Je(()=>{t.modelValue===!0&&m()}),()=>{const h=[L(ve,{class:c.value,name:t.dropdownIcon||l.$q.iconSet.arrow.dropdown})];return t.disableDropdown!==!0&&h.push(L(ke,{ref:n,id:a,class:t.contentClass,style:t.contentStyle,cover:t.cover,fit:!0,persistent:t.persistent,noRouteDismiss:t.noRouteDismiss,autoClose:t.autoClose,anchor:t.menuAnchor,self:t.menuSelf,offset:t.menuOffset,separateClosePopup:!0,transitionShow:t.transitionShow,transitionHide:t.transitionHide,transitionDuration:t.transitionDuration,onBeforeShow:p,onShow:y,onBeforeHide:E,onHide:D},i.default)),t.split===!1?L(M,{class:"q-btn-dropdown q-btn-dropdown--simple",...u.value,...r.value,disable:t.disable===!0||t.disableMainBtn===!0,noWrap:!0,round:!1,onClick:T},{default:()=>Be(i.label,[]).concat(h),loading:i.loading}):L(Ot,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:t.rounded,square:t.square,...d.value,glossy:t.glossy,stretch:t.stretch},()=>[L(M,{class:"q-btn-dropdown--current",...u.value,disable:t.disable===!0||t.disableMainBtn===!0,noWrap:!0,round:!1,onClick:w},{default:i.label,loading:i.loading}),L(M,{class:"q-btn-dropdown__arrow-container q-anchor--skip",...r.value,...d.value,disable:t.disable===!0||t.disableDropdown===!0,rounded:t.rounded,color:t.color,textColor:t.textColor,dense:t.dense,size:t.size,padding:t.padding,ripple:t.ripple},()=>h)])}}});function Pe(t){if(t===!1)return 0;if(t===!0||t===void 0)return 1;const i=parseInt(t,10);return isNaN(i)?0:i}var Tt=ze({name:"close-popup",beforeMount(t,{value:i}){const o={depth:Pe(i),handler(l){o.depth!==0&&setTimeout(()=>{const s=Ue(t);s!==void 0&&je(s,l,o.depth)})},handlerKey(l){Qe(l,13)===!0&&o.handler(l)}};t.__qclosepopup=o,t.addEventListener("click",o.handler),t.addEventListener("keyup",o.handlerKey)},updated(t,{value:i,oldValue:o}){i!==o&&(t.__qclosepopup.depth=Pe(i))},beforeUnmount(t){const i=t.__qclosepopup;t.removeEventListener("click",i.handler),t.removeEventListener("keyup",i.handlerKey),delete t.__qclosepopup}});const Pt=oe({name:"dropDwnBtn",props:{optionLabel:String,disableBtn:Boolean,daOptions:Array},emits:["doReload","chooseOption"],methods:{onClicked(){this.$emit("doReload")},onSelect(t){this.$emit("chooseOption",t)}}});function At(t,i,o,l,s,n){return P(),V(Rt,{split:"",dense:"",nowrap:"",align:"evenly",color:"",elevated:"","disable-main-btn":t.disableBtn,label:t.optionLabel,onClick:t.onClicked,"no-caps":""},{default:R(()=>[b(tt,{bordered:"",padding:""},{default:R(()=>[(P(!0),B(W,null,ye(t.daOptions,a=>Ke((P(),V(Ge,{key:a,clickable:"",onClick:r=>t.onSelect(a)},{default:R(()=>[b(Ve,{style:{"text-align":"center"}},{default:R(()=>[b(it,null,{default:R(()=>[I(G(a),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[Tt]])),128))]),_:1})]),_:1},8,["disable-main-btn","label","onClick"])}var Nt=U(Pt,[["render",At],["__scopeId","data-v-1c05e532"]]);const Bt={name:"adHocEvent",props:{mainGoals:Array},data(){return{aTitle:"",daP:null,own:"misc",duration:15}},emits:["saveEvent","doCancel"],computed:{pGoals:{get(){return this.mainGoals}},evName:{get(){return this.aTitle},set(t){this.aTitle=t}},labely:{get(){return this.own=="misc"?this.daP==null?"Defaut Misc. PGoal":"Of Parent Goal":"Select Parent Goal"}}},methods:{goalyColor(t){return this.daP==null?"":t=="c"?"bg-"+this.daP.bgcolor:this.daP.bgcolor},onClicked(){this.$emit("saveEvent",this.aTitle,this.daP,this.own,this.duration),this.own="own",this.daP=null,this.duration=15}}},Mt=t=>(ue("data-v-d5b4b8b4"),t=t(),fe(),t),kt=Mt(()=>A("div",{class:"text-h3"},"Ad hoc Event",-1)),Gt={class:"q-ml-md"},Vt={class:"radio-select"},Lt={key:0},It={class:"q-mx-md",style:{"text-align":"center"}};function _t(t,i,o,l,s,n){return P(),B(W,null,[kt,b(we),b(Z),A("div",Gt,[b(Se,{modelValue:n.evName,"onUpdate:modelValue":i[0]||(i[0]=a=>n.evName=a),filled:"",label:"A Goal","lazy-rules":"","item-aligned":"",rules:[a=>a&&a.length>0||"Please type a goal"]},null,8,["modelValue","rules"]),A("div",Vt,[b($e,{class:"q-mx-md",modelValue:s.own,"onUpdate:modelValue":i[1]||(i[1]=a=>s.own=a),val:"misc",label:"Misc"},null,8,["modelValue"]),b($e,{class:"q-mx-md",modelValue:s.own,"onUpdate:modelValue":i[2]||(i[2]=a=>s.own=a),val:"self",label:"By Self"},null,8,["modelValue"])]),n.pGoals?(P(),B("div",Lt,[b(Ce,{class:"q-gutter-md",modelValue:s.daP,"onUpdate:modelValue":i[3]||(i[3]=a=>s.daP=a),options:n.pGoals,"option-value":"id","option-label":"title",disable:s.own!="misc",label:n.labely,popupContentClass:"q-px-md","options-selected-class":n.goalyColor("c"),"label-color":n.goalyColor("l")},null,8,["modelValue","options","disable","label","options-selected-class","label-color"])])):k("",!0),A("div",null,[I(" duration "),b(ot,{min:15,max:120,thickness:.22,step:5,modelValue:s.duration,"onUpdate:modelValue":i[4]||(i[4]=a=>s.duration=a),"show-value":"",label:"Duration",size:"75px",color:"teal","track-color":"grey-3",class:"q-ma-md"},null,8,["thickness","modelValue"])])]),A("div",It,[b(M,{flat:"",align:"center",label:"Cancel",color:"primary",onClick:i[5]||(i[5]=a=>t.$emit("doCancel"))}),b(M,{elevated:"",color:"primary",onClick:n.onClicked},{default:R(()=>[I(" Add ")]),_:1},8,["onClick"])])],64)}var Ft=U(Bt,[["render",_t],["__scopeId","data-v-d5b4b8b4"]]);const xt={name:"selectEvent",props:{canBeScheduled:Array,toBalance:Number},data(){return{doForce:!1,toAddE:null,useBalance:!1,allEvts:this.canBeScheduled}},emits:["onPickEvent","doCancel"],computed:{allScheduled:{get(){return this.allEvts},set(t){this.allEvts=t}},toAdd:{get(){return this.toAddE},set(t){this.toAddE=t}}},methods:{onAddClicked(){this.$emit("onPickEvent",this.toAdd,this.doForce,this.useBalance),this.doForce=!1,this.useBalance=!1,this.toAdd=null},filterFn(t,i,o){i(()=>{const l=t.toLowerCase();this.allScheduled=this.canBeScheduled.filter(s=>(s==null?void 0:s.title.toLowerCase().indexOf(l))>-1)})},setModel(t){this.toAdd=t},goalyColor(t){var i,o;return this.toAdd==null?"":t=="c"?"bg-"+((i=this.toAdd)==null?void 0:i.color):(o=this.toAdd)==null?void 0:o.color},labely(){var t;return this.toAdd==null||this.toAdd==null||this.toAdd==""?" Sub Goal":" Of: "+((t=this.toAdd)==null?void 0:t.pg)},canBalance(){var i,o,l,s;let t=this.toBalance+parseInt((i=this.toAdd)==null?void 0:i.duration)||((o=this.toAdd)==null?void 0:o.isAlternative);return console.log("canBalance",t),this.toAdd==null?!1:this.toBalance+parseInt((l=this.toAdd)==null?void 0:l.duration)||((s=this.toAdd)==null?void 0:s.isAlternative)}}},Le=t=>(ue("data-v-5177a427"),t=t(),fe(),t),qt={class:"q-pa-md row items-start"},Ht=Le(()=>A("div",{class:"text-h3"},"Select event",-1)),Jt={class:"q-mx-md event-select"},Wt=Le(()=>A("div",{class:"q-mx-md",style:{"text-align":"center"}}," Add ",-1));function zt(t,i,o,l,s,n){return P(),B("div",qt,[b(te,null,{default:R(()=>[b(he,null,{default:R(()=>[Ht]),_:1}),b(Z),A("div",Jt,[b(Ce,{modelValue:n.toAdd,"onUpdate:modelValue":i[0]||(i[0]=a=>n.toAdd=a),options:n.allScheduled,class:"q-gutter-md q-px-md","option-value":"id","option-label":"title",popupContentClass:"q-px-md scheduly",label:n.labely(),"options-selected-class":n.goalyColor("c"),"label-color":n.goalyColor("l"),onFilter:n.filterFn,onInputValue:n.setModel,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0"},{"no-option":R(()=>[b(Ge,null,{default:R(()=>[b(Ve,{class:"text-grey"},{default:R(()=>[I(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","options","label","options-selected-class","label-color","onFilter","onInputValue"])]),b(ce,{align:"center",class:"q-px-xl"},{default:R(()=>[b(De,{dense:"",modelValue:s.doForce,"onUpdate:modelValue":i[1]||(i[1]=a=>s.doForce=a),label:"Force",color:"teal"},null,8,["modelValue"]),b(we),n.canBalance?(P(),V(De,{key:0,dense:"",modelValue:s.useBalance,"onUpdate:modelValue":i[2]||(i[2]=a=>s.useBalance=a),label:"Use Balance",color:"brown"},null,8,["modelValue"])):k("",!0)]),_:1}),b(ce,{align:"center"},{default:R(()=>[b(M,{flat:"",label:"Cancel",color:"primary",onClick:i[3]||(i[3]=a=>t.$emit("doCancel"))}),b(M,{elevated:"",color:"primary",onClick:n.onAddClicked},{default:R(()=>[Wt]),_:1},8,["onClick"])]),_:1})]),_:1})])}var Ut=U(xt,[["render",zt],["__scopeId","data-v-5177a427"]]);const jt=oe({name:"schedDialog",components:{adHocEvent:Ft,selectEvent:Ut},props:{parentGoals:Array,canBeScheduled:Array,balance:Number},data(){return{showPickDialog:$(!1),showAdHocDialog:$(!1),show:$(!0)}},emits:["addAdHocEvent","onPickEvent","euhHidin"],computed:{showDefaultOption:{get(){return this.show},set(t){this.show=t}},showPickyDialog:{get(){return this.showPickDialog},set(t){this.showPickDialog=t}},showAddyDialog:{get(){return this.showAdHocDialog},set(t){this.showAdHocDialog=t}},allScheduled:{get(){return this.canBeScheduled.forEach(t=>{let i=this.parentGoals.find(o=>o.id==t.parentGoal);i?t.color=i.bgcolor:t.color="",t.pg=i==null?void 0:i.title.trim()}),this.canBeScheduled}}},methods:{onAddClicked(t,i,o){this.$emit("onPickEvent",t,i,o),this.reset()},adHocNewEvent(t,i,o,l){this.$emit("addAdHocEvent",t,i,o,l),this.reset()},onChooseExisting(){this.showPickyDialog=!this.showPickyDialog},onChooseAdHoc(){this.showAddyDialog=!this.showAddyDialog},gonHide(){this.$emit("euhHidin")},onCancelBtn(){let t=this.showPickyDialog;this.showAddyDialog,t?this.showPickyDialog=!this.showPickyDialog:this.showAddyDialog=!this.showAddyDialog},reset(){this.showAddyDialog=!1,this.showPickyDialog=!1}}}),Qt=t=>(ue("data-v-554dc47a"),t=t(),fe(),t),Kt={class:"q-ma-md event-select"},Yt={class:"q-ma-md event-select"},Xt=Qt(()=>A("div",{class:"text-h6"},"Ad hoc or Existing event",-1));function Zt(t,i,o,l,s,n){const a=H("select-event"),r=H("ad-hoc-event");return P(),V(Ye,{modelValue:t.showDefaultOption,"onUpdate:modelValue":i[0]||(i[0]=c=>t.showDefaultOption=c),"transition-show":"rotate","transition-hide":"rotate","no-esc-dismiss":"",onBeforeHide:t.gonHide},{default:R(()=>[t.showPickyDialog?(P(),V(te,{key:0},{default:R(()=>[A("div",Kt,[b(a,{canBeScheduled:t.allScheduled,toBalance:t.balance,onOnPickEvent:t.onAddClicked,onDoCancel:t.onCancelBtn},null,8,["canBeScheduled","toBalance","onOnPickEvent","onDoCancel"])])]),_:1})):t.showAddyDialog?(P(),V(te,{key:1},{default:R(()=>[A("div",Yt,[b(r,{mainGoals:t.parentGoals,onSaveEvent:t.adHocNewEvent,onDoCancel:t.onCancelBtn},null,8,["mainGoals","onSaveEvent","onDoCancel"]),b(we)])]),_:1})):(P(),V(te,{key:2},{default:R(()=>[b(he,null,{default:R(()=>[Xt]),_:1}),b(ce,{align:"center"},{default:R(()=>[b(M,{flat:"",label:"Add hoc",color:"primary",onClick:t.onChooseAdHoc},null,8,["onClick"]),b(M,{flat:"",label:"Existing",color:"primary",onClick:t.onChooseExisting},null,8,["onClick"])]),_:1})]),_:1}))]),_:1},8,["modelValue","onBeforeHide"])}var ei=U(jt,[["render",Zt],["__scopeId","data-v-554dc47a"]]);function Ae(t){return t.button===0}const ti=oe({name:"dayCalendar",components:{NavigationBar:at,QCalendarDay:ct,addGoalForm:st,GoalyEnd:Et,schedBtn:Ct,dropDwnBtn:Nt,schedDialog:ei},data(){return $(null),$(null),$(null),$(null),$(null),ut(),{filter:$([]),filterRef:$(null),currentDate:$(z()),scoreOptions:$([1,2,3,4,5,6]),chosenScore:$(null),chosenPrio:$(null),hello:$(null),scheduledEvents:[],dailyScheduled:$(new Map),endTimesSet:$(new Set),startTimesSet:$(new Set),dailyScheduledMap:$(new Map),disablePrioBtn:$(!0),disableScoreBtn:$(!0),calendar:$(null),store:ht(),anchorTimestamp:$(null),otherTimestamp:$(null),mouseDown:$(!1),mobile:$(!0),usingMoods:$({}),timeStartPos:$(0),showGoalForm:$(!1),addEventDialog:$(!1),disabledScoreEvts:$({}),hasStarted:$({}),disableSaveSchedule:$(!0),showReloadBtn:$(!1),showLoadDefaults:$(!0),showOneEach:$(!1),showScoreBtn:$(!1),showPrio:$(!1),showClearBtn:$(!1),splitterPage:$(35),splitterLegend:$(40),treeGoals:$([]),expanded:$([]),parentGs:$(null)}},beforeMount(){this.mobile=ft(),this.resetGoalEvts(!0),this.constructTree()},beforeUnmount(){clearInterval(this.intervalId)},mounted(){this.adjustCurrentTime(),this.intervalId=setInterval(()=>{this.adjustCurrentTime()},6e4)},computed:{scheduleMoodsLabel(){let t="";if(!Object.keys(this.usingMoods).length>0)return t;let i=new Set;for(let l in this.usingMoods)i.add(this.usingMoods[l].join());let o=0;for(let l of i)o<1?t=l:t=t+", "+l,o++;return Object.keys(this.usingMoods).length!=i.size&&console.log("scheduleMoodsLabel..prob change!",JSON.parse(JSON.stringify(this.usingMoods)),i,t),t},chosenScoreLabel(){return this.chosenScore==null?"By Score":`Score >= ${this.chosenScore}`},chosenPrioLabel(){return this.chosenPrio==null?"By Priority":`Prio = ${this.chosenPrio}`},style(){return{top:this.timeStartPos+"px"}},showForm(){return this.showGoalForm||this.constructTree(),this.showGoalForm},saveScheduleDisabled(){return this.disableSaveSchedule},hasEventsForDate(){return this.store.hasEventsForDate(this.currentDate)},eventsMap(){const t={};return this.scheduledEvents.forEach(i=>{if(t[i.date]||(t[i.date]=[]),t[i.date].push(i),i.days){console.log(`eventsMap multiple days? event for ${i.date}`,i.days);let o=me(i.date),l=i.days;do o=N(o,{day:1}),t[o.date]||(t[o.date]=[]),t[o.date].push(i);while(--l>0)}}),t},canbeScheduled(){let t=this.deepCopy(this.storedSubGoals),i=t.filter(l=>!this.scheduledEvents.find(s=>s.id==l.id)),o=(l,s)=>{if(l.parentGoal>s.parentGoal)return 1;if(l.parentGoal==s.parentGoal)return 0;if(l.parentGoal<s.parentGoal)return-1};return i.length==0?(t.sort(o),t):(i.sort(o),i)},storedSubGoals(){return this.store.getSubGoals},storedAlternatives(){return this.store.fetchAlternativeEvts()},startEndTimes(){const t=[];return this.anchorDayTimeIdentifier!==!1&&this.otherDayTimeIdentifier!==!1&&(this.anchorDayTimeIdentifier<=this.otherDayTimeIdentifier?t.push(Q(this.anchorTimestamp),Q(this.otherTimestamp)):t.push(Q(this.otherTimestamp),Q(this.anchorTimestamp))),t},anchorDayTimeIdentifier(){return this.anchorTimestamp!==null?pe(this.anchorTimestamp):!1},otherDayTimeIdentifier(){return this.otherTimestamp!==null?pe(this.otherTimestamp):!1},storedCompPG(){return this.storedPG()},currentBalance(){return this.store.getBalance},filterString(){return this.filter.join()},defaultLabels(){let t=this.allEvents.filter(i=>(i==null?void 0:i.inDefaults)&&(i==null?void 0:i.time)!=""&&!this.scheduledEvents.find(o=>o.id==i.id)).length;return t>0?t+" Defaults":"Defaults"}},methods:{parentGoalsMap(){const t=new Map;let i=this.storedPG();return i?(i.forEach(o=>{t.set(o.id,o)}),t):(console.log("parentGoalsMap is empty or null",i),t)},storedPG(){return this.parentGs==this.store.getMainGoals?(console.log("storedPG SAME!!!!"),this.parentGs):(this.parentGs=this.store.getMainGoals,this.parentGs)},constructTree(){this.treeGoals=this.store.fetchGoalsTree()},badgeClasses(t,i){return Xe(t,i)},badgeStyles(t,i,o=void 0,l=void 0){return Ze(t,i,o,l)},classyColor(t){return`row items-center ${t.isChildren?"text-":"text-white bg-"}${t.color} `},resetFilter(){var t;this.filter=[],(t=this.filterRef)==null||t.focus()},myFilterMethod(t,i){if(t.isChildren&&(t==null?void 0:t.moods.length)>0){const o=this.filter.map(s=>s.toLowerCase());let l=t==null?void 0:t.moods.some(s=>o.indexOf(s.toLowerCase())>-1);return t.label&&l}},getTimeNumber(t){return t!==null?pe(t):!1},getTimeyNumber(t){return t!==null?rt(t):!1},labelGoals(t){let i=0;if(t=="s"){for(const o in this.treeGoals)i+=this.treeGoals[o].children.length;return`Scheduled => ${this.scheduledEvents.length} out of ${i} 
`}return`Balance: ${this.currentBalance?this.currentBalance:0} 
`},getDateEvents(t){const i=this.eventsMap[t]||[];if(i.length===1)i[0].side="full";else if(i.length===2){const o=N(x(i[0].date),{minute:J(i[0].time)}),l=N(o,{minute:i[0].duration}),s=N(x(i[1].date),{minute:J(i[1].time)}),n=N(s,{minute:i[1].duration});re(s,o,l,!0)||re(n,o,l,!0)?(console.log("getDateEvents...LENGTH==2..LEFT/RIGHT 'TWIX"),i[0].side="left",i[1].side="right"):(i[0].side="full",i[1].side="full")}return i},hasDate(t){return this.currentDate?t.find(i=>i.date===this.currentDate):!1},getEventsForDate(t){return this.store.getEventsForDate(t)},isViewingToday(){return z()==this.currentDate},isViewingPast(){let t=z();if(this.currentDate&&this.currentDate==t)return!1;let i=Re(x(t));return!(Re(x(this.currentDate))>=i)},adjustCurrentTime(){const t=q(new Date);if(this.currentDate!==t.date){this.timeStartPos=-10,this.currentTime="";return}this.currentDate=t.date,this.currentTime=t.time,this.timeStartPos=this.$refs.calendar.timeStartPos(t.time,!1);let i=this.endTimesSet&&this.endTimesSet.has(t.time),o=this.startTimesSet&&this.startTimesSet.has(t.time);(i||o)&&this.doEnableEndNowBtn(this.currentTime,i,o)},allMainGPrio(){let t=this.store.fetchAllPrio();return!t.size>0?(console.log("ERROR...no Priority goals?",t),[]):Array.from(t.values()).sort()},resetGoalEvts(t=!1){if(this.scheduledEvents==this.allEvents&&console.log("resetGoalEvts SAME"),t){let i=this.deepCopy(this.storedSubGoals);return this.allEvents=[...i],i}return this.allEvents},getLocalEvt(t){for(let i=0;i<this.allEvents.length;i++)if(this.allEvents[i].id===t)return this.allEvents[i];return null},getScheduledEvent(t){for(let i=0;i<this.scheduledEvents.length;i++)if(this.scheduledEvents[i].id==t)return this.scheduledEvents[i];return null},doSaveEvtProp(t,i=null,o=null){this.store.saveSubProp(t,i,o)},evtStartedOrPassed(t){const i=[];let o=N(t,{minute:0}),l=this.getTimeNumber(o);return this.dailyScheduled.forEach((s,n,a)=>{let r=this.getTimeNumber(s.start),c=this.getTimeNumber(s.end);if(r!==!1&&c!==!1){let d=l>=r&&l<c,u=l>=c;(d||u)&&i.push(n),d&&(this.hasStarted[n]=!0),this.enableEvtScoreEdit(n,u)}else console.log(`ERROR?!:${n} has no start/end?.`,s)}),i},allowScoreEdit(t){this.dailyScheduled.forEach((i,o,l)=>{this.disabledScoreEvts[o]=!t})},enableEvtScoreEdit(t,i){this.disabledScoreEvts[t]=!i},canEnableEditScore(t,i){const o=q(new Date);K(o,i)>0?this.disabledScoreEvts[t]=!0:(this.disabledScoreEvts[t]=!1,this.hasStarted[t]=!1)},parseScore(t){const i=t.split(/on/);return i.length!=2?(console.log(`parseScore error?${t}`,i),-1):i[1]-i[0]},doEnableEndNowBtn(t,i,o){for(let[l,s]of this.dailyScheduled)(i?s.end.time:s.start.time)==t&&(this.hasStarted[l]=!i,this.disabledScoreEvts[l]=!i)},enableEndNowBtn(t,i,o){const l=q(new Date);re(l,i,o,!0)?this.hasStarted[t]=!0:this.hasStarted[t]=!1},retrieveSameStart(t){let i=[];for(let[o,l]of this.dailyScheduled)l.start.time==t&&i.push(o);return i},confirmTimeChange(t,i,o,l,s,n,a=null){this.$q.dialog({title:t,message:i,cancel:!1,ok:o,options:{type:"radio",model:"",items:[{label:o+" and "+l,value:"ok"},{label:l,value:"alt"}]},class:"overflow-wrap: break-word;",style:""}).onOk(r=>{if(r==""){console.log("confirmTimeChange onOk with no selection >>onDismiss"),this.doNotify("No selection made...Defaulting","positive","bottom"),a?a():console.log("confirmTimeChange:: No Dismiss func to execute!");return}return s(r)}).onCancel(()=>{console.log("confirmTimeChange>> executeCancel..."),n()})},confirmAction(t,i,o,l,s=null){this.$q.dialog({title:"Warning",cancel:!0,ok:i,message:t}).onOk(()=>{o()}).onCancel(()=>{l()}).onDismiss(()=>{if(s){console.log("confirmAction with dismiss!!"),s();return}})},radioChoiceDialog(t,i,o,l,s=null,n=null,a=null){this.$q.dialog({title:t,cancel:!!n,persistent:!0,message:i,options:{type:"radio",model:l,items:o}}).onOk(r=>{s&&(r==""?this.radioChoiceDialog(t,i,o,l,s,n,a):s(r))}).onCancel(()=>{n&&n()}).onDismiss(()=>{a&&a()})},checkBoxDialog(t,i,o,l,s=null,n=null,a=null){let r=o.length,c=r>2?2:r;this.$q.dialog({title:t,message:i,options:{type:"checkbox",model:[],isValid:d=>d.length>0&&d.length==c,items:o},cancel:!0,persistent:!0}).onOk(d=>{s(d)}).onCancel(()=>{n&&n()}).onDismiss(()=>{a&&a()})},doNotify(t,i=void 0,o="top"){this.$q.notify({color:i!==void 0?i:"negative",position:o,message:t,icon:i==null?"report_problem":"thumb_up"})},useGroupNotify(t,i=void 0,o="top",l=!1,s=5e3){this.$q.notify({color:i!==void 0?i:"negative",position:o,message:t,icon:i==null?"report_problem":"thumb_up",group:l,timeout:s})},withDismissNotify(t,i=void 0,o="top",l=null,s=null){this.$q.notify({color:i!==void 0?i:"negative",position:o,message:t,icon:i==null?"report_problem":"thumb_up",timeout:l!=null?l:5e3,closeBtn:"Okey",onDismiss:s})},updateButtons(t=null,i=null,o=null){this.showLoadDefaults=t!=null?t:this.showLoadDefaults,this.showScoreBtn=i!=null?i:this.showScoreBtn,this.showPrio=o!=null?o:this.showPrio,this.showOneEach=o!=null?o:this.showOneEach},doRemove(t){let i=this.scheduledEvents.length;if(!t){console.log("ERROR doRemove, NO item to delete?!?",t);return}let o=0;for(o;o<i;o++)if(this.scheduledEvents[o].id==t.id){this.scheduledEvents.splice(o,1);let l=null;if(this.dailyScheduled.has(t.id)?(l=this.dailyScheduled.get(t.id),this.dailyScheduled.delete(t.id)):console.log("doRemove ::> dailyScheduled has no such item?@? ERROR",t),l){let s=this.startTimesSet.delete(l.start.time),n=this.endTimesSet.delete(l.end.time);(!s||!n)&&console.log(`doRemove ::> ERROR? scheduleSets has no such item?@? start:${s}...end:${n}`,l,t.id+" "+(t==null?void 0:t.title.trim())+" "+(t==null?void 0:t.details))}break}},addToBalance(t){let o=this.currentBalance-parseInt(t==null?void 0:t.duration);this.store.setBalance(o)},chooseAlternatives(t){let i=this.storedAlternatives,o=q(new Date),l=t.time,s=o.date;const n=u=>{let p=this.parentGoalsMap().get(u.parentGoal);return{label:`Of '${p==null?void 0:p.title.trim()}' "${u.title.trim()}" (${u.score}) for ${u==null?void 0:u.duration} mins`,value:u.id}},a=u=>u.filter(p=>!this.scheduledEvents.find(y=>y.id==p.id)),r=u=>{let p=N(x(s),{day:0}),y=N(x(p.date),{day:1}),E=this.getEventsForDate(p.date),D={},T=null;E?D=E:console.log("addInFutur EMPTY for >>...",p.date),u.forEach(w=>{if(T=this.getLocalEvt(w),D[w]){console.log("addInFutur...ALREADY PRESENT",w,p.date,T==null?void 0:T.title.trim()),this.doNotify(`Alternative '${T==null?void 0:T.title.trim()}' already present on ${p.date}. Moving it to next day`,"warning");let v=this.getEventsForDate(y.date);if(v)if(!v[w])v[w]={duration:T.duration,time:l};else{console.log("addInFutur...STILL PRESENT in next day:"+y.date,T.title.trim()),this.doNotify(`Boo Alt '${T==null?void 0:T.title.trim()}' also present on ${y.date} :(( ...Check BALANCE!`),this.addToBalance(T);return}else console.log("addInFutur next day EMPTY for >>...",y.date),v={},v[w]={duration:T.duration,time:l};this.store.saveDailySchedule(y.date,v),this.doNotify(`Saving ${T.title} in ${y.date}`,"positive","bottom")}else D[w]={duration:T.duration,time:l}}),console.log("addInFutur>>>",p.date,JSON.parse(JSON.stringify(D))),this.store.saveDailySchedule(p.date,D)},c=u=>{this.doRemove(t);let p=i.find(T=>T.id==u);console.log("remReplace...Add at:",l,p.title,"usually at:"+p.time),p=this.addPropsEventsTo(this.currentDate,[{...p,time:l}]);let y=this.overlapCheckEvtsAdd(p),E=Object.keys(y).length;if(E>0)return console.log(`chooseAlternatives::removeReplace:: OVERLAPS again from ${p.length} overlaps =${E}`,p,y),this.doNotify(`Extra Overlaps while adding ${p[0].title.trim()}`,"warning","top"),this.fixyOverlaps(y,null,"alts");let D=this.updateCurrentSchedule();console.log("chooseAlternatives::remReplace:SAMESTART",D),D.size>0&&this.fixSameStart(D),this.doSaveSchedule(),this.doNotify(`Added Alt replacement '${p[0].title}' at ${l}`,"positive","bottom")},d=u=>{this.doNotify(u)};if(i=a(i),i.length==0){d("Removing not allowed! Alternatives already present!");return}this.checkBoxDialog("Gotta pick alternatives","Select the first Evt to replace the removed and an Extra evt for later day (today)!",i.map(n),i[0].id,function(u){console.log("chooseAlternatives::opt",u),c(u.shift()),u.length>0?r(u):(console.log("chooseAlternatives::onOk...nothing to add?!?",i.length,u.length,i.length-u.length),d("No Alternative scheduled later :("))},function(){console.log("chooseAlternatives::onCancel")})},removeEvtInSchedule(t){let i=!1,o=()=>{if(this.doRemove(t),i){console.log("removeEvtInSchedule..autoSave for: "+t.title),delete this.usingMoods[t.id],this.doSaveSchedule(),this.disableSaveSchedule=!0;return}this.disableSaveSchedule=!1,this.showReloadBtn=this.hasEventsForDate};if(this.isViewingPast()){if(t.duration<30){this.doNotify("Removing from the past... Check BALANCE!"),this.addToBalance(t),i=!0,o();return}this.chooseAlternatives(t);return}if(!this.isViewingToday()){i=this.usingMoods[t.id],o(),console.log("Removed future evt");return}let l=`Remove "${t.title}" from schedule?`;this.usingMoods[t.id]&&(console.log("removeEvtInSchedule with MOOD?!?",this.usingMoods[t.id]),i=!0,l=l+" With Mood "+this.usingMoods[t.id]),this.confirmAction(l,"Remove",o,function(){console.log("Cancelled remove")})},updateCurrentSchedule(){const t=new Map;let i=new Set,o=new Set,l=new Set;return this.scheduledEvents.length<1?(this.dailyScheduled=t,this.endTimesSet=i,this.startTimesSet=l,o):(this.scheduledEvents.forEach(s=>{let n=N(x(s.date),{minute:J(s.time)}),a=N(n,{minute:s.duration});t.set(s.id,{...s,start:n,end:a,on:s.date,originalAt:s.time,for:s.duration,score:s.score}),i.add(a.time),l.has(n.time)?o.add({at:n.time,id:s.id}):l.add(n.time),(this.currentDate==z()||!this.isViewingPast())&&(this.canEnableEditScore(s.id,a),this.enableEndNowBtn(s.id,n,a))}),this.dailyScheduled=t,this.endTimesSet=i,this.startTimesSet=l,o)},addEvtPropsIntoSchedule(t){!this.addEvtInScheduleMaps(t)||this.scheduledEvents.push(t)},addEvtInScheduleMaps(t){if(this.dailyScheduled.has(t.id))return!1;let i=N(x(t.date),{minute:J(t.time)}),o=N(i,{minute:t.duration});return this.dailyScheduledMap.set((t.id,{...t,on:t.date,for:t.duration,start:i,end:o,score:t.score})),this.dailyScheduled.set(t.id,{...t,on:t.date,originalAt:t.time,for:t.duration,start:i,end:o,score:t.score}),this.endTimesSet.add(o.time),this.startTimesSet.add(i.time),(this.currentDate==z()||!this.isViewingPast())&&(this.canEnableEditScore(t.id,o),this.enableEndNowBtn(t.id,i,o)),!0},updateEvtInScheduleMaps(t,i){if(this.dailyScheduled.has(t)){let o=this.dailyScheduled.get(t),l=o.for,s=o.originalAt,n=o.start,a=o.end,r=N(i,{minute:l}),c=o.score;return this.dailyScheduled.set(t,{on:i.date,originalAt:s,for:l,start:i,end:r,score:c}),this.endTimesSet.delete(a.time)?this.endTimesSet.add(r.time):console.log("updateEvtInScheduleMaps-endTimesSet NOT FOUND?!?"),this.startTimesSet.delete(n.time)?this.startTimesSet.add(i.time):console.log("updateEvtInScheduleMaps-startTimesSet NOT FOUND?!?",t,i),(this.currentDate==z()||!this.isViewingPast())&&(this.canEnableEditScore(t,r),this.enableEndNowBtn(t,i,r)),!0}else return console.log("updateEvtInScheduleMaps--euh not found?ERROR?",t,i),!1},evtIsOverlappingTimes(t,i,o,l){let s=this.getTimeyNumber(t),n=this.getTimeyNumber(i),a=this.getTimeyNumber(o),r=this.getTimeyNumber(l);if(s===!1||a===!1||n===!1||r===!1)return console.log("ERROR... evtIsOverlappingTimes error",s,n,a,r),!1;let c=!1;return s>a&&s<r&&(c="bas"),n>a&&n<r&&(c="haut"),(a>=s&&n>=r||s>=a&&n<=r)&&(c="surrounding"),c},hasOverlappingEvent(t,i,o){const l=[];let s=i,n=N(s,{minute:o});return this.dailyScheduled.forEach((a,r,c)=>{if(r!=t){let d=this.evtIsOverlappingTimes(s,n,a.start,a.end);d&&l.push({target:t,targetStart:s,direction:d,inConflict:r})}}),l},overlapCheckEvtsAdd(t){let i={};for(let o=0;o<t.length;o++){let l=t[o],s=N(x(l.date),{minute:J(l.time)}),n=this.hasOverlappingEvent(l.id,s,l.duration);if(n.length>0){let a=0;do{let r=n[a];i[r.inConflict]||(i[r.inConflict]=[]),i[r.inConflict].push(r),a>0&&(r.inConflict in i&&(console.log("WOAH deleting inConflict",r.inConflict),delete i[r.inConflict]),n[a-1].inConflict in i&&(console.log("WOAH deleting PREV inConflict",n[a-1].inConflict),delete i[n[a-1].inConflict]),i[l.id]?(i[l.id].push(r),console.log("WOAH obj.id already present?",l.id)):i[l.id]=[r],i[l.id].unshift(n[a-1]),i.withID=!0)}while(++a<n.length)}else this.addEvtPropsIntoSchedule(l)}return i},whenFrmtTime(t){if(!t)return"";let i=t.split(":");return parseInt(i[0])>=12?t+"PM":t+"AM"},updatedEvtDetails(t){let i=this.parentGoalsMap().get(t.parentGoal);return i?(t.bgcolor=i.bgcolor,t.jeSuis?t.details=`Of '${i.title.trim()}' :: << ${t.jeSuis.join(",")} >>`:t.details=`Of '${i.title.trim()}' :: ${this.whenFrmtTime(t==null?void 0:t.time)} -> ${t==null?void 0:t.duration}min -- ${t!=null&&t.inDefaults?"Dft:":":"}${t!=null&&t.canMove?":Mv:":":"}${t!=null&&t.isAlternative?":Alt":":"}`):(console.log("ERROR?!? no parent goal for:",JSON.parse(JSON.stringify(t))),t.bgcolor="grey",t.title=`Ad-hoc:${t==null?void 0:t.title} (${this.parseScore(t==null?void 0:t.score)})`,t.details=`${t==null?void 0:t.title}: ${this.whenFrmtTime(t==null?void 0:t.time)} -- ${t==null?void 0:t.duration}min`),t},addPropsEventsTo(t,i){if(!i)return this.doNotify("addPropsEventsTo BUT no goals to schedule..."),[];let o=[];return i.forEach(l=>{let s=this.getLocalEvt(l.id);if(s){let n=Object.assign({},l);Object.assign(n,{...s,date:t}),o.push(this.updatedEvtDetails(n))}else console.log("ERROR in addPropsEventsTo...Evt:not present!",l)}),o},changeEvtTime(t,i,o,l=!1){let s=this.getScheduledEvent(t),n=null;if(s)n=s.time;else if(l){if(s=this.getLocalEvt(t),!s)return console.log("ERROR in changeEvtTime STILL NOT found?!?",e,t,i,l),!1;n=s.time}else return console.log("ERROR in changeEvtTime not found, not adding!",t,i,l),!1;let a=(d,u)=>{if(console.log(`changeEventTime::DoUpdateEvt:: ${u?"DOADD":"NOAdd"} (${d.id})'${d.title.trim()}' from ${n} to ${i.time} 
        
canMove:${d==null?void 0:d.canMove}, inDef:${d==null?void 0:d.inDefaults},skip? ${o}`),u){let p=this.addPropsEventsTo(this.currentDate,[{...d,time:i.time}]);this.addEvtPropsIntoSchedule(p[0]),this.showDefaultBtn(this.isViewingPast());return}this.updateEvtInScheduleMaps(t,i),d.time=i.time,this.updatedEvtDetails(d)},r=(d,u)=>{if(console.log(`changeEventTime::KeepAsIs (${t})'${d.title.trim()}' to ${n} with ${u?"DOADD":"NOAdd"}`,i.time,"canMove:"+(d==null?void 0:d.canMove),"inDef:"+(d==null?void 0:d.inDefaults),"skip?"+o),u){if(n==""){this.doNotify(`'${d.title.trim()}' have unset default time! Not adding...`);return}let p=this.addPropsEventsTo(this.currentDate,[{...d,time:n}]);console.log("KeepAsIs::doAddy afterProps",JSON.parse(JSON.stringify(p))),this.addEvtPropsIntoSchedule(p[0]),this.showDefaultBtn(this.isViewingPast());return}else this.updateEvtInScheduleMaps(t,n),d.time=n,this.updatedEvtDetails(d),console.log("changeEventTime::keepAsIs:: !NOT! doAdd afterProps..",t,d.id)},c=(d,u,p)=>(console.log(`changeEvtTime::userChoice ${d} >> ${u.id} to ${i.time}...`),d=="ok"&&this.doSaveEvtProp(t,i.time,null),a(u,p),d);if((s==null?void 0:s.inDefaults)||!(s!=null&&s.canMove))if(o)a(s,l);else{if(n==i.time){console.log(`SAME TIME (${s.id})'${s.title.trim()}'..ASKIN with doAdd? ${l} for updateEvt...`,n,i.time),l&&a(s,l);return}let u=[`Evt "${s.title.trim()}" by default at ${this.whenFrmtTime(n)}.
\u2800
`,`Also Change default time to ${this.whenFrmtTime(i.time)}? 
\u2800
`,`Cancel or Dismiss to undo!
\u2800
`,`
\u2800
`,`No selection to schedule at default ${this.whenFrmtTime(n)}`].join(`
`);this.confirmTimeChange("Default Time Change!",u,"Change",`Temp.${l?"Add":"Move"}`,function(p){c(p,s,l)},function(){console.log(`changeEventTime::onCancel...>doing nothing for ${s.id})'${s.title.trim()}'`,l)},function(){r(s,l)})}else if(s!=null&&s.canMove)a(s,l);else{if(n==i.time){console.log(`SAME TIME! BEWARE~~ (${s.id})'${s.title.trim()}'...doAdd?${l}..skipAsk?:${o}..returning!!`,n);return}let u=[`Evt "${s.title.trim()}" Aint move from ${this.whenFrmtTime(n)}.
\u2800
`,`
\u2800
`,`Also Move time to ${this.whenFrmtTime(i.time)}? 
\u2800
`,`
\u2800
`,`Cancel or Dismiss to undo!
\u2800
`,`
\u2800
`,`No selection to add at default ${this.whenFrmtTime(n)}`].join(`
`);this.confirmTimeChange("Moving Evt's time",u,"Change",`Temp.${l?"Add":"Move"}`,function(p){c(p,s,l)},function(){console.log(`changeEventTime::onCancel..>doing nothing for ${s.id})'${s.title.trim()}'`,l)},function(){console.log(`changeEventTime::onDismiss..keep as is>> ${s.id})'${s.title.trim()}'`,l),r(s,l)})}},recurChangeTime(t,i,o,l=!1,s=!1){let n=this.dailyScheduled.get(t);if(n){let a=J(n.start.time)-J(o.time),r=`${a>0?"DOWN":"UP"}`,c=null;if(a>=0){c=N(o,{minute:parseInt(i.duration)+10});let p=N(o,{minute:parseInt(n.for)+10});console.log(`recurChangeTime::${t}...FORWARD ${r} for ${a} due to evt:${i.id} at ${o.time} 
        
 doAdd?:${s}, skipAsk:${l} > New>`,JSON.parse(JSON.stringify(c.time)),"alt:",p.time);let y=K(p,c);y>0&&(Math.floor(y/1e3/60)<=a?console.log(`recurChangeTime::${t}....with duration:${n.for} vs evtDura:${i.duration}...NOT using alternative!!`):(console.log(`recurChangeTime::DIFFY>>${y}...gonna use Alternative`,p.time),c=p))}else{c=N(o,{minute:-(parseInt(n.for)+10)});let p=N(o,{minute:-(parseInt(i.duration)+10)}),y=K(p,c);console.log(`recurChangeTime::${t}...BACKWARD ${r} for ${a} due to evt:${i.id} at ${o.time}
        
 doAdd?:${s}, skipAsk:${l} > New`,c.time,"alt:"+p.time,"diffy="+y)}let d=this.hasOverlappingEvent(t,c,n.for);if(d.length>0){let p=0,y=d.length,E=this.getScheduledEvent(t);E?this.doNotify(`Cascading time change while adding '${E==null?void 0:E.title.trim()}' due to "${i.title.trim()}"`,"warning","top"):console.log(`ERROR::recurChangeTime ${t} not found`);do{if(console.log(`WARNING CASCADING timeChange ${t}-${E==null?void 0:E.title} at: ${c.time} 'gon recurChangeTime::
          OLDie doAdd?:${s}, OLDie skipAsk:${l}..gon be true 
 now at: ${n.start.time}  till ${n.end.time}`,d[p]),d[p].inConflict==i.id){console.log(`EUUUH...::recurChangeTime::self overlap?!?${t} ...breaking!`,d[p]);break}this.scrollToTime(c),this.recurChangeTime(d[p].inConflict,E,c,!0)}while(++p<y)}this.changeEvtTime(t,c,l),console.log(`recurChangeTime::OVERLAPPED: ${t} ${r} to ${c.time} ...skipAsk:${l} >> doAdd:${s}`);let u=o;console.log(`recurChangeTime::TARGET:(${i.id})${i==null?void 0:i.title.trim()} going ${r} skipAsk:${l} >> doAdd:${s} to time>> ${u.time}`),this.changeEvtTime(i.id,u,l,s)}else console.log("ERROR..ERROR recurChangeTime:: overlapped event not found!",t)},fixyOverlaps(t,i=null,o=""){var v;const l=(m,f)=>{if(m!=null&&m.parentGoal){let h=this.parentGoalsMap().get(m.parentGoal);return f?`Of '${h==null?void 0:h.title.trim()}' with Prio(${h==null?void 0:h.priority})`:`Of '${h==null?void 0:h.title.trim()}'`}return console.log("prioLabel..ERROR no PARENT found?",m),""},s=(m,f)=>{switch(f){case"score":return`${l(m,!1)} > "${m.title.trim()}" with Score:: ${m.score} = ${this.parseScore(m.score)}`;case"prio":return`"${m.title.trim()}" ${l(m,!0)}`;default:return`"${m.title.trim()}" ${l(m,!0)} && Score:: ${m.score}`}},n=m=>{this.doNotify(m,"positive","top")},a=m=>{this.usingMoods[m]?(delete this.usingMoods[m],console.log("fixyOverlaps::updateMoodLabel>>..."+m,this.scheduleMoodsLabel)):console.log("fixyOverlaps::updateMoodLabel>>NO mood by "+m,o)},r=m=>{console.log(`fixyOverlaps::doRem ${m.id}:${m.title}`),a(m.id),this.doRemove(m)},c=(m,f,h)=>{if(console.log(`fixyOverlaps::removeReplace >> replacing>> ${m.id}) '${m.title.trim()}' WITH ${f.id}) ${f.title.trim()}`,h,"from>"+o),f=this.addPropsEventsTo(h.targetStart.date,[{...f,time:h.targetStart.time}]),i){if(console.log("fixyOverlaps::removeReplace...OVERRIDE from>>"+o),o=="onDrop"){r(m);return}console.log("fixyOverlaps::removeReplace....OVERRIDE updating..."+o),this.updateEvtInScheduleMaps(f[0].id,h.targetStart),console.log("fixyOverlaps",this.startTimesSet,this.endTimesSet,JSON.parse(JSON.stringify(this.scheduledEvents)));return}r(m);let S=this.overlapCheckEvtsAdd(f),g=Object.keys(S).length;if(g>0)return console.log(`${o}>fixyOverlaps::removeReplace:: OVERLAPS again from adding ${f.length} overlaps =${g}`,f,JSON.parse(JSON.stringify(S))),this.doNotify(`Extra Overlaps while adding ${f[0].title.trim()}`,"warning","top"),this.fixyOverlaps(S,i,o+"nah");let O=this.updateCurrentSchedule();O.size>0&&(console.log("fixyOverlaps::removeReplace::SameStart?!?",O),this.fixSameStart(O))},d=(m,f,h)=>{const S=N(x(this.currentDate),{minute:J(m.time)});if(console.log(`from:${o}--forceAdd: ${f.id})'${f.title}' at ${f.time}.
        
Changing >>${m.id} from ${m.time} `,h.targetStart.time),console.log(h,S),h.direction!=="surrounding")this.recurChangeTime(m.id,f,h.targetStart,!0,!0);else{console.log("fixyOverlaps::forceAdd: gonna overlapCheckEvtsAdd...."),f=this.addPropsEventsTo(h.targetStart.date,[{...f,time:h.targetStart.time}]);let O=this.overlapCheckEvtsAdd(f),C=Object.keys(O).length;if(C>0)return console.log(`from:${o}>fixyOverlaps::forceAdd:: OVERLAPS again of size:${C} from > `+f[0].title,JSON.parse(JSON.stringify(O))),this.doNotify(`Extra Overlaps while adding '${f[0].title.trim()}' `,"warning","top"),this.fixyOverlaps(O,i,o+"nah")}let g=this.updateCurrentSchedule();g.size>0&&(console.log("fixyOverlaps::forceAdd::SameStart?!?",g),this.fixSameStart(g)),this.disableSaveSchedule=!1,this.showDefaultBtn(this.isViewingPast())};let u=(m,f,h,S,g)=>{E.push(f),f==h.id?(c(S,h,g),n(`by ${m}, Scheduling '${h.title.trim()}'`)):(console.log(`by ${m},chose scheduled ${f} ...with override?`,i,o),n(`by ${m}, Keeping scheduled '${S.title.trim()}'`),o.indexOf("byMood")>-1&&a(h.id),i&&r(h))},p=(m,f)=>{if(i){if(console.log("fixyOverlaps::cancelChoice::OVERRIDE...coolios!!from:"+o,m.title.trim()),o=="onDrop"){n("Umm...not moving then...."),this.disableSaveSchedule=!0,this.showReloadBtn=!1,this.showClearBtn=!1;return}r(m),n(`Keeping scheduled '${f.title.trim()}'`);return}o.indexOf("byMood")>-1&&(console.log("fixyOverlaps::cancelChoice::moody? from: "+o,m.title.trim()),a(m.id)),n(`Keeping scheduled '${f.title.trim()}'`)},y=m=>{console.log(m,"from>>"+o,this.scheduledEvents.length),this.showDefaultBtn(this.isViewingPast())},E=[],D=Object.keys(t).length;const T=(m,f,h,S)=>{if(m=="opt3"){let g="Pick one event...",O=[{label:s(f,"def"),value:f.id,color:"secondary"},{label:s(h,"def"),value:h.id}];this.radioChoiceDialog("",g,O,"",function(C){u("Event",C,f,h,S)},null,function(){y("fixyOverlaps::resolveChoice opt3>> by Event... dismissing")})}else if(m=="opt2"){let g="Pick event by Score",O=[{label:s(f,"score"),value:f.id,color:"secondary"},{label:s(h,"score"),value:h.id}];this.radioChoiceDialog("",g,O,"",function(C){u("Score",C,f,h,S)},null,function(){y("fixyOverlaps::resolveChoice opt2>> by Score... dismissing")})}else if(m=="opt1"){let g="Pick event by Priority",O=[{label:s(f,"prio"),value:f.id,color:"secondary"},{label:s(h,"prio"),value:h.id}];this.radioChoiceDialog("",g,O,"",function(C){u("Priority",C,f,h,S)},null,function(){y("fixyOverlaps::resolveChoice opt1>> by Priority... dismissing")})}else m=="opt0"?(console.log("resolveChoice::it's a dropppp...keeping as is...."),p(f,h)):d(h,f,S)},w=(m,f,h,S,g)=>{S.direction!=="surrounding"&&!g?o.indexOf("nah")>-1?console.log("fixyOverlaps::manualSolve NOT adding Force as from "+o):m.push({label:`Force in '${f.title.trim()}'`,value:"opt4"}):console.log("fixyOverlaps::manualSolve NO force option...direction!==surrounding?",S.direction!=="surrounding","autoSolve?: "+g,o);let O=` '${f.title.trim()}' Overlaps with Scheduled '${h.title.trim()}'.
        
Cancel to keep '${h.title.trim()}' at ${this.whenFrmtTime(h==null?void 0:h.time)}`;this.radioChoiceDialog("Resolve Overlapping Events",O,m,"opt1",function(C){T(C,f,h,S)},function(){console.log("fixyOverlaps::manualSolve::cancelChoice>> from: "+o,E),p(f,h)},function(){console.log("fixyOverlaps::onDismiss >"+o,E)})};for(let m in t){if(!t[m]||!t[m][0]){console.log("fixyOverlaps...unknown key found",m);continue}let f=[{label:"Choose one event",value:"opt3"}];o=="reloadScore"?f.unshift({label:"Choose by Priority",value:"opt1",color:"secondary"}):o=="findSamePrio"?f.unshift({label:"Choose by Score",value:"opt2"}):o=="onDrop"?f.unshift({label:"Leave as is!",value:"opt0"},{label:"Choose by Priority",value:"opt1",color:"secondary"},{label:"Choose by Score",value:"opt2"}):f.unshift({label:"Choose by Priority",value:"opt1",color:"secondary"},{label:"Choose by Score",value:"opt2"});let h=t[m];if(h.length>1){console.log("fixyOverlaps::WOAH WOAH...multiple overlaps!!"),"withID"in t?this.fixMultiConflicts(h,i,o):this.multiConflicts(h,i,o);continue}const S=h.pop();let g=this.getLocalEvt(S.target),O=this.getScheduledEvent(S.inConflict);if(!O||!g){console.log("fixyOverlaps...ERROR ERROR no evts found!!!",S);return}console.log(`fixyOverlaps::adding ${g.id}:${g.title.trim()}(${g.time})++${g.duration} AT >> ${(v=S==null?void 0:S.targetStart)==null?void 0:v.time} -- ${S.direction} 
      Overlap with ${O.id}:${O.title.trim()}(${O.time})++${O.duration}`,i,"from:"+o,"toHandle="+D);let C=g.title.trim().includes(O.title.trim()),_=O.title.trim().includes(g.title.trim()),se=this.parentGoalsMap().get(g.parentGoal),F=this.parentGoalsMap().get(O.parentGoal),j=g.title.trim().includes(F.title.trim()),ee=O.title.trim().includes(se.title.trim());(j||ee)&&console.log("fixyOverlaps:: WOAH PARENT AUTO schedule",j,ee,"Normal AUTO>>",C,_,"direction == surrounding? >>",S.direction=="surrounding"),C||_?(console.log("fixyOverlaps:: can AUTO schedule",C,_,"direction == surrounding? >>",S.direction=="surrounding"),this.scrollToTime(S==null?void 0:S.targetStart,"slow"),this.confirmAction(`"${g.title.trim()}" related to Scheduled "${O.title.trim()}".
        
Auto resolve Overlap?
        
Cancel/Dismiss for manual resolution.`,"Auto",function(){var le;if(C){console.log("auto schedule with removeReplace..with ORIG TIMES>>",g.time,O.time,(le=S==null?void 0:S.targetStart)==null?void 0:le.time),c(O,g,S),n(`Scheduling Evt '${g.title.trim()}'`);return}else{console.log("auto schedule with cancelChoice >> from: ",o),p(g,O);return}},function(){console.log("Cancelling Auto-Solve...doing manual"),w(f,g,O,S,!0)})):w(f,g,O,S,!1)}},multiConflicts(t,i=null,o=""){var f;let l="",s=[],n=null,a=[],r=null,c=new Map,d=new Map,u=[{label:"Pick one event",value:"opt3"}];const p=h=>{let S=this.parentGoalsMap().get(h.parentGoal);return{label:`Of '${S==null?void 0:S.title.trim()}' "${h.title.trim()}" (${h.score}) for ${h==null?void 0:h.duration} mins`,value:h.id}},y=h=>{let S=0,g=null;for(let O of h)if(O.parentGoal){let C=this.parentGoalsMap().get(O.parentGoal);C?C.priority>S&&(S=C.priority,g=O):console.log("multiConflicts::findhighestPrio..ERROR no PARENT found?",O)}else console.log("multiConflicts::findhighestPrio..ERROR EVT not found?",O);return d.set(g.id,`By highest priority (${S}),`),g};let E=h=>{let S=0,g=null;for(let O of h){let C=this.parseScore(O.score);C>-1&&C>=S&&(S=C,g=O)}if(g)return console.log("multiConflicts::Largest Score interval",g.id,g==null?void 0:g.title.trim(),g.score),g;console.log("ERROR ERROR multiConflicts::highestScore...no current set?",S,g,h)},D=(h,S)=>{console.log(`multiConflicts::removeConflicts with toKeep=${h.length} out of total:${S.length}`);let g=[];if(S.forEach((C,_,se)=>{if(h.find(F=>F.id==C.id)){let F=d.has(C.id)?d.get(C.id):"";if(console.log("multiConflicts::removeConflicts:KEEEP..TIME? by>"+F,C.id,C==null?void 0:C.title.trim(),C==null?void 0:C.time,r),C.id!=n.id){let j=this.addPropsEventsTo(this.currentDate,[{...C,time:r}]),ee=this.overlapCheckEvtsAdd(j);if(Object.keys(ee).length>0)g.push(ee);else{console.log("multiConflicts::removeConflicts--no other overlap",C==null?void 0:C.title.trim());let le=`${F} Adding '${C==null?void 0:C.title.trim()}' at ${this.whenFrmtTime(r)}`;this.doNotify(le,"positive","top")}}else console.log("multiConflicts::removeConflicts...already scheduled!!",C==null?void 0:C.title.trim()),this.doNotify(`${F} Keeping scheduled '${C==null?void 0:C.title.trim()}' `,"positive","top")}else C.id==n.id&&(console.log("multiConflicts::removeConflicts...removing scheduled!!",C.id,C.title),this.usingMoods[C.id]&&(delete this.usingMoods[C.id],console.log("multiConflicts::removeConflicts>>deleting Moody..."+C.id,this.scheduleMoodsLabel)),this.doRemove(C))}),g.length>0)return console.log(`${o}>multiConflicts::removeConflicts:: OVERLAPS again from ${h.length} overlaps =${g.length}`,g),this.doNotify("More Overlaps to fix!!!","warning","top"),this.fixyOverlaps(g[0],i,o+"nah");let O=this.updateCurrentSchedule();O.size>0&&(console.log("multiConflicts::removeConflicts::SAMESTART!!",O),this.fixSameStart(O))},T=h=>{this.radioChoiceDialog("","Choose the event to schedule",h.map(p),"",function(S){let g=h.find(O=>O.id==S);if(g)a.push(g),d.set(g.id,"By pick,");else{console.log("chooseEvt::ERROR NOT FOUND!!",S);return}return console.log(`chooseEvt::onOk >>${S} >> ${g==null?void 0:g.title.trim()}`),g},null,function(){a.length>0&&(console.log("chooseEvt::LAST LAST?",JSON.parse(JSON.stringify(a))),setTimeout(()=>{D(a,h)},0))})};const w=h=>{h.forEach(g=>{if(n.id==g.id)console.log("multiConflicts::forceAdd...SKIP scheduled",n.title);else{let O=c.has(g.id)?c.get(g.id):null;console.log(`multiConflicts::forceAdd...NEW:${g.id} '${g.title.trim()}' origAt: ${g.time}`,O.time),this.recurChangeTime(n.id,g,O,!0,!0)}});let S=this.updateCurrentSchedule();console.log("multiConflicts::forceAdd::DONE >>"+h.length+" addySize="+c.size,S,this.dailyScheduled),S.size>0&&this.fixSameStart(S)};o=="reloadScore"?u.unshift({label:"Resolve by Highest Priority",value:"opt1",color:"secondary"}):o=="findSamePrio"?u.unshift({label:"Resolve by Largest Score Interval (low Score)",value:"opt2"}):u.unshift({label:"Resolve by Highest Priority",value:"opt1",color:"secondary"},{label:"Resolve by Largest Score Interval (low Score)",value:"opt2"});let v=!1;for(let h of t){console.log("multiConflicts....handling:>",JSON.parse(JSON.stringify(h)));let S=this.getScheduledEvent(h.inConflict);if(!S){console.log("multiConflicts...ERROR ERROR no evts found!!!",h);return}n?n.id!=S.id&&console.log("multiConflicts...ERROR Not same inConflict",n.id,S.id):(n=S,r=(f=h==null?void 0:h.targetStart)==null?void 0:f.time);let g=this.getLocalEvt(h.target);if(!g){console.log("multiConflicts...ERROR ERROR local evt not found!!!",h);return}l+=` '${g==null?void 0:g.title.trim()}',`,s.push(g),c.set(h.target,h==null?void 0:h.targetStart),h.direction=="surrounding"?v=!0:v=v}v||u.push({label:"Force Schedule them in",value:"opt4"});let m=`${l} conflicts with scheduled '${n==null?void 0:n.title.trim()}' at ${this.whenFrmtTime(n==null?void 0:n.time)}.
    
Choose how to solve this...`;s.unshift(n),this.radioChoiceDialog("Overlap warning!!",m,u,"",function(h){if(h=="opt3")T(s);else if(h=="opt2"){let S=E(s);console.log("multiConflicts::ByScore",S.id,S==null?void 0:S.title.trim(),S.score),a.push(S),d.set(S.id,`By largest score interval (${S.score}),`)}else if(h=="opt1"){let S=y(s);console.log("multiConflicts::ByPriority",S.id,S==null?void 0:S.title.trim()),a.push(S)}else w(s)},null,function(){a.length>0&&(console.log("multiConflicts::MAIN LAST LAST?",a),setTimeout(()=>{D(a,s)},0))})},fixMultiConflicts(t,i=null,o=""){var v;let l="",s=null,n=[],a=[],r=new Map,c=null,d=[{label:"Pick one event",value:"opt3"}];const u=m=>{let f=this.parentGoalsMap().get(m.parentGoal);return{label:`Of '${f==null?void 0:f.title.trim()}' "${m.title.trim()}" (${m.score}) for ${m==null?void 0:m.duration} mins`,value:m.id}},p=m=>{let f=0,h=null;for(let S of m)if(S.parentGoal){let g=this.parentGoalsMap().get(S.parentGoal);g?g.priority>f&&(f=g.priority,h=S):console.log("fixMultiConflicts::findhighestPrio..ERROR no PARENT found?",S)}else console.log("fixMultiConflicts::findhighestPrio..ERROR EVT not found?",S);return r.set(h.id,`By highest priority (${f}),`),h};let y=m=>{let f=0,h=null;for(let S of m){let g=this.parseScore(S.score);g>-1&&g>=f&&(f=g,h=S)}if(h)return console.log("fixMultiConflicts::Largest score interval",h.id,h==null?void 0:h.title.trim(),h.score),h;console.log("ERROR ERROR fixMultiConflicts::highestScoreInterval...no current?",f,h,m)},E=(m,f)=>{let h=[];if(f.forEach((g,O,C)=>{if(m.find(_=>_.id==g.id))if(g.id==s.id)if(console.log("fixMultiConflicts::removeConflicts:inKeep toAdd at >"+c.time,g.id,g==null?void 0:g.title.trim(),g==null?void 0:g.time),o=="onDrop")console.log("removeConflicts...NOTHING to do as from"+o);else{let _=this.addPropsEventsTo(this.currentDate,[{...g,time:c.time}]),se=r.has(g.id)?r.get(g.id):"",F=this.overlapCheckEvtsAdd(_);if(Object.keys(F).length>0)h.push(F);else{console.log("fixMultiConflicts::removeConflicts--no other overlap adding",g==null?void 0:g.title.trim());let j=`${se} Adding '${g==null?void 0:g.title.trim()}' at ${this.whenFrmtTime(c.time)}`;this.doNotify(j,"positive","top")}}else{console.log("fixMultiConflicts::removeConflicts....Keeping scheduled Evt!!",c,g.id);let _=`${r.has(g.id)?r.get(g.id):""} Keeping scheduled '${g==null?void 0:g.title.trim()}'`;this.doNotify(_,"positive","top")}else g.id!=s.id?(console.log("fixMultiConflicts::removing scheduled...doNotify?",g.id,g.title,g.time),this.usingMoods[g.id]&&(delete this.usingMoods[g.id],console.log("fixMultiConflicts::removeConflicts>>deleting Moody..."+g.id,this.scheduleMoodsLabel)),this.doRemove(g)):console.log("fixMultiConflicts::NOT adding original target",s.id)}),h.length>0)return console.log(`${o}> fixMultiConflicts::removeConflict:: OVERLAPS again=${h.length}`,h),this.doNotify("More Overlaps to fix!!!","warning","top"),this.fixyOverlaps(h[0],i,o+"nah");let S=this.updateCurrentSchedule();S.size>0&&(console.log("fixMultiConflicts::removeConflicts::SAMESTART",S),this.fixSameStart(S))};const D=(m,f)=>{console.log(`At ${f.date}:${f.time} forceAdding:${m.id} ${m.title} from ${m.time} >>`+o,JSON.parse(JSON.stringify(s)),n.length,n[n.length-1]);let h=this.addPropsEventsTo(f.date,[{...m,time:f.time}]),S=this.overlapCheckEvtsAdd(h),g=Object.keys(S).length;if(g>0)return console.log(`${o} >fixMultiConflicts::forceAdd:: OVERLAPS again from ${s.length} overlaps =${g}`,JSON.parse(JSON.stringify(S))),this.doNotify(`Extra Overlaps while adding '${h[0].title.trim()}'`,"warning","top"),this.fixyOverlaps(S,i,o+"nah")};let T=m=>{this.radioChoiceDialog("","Choose the event to schedule",m.map(u),"",function(f){let h=m.find(S=>S.id==f);if(h)a.push(h),r.set(h.id,"By pick,");else{console.log("chooseEvt::ERROR NOT FOUND!!",f);return}return console.log(`chooseEvt::onOk >>${f} >> ${h==null?void 0:h.title.trim()}`),h},null,function(){a.length>0&&(console.log("chooseEvt::gon removeConflicts out of total="+m.length,JSON.parse(JSON.stringify(a))),setTimeout(()=>{E(a,m)},0))})};o=="reloadScore"?d.unshift({label:"Resolve by Highest Priority",value:"opt1",color:"secondary"}):o=="findSamePrio"?d.unshift({label:"Resolve by Largest Score Interval (low Score)",value:"opt2"}):d.unshift({label:"Resolve by Highest Priority",value:"opt1",color:"secondary"},{label:"Resolve by Largest Score Interval (low Score)",value:"opt2"});for(let m of t){console.log("fixMultiConflicts....handling:>",JSON.parse(JSON.stringify(m)));let f=this.getScheduledEvent(m.inConflict);if(!f){console.log("fixMultiConflicts...ERROR ERROR no evts found!!!",m);return}n.push(f),l+=` '${f==null?void 0:f.title.trim()}',`,c?c.time!=((v=m==null?void 0:m.targetStart)==null?void 0:v.time)&&console.log("fixMultiConflicts...ERROR Not same targetStart?!?",c,m==null?void 0:m.targetStart,m.direction):c=m==null?void 0:m.targetStart;let h=this.getLocalEvt(m.target);if(!h){console.log("fixMultiConflicts...ERROR ERROR local evt not found!!!",m);return}s=h,m.direction!=="surrounding"&&d.length<3&&d.push({label:`Force in '${s.title.trim()}'`,value:"opt4"})}let w=`'${s==null?void 0:s.title.trim()}' conflicts with scheduled ${l} 

      Choose how to solve this...`;n.unshift(s),this.radioChoiceDialog("Overlap warning!!",w,d,"",function(m){if(m=="opt3")T(n);else if(m=="opt2"){let f=y(n);console.log("fixMultiConflicts::ByScore",f.id,f==null?void 0:f.title.trim(),f.score),a.push(f),r.set(f.id,`By largest score interval (${f.score}),`)}else if(m=="opt1"){let f=p(n);console.log("fixMultiConflicts::ByPriority",f.id,f==null?void 0:f.title.trim()),a.push(f)}else console.log("fixMultiConflicts::forceAdd..."),D(s,c)},null,function(){a.length>0&&(console.log("fixMultiConflicts::MAIN gon removeConflicts from total="+n.length,JSON.parse(JSON.stringify(a))),setTimeout(()=>{E(a,n)},0))})},fixSameStart(t){const i=r=>{let c=0,d=null;for(let u of r){let p=this.getScheduledEvent(u);if(p){let y=this.parentGoalsMap().get(p.parentGoal);y?y.priority>c&&(c=y.priority,d=p):console.log("findhighestPrio..ERROR no PARENT found?",p)}else console.log("findhighestPrio..ERROR EVT not found?",u)}return n.set(d.id,`By highest priority (${c}),`),d},o=r=>{let c=this.parentGoalsMap().get(r.parentGoal);return{label:`Of '${c==null?void 0:c.title.trim()}' "${r.title.trim()}" (${r.score}) for ${r==null?void 0:r.duration} mins`,value:r.id}};let l=[],s=new Set,n=new Map,a=[{label:"Resolve by Highest Priority",value:"opt1",color:"secondary"},{label:"Resolve by Largest Score Interval (low Score)",value:"opt2"},{label:"Pick event",value:"opt3"}];for(let r of t){let c=this.retrieveSameStart(r.at);console.log("fixSameStart:conflict",JSON.parse(JSON.stringify(r)),JSON.parse(JSON.stringify(c)));let d=[],u="";for(let w of c){let v=this.getScheduledEvent(w);v?(d.push(v),u+=` '${v==null?void 0:v.title.trim()}',`,s.has(v)?console.log(`Set already contain ${v.id}~${v.title}..skipping`):s.add(v)):console.log("fixSameStart...ERROR not found?",w)}let p=w=>{let v=this.getScheduledEvent(w);return v?(l.push(v),n.set(v.id,"By pick,"),v):(console.log("fixSameStart::onOk:: ERROR ERROR?!?! Not found",w),v=this.getLocalEvt(w),v?(l.push(v),n.set(v.id,"By pick,"),v):(console.log("fixSameStart::onOk:: ERROR ERROR..still not found!!!",w),!1))},y=()=>{let w=0,v=null;for(let m of d){let f=this.parseScore(m.score);f>-1&&f>=w&&(w=f,v=m)}if(v)return console.log("fixSameStart::highestScore",v.id,v==null?void 0:v.title.trim(),v.score),l.push(v),n.set(v.id,`By largest score interval (${v.score}),`),v;console.log("ERROR ERROR fixSameStart::highestScore..nothing set?",w,e)},E=()=>{this.radioChoiceDialog("","Choose the event to schedule",d.map(o),"",function(w){let v=p(w);return console.log(`fixSameStart--chooseEvt::onOk >>${w} >> ${v==null?void 0:v.title.trim()}`),v},null,function(){l.length==t.size&&(console.log("fixSameStart--chooseEvt::onDismiss...PICKLAST"+l.length,l),setTimeout(()=>{D(l,s)},0))})},D=(w,v)=>{v.forEach((f,h,S)=>{if(w.find(g=>g.id==f.id)){console.log("fixSameStart::removeConflicts:KEEEP",f.id,f==null?void 0:f.title.trim());let O=`${n.has(f.id)?n.get(f.id):""} Keeping '${f==null?void 0:f.title.trim()}' at ${this.whenFrmtTime(f==null?void 0:f.time)}`;this.doNotify(O,"positive","top")}else this.usingMoods[f.id]&&(delete this.usingMoods[f.id],console.log("fixSameStart::removeConflicts>>deleting Moody..."+f.id,this.scheduleMoodsLabel)),this.doRemove(f)});let m=this.updateCurrentSchedule();m.size>0&&(console.log("fixSameStart::removeConflicts::SAMESTART",m),this.fixSameStart(m)),this.disableSaveSchedule=!1},T=`${u} scheduled at same ${this.whenFrmtTime(r.at)}.

      Choose how to solve this...`;this.radioChoiceDialog("Same start time!!",T,a,"opt1",function(w){if(w=="opt3")E();else{if(w=="opt2")return y();{let v=i(c);l.push(v)}}},null,function(){l.length==t.size&&(console.log("fixSameStart::onDismiss Main with size="+l.length,"conflicts="+s.size),setTimeout(()=>{D(l,s)},0))})}return!0},showDefaultBtn(t){let i=this.allEvents.some(o=>(o==null?void 0:o.inDefaults)&&(o==null?void 0:o.time)!=""&&!this.scheduledEvents.find(l=>l.id==o.id));this.updateButtons(t?!1:i,!t,!t)},getEventsForDatey(t,i){let o=(a,r)=>{"byMood"in r&&(this.usingMoods[a]=r.byMood);let c={};return r.notes!==void 0&&(console.log("savedEvtFunc::NOTES",a,r.notes,r.atScore),c.notes=r.notes,c.atScore=r.atScore),c.id=parseInt(a),c.duration=r.duration,c.time=r.time,c},l=this.getEventsForDate(t);if(!l){console.log(`ERROR no evts found for today:${t} ?!?`,l);return}let s=Object.keys(l).map(a=>o(a,l[a])),n=this.addPropsEventsTo(t,s);return i?this.overlapCheckEvtsAdd(n):(this.scheduledEvents=n,this.updateCurrentSchedule())},loadForDate(t,i,o){if(this.scheduledEvents=[],this.usingMoods={},this.updateCurrentSchedule(),i)if(this.isViewingToday()){let l=this.getEventsForDatey(t,!0);if(Object.keys(l).length>0){console.log("Overlaps toHandle >>",JSON.parse(JSON.stringify(l))),Object.keys(l).length>0?this.doNotify(`${t} with Some overlaps to fix!`,"warning","bottom"):this.doNotify(`Loaded schedule for ${t}`,"positive","bottom"),this.fixyOverlaps(l),this.showReloadBtn=i,this.showClearBtn=i,this.disableSaveSchedule=!1,this.evtStartedOrPassed(q(new Date)),this.showDefaultBtn(o);return}this.evtStartedOrPassed(q(new Date)),this.disableSaveSchedule=!0,this.showReloadBtn=!1,this.showClearBtn=i}else{let l=this.getEventsForDatey(t,!1);l.size>0&&!o?(console.log(`doLoadNotPresent..SAMESTART inPast?${o} on ${t}`,l.size),this.doNotify(`${t} with conflicts to fix!`,"warning","bottom"),this.fixSameStart(l)):(this.showReloadBtn=!1,this.disableSaveSchedule=!0,this.doNotify(`Loaded schedule for ${o?"past":"future"}:: ${t}`,"positive","bottom")),this.allowScoreEdit(o),this.showClearBtn=!o}else this.showReloadBtn=!1,this.showClearBtn=!1,this.disableSaveSchedule=!0;(o||t!==z())&&this.adjustCurrentTime(),this.reset(),this.showDefaultBtn(o)},reset(){this.draggedItem=null,this.targetDrop=null,this.chosenScore=null,this.chosenPrio=null,this.possibleRange=null},deepCopy(t){if(t===null||typeof t!="object")return t;if(Array.isArray(t))return t.map(o=>this.deepCopy(o));const i={};for(let o in t)t.hasOwnProperty(o)&&(i[o]=this.deepCopy(t[o]));return i},onRefresh(t){setTimeout(()=>{this.scheduledEvents=[],this.updateCurrentSchedule(),this.resetGoalEvts(!0),this.loadForDate(this.currentDate,this.hasEventsForDate,this.isViewingPast()),t()},1e3)},doSaveSchedule(){let t={};this.dailyScheduled.size<1?t=null:this.dailyScheduled.forEach((i,o,l)=>{t[o]={time:i.start.time,duration:i.for},this.usingMoods[o]&&(t[o].byMood=this.usingMoods[o]),i.notes!==void 0&&(i==null?void 0:i.notes)!==""&&(console.log("doSaveSchedule",o,i==null?void 0:i.notes,t[o].atScore,i==null?void 0:i.score),t[o].atScore=i==null?void 0:i.score,t[o].notes=i==null?void 0:i.notes)}),this.store.saveDailySchedule(this.currentDate,t),this.disableSaveSchedule=!0,this.showReloadBtn=!1,this.showClearBtn=t!=null,this.doNotify(`Schedule saved for ${this.currentDate}`,"positive","top")},addParentGoal(t,i,o="red-14",l=2){let s=[];this.parentGoalsMap().forEach((r,c,d)=>{let u=r.bgcolor;s.push(u)});let n=et(),a=s.length;if(a>1){let r=a;for(;s.some(d=>n[r]==d);)console.log("addParentGoal::index with taken color...new random",r,n[r]),r=Math.floor(Math.random()*a);let c=n[r];o=c||o}return this.store.addMainGoal(t,i,o,l)},onAddHocEvent(t,i,o,l){if(this.possibleRange||(console.log("umm onAddHocEvent... not a range selection",this.startEndTimes),this.possibleRange=this.startEndTimes),t.trim()==""){this.doNotify("Empty Goal title..."),this.addEventDialog=!1,this.reset();return}let s=me(this.possibleRange[0]),n=l>15?N(s,{minute:parseInt(l)}):N(me(this.possibleRange[1]),{minute:15}),a=Math.floor(K(s,n)/1e3/60);console.log(`onAddHocEvent:${t} :${o}: from ${s.time} till ${n.time}.Duration:${a}`,l);let r=null;if(o=="self"){let c=this.addParentGoal(t,t,"purple-10",2);c?r=this.store.addSubGoal(c,t,"1on5",s.time,a,!0,!1,a<30):console.log("ERROR? no pID",c)}else if(i){console.log("with parentGoal "+i.id,i==null?void 0:i.title),r=this.store.addSubGoal(i.id,t,"1on5",s.time,a,!1,!1,a<30);//!canMove and notInDefaults. isAlternative when duration<30
}else{let c=this.store.getGoalByTitle("Misc");if(c){console.log("Woo!! Misc pGoal already exists!",c.id),r=this.store.addSubGoal(c.id,t,"1on5",s.time,a,!1,!1,a<30);//!canMove and notInDefaults.isAlternative when duration<30
}else{let d=this.addParentGoal("Misc","Miscellaneous","grey-10",2);d&&(console.log("NEW Misc pGoal created",d),r=this.store.addSubGoal(d,t,"1on5",s.time,a,!0,!1,a<30))}}if(r){this.resetGoalEvts(!0);let c=this.tooClose(s,a);if(c){console.log("onAddHocEvent::tooClose check FAIL!!",c),c===!0?this.doNotify(`'${t}' created But Not added as over midnight!`):this.doNotify(`'${t}' created But Not added as too close to a scheduled Evt!!`),this.addEventDialog=!1;return}let d=this.hasOverlappingEvent(r,s,a);if(d.length>0){let u={};for(let p=0;p<d.length;p++){let y=d[p];u[y==null?void 0:y.inConflict]?u[y==null?void 0:y.inConflict].push(y):u[y==null?void 0:y.inConflict]=[y],p>0&&(console.log(p+" WOAH WOAH,onAddHocEvent.. multiple overlaps with same target!",d[p].target),y.inConflict in u&&(console.log("WOAH deleting inConflict",y.inConflict),delete u[y.inConflict]),d[p-1].inConflict in u&&(console.log("WOAH deleting PREV inConflict",d[p-1].inConflict),delete u[d[p-1].inConflict]),u[y.target]?(u[y.target].push(y),console.log("WOAH obj.id already present?",y.target)):u[y.target]=[y],u[y.target].unshift(d[p-1]),u.withID=!0)}console.log("onAddHocEvent:: OVERLAPS >>",JSON.parse(JSON.stringify(u))),this.fixyOverlaps(u,null,"addNew")}else{let u=this.addPropsEventsTo(this.currentDate,[{id:r,time:s.time,title:t,score:"2on5",duration:a,canMove:!i}]);console.log(`onAddHocEvent, addEvtPropsIntoSchedule: ${r} at ${s.time}`),this.addEvtPropsIntoSchedule(u[0])}this.disableSaveSchedule=!1,this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!this.isViewingPast(),this.constructTree()}else console.log("BOO ERROR no subID:(",r),this.doNotify("Error creating and adding this event :(","negative");this.addEventDialog=!1},tooClose(t,i){let o=N(t,{minute:0}),l=this.getTimeNumber(o),s=N(t,{day:1}),n=new Date(s.date);n.setHours(24),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0);let a=q(n),r=Math.floor(K(o,a)/1e3/60);if(r<i)return console.log("tooClose to midnight eh...:(",r),!0;let c=!1;return this.dailyScheduled.forEach((d,u,p)=>{let E=this.getTimeNumber(d.start)-l,D=K(o,d.start);Math.floor(D/1e3/60)<=10&&E>0&&(c=u)}),c},onPickEvent(t,i,o){if(this.addEventDialog=!1,!t){console.log("onPickEvent...ERROR nothing!",t,i,o),this.doNotify("No Goal selected..."),this.reset();return}let l=()=>{if(this.isViewingPast()){console.log("onPickEvent...inPast auto saveSchedule"),this.doSaveSchedule(),this.disableSaveSchedule=!0;return}if(n>0){if(console.log("onPickEvent::saveSchedule..overlaps: "+n,"useBalance?"+o),o){let r=this.currentBalance,c=r+parseInt(s==null?void 0:s.duration);console.log("onPickEvent::saveSchedule...useBalance",r,c),this.doNotify("oooh What is Owed PAID!gg! >>"+c,"positive","right"),this.store.setBalance(c),this.doSaveSchedule(),this.disableSaveSchedule=!0}}else console.log("onPickEvent::saveSchedule...no overlaps so no auto-save!!",n,o),this.disableSaveSchedule=!1},s=null,n=0;if(s){console.log("onPickEvent...NOT NEW?!?ERROR!",s,t);return}else{s=t;let a=this.isViewingPast()?!0:i;console.log(`onPickEvent::(${s.id})'${s.title.trim()}' from ${s.time} to ${this.targetDrop.timestamp.time} with force?${i} BUT Forcing?:${a}`);let r=this.tooClose(this.targetDrop.timestamp,s.duration);if(r){if(console.log("onPickEvent::tooClose check FAIL!",r),r===!0){this.doNotify("Picking event TOO close to midnight!"),this.reset();return}if(a)this.doNotify(`'${s.title.trim()}' TOO close to a scheduled Evt Buuut..FORCING!`);else{this.doNotify(`'${s.title.trim()}' Not added as TOO close to a scheduled Evt`),this.reset();return}}let c=this.hasOverlappingEvent(s.id,this.targetDrop.timestamp,s.duration);if(n=c.length,n>0){let d={};for(let u=0;u<n;u++){let p=c[u];d[p==null?void 0:p.inConflict]?d[p==null?void 0:p.inConflict].push(p):d[p==null?void 0:p.inConflict]=[p],u>0&&(console.log(u+" WOAH WOAH,onPickEvent.. multiple overlaps with same target?",c[u].target),p.inConflict in d&&(console.log("WOAH deleting inConflict",p.inConflict),delete d[p.inConflict]),c[u-1].inConflict in d&&(console.log("WOAH deleting PREV inConflict",c[u-1].inConflict),delete d[c[u-1].inConflict]),d[p.target]?(d[p.target].push(p),console.log("WOAH obj.id already present?",p.target)):d[p.target]=[p],d[p.target].unshift(c[u-1]),d.withID=!0)}console.log(`onPickEvent::OVERLAPS of size: ${n} and force:${a}`,JSON.parse(JSON.stringify(d))),this.fixyOverlaps(d,null,"onPickEvt")}else{if(o){let d=this.currentBalance,u=d+parseInt(s==null?void 0:s.duration);console.log("onPickEvent...useBalance",d,u),this.doNotify("oooh What is Owed PAID!gg! >>"+u,"positive","center"),this.store.setBalance(u)}this.changeEvtTime(s.id,this.targetDrop.timestamp,a,!0)}}setTimeout(l,n>0?5e3:0),this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!this.isViewingPast()},closingDialog(){this.addEventDialog=!1,this.reset()},onEndNow(t){const i=q(new Date);let o=this.hasEventsForDate;if(this.dailyScheduled.has(t)){let l=this.dailyScheduled.get(t),s=l.start,n=l.end;if(re(i,s,n,!0)){let a=this.getTimeNumber(n)-this.getTimeNumber(s),r=this.getTimeNumber(i)-this.getTimeNumber(s);console.log(`onEndNow::${t}`,s.time,n.time,r);const c=()=>{console.log(`Great, ${t} REDUCING duration from ${a} to:`,r);for(let u=0;u<this.scheduledEvents.length;u++){let p=this.scheduledEvents[u];p.id===t&&(p.duration=r)}this.dailyScheduled.set(t,{...l,for:r,end:i}),this.endTimesSet.delete(n.time)||console.log("ERROR endTimesSet item does not exist?!?",l,this.endTimesSet),this.endTimesSet.add(i.time),this.disabledScoreEvts[t]=!1,this.doSaveSchedule(),this.disableSaveSchedule=!0,this.showReloadBtn=o,this.showClearBtn=!this.isViewingPast&&this.scheduledEvents.length>0},d=()=>{console.log("onEndNow::removing and saving!"),this.doRemove(this.getLocalEvt(t)),this.doSaveSchedule()};r<10?(console.log(`onEndNow:: ${r} less than 10 mins...REMOVE?`),this.confirmAction(`Less than 10mins remove?
 Cancel to just EndNow`,"OK",d,c)):c()}else console.log("umm aint in the middle of this event! Nothing to do...ERROR?",i.time,s.time,n.time)}else{console.log("ERROR doEndNow not found!!!",t);return}},onSaveScore(t,i,o=""){let l=this.dailyScheduled.get(i);if(l){if(this.parseScore(t)<-1){this.doNotify("Score Error: higher# on lower#");return}this.doSaveEvtProp(i,null,t);let n=this.getScheduledEvent(i),a=null;n?(a=n.score,n.score=t):console.log("onSaveScore ERROR not found",n,i),o!==""&&(console.log(`onSaveScore ${i}from ${a} to ${t} with note>>`,o),l.score=a||t,l.notes=o,this.doSaveSchedule())}else console.log(`ERROR onSaveScore could not find event ${i}?!?`)},onAddMins(t,i){if(this.dailyScheduled.has(t)){let o=this.dailyScheduled.get(t),l=o.end,s=N(l,{minute:parseInt(i)}),n=parseInt(i)+o.for;console.log(`onAddMins::${t} add ${i} from ${o.for} to> ${n}`,l.time,s.time);let a=this.hasOverlappingEvent(t,o.start,n);if(a.length>0){console.log("onAddMins::huh some OVERLAPS",a);let r={};for(let c=0;c<a.length;c++){let d=a[c];r[d==null?void 0:d.inConflict]?r[d==null?void 0:d.inConflict].push(d):r[d==null?void 0:d.inConflict]=[d],c>0&&(console.log(c+" WOAH WOAH,onAddMins..ERROR?!? multiple overlaps with same target?",a[c].target),d.inConflict in r&&(console.log("WOAH deleting inConflict",d.inConflict),delete r[d.inConflict]),a[c-1].inConflict in r&&(console.log("WOAH deleting PREV inConflict",a[c-1].inConflict),delete r[a[c-1].inConflict]),r[d.target]?(r[d.target].push(d),console.log("WOAH obj.id already present?",d.target)):r[d.target]=[d],r[d.target].unshift(a[c-1]),r.withID=!0)}console.log("onAddMins:: OVERLAPS >>",JSON.parse(JSON.stringify(r))),this.fixyOverlaps(r,null,"addMins")}else{for(let r=0;r<this.scheduledEvents.length;r++){let c=this.scheduledEvents[r];c.id===t&&(c.duration=n)}this.dailyScheduled.set(t,{...o,for:n,end:s}),this.endTimesSet.delete(l.time)||console.log("ERROR endTimesSet item does not exist?!?",o,this.endTimesSet),this.endTimesSet.add(s.time),this.doSaveSchedule()}}else{console.log("ERROR onAddMins EVT not found!!!",t);return}},onClearDay(){if(this.isViewingPast()){this.doNotify("Editing past is no no!");return}let t=this.hasEventsForDate;this.scheduledEvents=[],this.updateCurrentSchedule(),this.resetGoalEvts(!0);let i=t?"Cleared...Can still reload saved":"Cleared daily schedule";this.doNotify(i,"warning","top"),this.reset(),this.showReloadBtn=t,this.showLoadDefaults=!0,this.showClearBtn=!1,this.disableSaveSchedule=!t},onReloadSaved(){let t=this.hasEventsForDate,i=()=>{console.log("Aborting",this.currentDate,this.scheduledEvents,t),this.showReloadBtn=!this.isViewingPast()||t},o=()=>{this.scheduledEvents=[],this.updateCurrentSchedule(),this.loadForDate(this.currentDate,t,this.isViewingPast()),this.reset()};if(this.scheduledEvents.length>0&&!this.isViewingPast()){let l=t?"Reload? saved schedule of: "+this.currentDate:"Overwrite current Evts?";this.confirmAction(l,"OK",o,i)}else o();this.showReloadBtn=!1,this.showClearBtn=!this.isViewingPast()},onMoodAdd(){console.log("onMoodAdd>>>",this.filterString);let t=[];const i=this.filter.map(o=>o.toLowerCase());this.treeGoals.filter(o=>{if(o.children.length>0)return o.children.find(l=>{if((l==null?void 0:l.moods.length)>0&&(l==null?void 0:l.moods.some(s=>i.indexOf(s.toLowerCase())>-1))){let s=l==null?void 0:l.moods.filter(n=>{if(i.indexOf(n.toLowerCase())>-1)return n});return t.push({id:l.id,mood:s}),l}})}),t.length>0?(t=t.filter(o=>!this.scheduledEvents.find(l=>l.id==o.id)),t.length>0?this.scheduleByMood(t):this.doNotify(`Evts of Mood '${this.filterString}' already scheduled!`,"warning","top")):this.doNotify("Nothing to add :(","warning","top")},scheduleByMood(t){var s;let i=[];for(let n=0;n<t.length;n++){let a=this.getLocalEvt(t[n].id);a&&a.time!=""?(i.push(a),this.usingMoods[t[n].id]=(s=t[n])==null?void 0:s.mood):this.withDismissNotify(`Evt '${a==null?void 0:a.title}' has no set time for scheduling, Manually Add it!`,"warning","top",null,function(){console.log("scheduleByMood>>>no time eh >> "+(a==null?void 0:a.title))})}i=this.addPropsEventsTo(this.currentDate,i);let o=this.overlapCheckEvtsAdd(i);Object.keys(o).length>0&&this.fixyOverlaps(o,null,"byMood"),this.disableSaveSchedule=!i.length>0,this.showReloadBtn=i.length>0&&this.hasEventsForDate,this.showClearBtn=!this.isViewingPast()},unscheduledDefaults(){return this.resetGoalEvts(!0),this.allEvents.filter(t=>(t==null?void 0:t.inDefaults)&&(t==null?void 0:t.time)!=""&&!this.scheduledEvents.find(i=>i.id==t.id))},removeNoTimes(t,i){if(t.some(o=>o.time=="")){let o="";t=t.filter(l=>{if(l.time!="")return l;o+=`'${l==null?void 0:l.title}'. `}),this.withDismissNotify(`Evts ${o} without set time not scheduled, Manually Add them.`,"warning","top",null,function(){console.log(`${i}::dismiss >> `,o)})}return t},scheduleDefaults(t){let i=this.deepCopy(this.store.fetchDefaults()),o=this.unscheduledDefaults();console.log("unscheduledDefaults",o);let l=this.isViewingPast();if(this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!l&&i.length>0,this.isViewingToday()){let s=this.addPropsEventsTo(this.currentDate,i);if(t=="add"){let r=s.length;s=s.filter(c=>(c==null?void 0:c.inDefaults)&&!this.scheduledEvents.find(d=>d.id==c.id)),console.log(`scheduleDefaults..ADDIN from ${r} to ${s.length}`)}else this.scheduledEvents=[],this.updateCurrentSchedule();s=this.removeNoTimes(s,"scheduleDefaults"),console.log(`scheduleDefaults:${this.currentDate} with '${t}'`,s.length,this.scheduledEvents.length);let n=this.overlapCheckEvtsAdd(s),a=Object.keys(n).length;a>0&&(console.log(`scheduleDefaults overlaps on:${this.currentDate} from ${i.length} to ${s.length}. overlaps =${a}`),this.fixyOverlaps(n,null,"byDefaults")),this.evtStartedOrPassed(q(new Date)),this.showDefaultBtn(l),this.disableSaveSchedule=!(s.length>0);return}else{let s=this.addPropsEventsTo(this.currentDate,i);if(s=this.removeNoTimes(s,"scheduleDefaults"),t=="add"){let a=s.length;s=s.filter(c=>!this.scheduledEvents.find(d=>d.id==c.id)),console.log(`scheduleDefaults..ADDIN to ${this.currentDate} of ${this.scheduledEvents.length} from ${a} to `,s.length);let r=this.scheduledEvents.concat(s);this.scheduledEvents=r}else this.scheduledEvents=s;let n=this.updateCurrentSchedule();n.size>0&&console.log("scheduleDefaults..sameStart="+n.size),l?this.allowScoreEdit(!0):this.allowScoreEdit(!1)}this.showDefaultBtn(l),this.disableSaveSchedule=!(i.length>0)},onLoadDefault(){let t=()=>{console.log("Aborting",this.currentDate)},i=o=>{this.scheduleDefaults(o)};if(this.scheduledEvents.length>0){let o=this.unscheduledDefaults(),l=[{label:`Add ${o==null?void 0:o.length} Default Evts to current day schedule`,value:"add"},{label:"Overwrite and only schedule Defaults",value:"overwrite"}];this.radioChoiceDialog("Warning!!",`Date: ${this.currentDate} already have scheduled Events...`,l,"",function(s){i(s)},t)}else i("overwrite")},onChoosenPrio(t){let i=this.chosenPrio;i&&i==t?this.disablePrioBtn=!0:(this.chosenPrio=t,this.disablePrioBtn=!1)},onChoosenScore(t){let i=this.chosenScore;i&&i==t?this.disableScoreBtn=!0:(this.chosenScore=t,this.disableScoreBtn=!1)},scheduleOneEach(t){let i=this.deepCopy(this.storedSubGoals),o=i.filter(r=>!this.scheduledEvents.find(c=>c.id==r.id));const l=r=>i.filter(c=>c.parentGoal==r),s=r=>{let c=[];return this.parentGoalsMap().forEach((d,u,p)=>{let y=l(d.id);if(y){let E=null,D=y.length;if(r)E=y[Math.floor(Math.random()*D)];else{let T=0;for(;this.scheduledEvents.some(w=>y[D].id==w.id);)if(T++,D=Math.floor(Math.random()*y.length),console.log(`selectOneFromP::index ${D} scheduled...new random> At try> `+T,y.length),T>2){console.log("selectOneFromP::random...TOO MANY TRIES..ERROR?",T,D,y.length,y);break}E=y[D],console.log("selectOneFromP::NO Random at index: "+D,T,E)}c.push(E)}else console.log("scheduleOneEach::selectOneFromP...huh no subgoals for",d)}),c};let n=this.isViewingToday(),a=[];if(t=="add"?(this.parentGoalsMap().forEach((r,c,d)=>{let u=o.find(p=>p.parentGoal==r.id);u?a.push(u):this.useGroupNotify(`No SubGoals for Parent: '${r==null?void 0:r.title}'`,r==null?void 0:r.bgcolor,"bottom")}),a=this.addPropsEventsTo(this.currentDate,a),a=this.removeNoTimes(a,"scheduleOneEach")):(this.scheduledEvents=[],this.updateCurrentSchedule(),a=s(!0),a=this.addPropsEventsTo(this.currentDate,a),a=this.removeNoTimes(a,"scheduleOneEach")),n){let r=this.overlapCheckEvtsAdd(a),c=Object.keys(r).length;c>0&&(console.log(`scheduleOneEach:: Overlaps on:${this.currentDate} from ${o.length} to ${a.length}. overlaps =${c}`),this.fixyOverlaps(r,null,"oneEach"))}else{let r=t=="overwrite";if(r)this.scheduledEvents=a;else{let d=this.scheduledEvents.concat(a);this.scheduledEvents=d}let c=this.updateCurrentSchedule();console.log("scheduleOneEach....sameStart="+c.size),c.size>0&&n&&this.fixSameStart(r)}this.isViewingPast()?this.allowScoreEdit(!0):this.allowScoreEdit(!1),this.disableSaveSchedule=!1,this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!0},onScheduleOneEach(){if(this.scheduledEvents.length>0){let t=[{label:"Add one Evt from Each parent Goals",value:"add"},{label:"Overwrite current with one random Evt from Each parent Goals",value:"overwrite"}];this.radioChoiceDialog("Warning!!",`Date: ${this.currentDate} already have scheduled Events...`,t,"",this.scheduleOneEach,function(){console.log("One of Each....Aborting")})}else this.scheduleOneEach("overwrite")},scheduleSamePrio(t){const i=()=>this.scheduledEvents.filter(s=>{var n;return((n=this.parentGoalsMap().get(s.parentGoal))==null?void 0:n.priority)==this.chosenPrio});let o=[],l=this.isViewingToday();if(t=="overwrite"||t=="add"){let s=this.deepCopy(this.storedSubGoals);for(let n of s){let a=this.parentGoalsMap().get(n.parentGoal);(a==null?void 0:a.priority)==this.chosenPrio&&o.push(n)}t=="add"?o=o.filter(n=>!this.scheduledEvents.find(a=>a.id==n.id)):(this.scheduledEvents=[],this.updateCurrentSchedule()),console.log(`scheduleSamePrio...${t} to size: ${this.scheduledEvents.length} some evts = ${o.length}`)}else o=i(),console.log("scheduleSamePrio..filtering!!",this.chosenPrio,o);if(l&&t!="filter"){o=this.addPropsEventsTo(this.currentDate,o),o=this.removeNoTimes(o,"scheduleSamePrio");let s=this.overlapCheckEvtsAdd(o);if(Object.keys(s).length>0)console.log(`scheduleSamePrio:${this.chosenPrio}...overlaps`,JSON.parse(JSON.stringify(s))),this.fixyOverlaps(s,null,"findSamePrio");else{if(console.log("scheduleSamePrio >>No overlaps!!...",o.length),o.length<1){this.disableSaveSchedule=!0,this.showReloadBtn=!1,this.showClearBtn=!1;return}this.updateCurrentSchedule()}}else{if(t=="filter")this.scheduledEvents=o;else if(o=this.addPropsEventsTo(this.currentDate,o),o=this.removeNoTimes(o,"scheduleSamePrio"),t=="add"){let s=this.scheduledEvents.concat(o);this.scheduledEvents=s}else this.scheduledEvents=o;this.updateCurrentSchedule()}if(!this.scheduledEvents.length>0){this.doNotify(`Empty for Priority == ${this.chosenPrio} :(`,"warning","bottom"),this.disableSaveSchedule=!0,this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!1;return}this.disableSaveSchedule=!1,this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!0},doReloadWithPrio(){if(this.chosenPrio==null){this.doNotify("Ayo select a priority!");return}let t=()=>{console.log("doReloadWithPrio..cancelling"),this.reset()};if(this.scheduledEvents.length>0){let i=[{label:`Filter current Evts by priority == ${this.chosenPrio}`,value:"filter"},{label:`Add to schedule Evts with priority == ${this.chosenPrio}`,value:"add"},{label:`Overwrite current and schedule All of priority == ${this.chosenPrio}`,value:"overwrite"}];this.radioChoiceDialog("","Schedule change...",i,"",this.scheduleSamePrio,t)}else this.scheduleSamePrio("overwrite");this.showDefaultBtn(this.isViewingPast()),this.disablePrioBtn=!0},scheduleByScore(t){const i=()=>{let s=[];return this.scheduledEvents.forEach(n=>{let a=this.parseScore(n.score);a>-1&&a>=this.chosenScore&&s.push(n)}),s};let o=[],l=this.isViewingToday();if(t=="overwrite"||t=="add"){const s=this.store.fetchGoalsWithMinScore(this.chosenScore);t=="add"?o=s.filter(n=>!this.scheduledEvents.find(a=>a.id==n.id)):(o=s,this.scheduledEvents=[],this.updateCurrentSchedule())}else o=i(),console.log(`scheduleByScore AFTER flag ${t}`,this.scheduledEvents.length,JSON.parse(JSON.stringify(o))),JSON.parse(JSON.stringify(this.scheduledEvents));if(l&&t!="filter"){o=this.addPropsEventsTo(this.currentDate,o),o=this.removeNoTimes(o,"scheduleByScore"),console.log(`scheduleByScore::addPropsEventsTo today for '${t}'`,this.scheduledEvents.length,JSON.parse(JSON.stringify(o)));let s=this.overlapCheckEvtsAdd(o);if(Object.keys(s).length>0)console.log(`scheduleByScore ${this.chosenScore}...overlaps!!`,JSON.parse(JSON.stringify(s))),this.fixyOverlaps(s,!1,"reloadScore");else{if(console.log("scheduleByScore >>NO OVERLAPS!!!..."),o.length<1){this.disableSaveSchedule=!0,this.showReloadBtn=!1,this.showClearBtn=!1;return}this.updateCurrentSchedule()}}else{if(console.log(`scheduleByScore... with flag '${t}' on>`,this.currentDate,JSON.parse(JSON.stringify(this.scheduledEvents.length)),JSON.parse(JSON.stringify(o))),t=="filter")this.scheduledEvents=o;else if(o=this.addPropsEventsTo(this.currentDate,o),o=this.removeNoTimes(o,"scheduleByScore"),t=="add"){let s=this.scheduledEvents.concat(o);this.scheduledEvents=s}else this.scheduledEvents=o;this.updateCurrentSchedule()}if(!this.scheduledEvents.length>0){this.doNotify(`Empty for Score >= ${this.chosenScore} :(`,"warning","bottom"),this.disableSaveSchedule=!0,this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!1;return}this.disableSaveSchedule=!1,this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!0},doReloadWithScore(){if(this.chosenScore==null){this.doNotify("Ayo select a score!");return}let t=()=>{console.log("doReloadWithScore..cancelling",this.scheduledEvents),this.reset()};if(this.scheduledEvents.length>0){let i=[{label:`Filter current Evts by Interval Score >= ${this.chosenScore}`,value:"filter"},{label:`Add to schedule Evts with Interval Score >= ${this.chosenScore}`,value:"add"},{label:`Overwrite current and schedule All of Interval Score >= ${this.chosenScore}`,value:"overwrite"}];this.radioChoiceDialog("","Schedule change...",i,"",this.scheduleByScore,t)}else this.scheduleByScore("overwrite");this.showDefaultBtn(this.isViewingPast()),this.disableScoreBtn=!0},onChange(t){this.loadForDate(t.start,this.hasEventsForDate,this.isViewingPast())},onDragStart(t,i){if(this.isViewingPast()){this.doNotify("Editing past is no no!"),t.preventDefault();return}this.draggedItem=i},onDragEnter(t,i,o){return i==="goal-item"||(this.targetDrop=o),t.preventDefault(),!0},onDragOver(t,i,o){return t.preventDefault(),!0},onDragLeave(t,i,o){return!1},onDragEnd(t){console.log("onDragEnd",t)},onDrop(t,i,o){let l=this.getScheduledEvent(this.draggedItem.id);if(!l){console.log("onDrop ERROR",l,this.draggedItem);return}let s=null;if(i==="interval")s=o.timestamp;else if(i==="goal-item"&&this.targetDrop)s=this.targetDrop.timestamp;else{console.log("Cannot drop here YO!!",t,i,o,this.targetDrop);return}if(!s){console.log("ERROR...no timestamp YO!!",t,i,o,this.targetDrop);return}let n=this.tooClose(s,l.duration);if(n&&(console.log("onDrop::tooClose to>>",n),n===!0)){this.doNotify("Dropping event TOO close to midnight!"),this.reset();return}let a=this.hasOverlappingEvent(l.id,s,l.duration),r={},c=a.length;if(c>0){let d=0;do{if(a[d].inConflict==a[d].target){console.log("EUUUH...self overlap?!?",a[d]);break}console.log("onDrop...OVERLAP handlin::size="+c,a[d].direction);let u=a[d];r[u==null?void 0:u.inConflict]?r[u==null?void 0:u.inConflict].push(u):r[u==null?void 0:u.inConflict]=[u],d>0&&(console.log(d+" WOAH WOAH,onDrop.. multiple overlaps with same target!",a[d].target),u.inConflict in r&&(console.log("WOAH deleting inConflict",u.inConflict),delete r[u.inConflict]),a[d-1].inConflict in r&&(console.log("WOAH deleting PREV inConflict",a[d-1].inConflict),delete r[a[d-1].inConflict]),r[u.target]?(r[u.target].push(u),console.log("WOAH obj.id already present?",u.target)):r[u.target]=[u],r[u.target].unshift(a[d-1]),r.withID=!0)}while(++d<c);console.log("onDrop...OVERLAP with fixOverlap",r),this.fixyOverlaps(r,!0,"onDrop")}else this.changeEvtTime(l.id,s,!1),console.log(`onDrop with No overlap complete (${l.id}) to ${s.time}`);this.disableSaveSchedule=!1,this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!0,this.reset()},onDblClickEvent(t,i){if(this.isViewingPast()){if(i.duration<30){console.log("onDblClickEvent..baah too smoll smoll",i.title,i.duration),this.doNotify("umm Removing from the past..Soo Check BALANCE!"),this.addToBalance(i),this.doRemove(i);return}this.chooseAlternatives(i),t.preventDefault();return}this.removeEvtInSchedule(i)},onClickDate(t){console.log("onClickDate",t)},onClickTime(t){console.log("onClickTime..event",t),this.addEventDialog=!0,this.targetDrop=t.scope},onClickInterval(t){console.log("onClickInterval",t)},onClickHeadIntervals(t){console.log("onClickHeadIntervals",t)},onClickHeadDay(t){console.log("onClickHeadDay",t)},onMouseEnter(t){console.log("onMouseAt",t)},onMouseLeave(t){console.log("onMouseLeave",JSON.stringify(t))},onMouseDownTime({scope:t,event:i}){if(Ae(i)){if(this.mobile===!0&&this.anchorTimestamp!==null&&this.otherTimestamp!==null&&Q(this.anchorTimestamp)===Q(this.otherTimestamp)){this.otherTimestamp=t.timestamp,this.mouseDown=!1;return}this.mouseDown=!0,this.anchorTimestamp=t.timestamp,this.otherTimestamp=t.timestamp}},onMouseUpTime({scope:t,event:i}){if(this.mobile!==!0&&Ae(i)&&(this.otherTimestamp=t.timestamp,this.mouseDown=!1),!this.mousedown){let o=this.startEndTimes;if(o[1]==o[0])return;this.possibleRange=o,console.log("onMouseUpTime range change",this.possibleRange)}},onMouseMoveTime({scope:t,event:i}){this.mobile!==!0&&this.mouseDown===!0&&(this.otherTimestamp=t.timestamp)},scrollToEvent(t){this.$refs.calendar.scrollToTime(t.time,350)},scrollToTime(t,i=null){var o;if(this.$refs.calendar){let l=N(t,{minute:-30});console.log("scrollToTime::gonna SCROLL",t.time,l.time,i),(o=this.$refs.calendar)==null||o.scrollToTime(l.time,i?i=="fast"?400:1e3:500)}else console.log("scrollToTime::NO SCROLLY",t.time,JSON.parse(JSON.stringify(this.$refs)))},onToday(){let t=()=>{this.$refs.calendar.moveToToday()},i=()=>{setTimeout(t,1e3),this.doSaveSchedule()};this.disableSaveSchedule?t():this.confirmAction(`Save day: ${this.currentDate} changes?`,"Save",i,t)},onPrev(){let t=()=>{this.$refs.calendar.prev()},i=()=>{setTimeout(t,1e3),this.doSaveSchedule()};this.disableSaveSchedule?t():this.confirmAction(`Save day: ${this.currentDate} changes?`,"Save",i,t)},onNext(){let t=()=>{this.$refs.calendar.next()},i=()=>{setTimeout(t,1e3),this.doSaveSchedule()};this.disableSaveSchedule?t():this.confirmAction(`Save day: ${this.currentDate} changes?`,"Save",i,t)}}}),ge=t=>(ue("data-v-43dbf9c5"),t=t(),fe(),t),ii={key:0,class:"q-gutter-md"},oi={key:1,class:"subcontent"},si={class:"q-px-md boxy"},li={key:0},ni={key:1},ai={key:2},ri={key:3},di={key:4},hi={key:5},ci=ge(()=>A("br",null,null,-1)),ui=ge(()=>A("br",null,null,-1)),fi={key:0,class:"q-pa-sm bg-grey-12",style:{"max-width":"400px"}},gi={class:"q-pa-sm row justify-center"},mi={class:"row justify-center"},pi=ge(()=>A("br",null,null,-1)),Si={class:"q-mr-sm text-weight-bold",size:"28px"},vi={key:0},yi={class:"text-weight-bold"},Ei={key:1,class:"text-weight-light text-black"},bi={key:1,class:"q-pa-md q-gutter-sm bg-grey-12",style:{"max-width":"400px"}},wi={key:0,class:"row"},Ci={class:"row justify-center"},Oi={class:"q-gutter-md",style:{display:"flex","max-width":"800px",width:"100%",height:"600px"}},$i={style:{display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"2px"}},Di={class:"title q-calendar__ellipsis"},Ri=["onDblclick","onDragstart"],Ti={class:"row justify-center"},Pi=ge(()=>A("br",null,null,-1));function Ai(t,i,o,l,s,n){const a=H("add-goal-form"),r=H("sched-btn"),c=H("drop-dwn-btn"),d=H("navigation-bar"),u=H("goaly-end"),p=H("q-calendar-day"),y=H("sched-dialog");return P(),B(W,null,[t.showForm?(P(),B("div",ii,[b(M,{class:"q-pl-xl justify-center",color:"","text-color":"green",elevated:"",label:"HideForm",onClick:i[0]||(i[0]=E=>t.showGoalForm=!t.showGoalForm),"no-caps":""}),b(a)])):k("",!0),t.showForm?k("",!0):(P(),B("div",oi,[b(Te,{modelValue:t.splitterPage,"onUpdate:modelValue":i[10]||(i[10]=E=>t.splitterPage=E),limits:[30,70]},{before:R(()=>[b(Te,{modelValue:t.splitterLegend,"onUpdate:modelValue":i[3]||(i[3]=E=>t.splitterLegend=E),horizontal:"",limits:[20,80],style:{height:"100%"}},{before:R(()=>[A("div",si,[t.showReloadBtn?(P(),B("div",li,[b(r,{"text-label":"Reload",class:"sched-btn","text-color":"green",onDoBtnAction:t.onReloadSaved},null,8,["onDoBtnAction"])])):k("",!0),t.showClearBtn?(P(),B("div",ni,[b(r,{"text-label":"Clear",class:"sched-btn","text-color":"lime-5",onDoBtnAction:t.onClearDay},null,8,["onDoBtnAction"])])):k("",!0),t.showLoadDefaults?(P(),B("div",ai,[b(r,{textLabel:t.defaultLabels,class:"sched-btn","text-color":"blue",onDoBtnAction:t.onLoadDefault},null,8,["textLabel","onDoBtnAction"])])):k("",!0),t.showScoreBtn?(P(),B("div",ri,[b(c,{class:"sched-drop-btn","text-color":"teal",disableBtn:t.disableScoreBtn,optionLabel:t.chosenScoreLabel,daOptions:t.scoreOptions,onDoReload:t.doReloadWithScore,onChooseOption:t.onChoosenScore},null,8,["disableBtn","optionLabel","daOptions","onDoReload","onChooseOption"])])):k("",!0),t.showPrio?(P(),B("div",di,[b(c,{class:"sched-drop-btn","text-color":"teal",disableBtn:t.disablePrioBtn,optionLabel:t.chosenPrioLabel,daOptions:t.allMainGPrio(),onDoReload:t.doReloadWithPrio,onChooseOption:t.onChoosenPrio},null,8,["disableBtn","optionLabel","daOptions","onDoReload","onChooseOption"])])):k("",!0),t.showOneEach?(P(),B("div",hi,[b(r,{"text-label":"One Each",class:"sched-btn","text-color":"brown",onDoBtnAction:t.onScheduleOneEach},null,8,["onDoBtnAction"])])):k("",!0)]),ci]),after:R(()=>[ui,t.treeGoals.length>0?(P(),B("div",fi,[A("div",gi,G(t.labelGoals("s")),1),A("div",mi,[b(ae,{color:"secondary","multi-line":""},{default:R(()=>[I(G(t.labelGoals("b"))+" mins ",1)]),_:1})]),b(Z),pi,b(Ce,{label:"Moods: 'je-suis'",ref:"filterRef",filled:"",modelValue:t.filter,"onUpdate:modelValue":i[1]||(i[1]=E=>t.filter=E),"use-input":"","use-chips":"",multiple:"",disable:t.isViewingPast(),"hide-dropdown-icon":"","input-debounce":"0","new-value-mode":"add-unique",class:"q-gutter-sm"},{"selected-item":R(E=>[b(lt,{removable:"",dense:"",onRemove:D=>E.removeAtIndex(E.index),tabindex:E.tabindex,"text-color":"black",class:"q-ma-none",style:{width:"80px"}},{default:R(()=>[I(G(E.opt),1)]),_:2},1032,["onRemove","tabindex"])]),append:R(()=>[t.filter.length>0?(P(),V(ve,{key:0,name:"clear",class:"cursor-pointer",onClick:t.resetFilter},null,8,["onClick"])):k("",!0)]),_:1},8,["modelValue","disable"]),b(dt,{nodes:t.treeGoals,"node-key":"label",filter:t.filterString,"filter-method":t.myFilterMethod,expanded:t.expanded,"onUpdate:expanded":i[2]||(i[2]=E=>t.expanded=E),"no-connectors":"",dense:"","default-expand-all":""},{"default-header":R(E=>[A("div",{class:ne(t.classyColor(E.node))},[E.node.isChildren?k("",!0):(P(),V(ve,{key:0,name:E.node.icon||E.expanded?"expand_less":"expand_more",size:"28px",right:""},null,8,["name"])),A("div",Si,G(E.node.label),1)],2)]),"default-body":R(E=>[E.node.isChildren?(P(),B("div",vi,[A("span",yi," >> "+G(E.node.details),1)])):(P(),B("span",Ei,G(E.node.details),1))]),_:1},8,["nodes","filter","filter-method","expanded"])])):k("",!0),t.filter.length>0?(P(),B("div",bi,[b(r,{"text-label":"Add Moods",class:"q-mt-xl sched-btn","text-color":"red",onDoBtnAction:t.onMoodAdd},null,8,["onDoBtnAction"])])):k("",!0)]),_:1},8,["modelValue"])]),after:R(()=>[b(nt,{onRefresh:t.onRefresh},{default:R(()=>[b(d,{onToday:t.onToday,onPrev:t.onPrev,onNext:t.onNext},null,8,["onToday","onPrev","onNext"])]),_:1},8,["onRefresh"]),t.scheduleMoodsLabel!=""?(P(),B("div",wi,[b(ae,{color:"secondary","multi-line":""},{default:R(()=>[I(G(t.scheduleMoodsLabel),1)]),_:1})])):k("",!0),A("div",Ci,[A("div",Oi,[b(p,{ref:"calendar",view:"day",modelValue:t.currentDate,"onUpdate:modelValue":i[8]||(i[8]=E=>t.currentDate=E),"drag-enter-func":t.onDragEnter,"drag-over-func":t.onDragOver,"drag-leave-func":t.onDragLeave,"drop-func":t.onDrop,animated:"",bordered:"",hoverable:"","no-active-date":"","transition-next":"slide-left","transition-prev":"slide-right","time-clicks-clamped":"","interval-minutes":15,"interval-count":96,"interval-height":28,"selected-start-end-dates":t.startEndTimes,onChange:t.onChange,onClickDate:t.onClickDate,onClickTime:t.onClickTime,onClickInterval:t.onClickInterval,onClickHeadIntervals:t.onClickHeadIntervals,onClickHeadDay:t.onClickHeadDay,onMousedownTime:t.onMouseDownTime,onMouseupTime:t.onMouseUpTime,onMousemoveTime:t.onMouseMoveTime},{"head-day-event":R(({scope:{timestamp:E}})=>[A("div",$i,[(P(!0),B(W,null,ye(t.eventsMap[E.date],D=>(P(),B(W,{key:D.id},[D.time?(P(),V(ae,{key:1,class:ne(t.badgeClasses(D,"header")),style:Y([t.badgeStyles(D,"header"),{margin:"1px",width:"10px","max-width":"10px",height:"10px","max-height":"10px",cursor:"pointer"}]),onClick:T=>t.scrollToEvent(D)},{default:R(()=>[b(Ee,null,{default:R(()=>[I(G("("+D.id+") "+D.title+" - "+D.time+" >> "+D.duration+"min"),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"])):(P(),V(ae,{key:0,class:ne(t.badgeClasses(D,"header")),style:Y([t.badgeStyles(D,"header"),{width:"100%",cursor:"pointer",height:"12px","font-size":"10px",margin:"1px"}])},{default:R(()=>[A("div",Di,[I(G(D.title)+" ",1),b(Ee,null,{default:R(()=>[I(G(D.details),1)]),_:2},1024)])]),_:2},1032,["class","style"]))],64))),128))])]),"day-container":R(({scope:{days:E}})=>[t.hasDate(E)?(P(),B(W,{key:0},[A("div",{class:"day-view-current-time-indicator",style:Y(t.style)},null,4),A("div",{class:"day-view-current-time-line",style:Y(t.style)},null,4)],64)):k("",!0)]),"day-body":R(({scope:{timestamp:E,timeStartPos:D,timeDurationHeight:T}})=>[(P(!0),B(W,null,ye(t.getDateEvents(E.date),w=>(P(),B(W,{key:w.id},[w.time!==void 0?(P(),B("div",{key:0,class:ne(["my-event",t.badgeClasses(w,"body")]),style:Y(t.badgeStyles(w,"body",D,T)),draggable:!0,onDblclick:de(v=>t.onDblClickEvent(v,w),["prevent"]),onDragstart:de(v=>t.onDragStart(v,w),["stop"]),onDragend:i[4]||(i[4]=de((...v)=>t.onDragEnd&&t.onDragEnd(...v),["stop"])),onDrop:i[5]||(i[5]=v=>t.onDrop(v,"goal-item",t.scope)),onDragenter:i[6]||(i[6]=v=>t.onDragEnter(v,"goal-item",t.scope)),onDragover:i[7]||(i[7]=v=>t.onDragOver(v,"goal-item",t.scope))},[b(u,{disabledScore:t.disabledScoreEvts[w.id],title:w.title,id:w.id,startTime:w.time,score:w.score,details:w.details,happeningNow:t.hasStarted[w.id]?t.hasStarted[w.id]:!1,onEndNow:t.onEndNow,onSaveScore:t.onSaveScore,onAddMins:t.onAddMins,onDeleteNow:v=>t.removeEvtInSchedule(w)},null,8,["disabledScore","title","id","startTime","score","details","happeningNow","onEndNow","onSaveScore","onAddMins","onDeleteNow"])],46,Ri)):k("",!0)],64))),128))]),_:1},8,["modelValue","drag-enter-func","drag-over-func","drag-leave-func","drop-func","selected-start-end-dates","onChange","onClickDate","onClickTime","onClickInterval","onClickHeadIntervals","onClickHeadDay","onMousedownTime","onMouseupTime","onMousemoveTime"])])]),A("div",Ti,[b(M,{class:"q-mt-xl",color:"Green","text-color":"blue",elevated:"",label:"SaveSchedule",disable:t.saveScheduleDisabled,onClick:t.doSaveSchedule,"no-caps":""},null,8,["disable","onClick"]),b(M,{class:"q-mt-xl",color:"","text-color":"green",elevated:"",label:"ShowForm",onClick:i[9]||(i[9]=E=>t.showGoalForm=!t.showGoalForm),"no-caps":""})]),Pi,t.addEventDialog?(P(),V(y,{key:1,parentGoals:t.storedCompPG,canBeScheduled:t.canbeScheduled,balance:t.currentBalance,onAddAdHocEvent:t.onAddHocEvent,onOnPickEvent:t.onPickEvent,onEuhHidin:t.closingDialog},null,8,["parentGoals","canBeScheduled","balance","onAddAdHocEvent","onOnPickEvent","onEuhHidin"])):k("",!0)]),_:1},8,["modelValue"])]))],64)}var _i=U(ti,[["render",Ai],["__scopeId","data-v-43dbf9c5"]]);export{_i as default};
