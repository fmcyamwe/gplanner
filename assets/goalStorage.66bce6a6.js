import{j as C,e as U,h as q,T as z,aj as K,r as W,c as A}from"./index.32de9b4d.js";import{u as P}from"./use-quasar.6f7380e0.js";var Z=C({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(v,{slots:O,emit:f}){let y=!1,$,T,b=null,g=null,m,M;function D(){$&&$(),$=null,y=!1,b!==null&&(clearTimeout(b),b=null),g!==null&&(clearTimeout(g),g=null),T!==void 0&&T.removeEventListener("transitionend",m),m=null}function x(i,h,S){h!==void 0&&(i.style.height=`${h}px`),i.style.transition=`height ${v.duration}ms cubic-bezier(.25, .8, .50, 1)`,y=!0,$=S}function E(i,h){i.style.overflowY=null,i.style.height=null,i.style.transition=null,D(),h!==M&&f(h)}function N(i,h){let S=0;T=i,y===!0?(D(),S=i.offsetHeight===i.scrollHeight?0:void 0):(M="hide",i.style.overflowY="hidden"),x(i,S,h),b=setTimeout(()=>{b=null,i.style.height=`${i.scrollHeight}px`,m=p=>{g=null,(Object(p)!==p||p.target===i)&&E(i,"show")},i.addEventListener("transitionend",m),g=setTimeout(m,v.duration*1.1)},100)}function I(i,h){let S;T=i,y===!0?D():(M="show",i.style.overflowY="hidden",S=i.scrollHeight),x(i,S,h),b=setTimeout(()=>{b=null,i.style.height=0,m=p=>{g=null,(Object(p)!==p||p.target===i)&&E(i,"hide")},i.addEventListener("transitionend",m),g=setTimeout(m,v.duration*1.1)},100)}return U(()=>{y===!0&&D()}),()=>q(z,{css:!1,appear:v.appear,onEnter:N,onLeave:I},O.default)}});const _=K("allGoals",()=>{const v=W([{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}]),O=[{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}],f=P(),y=A(()=>O),$=A(()=>{let t=JSON.parse(f.localStorage.getItem("mainGoals"));return g(t)}),T=A(()=>{let t=JSON.parse(f.localStorage.getItem("subGoals"));return g(t)}),b=A(()=>JSON.parse(f.localStorage.getItem("AllDates")));function g(t){return t?[...t]:[]}function m(t,o,l,r){let e=this.getMainGoals;if(!e){console.log("umm no mainGoals...adding"),f.localStorage.set("mainGoals",JSON.stringify([{id:0,title:t,details:o,priority:r,bgcolor:l,icon:"fas fa-utensils"}]));return}let a=e.length+1;for(;e.some(u=>u.id===a);)a=Math.floor(Math.random()*1e3);return e.unshift({id:a,title:t,details:o,priority:r,bgcolor:l,icon:"fas fa-utensils"}),f.localStorage.set("mainGoals",JSON.stringify(e)),a}function M(t,o,l,r,e,a,u){let n=this.getSubGoals;if(!n){f.localStorage.set("subGoals",JSON.stringify([{id:0,parentGoal:t,title:o,score:l,time:r,duration:e,canMove:a,inDefaults:u}]));return}let s=n.length+1;for(;n.some(c=>c.id===s);)s=Math.floor(Math.random()*1e3);return n.unshift({id:s,parentGoal:t,title:o,score:l,time:r,duration:e,canMove:a,inDefaults:u}),f.localStorage.set("subGoals",JSON.stringify(n)),s}function D(t,o,l,r,e,a,u){console.log("editSubGoal",pGoal+" "+o+" "+l+" "+r+" "+e+" "+a+" "+u);let n=this.getSubGoals;for(var s=0;s<n.length;s++)if(n[s].id===t){n[s].title=o,n[s].score=l,n[s].time=r,n[s].duration=e,n[s].canMove=a,n[s].inDefaults=u,console.log("editSubGoal for",n[s],s);break}f.localStorage.set("subGoals",JSON.stringify(n))}function x(){f.localStorage.remove("mainGoals"),console.log("removed all mainGoal")}function E(){f.localStorage.remove("subGoals"),console.log("removed all subGoals")}function N(){f.localStorage.remove("subGoals"),f.localStorage.remove("mainGoals"),console.log("removed ALL")}function I(t,o=null,l=null){let r=this.getSubGoals;for(var e=0;e<r.length;e++)if(r[e].id===t){r[e].time=o||r[e].time,r[e].score=l||r[e].score;break}f.localStorage.set("subGoals",JSON.stringify(r))}function i(t){let o=this.getSubGoals;for(var l=0;l<o.length;l++)o[l].id===t&&(o.splice(l,1),console.log("removeSubgoal spliced!"));return f.localStorage.set("subGoals",JSON.stringify(o)),o}function h(t,o){let l=this.getMainGoals;for(var r=0;r<l.length;r++)l[r].id===t&&(l.splice(r,1),console.log("removeMaingoal spliced!"));return f.localStorage.set("mainGoals",JSON.stringify(l)),l}function S(t){let o=this.getMainGoals;for(var l=0;l<o.length;l++)if(o[l].title===t)return o[l];return null}function p(t,o=null){let l=this.getAllDates;l?o?l[`${t}`]=o:t in l?delete l[`${t}`]:console.log(`ERROR? deleting schedule of ${t} not found!`):(console.log(`Adding new schedule for ${t}`),l={},l[`${t}`]=o),f.localStorage.set("AllDates",JSON.stringify(l))}function J(t){let o=this.getAllDates;if(o)return o[`${t}`]}function R(t){let o=this.getAllDates;return o?!!o[`${t}`]:!1}function L(){const t=[];let o=function(r){return r==null?void 0:r.inDefaults},l=this.getSubGoals;return l?(l.forEach(r=>{o(r)&&t.push(r)}),t):(console.log("No subgoals to fetch defaults :("),t)}function w(t=null){let o=this.getMainGoals,l=new Set;if(t)for(var r=0;r<o.length;r++)o[r].priority==t&&l.add(o[r].priority);else o.forEach(e=>{l.add(e.priority)});return l}function F(t){const o=[];let l=function(e){const a=e.split(/on/);return a.length!=2?(console.log(`parseScore error?${e}`,a),-1):a[1]-a[0]},r=this.getSubGoals;return r&&r.forEach(e=>{if(e.score=="")console.log(`no score event added: ${e.title}`,e.score),o.push(e);else{let a=l(e.score);a>-1&&a>=t&&o.push(e)}}),o}function H(t){const l=(t/60).toFixed(2);return parseFloat(l)}function Y(){let t=this.getMainGoals,o=this.getSubGoals,l=e=>{let a=[];return o&&o.forEach(u=>{u.parentGoal==e&&a.push(u)}),a},r=[];return t.forEach(e=>{var n,s,c,G;let a={label:`${e.id} - ${e==null?void 0:e.title.trim()} (${e==null?void 0:e.priority})`,color:`${e==null?void 0:e.bgcolor}`,prio:e==null?void 0:e.priority,children:[]},u=l(e.id);for(let d=0;d<u.length;d++){let Q=u[d].inDefaults?"D":"#",B=u[d].canMove?"M":"#";a.children.push({label:`${u[d].id} -- ${(n=u[d])==null?void 0:n.title.trim()} (${(s=u[d])==null?void 0:s.score}) at ${(c=u[d])==null?void 0:c.time}..${(G=u[d])==null?void 0:G.duration} :: ${Q}${B}`,color:`${e==null?void 0:e.bgcolor}`})}r.push(a)}),r}function j(){let t=this.getAllDates;if(!t)return[];let o=this.getMainGoals,l=this.getSubGoals,r={};for(let n in t){let s=t[n];for(let c in s)r[c]||(r[c]=[]),r[c].push({date:n,logged:H(s[c].duration)})}let e=n=>{let s=[];return l&&l.forEach(c=>{c.parentGoal==n&&s.push(c)}),s},a=(n,s=null)=>{let c={children:[],title:s?`${n.title.trim()}(${n.score})`:`${n.title.trim()} !${n.priority}!`,key:s?`${s}-${n.id}`:n.id,logged:[],expanded:!1,color:n==null?void 0:n.bgcolor,isChild:!!s};if(s){let G=r[n.id]||[];c.logged=[...G]}return c},u=[];return o.forEach(n=>{let s=a(n),c=e(n.id);for(let G=0;G<c.length;G++){let d=a(c[G],n.id);if(d.logged.length==0){console.log(`Oooh no logged for parent ${n.title}`,d);continue}s.logged.push(...d.logged),s.children.push(d)}u.push(s)}),u}return{headers:O,headerRefs:v,getHeaders:y,getMainGoals:$,getSubGoals:T,getAllDates:b,addMainGoal:m,addSubGoal:M,editSubGoal:D,getGoalByTitle:S,saveSubProp:I,saveDailySchedule:p,resetSub:E,resetMain:x,resetAll:N,removeSubgoal:i,removeMaingoal:h,getEventsForDate:J,hasEventsForDate:R,fetchAllTaskSummary:j,fetchGoalsWithMinScore:F,fetchAllPrio:w,fetchDefaults:L,fetchGoalsTree:Y}});export{Z as Q,_ as u};
