import{Q as H}from"./QTooltip.821ab2b7.js";import{j as $,q as C,s as d,c as k,h as x,k as Q,g as N,u as S,x as q,_ as P,d as R,r as m,E as b,F as g,G as B,H as f,I as c,K as h,M as y,N as V,O as _,P as F,R as z,J as T,S as w,U as K,Q as v}from"./index.dfe0cbf5.js";import{Q as O,a as j,b as L}from"./utiFunc.9c7f105d.js";import{N as U,t as A,p as J,a as p,b as D,c as E,i as G}from"./NavigationBar.071c337b.js";import{u as W}from"./goalStorage.08b2009d.js";import"./use-quasar.47598782.js";var X=$({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(e,{slots:t}){const{proxy:{$q:a}}=N(),o=C(S,d);if(o===d)return console.error("QPage needs to be a deep child of QLayout"),d;if(C(q,d)===d)return console.error("QPage needs to be child of QPageContainer"),d;const l=k(()=>{const n=(o.header.space===!0?o.header.size:0)+(o.footer.space===!0?o.footer.size:0);if(typeof e.styleFn=="function"){const u=o.isContainer.value===!0?o.containerHeight.value:a.screen.height;return e.styleFn(n,u)}return{minHeight:o.isContainer.value===!0?o.containerHeight.value-n+"px":a.screen.height===0?n!==0?`calc(100vh - ${n}px)`:"100vh":a.screen.height-n+"px"}}),r=k(()=>`q-page${e.padding===!0?" q-layout-padding":""}`);return()=>x("main",{class:r.value,style:l.value},Q(t.default))}});const Y=R({name:"weekCalendar",components:{NavigationBar:U,QCalendar:O},data(){return m(null),m(null),{store:W(),calendar:m(null),currentDate:m(A()),events:[]}},beforeMount(){this.loadEvts()},mounted(){console.log("mounted")},computed:{storedGoalsMap(){const e=new Map;let t=this.store.getSubGoals;return t?(t.forEach(a=>{e.set(a.id,a)}),e):(console.log("GoalsMap is empty or null",t),e)},allEvents(){return this.store.getAllDates},parentGoalsMap(){const e=new Map;let t=this.store.getMainGoals;return t?(t.forEach(a=>{e.set(a.id,a)}),e):(console.log("parentGoalsMap is empty or null",t),e)},storedEvents(){return this.store.getSubGoals},eventsMap(){const e={};return this.events.forEach(t=>{if(e[t.date]||(e[t.date]=[]),e[t.date].push(t),t.days){console.log(`eventsMap multiple days? event for ${t.date}`,t.days);let a=J(t.date),o=t.days;do a=p(a,{day:1}),e[a.date]||(e[a.date]=[]),e[a.date].push(t);while(--o>0)}}),e}},methods:{loadEvts(){let e=this.parentGoalsMap,t=this.storedGoalsMap,a=this.allEvents;if(t&&e){if(a)for(let o in a){let s=a[o];for(let l in s){let r=t.get(parseInt(l));if(r){let n=e.get(r.parentGoal);this.events.push({id:r.id,title:r.title,details:"from:"+n.title,time:s[l].time,duration:s[l].duration,date:o,bgcolor:n.bgcolor})}else console.log("ERROR?!?:",l,s)}}}else{console.log("ERROR--no parent or goals!!REVIEW**");return}},getEvents(e){const t=this.eventsMap[e]||[];if(t.length===1)t[0].side="full";else if(t.length===2){const a=p(E(t[0].date),{minute:D(t[0].time)}),o=p(a,{minute:t[0].duration}),s=p(E(t[1].date),{minute:D(t[1].time)}),l=p(s,{minute:t[1].duration});G(s,a,o,!0)||G(l,a,o,!0)?(t[0].side="left",t[1].side="right"):(t[0].side="full",t[1].side="full")}return t},badgeClasses(e,t){return j(e,t)},badgeStyles(e,t,a=void 0,o=void 0){return L(e,t,a,o)},onToday(){this.$refs.calendar.moveToToday()},onPrev(){this.doReset=!0,this.$refs.calendar.prev()},onNext(){this.$refs.calendar.next()},onClickDate(e){console.log("onClickDate",e)},onClickTime(e){console.log("onClickTime",e)},onClickInterval(e){console.log("onClickInterval",e)},onClickHeadIntervals(e){console.log("onClickHeadIntervals",e)},onClickHeadDay(e){console.log("onClickHeadDay",e)},onChange(e){console.log("onChange",e)}}}),Z={class:"row justify-center"},ee={style:{display:"flex","max-width":"800px",width:"100%",height:"400px",overflow:"auto"}},te={class:"title q-calendar__ellipsis"},ae={class:"row justify-center items-center"};function oe(e,t,a,o,s,l){const r=b("navigation-bar"),n=b("q-calendar");return g(),B(X,null,{default:f(()=>[c(r,{onToday:e.onToday,onPrev:e.onPrev,onNext:e.onNext},null,8,["onToday","onPrev","onNext"]),h("div",Z,[h("div",ee,[c(n,{ref:"calendar",modelValue:e.currentDate,"onUpdate:modelValue":t[0]||(t[0]=u=>e.currentDate=u),view:"week",dark:"",animated:"",hoverable:"",bordered:"","transition-prev":"slide-right","transition-next":"slide-left","no-active-date":"","interval-minutes":30,"interval-count":48,"interval-height":20,onChange:e.onChange,onClickDate:e.onClickDate,onClickTime:e.onClickTime,onClickInterval:e.onClickInterval,onClickHeadIntervals:e.onClickHeadIntervals,onClickHeadDay:e.onClickHeadDay},{"day-body":f(({scope:{timestamp:u,timeStartPos:I,timeDurationHeight:M}})=>[(g(!0),y(_,null,V(e.getEvents(u.date),i=>(g(),y(_,{key:i.id},[i.time!==void 0?(g(),y("div",{key:0,class:F(["my-event",e.badgeClasses(i,"body")]),style:z(e.badgeStyles(i,"body",I,M))},[h("span",te,[T(w(i.title)+" ",1),c(H,null,{default:f(()=>[T(w(i.details),1)]),_:2},1024)])],6)):K("",!0)],64))),128))]),_:1},8,["modelValue","onChange","onClickDate","onClickTime","onClickInterval","onClickHeadIntervals","onClickHeadDay"])])]),h("div",ae,[c(v,{class:"q-ma-xl",color:"white","text-color":"blue",unelevated:"",to:"/summary",label:"Summary","no-caps":""}),c(v,{class:"q-ma-xl",color:"white","text-color":"blue",unelevated:"",to:"/dayCalendar",label:"Daily","no-caps":""}),c(v,{class:"q-ma-xl",color:"white","text-color":"blue",unelevated:"",to:"/viewGoals",label:"Goals","no-caps":""})])]),_:1})}var ce=P(Y,[["render",oe],["__scopeId","data-v-3b6df654"]]);export{ce as default};
