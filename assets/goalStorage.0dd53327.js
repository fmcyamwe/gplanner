import{aq as V,j as X,e as Z,h as _,T as k,l as ee,ar as te,as as le,c as R}from"./index.5b37cd2a.js";function ne(){if(window.getSelection!==void 0){const u=window.getSelection();u.empty!==void 0?u.empty():u.removeAllRanges!==void 0&&(u.removeAllRanges(),V.is.mobile!==!0&&u.addRange(document.createRange()))}else document.selection!==void 0&&document.selection.empty()}var ie=X({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(u,{slots:J,emit:T}){let v=!1,$,A,p=null,G=null,S,D;function M(){$&&$(),$=null,v=!1,p!==null&&(clearTimeout(p),p=null),G!==null&&(clearTimeout(G),G=null),A!==void 0&&A.removeEventListener("transitionend",S),S=null}function O(d,g,b){g!==void 0&&(d.style.height=`${g}px`),d.style.transition=`height ${u.duration}ms cubic-bezier(.25, .8, .50, 1)`,v=!0,$=b}function N(d,g){d.style.overflowY=null,d.style.height=null,d.style.transition=null,M(),g!==D&&T(g)}function w(d,g){let b=0;A=d,v===!0?(M(),b=d.offsetHeight===d.scrollHeight?0:void 0):(D="hide",d.style.overflowY="hidden"),O(d,b,g),p=setTimeout(()=>{p=null,d.style.height=`${d.scrollHeight}px`,S=y=>{G=null,(Object(y)!==y||y.target===d)&&N(d,"show")},d.addEventListener("transitionend",S),G=setTimeout(S,u.duration*1.1)},100)}function E(d,g){let b;A=d,v===!0?M():(D="show",d.style.overflowY="hidden",b=d.scrollHeight),O(d,b,g),p=setTimeout(()=>{p=null,d.style.height=0,S=y=>{G=null,(Object(y)!==y||y.target===d)&&N(d,"hide")},d.addEventListener("transitionend",S),G=setTimeout(S,u.duration*1.1)},100)}return Z(()=>{v===!0&&M()}),()=>_(k,{css:!1,appear:u.appear,onEnter:w,onLeave:E},J.default)}});function oe(){return ee(te)}const se=le("allGoals",()=>{const u=oe(),J=R(()=>{let e=JSON.parse(u.localStorage.getItem("mainGoals"));return $(e)}),T=R(()=>{let e=JSON.parse(u.localStorage.getItem("subGoals"));return $(e)}),v=R(()=>JSON.parse(u.localStorage.getItem("AllDates")));function $(e){return e?[...e]:[]}function A(e){u.localStorage.set("Balancey",JSON.stringify(e))}function p(){return JSON.parse(u.localStorage.getItem("Balancey"))}function G(e,l,t=null){E(),u.localStorage.set("mainGoals",JSON.stringify(e)),u.localStorage.set("subGoals",JSON.stringify(l)),t&&u.localStorage.set("AllDates",JSON.stringify(t))}function S(e,l,t,r){let a=this.getMainGoals;if(!a){console.log("umm no mainGoals...adding"),u.localStorage.set("mainGoals",JSON.stringify([{id:0,title:e.trim(),details:l,priority:r,bgcolor:t,icon:"fas fa-utensils"}]));return}let c=a.length+1;for(;a.some(o=>o.id===c);)c=Math.floor(Math.random()*1e3);return a.unshift({id:c,title:e.trim(),details:l,priority:r,bgcolor:t,icon:"fas fa-utensils"}),u.localStorage.set("mainGoals",JSON.stringify(a)),c}function D(e,l,t,r,a){let c=this.getMainGoals;for(var o=0;o<c.length;o++)if(c[o].id===e){c[o].title=l.trim(),c[o].details=t,c[o].bgcolor=r,c[o].priority=a;break}u.localStorage.set("mainGoals",JSON.stringify(c))}function M(e,l,t,r,a,c,o,i,n){let s=this.getSubGoals;if(!s){u.localStorage.set("subGoals",JSON.stringify([{id:0,parentGoal:e,title:l.trim(),score:t,time:r,duration:a,canMove:c,inDefaults:o,isAlternative:i,jeSuis:n||[]}]));return}let f=s.length+1;for(;s.some(m=>m.id===f);)f=Math.floor(Math.random()*1e3);return s.unshift({id:f,parentGoal:e,title:l.trim(),score:t,time:r,duration:a,canMove:c,inDefaults:o,isAlternative:i,jeSuis:n||[]}),u.localStorage.set("subGoals",JSON.stringify(s)),f}function O(e,l,t,r,a,c,o,i,n){let s=this.getSubGoals;for(var f=0;f<s.length;f++)if(s[f].id===e){s[f].title=l.trim(),s[f].score=t,s[f].time=r,s[f].duration=a,s[f].canMove=c,s[f].inDefaults=o,s[f].isAlternative=i,s[f].jeSuis=n||[];break}u.localStorage.set("subGoals",JSON.stringify(s))}function N(){u.localStorage.remove("mainGoals"),console.log("removed all mainGoal")}function w(){u.localStorage.remove("subGoals"),console.log("removed all subGoals")}function E(){u.localStorage.remove("subGoals"),u.localStorage.remove("mainGoals"),u.localStorage.remove("AllDates"),u.localStorage.remove("Balancey"),console.log("removed ALL")}function d(e,l=null,t=null){let r=this.getSubGoals;for(var a=0;a<r.length;a++)if(r[a].id===e){r[a].time=l||r[a].time,r[a].score=t||r[a].score;break}u.localStorage.set("subGoals",JSON.stringify(r))}function g(e){let l=this.getSubGoals;for(var t=0;t<l.length;t++)l[t].id===e&&(l.splice(t,1),console.log("removeSubgoal spliced!"));return u.localStorage.set("subGoals",JSON.stringify(l)),l}function b(e,l){let t=this.getMainGoals;for(var r=0;r<t.length;r++)t[r].id===e&&(t.splice(r,1),console.log("removeMaingoal spliced!"));return u.localStorage.set("mainGoals",JSON.stringify(t)),t}function y(e){var r;let l=this.getMainGoals;for(var t=0;t<l.length;t++)if(((r=l[t])==null?void 0:r.title.trim())===e)return l[t];return null}function I(e,l=null){let t=this.getAllDates;t?l?t[`${e}`]=l:e in t?delete t[`${e}`]:console.log(`ERROR? deleting schedule of ${e} not found!`):(console.log(`Adding new schedule for ${e}`),t={},t[`${e}`]=l),u.localStorage.set("AllDates",JSON.stringify(t))}function L(e){let l=this.getAllDates;if(l)return l[`${e}`]}function x(e){let l=this.getAllDates;return l?!!l[`${e}`]:!1}function F(){const e=[];let l=function(r){return r==null?void 0:r.inDefaults},t=this.getSubGoals;return t?(t.forEach(r=>{l(r)&&e.push(r)}),e):(console.log("No subgoals to fetch defaults :("),e)}function C(e=null){let l=this.getMainGoals,t=new Set;if(e)for(var r=0;r<l.length;r++)l[r].priority==e&&t.add(l[r].priority);else l.forEach(a=>{t.add(a.priority)});return t}function H(){const e=[];let l=this.getSubGoals;return l&&l.forEach(t=>{t!=null&&t.isAlternative&&e.push(t)}),e}function Q(e){const l=[];let t=function(a){const c=a.split(/on/);return c.length!=2?(console.log(`parseScore error?${a}`,c),-1):c[1]-c[0]},r=this.getSubGoals;return r&&r.forEach(a=>{if(a.score=="")console.log(`no score event added: ${a.title}`,a.score),l.push(a);else{let c=t(a.score);c>-1&&c>=e&&l.push(a)}}),l}function q(e){const t=(e/60).toFixed(2);return parseFloat(t)}function Y(){let e=this.getMainGoals,l=this.getSubGoals,t=(o,i)=>{if(o.id>i.id)return 1;if(o.id==i.id)return 0;if(o.id<i.id)return-1},r=o=>{if(!o)return"";let i=o.split(":");return parseInt(i[0])>=12?o+"PM":o+"AM"},a=o=>{let i=[];return l&&l.forEach(n=>{n.parentGoal==o&&i.push(n)}),i},c=[];return e.forEach(o=>{var f,m,j,B;let i={id:o.id,label:`${o.id}) ${o==null?void 0:o.title.trim()}`,details:`${o.details} ==> Prio:${o==null?void 0:o.priority}`,color:`${o==null?void 0:o.bgcolor}`,prio:o==null?void 0:o.priority,children:[]},n=a(o.id);for(let h=0;h<n.length;h++){let z=n[h].inDefaults?"Dft":"#",P=n[h].canMove?"Mv":"#",U=n[h].isAlternative?"Alt":"#",W=[`${r((f=n[h])==null?void 0:f.time)} for ${(m=n[h])==null?void 0:m.duration} mins`,`:: ${z}~${P}~${U}`].join(`
`);i.children.push({id:n[h].id,label:`${n[h].id})- ${(j=n[h])==null?void 0:j.title.trim()} (${(B=n[h])==null?void 0:B.score})`,details:W,color:`${o==null?void 0:o.bgcolor}`,isChildren:!0,moods:n[h].jeSuis||[]})}let s=i.children;s.sort(t),i.children=s,c.push(i)}),c.sort(t),c}function K(){let e=this.getAllDates;if(!e)return[];let l=this.getMainGoals,t=this.getSubGoals,r={};for(let i in e){let n=e[i];for(let s in n){r[s]||(r[s]=[]);let f={date:i,logged:q(n[s].duration)};"notes"in n[s]&&(f.notes=n[s].notes,f.atScore=n[s].atScore),r[s].push(f)}}let a=i=>{let n=[];return t&&t.forEach(s=>{s.parentGoal==i&&n.push(s)}),n},c=(i,n=null)=>{let s={children:[],title:n?`${i.title.trim()}(${i.score})`:`${i.title.trim()} !${i.priority}!`,key:n?`${n}-${i.id}`:i.id,logged:[],expanded:!0,color:i==null?void 0:i.bgcolor,isChild:!!n};if(n){let f=r[i.id]||[];s.logged=[...f]}return s},o=[];return l.forEach(i=>{let n=c(i),s=a(i.id);for(let f=0;f<s.length;f++){let m=c(s[f],i.id);m.logged.length!=0&&(n.logged.push(...m.logged),m.children.length<1?delete m.children:console.log("huh children has descendents?!? ERROR?",m),n.children.push(m))}o.push(n)}),o}return{getMainGoals:J,getSubGoals:T,getAllDates:v,currentBalance:p,setBalance:A,addMainGoal:S,addSubGoal:M,editSubGoal:O,editMainGoal:D,importGoals:G,getGoalByTitle:y,saveSubProp:d,saveDailySchedule:I,resetSub:w,resetMain:N,resetAll:E,removeSubgoal:g,removeMaingoal:b,getEventsForDate:L,hasEventsForDate:x,fetchAllTaskSummary:K,fetchGoalsWithMinScore:Q,fetchAllPrio:C,fetchDefaults:F,fetchAlternativeEvts:H,fetchGoalsTree:Y}});export{ie as Q,oe as a,ne as c,se as u};
