import{j as K,e as W,h as P,T as V,aj as X,r as Z,c as N}from"./index.3e7e061f.js";import{u as _}from"./use-quasar.d070d5b1.js";var te=K({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup($,{slots:O,emit:c}){let v=!1,D,T,S=null,g=null,m,M;function A(){D&&D(),D=null,v=!1,S!==null&&(clearTimeout(S),S=null),g!==null&&(clearTimeout(g),g=null),T!==void 0&&T.removeEventListener("transitionend",m),m=null}function E(u,d,p){d!==void 0&&(u.style.height=`${d}px`),u.style.transition=`height ${$.duration}ms cubic-bezier(.25, .8, .50, 1)`,v=!0,D=p}function x(u,d){u.style.overflowY=null,u.style.height=null,u.style.transition=null,A(),d!==M&&c(d)}function I(u,d){let p=0;T=u,v===!0?(A(),p=u.offsetHeight===u.scrollHeight?0:void 0):(M="hide",u.style.overflowY="hidden"),E(u,p,d),S=setTimeout(()=>{S=null,u.style.height=`${u.scrollHeight}px`,m=G=>{g=null,(Object(G)!==G||G.target===u)&&x(u,"show")},u.addEventListener("transitionend",m),g=setTimeout(m,$.duration*1.1)},100)}function J(u,d){let p;T=u,v===!0?A():(M="show",u.style.overflowY="hidden",p=u.scrollHeight),E(u,p,d),S=setTimeout(()=>{S=null,u.style.height=0,m=G=>{g=null,(Object(G)!==G||G.target===u)&&x(u,"hide")},u.addEventListener("transitionend",m),g=setTimeout(m,$.duration*1.1)},100)}return W(()=>{v===!0&&A()}),()=>P(V,{css:!1,appear:$.appear,onEnter:I,onLeave:J},O.default)}});const le=X("allGoals",()=>{const $=Z([{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}]),O=[{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}],c=_(),v=N(()=>O),D=N(()=>{let t=JSON.parse(c.localStorage.getItem("mainGoals"));return g(t)}),T=N(()=>{let t=JSON.parse(c.localStorage.getItem("subGoals"));return g(t)}),S=N(()=>JSON.parse(c.localStorage.getItem("AllDates")));function g(t){return t?[...t]:[]}function m(t,l,e,r){let n=this.getMainGoals;if(!n){console.log("umm no mainGoals...adding"),c.localStorage.set("mainGoals",JSON.stringify([{id:0,title:t.trim(),details:l,priority:r,bgcolor:e,icon:"fas fa-utensils"}]));return}let o=n.length+1;for(;n.some(f=>f.id===o);)o=Math.floor(Math.random()*1e3);return n.unshift({id:o,title:t.trim(),details:l,priority:r,bgcolor:e,icon:"fas fa-utensils"}),c.localStorage.set("mainGoals",JSON.stringify(n)),o}function M(t,l,e,r,n,o,f,i){let s=this.getSubGoals;if(!s){c.localStorage.set("subGoals",JSON.stringify([{id:0,parentGoal:t,title:l.trim(),score:e,time:r,duration:n,canMove:o,inDefaults:f,isAlternative:i}]));return}let a=s.length+1;for(;s.some(b=>b.id===a);)a=Math.floor(Math.random()*1e3);return s.unshift({id:a,parentGoal:t,title:l.trim(),score:e,time:r,duration:n,canMove:o,inDefaults:f,isAlternative:i}),c.localStorage.set("subGoals",JSON.stringify(s)),a}function A(t,l,e,r,n,o,f,i){let s=this.getSubGoals;for(var a=0;a<s.length;a++)if(s[a].id===t){s[a].title=l.trim(),s[a].score=e,s[a].time=r,s[a].duration=n,s[a].canMove=o,s[a].inDefaults=f,s[a].isAlternative=i,console.log("editSubGoal for",s[a],a);break}c.localStorage.set("subGoals",JSON.stringify(s))}function E(){c.localStorage.remove("mainGoals"),console.log("removed all mainGoal")}function x(){c.localStorage.remove("subGoals"),console.log("removed all subGoals")}function I(){c.localStorage.remove("subGoals"),c.localStorage.remove("mainGoals"),console.log("removed ALL")}function J(t,l=null,e=null){let r=this.getSubGoals;for(var n=0;n<r.length;n++)if(r[n].id===t){r[n].time=l||r[n].time,r[n].score=e||r[n].score;break}c.localStorage.set("subGoals",JSON.stringify(r))}function u(t){let l=this.getSubGoals;for(var e=0;e<l.length;e++)l[e].id===t&&(l.splice(e,1),console.log("removeSubgoal spliced!"));return c.localStorage.set("subGoals",JSON.stringify(l)),l}function d(t,l){let e=this.getMainGoals;for(var r=0;r<e.length;r++)e[r].id===t&&(e.splice(r,1),console.log("removeMaingoal spliced!"));return c.localStorage.set("mainGoals",JSON.stringify(e)),e}function p(t){var r;let l=this.getMainGoals;for(var e=0;e<l.length;e++)if(((r=l[e])==null?void 0:r.title.trim())===t)return l[e];return null}function G(t,l=null){let e=this.getAllDates;e?l?e[`${t}`]=l:t in e?delete e[`${t}`]:console.log(`ERROR? deleting schedule of ${t} not found!`):(console.log(`Adding new schedule for ${t}`),e={},e[`${t}`]=l),c.localStorage.set("AllDates",JSON.stringify(e))}function L(t){let l=this.getAllDates;if(l)return l[`${t}`]}function w(t){let l=this.getAllDates;return l?!!l[`${t}`]:!1}function F(){const t=[];let l=function(r){return r==null?void 0:r.inDefaults},e=this.getSubGoals;return e?(e.forEach(r=>{l(r)&&t.push(r)}),t):(console.log("No subgoals to fetch defaults :("),t)}function C(t=null){let l=this.getMainGoals,e=new Set;if(t)for(var r=0;r<l.length;r++)l[r].priority==t&&e.add(l[r].priority);else l.forEach(n=>{e.add(n.priority)});return e}function H(){const t=[];let l=this.getSubGoals;return l&&l.forEach(e=>{e!=null&&e.isAlternative&&t.push(e)}),t}function Y(t){const l=[];let e=function(n){const o=n.split(/on/);return o.length!=2?(console.log(`parseScore error?${n}`,o),-1):o[1]-o[0]},r=this.getSubGoals;return r&&r.forEach(n=>{if(n.score=="")console.log(`no score event added: ${n.title}`,n.score),l.push(n);else{let o=e(n.score);o>-1&&o>=t&&l.push(n)}}),l}function j(t){const e=(t/60).toFixed(2);return parseFloat(e)}function Q(){let t=this.getMainGoals,l=this.getSubGoals,e=(o,f)=>{if(o.id>f.id)return 1;if(o.id==f.id)return 0;if(o.id<f.id)return-1},r=o=>{let f=[];return l&&l.forEach(i=>{i.parentGoal==o&&f.push(i)}),f},n=[];return t.forEach(o=>{var a,b,y,R;let f={id:o.id,label:`${o.id} - ${o==null?void 0:o.title.trim()} (${o==null?void 0:o.priority})`,details:`${o.details}`,color:`${o==null?void 0:o.bgcolor}`,prio:o==null?void 0:o.priority,children:[]},i=r(o.id);for(let h=0;h<i.length;h++){let U=i[h].inDefaults?"Dft":"#",q=i[h].canMove?"Mv":"#",z=i[h].isAlternative?"Alt":"#";f.children.push({id:i[h].id,label:`${i[h].id} -- ${(a=i[h])==null?void 0:a.title.trim()} (${(b=i[h])==null?void 0:b.score})`,details:`${(y=i[h])==null?void 0:y.time} for ${(R=i[h])==null?void 0:R.duration} mins :: ${U}~${q}~${z}`,color:`${o==null?void 0:o.bgcolor}`,isChildren:!0})}let s=f.children;s.sort(e),f.children=s,n.push(f)}),n.sort(e),n}function B(){let t=this.getAllDates;if(!t)return[];let l=this.getMainGoals,e=this.getSubGoals,r={};for(let i in t){let s=t[i];for(let a in s)r[a]||(r[a]=[]),r[a].push({date:i,logged:j(s[a].duration)})}let n=i=>{let s=[];return e&&e.forEach(a=>{a.parentGoal==i&&s.push(a)}),s},o=(i,s=null)=>{let a={children:[],title:s?`${i.title.trim()}(${i.score})`:`${i.title.trim()} !${i.priority}!`,key:s?`${s}-${i.id}`:i.id,logged:[],expanded:!1,color:i==null?void 0:i.bgcolor,isChild:!!s};if(s){let b=r[i.id]||[];a.logged=[...b]}return a},f=[];return l.forEach(i=>{let s=o(i),a=n(i.id);for(let b=0;b<a.length;b++){let y=o(a[b],i.id);if(y.logged.length==0){console.log(`Oooh no logged for parent ${i.title}`,y);continue}s.logged.push(...y.logged),s.children.push(y)}f.push(s)}),f}return{headers:O,headerRefs:$,getHeaders:v,getMainGoals:D,getSubGoals:T,getAllDates:S,addMainGoal:m,addSubGoal:M,editSubGoal:A,getGoalByTitle:p,saveSubProp:J,saveDailySchedule:G,resetSub:x,resetMain:E,resetAll:I,removeSubgoal:u,removeMaingoal:d,getEventsForDate:L,hasEventsForDate:w,fetchAllTaskSummary:B,fetchGoalsWithMinScore:Y,fetchAllPrio:C,fetchDefaults:F,fetchAlternativeEvts:H,fetchGoalsTree:Q}});export{te as Q,le as u};
