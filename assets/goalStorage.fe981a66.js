import{j as V,e as X,h as Z,T as _,l as k,ar as ee,as as te,c as w}from"./index.8c8e6158.js";var ne=V({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(c,{slots:J,emit:T}){let $=!1,v,M,p=null,G=null,m,D;function A(){v&&v(),v=null,$=!1,p!==null&&(clearTimeout(p),p=null),G!==null&&(clearTimeout(G),G=null),M!==void 0&&M.removeEventListener("transitionend",m),m=null}function O(f,g,b){g!==void 0&&(f.style.height=`${g}px`),f.style.transition=`height ${c.duration}ms cubic-bezier(.25, .8, .50, 1)`,$=!0,v=b}function N(f,g){f.style.overflowY=null,f.style.height=null,f.style.transition=null,A(),g!==D&&T(g)}function j(f,g){let b=0;M=f,$===!0?(A(),b=f.offsetHeight===f.scrollHeight?0:void 0):(D="hide",f.style.overflowY="hidden"),O(f,b,g),p=setTimeout(()=>{p=null,f.style.height=`${f.scrollHeight}px`,m=y=>{G=null,(Object(y)!==y||y.target===f)&&N(f,"show")},f.addEventListener("transitionend",m),G=setTimeout(m,c.duration*1.1)},100)}function E(f,g){let b;M=f,$===!0?A():(D="show",f.style.overflowY="hidden",b=f.scrollHeight),O(f,b,g),p=setTimeout(()=>{p=null,f.style.height=0,m=y=>{G=null,(Object(y)!==y||y.target===f)&&N(f,"hide")},f.addEventListener("transitionend",m),G=setTimeout(m,c.duration*1.1)},100)}return X(()=>{$===!0&&A()}),()=>Z(_,{css:!1,appear:c.appear,onEnter:j,onLeave:E},J.default)}});function le(){return k(ee)}const oe=te("allGoals",()=>{const c=le(),J=w(()=>{let e=JSON.parse(c.localStorage.getItem("mainGoals"));return v(e)}),T=w(()=>{let e=JSON.parse(c.localStorage.getItem("subGoals"));return v(e)}),$=w(()=>JSON.parse(c.localStorage.getItem("AllDates")));function v(e){return e?[...e]:[]}function M(e){c.localStorage.set("Balancey",JSON.stringify(e))}function p(){return JSON.parse(c.localStorage.getItem("Balancey"))}function G(e,l,t=null){E(),c.localStorage.set("mainGoals",JSON.stringify(e)),c.localStorage.set("subGoals",JSON.stringify(l)),t&&c.localStorage.set("AllDates",JSON.stringify(t))}function m(e,l,t,n){let s=this.getMainGoals;if(!s){console.log("umm no mainGoals...adding"),c.localStorage.set("mainGoals",JSON.stringify([{id:0,title:e.trim(),details:l,priority:n,bgcolor:t,icon:"fas fa-utensils"}]));return}let u=s.length+1;for(;s.some(r=>r.id===u);)u=Math.floor(Math.random()*1e3);return s.unshift({id:u,title:e.trim(),details:l,priority:n,bgcolor:t,icon:"fas fa-utensils"}),c.localStorage.set("mainGoals",JSON.stringify(s)),u}function D(e,l,t,n,s){let u=this.getMainGoals;for(var r=0;r<u.length;r++)if(u[r].id===e){u[r].title=l.trim(),u[r].details=t,u[r].bgcolor=n,u[r].priority=s;break}c.localStorage.set("mainGoals",JSON.stringify(u))}function A(e,l,t,n,s,u,r,o,i){let a=this.getSubGoals;if(!a){c.localStorage.set("subGoals",JSON.stringify([{id:0,parentGoal:e,title:l.trim(),score:t,time:n,duration:s,canMove:u,inDefaults:r,isAlternative:o,jeSuis:i||[]}]));return}let d=a.length+1;for(;a.some(S=>S.id===d);)d=Math.floor(Math.random()*1e3);return a.unshift({id:d,parentGoal:e,title:l.trim(),score:t,time:n,duration:s,canMove:u,inDefaults:r,isAlternative:o,jeSuis:i||[]}),c.localStorage.set("subGoals",JSON.stringify(a)),d}function O(e,l,t,n,s,u,r,o,i){let a=this.getSubGoals;for(var d=0;d<a.length;d++)if(a[d].id===e){a[d].title=l.trim(),a[d].score=t,a[d].time=n,a[d].duration=s,a[d].canMove=u,a[d].inDefaults=r,a[d].isAlternative=o,a[d].jeSuis=i||[];break}c.localStorage.set("subGoals",JSON.stringify(a))}function N(){c.localStorage.remove("mainGoals"),console.log("removed all mainGoal")}function j(){c.localStorage.remove("subGoals"),console.log("removed all subGoals")}function E(){c.localStorage.remove("subGoals"),c.localStorage.remove("mainGoals"),c.localStorage.remove("AllDates"),c.localStorage.remove("Balancey"),console.log("removed ALL")}function f(e,l=null,t=null){let n=this.getSubGoals;for(var s=0;s<n.length;s++)if(n[s].id===e){n[s].time=l||n[s].time,n[s].score=t||n[s].score;break}c.localStorage.set("subGoals",JSON.stringify(n))}function g(e){let l=this.getSubGoals;for(var t=0;t<l.length;t++)l[t].id===e&&(l.splice(t,1),console.log("removeSubgoal spliced!"));return c.localStorage.set("subGoals",JSON.stringify(l)),l}function b(e,l){let t=this.getMainGoals;for(var n=0;n<t.length;n++)t[n].id===e&&(t.splice(n,1),console.log("removeMaingoal spliced!"));return c.localStorage.set("mainGoals",JSON.stringify(t)),t}function y(e){var n;let l=this.getMainGoals;for(var t=0;t<l.length;t++)if(((n=l[t])==null?void 0:n.title.trim())===e)return l[t];return null}function L(e,l=null){let t=this.getAllDates;t?l?t[`${e}`]=l:e in t?delete t[`${e}`]:console.log(`ERROR? deleting schedule of ${e} not found!`):(console.log(`Adding new schedule for ${e}`),t={},t[`${e}`]=l),c.localStorage.set("AllDates",JSON.stringify(t))}function x(e){let l=this.getAllDates;if(l)return l[`${e}`]}function F(e){let l=this.getAllDates;return l?!!l[`${e}`]:!1}function R(){const e=[];let l=function(n){return n==null?void 0:n.inDefaults},t=this.getSubGoals;return t?(t.forEach(n=>{l(n)&&e.push(n)}),e):(console.log("No subgoals to fetch defaults :("),e)}function C(e=null){let l=this.getMainGoals,t=new Set;if(e)for(var n=0;n<l.length;n++)l[n].priority==e&&t.add(l[n].priority);else l.forEach(s=>{t.add(s.priority)});return t}function H(){const e=[];let l=this.getSubGoals;return l&&l.forEach(t=>{t!=null&&t.isAlternative&&e.push(t)}),e}function Q(e){const l=[];let t=function(s){const u=s.split(/on/);return u.length!=2?(console.log(`parseScore error?${s}`,u),-1):u[1]-u[0]},n=this.getSubGoals;return n&&n.forEach(s=>{if(s.score=="")console.log(`no score event added: ${s.title}`,s.score),l.push(s);else{let u=t(s.score);u>-1&&u>=e&&l.push(s)}}),l}function Y(e){const t=(e/60).toFixed(2);return parseFloat(t)}function q(){let e=this.getMainGoals,l=this.getSubGoals,t=(r,o)=>{if(r.id>o.id)return 1;if(r.id==o.id)return 0;if(r.id<o.id)return-1},n=r=>{if(!r)return"";let o=r.split(":");return parseInt(o[0])>=12?r+"PM":r+"AM"},s=r=>{let o=[];return l&&l.forEach(i=>{i.parentGoal==r&&o.push(i)}),o},u=[];return e.forEach(r=>{var d,S,B,I;let o={id:r.id,label:`${r.id}) ${r==null?void 0:r.title.trim()}`,details:`${r.details} ==> Prio:${r==null?void 0:r.priority}`,color:`${r==null?void 0:r.bgcolor}`,prio:r==null?void 0:r.priority,children:[]},i=s(r.id);for(let h=0;h<i.length;h++){let z=i[h].inDefaults?"Dft":"#",U=i[h].canMove?"Mv":"#",W=i[h].isAlternative?"Alt":"#",P=[`${n((d=i[h])==null?void 0:d.time)} for ${(S=i[h])==null?void 0:S.duration} mins`,`:: ${z}~${U}~${W}`].join(`
`);o.children.push({id:i[h].id,label:`${i[h].id})- ${(B=i[h])==null?void 0:B.title.trim()} (${(I=i[h])==null?void 0:I.score})`,details:P,color:`${r==null?void 0:r.bgcolor}`,isChildren:!0,moods:i[h].jeSuis||[]})}let a=o.children;a.sort(t),o.children=a,u.push(o)}),u.sort(t),u}function K(){let e=this.getAllDates;if(!e)return[];let l=this.getMainGoals,t=this.getSubGoals,n={};for(let o in e){let i=e[o];for(let a in i)n[a]||(n[a]=[]),n[a].push({date:o,logged:Y(i[a].duration)})}let s=o=>{let i=[];return t&&t.forEach(a=>{a.parentGoal==o&&i.push(a)}),i},u=(o,i=null)=>{let a={children:[],title:i?`${o.title.trim()}(${o.score})`:`${o.title.trim()} !${o.priority}!`,key:i?`${i}-${o.id}`:o.id,logged:[],expanded:!0,color:o==null?void 0:o.bgcolor,isChild:!!i};if(i){let d=n[o.id]||[];a.logged=[...d]}return a},r=[];return l.forEach(o=>{let i=u(o),a=s(o.id);for(let d=0;d<a.length;d++){let S=u(a[d],o.id);S.logged.length!=0&&(i.logged.push(...S.logged),S.children.length<1?delete S.children:console.log("huh children has descendents?!? ERROR?",S),i.children.push(S))}r.push(i)}),r}return{getMainGoals:J,getSubGoals:T,getAllDates:$,currentBalance:p,setBalance:M,addMainGoal:m,addSubGoal:A,editSubGoal:O,editMainGoal:D,importGoals:G,getGoalByTitle:y,saveSubProp:f,saveDailySchedule:L,resetSub:j,resetMain:N,resetAll:E,removeSubgoal:g,removeMaingoal:b,getEventsForDate:x,hasEventsForDate:F,fetchAllTaskSummary:K,fetchGoalsWithMinScore:Q,fetchAllPrio:C,fetchDefaults:R,fetchAlternativeEvts:H,fetchGoalsTree:q}});export{ne as Q,le as a,oe as u};
