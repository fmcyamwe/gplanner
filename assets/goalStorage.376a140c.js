import{aq as W,j as X,e as Z,h as _,T as k,l as ee,ar as te,as as le,c as j}from"./index.2cea40bf.js";function ne(){if(window.getSelection!==void 0){const u=window.getSelection();u.empty!==void 0?u.empty():u.removeAllRanges!==void 0&&(u.removeAllRanges(),W.is.mobile!==!0&&u.addRange(document.createRange()))}else document.selection!==void 0&&document.selection.empty()}var ie=X({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(u,{slots:T,emit:w}){let $=!1,A,M,p=null,G=null,S,O;function D(){A&&A(),A=null,$=!1,p!==null&&(clearTimeout(p),p=null),G!==null&&(clearTimeout(G),G=null),M!==void 0&&M.removeEventListener("transitionend",S),S=null}function N(f,m,b){m!==void 0&&(f.style.height=`${m}px`),f.style.transition=`height ${u.duration}ms cubic-bezier(.25, .8, .50, 1)`,$=!0,A=b}function E(f,m){f.style.overflowY=null,f.style.height=null,f.style.transition=null,D(),m!==O&&w(m)}function R(f,m){let b=0;M=f,$===!0?(D(),b=f.offsetHeight===f.scrollHeight?0:void 0):(O="hide",f.style.overflowY="hidden"),N(f,b,m),p=setTimeout(()=>{p=null,f.style.height=`${f.scrollHeight}px`,S=y=>{G=null,(Object(y)!==y||y.target===f)&&E(f,"show")},f.addEventListener("transitionend",S),G=setTimeout(S,u.duration*1.1)},100)}function J(f,m){let b;M=f,$===!0?D():(O="show",f.style.overflowY="hidden",b=f.scrollHeight),N(f,b,m),p=setTimeout(()=>{p=null,f.style.height=0,S=y=>{G=null,(Object(y)!==y||y.target===f)&&E(f,"hide")},f.addEventListener("transitionend",S),G=setTimeout(S,u.duration*1.1)},100)}return Z(()=>{$===!0&&D()}),()=>_(k,{css:!1,appear:u.appear,onEnter:R,onLeave:J},T.default)}});function oe(){return ee(te)}const se=le("allGoals",()=>{const u=oe(),T=j(()=>{let e=JSON.parse(u.localStorage.getItem("mainGoals"));return A(e)}),w=j(()=>{let e=JSON.parse(u.localStorage.getItem("subGoals"));return A(e)}),$=j(()=>JSON.parse(u.localStorage.getItem("AllDates")));function A(e){return e?[...e]:[]}function M(e){u.localStorage.set("Balancey",JSON.stringify(e))}function p(){return JSON.parse(u.localStorage.getItem("Balancey"))}function G(e,l,t=null){J(),u.localStorage.set("mainGoals",JSON.stringify(e)),u.localStorage.set("subGoals",JSON.stringify(l)),t&&u.localStorage.set("AllDates",JSON.stringify(t))}function S(e,l,t,r){let s=this.getMainGoals;if(!s){console.log("umm no mainGoals...adding"),u.localStorage.set("mainGoals",JSON.stringify([{id:0,title:e.trim(),details:l,priority:r,bgcolor:t,icon:"fas fa-utensils"}]));return}let c=s.length+1;for(;s.some(o=>o.id===c);)c=Math.floor(Math.random()*1e3);return s.unshift({id:c,title:e.trim(),details:l,priority:r,bgcolor:t,icon:"fas fa-utensils"}),u.localStorage.set("mainGoals",JSON.stringify(s)),c}function O(e,l,t,r,s){let c=this.getMainGoals;for(var o=0;o<c.length;o++)if(c[o].id===e){c[o].title=l.trim(),c[o].details=t,c[o].bgcolor=r,c[o].priority=s;break}u.localStorage.set("mainGoals",JSON.stringify(c))}function D(e,l,t,r,s,c,o,d,n){let i=this.getSubGoals;if(!i){u.localStorage.set("subGoals",JSON.stringify([{id:0,parentGoal:e,title:l.trim(),score:t,time:r,duration:s,canMove:c,inDefaults:o,isAlternative:d,jeSuis:n||[]}]));return}let a=i.length+1;for(;i.some(h=>h.id===a);)a=Math.floor(Math.random()*1e3);return i.unshift({id:a,parentGoal:e,title:l.trim(),score:t,time:r,duration:s,canMove:c,inDefaults:o,isAlternative:d,jeSuis:n||[]}),u.localStorage.set("subGoals",JSON.stringify(i)),a}function N(e,l,t,r,s,c,o,d,n){let i=this.getSubGoals;for(var a=0;a<i.length;a++)if(i[a].id===e){i[a].title=l.trim(),i[a].score=t,i[a].time=r,i[a].duration=s,i[a].canMove=c,i[a].inDefaults=o,i[a].isAlternative=d,i[a].jeSuis=n||[];break}u.localStorage.set("subGoals",JSON.stringify(i))}function E(){u.localStorage.remove("mainGoals"),console.log("removed all mainGoal")}function R(){u.localStorage.remove("subGoals"),console.log("removed all subGoals")}function J(){u.localStorage.remove("subGoals"),u.localStorage.remove("mainGoals"),u.localStorage.remove("AllDates"),u.localStorage.remove("Balancey"),console.log("removed ALL")}function f(e,l=null,t=null){let r=this.getSubGoals;for(var s=0;s<r.length;s++)if(r[s].id===e){r[s].time=l||r[s].time,r[s].score=t||r[s].score;break}u.localStorage.set("subGoals",JSON.stringify(r))}function m(e){let l=this.getSubGoals;for(var t=0;t<l.length;t++)l[t].id===e&&(l.splice(t,1),console.log("removeSubgoal spliced!"));return u.localStorage.set("subGoals",JSON.stringify(l)),l}function b(e,l){let t=this.getMainGoals;for(var r=0;r<t.length;r++)t[r].id===e&&(t.splice(r,1),console.log("removeMaingoal spliced!"));return u.localStorage.set("mainGoals",JSON.stringify(t)),t}function y(e){var r;let l=this.getMainGoals;for(var t=0;t<l.length;t++)if(((r=l[t])==null?void 0:r.title.trim())===e)return l[t];return null}function I(e,l=null){let t=this.getAllDates;t?l?t[`${e}`]=l:e in t?delete t[`${e}`]:console.log(`ERROR? deleting schedule of ${e} not found!`):(console.log(`Adding new schedule for ${e}`),t={},t[`${e}`]=l),u.localStorage.set("AllDates",JSON.stringify(t))}function x(e){let l=this.getAllDates;if(l)return l[`${e}`]}function L(e){let l=this.getAllDates;return l?!!l[`${e}`]:!1}function F(){const e=[];let l=function(r){return r==null?void 0:r.inDefaults},t=this.getSubGoals;return t?(t.forEach(r=>{l(r)&&e.push(r)}),e):(console.log("No subgoals to fetch defaults :("),e)}function C(e=null){let l=this.getMainGoals,t=new Set;if(e)for(var r=0;r<l.length;r++)l[r].priority==e&&t.add(l[r].priority);else l.forEach(s=>{t.add(s.priority)});return t}function H(){const e=[];let l=this.getSubGoals;return l&&l.forEach(t=>{t!=null&&t.isAlternative&&e.push(t)}),e}function Q(e){const l=[];let t=function(s){const c=s.split(/on/);return c.length!=2?(console.log(`parseScore error?${s}`,c),-1):c[1]-c[0]},r=this.getSubGoals;return r&&r.forEach(s=>{if(s.score=="")console.log(`no score event added: ${s.title}`,s.score),l.push(s);else{let c=t(s.score);c>-1&&c<=e&&l.push(s)}}),l}function q(e){const t=(e/60).toFixed(2);return parseFloat(t)}function Y(){let e=this.getMainGoals,l=this.getSubGoals,t=(o,d)=>{if(o.id>d.id)return 1;if(o.id==d.id)return 0;if(o.id<d.id)return-1},r=o=>{if(!o)return"";let d=o.split(":");return parseInt(d[0])>=12?o+"PM":o+"AM"},s=o=>{let d=[];return l&&l.forEach(n=>{n.parentGoal==o&&d.push(n)}),d},c=[];return e.forEach(o=>{var a,h,v,B;let d={id:o.id,label:`${o.id}) ${o==null?void 0:o.title.trim()}`,details:`${o.details} ==> Prio:${o==null?void 0:o.priority}`,color:`${o==null?void 0:o.bgcolor}`,prio:o==null?void 0:o.priority,children:[]},n=s(o.id);for(let g=0;g<n.length;g++){let U=n[g].inDefaults?"Dft":"#",z=n[g].canMove?"Mv":"#",P=n[g].isAlternative?"Alt":"#",V=[`${r((a=n[g])==null?void 0:a.time)} for ${(h=n[g])==null?void 0:h.duration} mins`,`:: ${U}~${z}~${P}`].join(`
`);d.children.push({id:n[g].id,label:`${n[g].id})- ${(v=n[g])==null?void 0:v.title.trim()} (${(B=n[g])==null?void 0:B.score})`,details:V,color:`${o==null?void 0:o.bgcolor}`,isChildren:!0,moods:n[g].jeSuis||[]})}let i=d.children;i.sort(t),d.children=i,c.push(d)}),c.sort(t),c}function K(){var d;let e=this.getAllDates;if(!e)return[];let l=this.getMainGoals,t=this.getSubGoals,r={};for(let n in e){let i=e[n];for(let a in i){r[a]||(r[a]=[]);let h={date:n,logged:q(i[a].duration),atScore:(d=i[a])==null?void 0:d.atScore};"notes"in i[a]&&(h.notes=i[a].notes),r[a].push(h)}}let s=n=>{let i=[];return t&&t.forEach(a=>{a.parentGoal==n&&i.push(a)}),i},c=(n,i=null)=>{let a={children:[],title:i?`${n.title.trim()}(${n.score})`:`${n.title.trim()} !${n.priority}!`,key:i?`${i}-${n.id}`:n.id,logged:[],expanded:!0,color:n==null?void 0:n.bgcolor,isChild:!!i};if(i){let h=r[n.id]||[];a.logged=[...h]}return a},o=[];return l.forEach(n=>{let i=c(n),a=s(n.id);for(let h=0;h<a.length;h++){let v=c(a[h],n.id);v.logged.length!=0&&(i.logged.push(...v.logged),v.children.length<1?delete v.children:console.log("huh children has descendents?!? ERROR?",v),i.children.push(v))}o.push(i)}),o}return{getMainGoals:T,getSubGoals:w,getAllDates:$,currentBalance:p,setBalance:M,addMainGoal:S,addSubGoal:D,editSubGoal:N,editMainGoal:O,importGoals:G,getGoalByTitle:y,saveSubProp:f,saveDailySchedule:I,resetSub:R,resetMain:E,resetAll:J,removeSubgoal:m,removeMaingoal:b,getEventsForDate:x,hasEventsForDate:L,fetchAllTaskSummary:K,fetchGoalsUpToMaxScore:Q,fetchAllPrio:C,fetchDefaults:F,fetchAlternativeEvts:H,fetchGoalsTree:Y}});export{ie as Q,se as a,ne as c,oe as u};
