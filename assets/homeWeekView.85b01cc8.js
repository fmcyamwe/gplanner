import{_ as B,$ as j,r as v,L as V,E as c,F as C,G as d,M as u,H as n,O as f,P as H,R as T,a0 as z,a1 as k,Q as N,I as w,K as y,a2 as E,J as _,a3 as x,a4 as L,a5 as Q,a6 as A,a7 as O}from"./index.9430d842.js";import{u as F,a as U,Q as G,b as W}from"./goalStorage.5f034ce0.js";import{a as K,b as J,Q as P}from"./utiFunc.1202864f.js";import{t as X,a as g,p as I,b as M,c as Y,i as R,Q as Z,d as $,e as ee}from"./QCalendarTask.a6f8720e.js";import{Q as te}from"./QCalendar.ca85dbc2.js";const se={name:"weekCalendar",components:{NavigationBar:j(()=>L(()=>import("./NavigationBar.5bb8dcc0.js"),["assets/NavigationBar.5bb8dcc0.js","assets/index.9430d842.js","assets/index.4f70e4de.css"])),QCalendar:te},data(){return F(),{store:U(),calendar:v(null),currentDate:v(X()),events:[],mostEvts:5,treeGoals:v([]),expanded:v([]),showTree:v(!1),moods:v({})}},beforeMount(){this.loadEvts(),this.constructTree()},mounted(){console.log("mounted")},computed:{storedGoalsMap(){const e=new Map;let t=this.store.getSubGoals;return t?(t.forEach(s=>{e.set(s.id,s)}),e):(console.log("GoalsMap is empty or null",t),e)},label(){return this.showTree?"Hide Legend":"Show Legend"},allEvents(){return this.store.getAllDates},parentGoalsMap(){const e=new Map;let t=this.store.getMainGoals;return t?(t.forEach(s=>{e.set(s.id,s)}),e):(console.log("parentGoalsMap is empty or null",t),e)},storedEvents(){return this.store.getSubGoals},eventsMap(){const e={};return this.events.forEach(t=>{if(e[t.date]||(e[t.date]=[]),t.sortTime=g(M(t.date),{minute:I(t.time)}),e[t.date].push(t),t.days){console.log(`eventsMap multiple days? event for ${t.date}`,t.days);let s=Y(t.date),r=t.days;do s=g(s,{day:1}),e[s.date]||(e[s.date]=[]),e[s.date].push(t);while(--r>0)}}),e}},methods:{classyColor(e){return`row items-center ${e.isChildren?"text-":"text-white bg-"}${e.color} `},loadEvts(){var r,i,l;let e=this.parentGoalsMap,t=this.storedGoalsMap,s=this.allEvents;if(t&&e){if(s)for(let h in s){let m=s[h];for(let a in m){let o=t.get(parseInt(a));if(o){let b=e.get(o.parentGoal),p=g(M(h),{minute:I(m[a].time)}),q=g(p,{minute:parseInt(m[a].duration)}),D="";m[a].notes!==void 0&&((r=m[a])==null?void 0:r.notes)!==""?D=[`${p.time} - ${q.time}`,`${(i=m[a])==null?void 0:i.atScore} >> ${o.score}`,`${(l=m[a])==null?void 0:l.notes}`].join(`
\r`):D=`${p.time} - ${q.time}`,m[a].byMood!==void 0&&(this.moods[h]||(this.moods[h]=[]),this.moods[h].push(...m[a].byMood)),this.events.push({id:o.id,title:o.title,details:D,time:m[a].time,duration:m[a].duration,date:h,bgcolor:b.bgcolor})}}}}else{console.log("ERROR--no parent or goals!!REVIEW**");return}},constructTree(){this.treeGoals=this.store.fetchGoalsTree()},getEvents(e){let t=(r,i)=>{let l=$(r.sortTime,i.sortTime);if(l>0)return-1;if(l==0)return 0;if(l<0)return 1};const s=this.eventsMap[e]||[];if(s.length===1)s[0].side="full";else if(s.length===2){const r=g(M(s[0].date),{minute:I(s[0].time)}),i=g(r,{minute:s[0].duration}),l=g(M(s[1].date),{minute:I(s[1].time)}),h=g(l,{minute:s[1].duration});R(l,r,i,!0)||R(h,r,i,!0)?(s[0].side="left",s[1].side="right"):(s[0].side="full",s[1].side="full")}return s.length>this.mostEvts&&(this.mostEvts=s.length),s.sort(t)},badgeClasses(e,t){return K(e,t)},badgeStyles(e,t,s=void 0,r=void 0){return J(e,t,s,r)},scrollToEvent(e){this.$refs.calendar.scrollToTime(e.time,350)},onToday(){this.$refs.calendar.moveToToday()},onPrev(){this.doReset=!0,this.$refs.calendar.prev()},onNext(){this.$refs.calendar.next()},onClickDate(e){console.log("onClickDate",e)},onClickTime(e){console.log("onClickTime",e)},onClickInterval(e){console.log("onClickInterval",e)},onClickHeadIntervals(e){console.log("onClickHeadIntervals",e)},onClickHeadDay({scope:e,event:t}){let s=e.timestamp.date,r=this.moods[s];r?this.$q.notify({color:"positive",position:"top",message:`Scheduled by moods: ${r.join()}`,icon:"tag_faces"}):this.$q.notify({color:"white",textColor:"black",position:"top",message:"NO mood!!",icon:"sentiment_neutral",iconColor:"red",multiLine:!0})},onChange(e){this.mostEvts=5,console.log("onChange",e)}}},S=e=>(A("data-v-7e20e1c1"),e=e(),O(),e),ae={class:"q-pa-md"},le=S(()=>u("i",{class:"row justify-center q-pa-sm"},"Click on Day header for that day's Moods ",-1)),oe={class:"row justify-center"},ne={class:"q-px-md",style:{display:"flex","max-width":"800px",width:"100%",height:"500px",overflow:"auto"}},ie={style:{display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"2px"}},de={class:"title q-calendar__ellipsis"},re={class:"title q-calendar__ellipsis"},ce={class:"lineyy"},ue={key:0,class:"q-pa-md"},me={key:0,class:"q-pa-md bg-grey-12",style:{"max-width":"400px"}},he=S(()=>u("div",{class:"row justify-center"}," Goals & Goal Events ",-1)),pe=S(()=>u("br",null,null,-1)),fe={class:"q-mr-sm text-weight-bold",size:"28px"},_e={key:0},ye={class:"text-weight-bold liney"},ge={key:1,class:"text-weight-light text-black liney"},ve={key:1,class:"column justify-center items-center"},Ce=S(()=>u("br",null,null,-1));function ke(e,t,s,r,i,l){const h=V("navigation-bar"),m=V("q-calendar");return c(),C(Z,null,{default:d(()=>[u("div",ae,[n(h,{onToday:l.onToday,onPrev:l.onPrev,onNext:l.onNext},null,8,["onToday","onPrev","onNext"]),le,u("div",oe,[u("div",ne,[n(m,{ref:"calendar",modelValue:i.currentDate,"onUpdate:modelValue":t[0]||(t[0]=a=>i.currentDate=a),view:"week",dark:"",animated:"",hoverable:"",bordered:"","transition-prev":"slide-right","transition-next":"slide-left","no-active-date":"","interval-minutes":30,"interval-count":48,"interval-height":i.mostEvts*3,onChange:l.onChange,onClickDate:l.onClickDate,onClickTime:l.onClickTime,onClickInterval:l.onClickInterval,onClickHeadIntervals:l.onClickHeadIntervals,onClickHeadDay:l.onClickHeadDay},{"head-day-event":d(({scope:{timestamp:a}})=>[u("div",ie,[(c(!0),f(T,null,H(l.eventsMap[a.date],o=>(c(),f(T,{key:o.id},[o.time?(c(),C(P,{key:1,class:E(l.badgeClasses(o,"header")),style:Q([l.badgeStyles(o,"header"),{margin:"1px",width:"10px","max-width":"10px",height:"10px","max-height":"10px",cursor:"pointer"}]),onClick:b=>l.scrollToEvent(o)},{default:d(()=>[n(G,null,{default:d(()=>[_(y(o.time+" - "+o.title),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"])):(c(),C(P,{key:0,class:E(l.badgeClasses(o,"header")),style:Q([l.badgeStyles(o,"header"),{width:"100%",cursor:"pointer",height:"12px","font-size":"10px",margin:"1px"}])},{default:d(()=>[u("div",de,[_(y(o.title)+" ",1),n(G,null,{default:d(()=>[_(y(o.details),1)]),_:2},1024)])]),_:2},1032,["class","style"]))],64))),128))])]),"day-body":d(({scope:{timestamp:a,timeStartPos:o,timeDurationHeight:b}})=>[(c(!0),f(T,null,H(l.getEvents(a.date),p=>(c(),f(T,{key:p.id},[p.time!==void 0?(c(),f("div",{key:0,class:E(["my-event",l.badgeClasses(p,"body")]),style:Q(l.badgeStyles(p,"body",o,b))},[u("span",re,[_(y(p.title)+" ",1),n(G,null,{default:d(()=>[u("div",ce,y(p.details),1)]),_:2},1024)])],6)):w("",!0)],64))),128))]),_:1},8,["modelValue","interval-height","onChange","onClickDate","onClickTime","onClickInterval","onClickHeadIntervals","onClickHeadDay"])])])]),n(z,{modelValue:i.showTree,"onUpdate:modelValue":t[1]||(t[1]=a=>i.showTree=a),label:l.label,color:"teal",class:"q-pa-md"},null,8,["modelValue","label"]),n(W,null,{default:d(()=>[i.showTree?(c(),f("div",ue,[i.treeGoals.length>0?(c(),f("div",me,[he,n(k),pe,n(ee,{nodes:i.treeGoals,"node-key":"label",expanded:i.expanded,"onUpdate:expanded":t[2]||(t[2]=a=>i.expanded=a),"no-connectors":"",dense:"",accordion:""},{"default-header":d(a=>[u("div",{class:E(l.classyColor(a.node))},[a.node.isChildren?w("",!0):(c(),C(N,{key:0,name:a.expanded?"expand_less":"expand_more",size:"28px",class:"q-mr-sm"},null,8,["name"])),u("div",fe,y(a.node.label),1),n(N,{name:a.node.icon},null,8,["name"])],2)]),"default-body":d(a=>[a.node.isChildren?(c(),f("div",_e,[u("span",ye," >> "+y(a.node.details),1),a.node.moods.length>0?(c(),C(G,{key:0},{default:d(()=>[_(y("Moods::> "+a.node.moods.join(",")),1)]),_:2},1024)):w("",!0)])):(c(),f("span",ge,y(a.node.details),1))]),_:1},8,["nodes","expanded"])])):(c(),f("div",ve,[Ce,n(x,null,{default:d(()=>[_(" 1. Add some Goals first. A schedulable goal is one with a parent Goal--can have multiple related goals with the same parent. ")]),_:1}),n(k),n(x,null,{default:d(()=>[_(" 2. Go to Schedule to see a daily schedule. Drag scheduled events to new timeslots or click in calendar to add an event. ")]),_:1}),n(k),n(x,null,{default:d(()=>[_(" 3. Reload a saved daily schedule or defaults or choose minimal score events to schedule. Fix any scheduling conflicts. ")]),_:1}),n(k),n(x,null,{default:d(()=>[_(" 4. Save the daily schedule (dont forget to update their score as needed!) ")]),_:1}),n(k),n(x,null,{default:d(()=>[_(" 5. Check out the summary of all goals here! ")]),_:1})]))])):w("",!0)]),_:1})]),_:1})}var Ge=B(se,[["render",ke],["__scopeId","data-v-7e20e1c1"]]);export{Ge as default};
