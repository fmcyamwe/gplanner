import{Q as I,a as b}from"./QBadge.bb61bc7c.js";import{j as q,q as M,s as g,c as H,h as P,k as R,g as V,u as B,x as F,_ as z,d as K,r as k,E as S,F as c,G as _,H as u,I as p,K as y,M as f,N,O as E,P as w,R as T,J as v,S as C,U as j,Q as x}from"./index.0f75d3cd.js";import{Q as L,a as O,b as W}from"./utiFunc.696b94ce.js";import{N as U,t as A,p as J,a as m,b as $,c as D,i as Q}from"./NavigationBar.8e417093.js";import{u as X}from"./goalStorage.8dbaf97b.js";import"./use-quasar.17b845fa.js";var Y=q({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(e,{slots:t}){const{proxy:{$q:a}}=V(),s=M(B,g);if(s===g)return console.error("QPage needs to be a deep child of QLayout"),g;if(M(F,g)===g)return console.error("QPage needs to be child of QPageContainer"),g;const l=H(()=>{const r=(s.header.space===!0?s.header.size:0)+(s.footer.space===!0?s.footer.size:0);if(typeof e.styleFn=="function"){const i=s.isContainer.value===!0?s.containerHeight.value:a.screen.height;return e.styleFn(r,i)}return{minHeight:s.isContainer.value===!0?s.containerHeight.value-r+"px":a.screen.height===0?r!==0?`calc(100vh - ${r}px)`:"100vh":a.screen.height-r+"px"}}),d=H(()=>`q-page${e.padding===!0?" q-layout-padding":""}`);return()=>P("main",{class:d.value,style:l.value},R(t.default))}});const Z=K({name:"weekCalendar",components:{NavigationBar:U,QCalendar:L},data(){return k(null),k(null),{store:X(),calendar:k(null),currentDate:k(A()),events:[],mostEvts:0}},beforeMount(){this.loadEvts()},mounted(){console.log("mounted")},computed:{storedGoalsMap(){const e=new Map;let t=this.store.getSubGoals;return t?(t.forEach(a=>{e.set(a.id,a)}),e):(console.log("GoalsMap is empty or null",t),e)},allEvents(){return this.store.getAllDates},parentGoalsMap(){const e=new Map;let t=this.store.getMainGoals;return t?(t.forEach(a=>{e.set(a.id,a)}),e):(console.log("parentGoalsMap is empty or null",t),e)},storedEvents(){return this.store.getSubGoals},eventsMap(){const e={};return this.events.forEach(t=>{if(e[t.date]||(e[t.date]=[]),e[t.date].push(t),t.days){console.log(`eventsMap multiple days? event for ${t.date}`,t.days);let a=J(t.date),s=t.days;do a=m(a,{day:1}),e[a.date]||(e[a.date]=[]),e[a.date].push(t);while(--s>0)}}),e}},methods:{loadEvts(){let e=this.parentGoalsMap,t=this.storedGoalsMap,a=this.allEvents;if(console.log("returnNewEvts:",e,t,a),t&&e){if(a)for(let s in a){let n=a[s];for(let l in n){let d=t.get(parseInt(l));if(d){let r=e.get(d.parentGoal),i=m(D(s),{minute:$(n[l].time)}),o=m(i,{minute:parseInt(n[l].duration)});this.events.push({id:d.id,title:d.title,details:`${i.time} - ${o.time}`,time:n[l].time,duration:n[l].duration,date:s,bgcolor:r.bgcolor})}else console.log(`ERROR: ${l} no exist!! on`,s)}}}else{console.log("ERROR--no parent or goals!!REVIEW**");return}},getEvents(e){const t=this.eventsMap[e]||[];if(t.length===1)t[0].side="full";else if(t.length===2){console.log("getEvents...LENGTH is 2?!?",e,t);const a=m(D(t[0].date),{minute:$(t[0].time)}),s=m(a,{minute:t[0].duration}),n=m(D(t[1].date),{minute:$(t[1].time)}),l=m(n,{minute:t[1].duration});Q(n,a,s,!0)||Q(l,a,s,!0)?(t[0].side="left",t[1].side="right"):(t[0].side="full",t[1].side="full")}return t.length>this.mostEvts&&(console.log(`getEvents hiiigh ${e}`,t.length),this.mostEvts=t.length),t},badgeClasses(e,t){return O(e,t)},badgeStyles(e,t,a=void 0,s=void 0){return W(e,t,a,s)},scrollToEvent(e){this.$refs.calendar.scrollToTime(e.time,350)},onToday(){this.$refs.calendar.moveToToday()},onPrev(){this.doReset=!0,this.$refs.calendar.prev()},onNext(){this.$refs.calendar.next()},onClickDate(e){console.log("onClickDate",e)},onClickTime(e){console.log("onClickTime",e)},onClickInterval(e){console.log("onClickInterval",e)},onClickHeadIntervals(e){console.log("onClickHeadIntervals",e)},onClickHeadDay(e){console.log("onClickHeadDay",e)},onChange(e){console.log("onChange",e)}}}),ee={class:"row justify-center"},te={style:{display:"flex","max-width":"800px",width:"100%",height:"400px",overflow:"auto"}},ae={style:{display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"2px"}},se={class:"title q-calendar__ellipsis"},oe={class:"title q-calendar__ellipsis"},le={class:"row justify-center items-center"};function ne(e,t,a,s,n,l){const d=S("navigation-bar"),r=S("q-calendar");return c(),_(Y,null,{default:u(()=>[p(d,{onToday:e.onToday,onPrev:e.onPrev,onNext:e.onNext},null,8,["onToday","onPrev","onNext"]),y("div",ee,[y("div",te,[p(r,{ref:"calendar",modelValue:e.currentDate,"onUpdate:modelValue":t[0]||(t[0]=i=>e.currentDate=i),view:"week",dark:"",animated:"",hoverable:"",bordered:"","transition-prev":"slide-right","transition-next":"slide-left","no-active-date":"","interval-minutes":30,"interval-count":48,"interval-height":e.mostEvts*3,onChange:e.onChange,onClickDate:e.onClickDate,onClickTime:e.onClickTime,onClickInterval:e.onClickInterval,onClickHeadIntervals:e.onClickHeadIntervals,onClickHeadDay:e.onClickHeadDay},{"head-day-event":u(({scope:{timestamp:i}})=>[y("div",ae,[(c(!0),f(E,null,N(e.eventsMap[i.date],o=>(c(),f(E,{key:o.id},[o.time?(c(),_(I,{key:1,class:w(e.badgeClasses(o,"header")),style:T([e.badgeStyles(o,"header"),{margin:"1px",width:"10px","max-width":"10px",height:"10px","max-height":"10px",cursor:"pointer"}]),onClick:G=>e.scrollToEvent(o)},{default:u(()=>[p(b,null,{default:u(()=>[v(C(o.time+" - "+o.title),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"])):(c(),_(I,{key:0,class:w(e.badgeClasses(o,"header")),style:T([e.badgeStyles(o,"header"),{width:"100%",cursor:"pointer",height:"12px","font-size":"10px",margin:"1px"}])},{default:u(()=>[y("div",se,[v(C(o.title)+" ",1),p(b,null,{default:u(()=>[v(C(o.details),1)]),_:2},1024)])]),_:2},1032,["class","style"]))],64))),128))])]),"day-body":u(({scope:{timestamp:i,timeStartPos:o,timeDurationHeight:G}})=>[(c(!0),f(E,null,N(e.getEvents(i.date),h=>(c(),f(E,{key:h.id},[h.time!==void 0?(c(),f("div",{key:0,class:w(["my-event",e.badgeClasses(h,"body")]),style:T(e.badgeStyles(h,"body",o,G))},[y("span",oe,[v(C(h.title)+" ",1),p(b,null,{default:u(()=>[v(C(h.details),1)]),_:2},1024)])],6)):j("",!0)],64))),128))]),_:1},8,["modelValue","interval-height","onChange","onClickDate","onClickTime","onClickInterval","onClickHeadIntervals","onClickHeadDay"])])]),y("div",le,[p(x,{class:"q-ma-xl",color:"white","text-color":"blue",unelevated:"",to:"/summary",label:"Summary","no-caps":""}),p(x,{class:"q-ma-xl",color:"white","text-color":"blue",unelevated:"",to:"/dayCalendar",label:"Daily","no-caps":""}),p(x,{class:"q-ma-xl",color:"white","text-color":"blue",unelevated:"",to:"/viewGoals",label:"Goals","no-caps":""})])]),_:1})}var me=z(Z,[["render",ne],["__scopeId","data-v-97c04a08"]]);export{me as default};
