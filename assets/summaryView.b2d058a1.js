import{_ as G,d as Q,L as b,E as r,F as S,G as i,M as d,H as n,K as h,O as g,P as M,R as w,J as k,a3 as f,a1 as v,I as p,a0 as q,a2 as $,Q as x,a6 as V,a7 as N}from"./index.d5412a32.js";import{S as L,t as D,T as E,b as y,i as C,Q as F,e as B}from"./QCalendarTask.06f0220a.js";import{u as H,a as I,Q as P}from"./goalStorage.f129a10b.js";/* empty css                             */import U from"./NavigationBar.2c80bbed.js";const R=Q({name:"summaryCalendar",components:{NavigationBar:U,QCalendarTask:L},data(){return{selectedDate:D(),selectedMonth:"",allMonths:E("long","en-US"),startDate:D(),endDate:D(),store:H(),tasks:[],footerTasks:[{title:"TOTALS"}],$q:I(),treeGoals:[],expanded:[],showTree:!1}},computed:{parsedTasks(){const e=y(this.startDate),t=y(this.endDate),l=[];for(let a=0;a<this.tasks.length;++a){const o=this.tasks[a];for(let c=0;c<o.logged.length;++c){const u=y(o.logged[c].date);if(C(u,e,t)){l.push(o);break}}}return l},getViewedMonth(){return`Goaly in ${this.selectedMonth}`}},beforeMount(){let e=this.store.fetchAllTaskSummary();if(e.length==0){this.$q.notify({color:"negative",position:"center",message:"No summary...please save a schedule to see more!",icon:"warning"});return}this.tasks=e;const t=l=>{l.logged.forEach(a=>{a.date.slice(-2)})};this.tasks.forEach(l=>{t(l),l.children!==void 0&&l.children.forEach(a=>{t(a)})}),this.constructTree()},methods:{getLogged(e,t,l=null){const a=[];if(t.length==0)return console.log("ERROR...Empty getLogged?!?",e,l),a;for(let o=0;o<t.length;++o)if(t[o].date===e){a.push({logged:t[o].logged});break}return a},classyColor(e){return`row items-center ${e.isChildren?"text-":"text-white bg-"}${e.color} `},getLoggedSummary(e){let t=0;const l=(a,o)=>e===o.date?a+o.logged:a;for(const a in this.tasks)t+=this.tasks[a].logged.reduce(l,0);return t.toFixed(2)},constructTree(){this.treeGoals=this.store.fetchGoalsTree(),console.log("constructTree",this.treeGoals.length)},sum(e,t,l){const a=(c,u)=>{const T=y(u.date);return C(T,e,t)?c+u.logged:c};return l.logged.reduce(a,0).toFixed(2)},getTasks(e,t,l){const a=[];for(let o=0;o<l.logged.length;++o){const c=y(l.logged[o].date);if(C(c,e,t)){a.push(l);break}}return a},badgeStyles(e){return`issue ellipsis ${e.isChild?"text-white":`text-white bg-${e.color}`}`},weekdayClass(e){return{"task__weekday--style":!0}},dayClass(e){return{"task__day--style":!0}},footerDayClass(e){return{"task__footer--day__style":!0}},totals(e,t){let l=0;const a=(o,c)=>{const u=y(c.date);return C(u,e,t)?o+c.logged:o};for(const o in this.tasks)l+=this.tasks[o].logged.reduce(a,0);return l.toFixed(2)},onToday(){this.$refs.calendar.moveToToday()},onPrev(){this.$refs.calendar.prev()},onNext(){this.$refs.calendar.next()},onMoved(e){console.log("onMoved",e)},onChange(e){let t=e.days[0].month;console.log("onChange",t,e),this.selectedMonth=this.allMonths[t-1],this.startDate=e.start,this.endDate=e.end},onClickDate(e){console.log("onClickDate",e)},onClickDay(e){console.log("onClickDay",e)},onClickHeadDay(e){console.log("onClickHeadDay",e)}}}),_=e=>(V("data-v-b5dc40e4"),e=e(),N(),e),j={class:"subcontent"},A={class:"q-pa-md"},z={class:"row justify-center"},O={style:{display:"flex","max-width":"800px",width:"100%"}},K={class:"header ellipsis q-ma-sm",style:{"font-weight":"600"}},J={class:"issue ellipsis q-px-xs"},W=_(()=>d("div",{class:"key"},"Key",-1)),X=_(()=>d("div",{class:"logged"},"Logged",-1)),Y={class:"key"},Z={class:"logged"},ee={key:0,class:"logged-time",style:{"font-weight":"800"}},se={key:1,class:"logged-time"},te={class:"summary ellipsis"},ae={class:"title ellipsis"},oe={class:"total"},le={class:"logged-time"},de=_(()=>d("br",null,null,-1)),ne={key:0,class:"column justify-center items-center"},ie={key:0,class:"q-pa-md"},re={key:0,class:"q-pa-md bg-grey-12",style:{"max-width":"400px"}},ce=_(()=>d("div",{class:"row justify-center"}," Goals & Goal Events ",-1)),he=_(()=>d("br",null,null,-1)),ge={class:"q-mr-sm text-weight-bold",size:"28px"},ue={key:0},me={class:"text-weight-bold"},ye={key:1,class:"text-weight-light text-black"};function ke(e,t,l,a,o,c){const u=b("navigation-bar"),T=b("q-calendar-task");return r(),S(F,{padding:""},{default:i(()=>[d("div",j,[d("div",A,[n(u,{onToday:e.onToday,onPrev:e.onPrev,onNext:e.onNext},null,8,["onToday","onPrev","onNext"]),d("div",z,[d("div",O,[n(T,{ref:"calendar",modelValue:e.selectedDate,"onUpdate:modelValue":t[0]||(t[0]=s=>e.selectedDate=s),"model-tasks":e.parsedTasks,"onUpdate:modelTasks":t[1]||(t[1]=s=>e.parsedTasks=s),"model-footer":e.footerTasks,"onUpdate:modelFooter":t[2]||(t[2]=s=>e.footerTasks=s),view:"month","task-width":240,"cell-width":75,"task-key":"key","min-weekday-length":2,"weekday-class":e.weekdayClass,"day-class":e.dayClass,"footer-day-class":e.footerDayClass,"focus-type":["weekday","date","task"],dark:"",focusable:"",hoverable:"",animated:"",bordered:"",onChange:e.onChange,onMoved:e.onMoved,onClickDate:e.onClickDate,onClickDay:e.onClickDay,onClickHeadDay:e.onClickHeadDay},{"head-tasks":i(({})=>[d("div",K,[d("div",J,h(e.getViewedMonth),1),W,X])]),task:i(({scope:s})=>[(r(!0),g(w,null,M(e.getTasks(s.start,s.end,s.task),m=>(r(),g("div",{key:m.key,class:"header ellipsis"},[d("div",{class:$(e.badgeStyles(m))},h(s.task.title)+" ",3),d("div",Y,h(s.task.key),1),d("div",Z,h(e.sum(s.start,s.end,s.task)),1)]))),128))]),day:i(({scope:s})=>[(r(!0),g(w,null,M(e.getLogged(s.timestamp.date,s.task.logged),m=>(r(),g(w,{key:m},[s.task.children!==void 0?(r(),g("div",ee,h(m.logged),1)):(r(),g("div",se,h(m.logged),1))],64))),128))]),"footer-task":i(({scope:s})=>[d("div",te,[d("div",ae,h(s.footer.title),1),d("div",oe,h(e.totals(s.start,s.end)),1)])]),"footer-day":i(({scope:s})=>[d("div",le,h(e.getLoggedSummary(s.timestamp.date)),1)]),_:1},8,["modelValue","model-tasks","model-footer","weekday-class","day-class","footer-day-class","onChange","onMoved","onClickDate","onClickDay","onClickHeadDay"])])]),de,e.tasks.length<=0?(r(),g("div",ne,[n(f,null,{default:i(()=>[k(" 1. Add some Goals first. A schedulable goal is one with a parent Goal--can have multiple related goals with the same parent. ")]),_:1}),n(v),n(f,null,{default:i(()=>[k(" 2. Go to Schedule to see a daily schedule. Drag scheduled events to new timeslots or click in calendar to add an event. ")]),_:1}),n(v),n(f,null,{default:i(()=>[k(" 3. Reload a saved daily schedule or defaults or choose minimal score events to schedule. Fix any scheduling conflicts. ")]),_:1}),n(v),n(f,null,{default:i(()=>[k(" 4. Save the daily schedule (dont forget to update their score as needed!) ")]),_:1}),n(v),n(f,null,{default:i(()=>[k(" 5. Check out the summary of all goals here! ")]),_:1})])):p("",!0)]),n(q,{modelValue:e.showTree,"onUpdate:modelValue":t[3]||(t[3]=s=>e.showTree=s),label:"Tree Legend",color:"teal",class:"q-pa-md"},null,8,["modelValue"]),n(P,null,{default:i(()=>[e.showTree?(r(),g("div",ie,[e.treeGoals.length>0?(r(),g("div",re,[ce,n(v),he,n(B,{nodes:e.treeGoals,"node-key":"label",expanded:e.expanded,"onUpdate:expanded":t[4]||(t[4]=s=>e.expanded=s),"no-connectors":"",dense:"",accordion:""},{"default-header":i(s=>[d("div",{class:$(e.classyColor(s.node))},[s.node.isChildren?p("",!0):(r(),S(x,{key:0,name:s.node.icon||s.expanded?"expand_less":"expand_more",size:"28px",class:"q-mr-sm"},null,8,["name"])),d("div",ge,h(s.node.label),1)],2)]),"default-body":i(s=>[s.node.isChildren?(r(),g("div",ue,[d("span",me," >> "+h(s.node.details),1)])):(r(),g("span",ye,h(s.node.details),1))]),_:1},8,["nodes","expanded"])])):p("",!0)])):p("",!0)]),_:1})])]),_:1})}var Te=G(R,[["render",ke],["__scopeId","data-v-b5dc40e4"]]);export{Te as default};
