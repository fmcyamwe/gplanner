import{j as C,e as U,h as q,T as z,aj as K,r as W,c as A}from"./index.01ac1f1f.js";import{u as P}from"./use-quasar.da98edb0.js";var Z=C({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(v,{slots:O,emit:f}){let y=!1,$,T,b=null,g=null,m,M;function D(){$&&$(),$=null,y=!1,b!==null&&(clearTimeout(b),b=null),g!==null&&(clearTimeout(g),g=null),T!==void 0&&T.removeEventListener("transitionend",m),m=null}function x(i,h,S){h!==void 0&&(i.style.height=`${h}px`),i.style.transition=`height ${v.duration}ms cubic-bezier(.25, .8, .50, 1)`,y=!0,$=S}function E(i,h){i.style.overflowY=null,i.style.height=null,i.style.transition=null,D(),h!==M&&f(h)}function N(i,h){let S=0;T=i,y===!0?(D(),S=i.offsetHeight===i.scrollHeight?0:void 0):(M="hide",i.style.overflowY="hidden"),x(i,S,h),b=setTimeout(()=>{b=null,i.style.height=`${i.scrollHeight}px`,m=p=>{g=null,(Object(p)!==p||p.target===i)&&E(i,"show")},i.addEventListener("transitionend",m),g=setTimeout(m,v.duration*1.1)},100)}function I(i,h){let S;T=i,y===!0?D():(M="show",i.style.overflowY="hidden",S=i.scrollHeight),x(i,S,h),b=setTimeout(()=>{b=null,i.style.height=0,m=p=>{g=null,(Object(p)!==p||p.target===i)&&E(i,"hide")},i.addEventListener("transitionend",m),g=setTimeout(m,v.duration*1.1)},100)}return U(()=>{y===!0&&D()}),()=>q(z,{css:!1,appear:v.appear,onEnter:N,onLeave:I},O.default)}});const _=K("allGoals",()=>{const v=W([{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}]),O=[{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}],f=P(),y=A(()=>O),$=A(()=>{let e=JSON.parse(f.localStorage.getItem("mainGoals"));return g(e)}),T=A(()=>{let e=JSON.parse(f.localStorage.getItem("subGoals"));return g(e)}),b=A(()=>JSON.parse(f.localStorage.getItem("AllDates")));function g(e){return e?[...e]:[]}function m(e,o,t,r){let l=this.getMainGoals;if(!l){console.log("umm no mainGoals...adding"),f.localStorage.set("mainGoals",JSON.stringify([{id:0,title:e,details:o,priority:r,bgcolor:t,icon:"fas fa-utensils"}]));return}let a=l.length+1;for(;l.some(u=>u.id===a);)a=Math.floor(Math.random()*1e3);return l.unshift({id:a,title:e,details:o,priority:r,bgcolor:t,icon:"fas fa-utensils"}),f.localStorage.set("mainGoals",JSON.stringify(l)),a}function M(e,o,t,r,l,a,u){console.log(e+" "+o+" "+t+" "+r+" "+l+" "+a+" "+u);let n=this.getSubGoals;if(!n){f.localStorage.set("subGoals",JSON.stringify([{id:0,parentGoal:e,title:o,score:t,time:r,duration:l,canMove:a,inDefaults:u}]));return}let s=n.length+1;for(;n.some(c=>c.id===s);)s=Math.floor(Math.random()*1e3);return n.unshift({id:s,parentGoal:e,title:o,score:t,time:r,duration:l,canMove:a,inDefaults:u}),f.localStorage.set("subGoals",JSON.stringify(n)),s}function D(e,o,t,r,l,a,u){let n=this.getSubGoals;for(var s=0;s<n.length;s++)if(n[s].id===e){n[s].title=o,n[s].score=t,n[s].time=r,n[s].duration=l,n[s].canMove=a,n[s].inDefaults=u,console.log("editSubGoal for",n[s],s);break}f.localStorage.set("subGoals",JSON.stringify(n))}function x(){f.localStorage.remove("mainGoals"),console.log("removed all mainGoal")}function E(){f.localStorage.remove("subGoals"),console.log("removed all subGoals")}function N(){f.localStorage.remove("subGoals"),f.localStorage.remove("mainGoals"),console.log("removed ALL")}function I(e,o=null,t=null){let r=this.getSubGoals;for(var l=0;l<r.length;l++)if(r[l].id===e){r[l].time=o||r[l].time,r[l].score=t||r[l].score;break}f.localStorage.set("subGoals",JSON.stringify(r))}function i(e){let o=this.getSubGoals;for(var t=0;t<o.length;t++)o[t].id===e&&(o.splice(t,1),console.log("removeSubgoal spliced!"));return f.localStorage.set("subGoals",JSON.stringify(o)),o}function h(e,o){let t=this.getMainGoals;for(var r=0;r<t.length;r++)t[r].id===e&&(t.splice(r,1),console.log("removeMaingoal spliced!"));return f.localStorage.set("mainGoals",JSON.stringify(t)),t}function S(e){let o=this.getMainGoals;for(var t=0;t<o.length;t++)if(o[t].title===e)return o[t];return null}function p(e,o=null){let t=this.getAllDates;t?o?t[`${e}`]=o:e in t?delete t[`${e}`]:console.log(`ERROR? deleting schedule of ${e} not found!`):(console.log(`Adding new schedule for ${e}`),t={},t[`${e}`]=o),f.localStorage.set("AllDates",JSON.stringify(t))}function J(e){let o=this.getAllDates;if(o)return o[`${e}`]}function R(e){let o=this.getAllDates;return o?!!o[`${e}`]:!1}function L(){const e=[];let o=function(r){return r==null?void 0:r.inDefaults},t=this.getSubGoals;return t?(t.forEach(r=>{o(r)&&e.push(r)}),e):(console.log("No subgoals to fetch defaults :("),e)}function w(e=null){let o=this.getMainGoals,t=new Set;if(e)for(var r=0;r<o.length;r++)o[r].priority==e&&t.add(o[r].priority);else o.forEach(l=>{t.add(l.priority)});return t}function F(e){const o=[];let t=function(l){const a=l.split(/on/);return a.length!=2?(console.log(`parseScore error?${l}`,a),-1):a[1]-a[0]},r=this.getSubGoals;return r&&r.forEach(l=>{if(l.score=="")console.log(`no score event added: ${l.title}`,l.score),o.push(l);else{let a=t(l.score);a>-1&&a>=e&&o.push(l)}}),o}function H(e){const t=(e/60).toFixed(2);return parseFloat(t)}function Y(){let e=this.getMainGoals,o=this.getSubGoals,t=l=>{let a=[];return o&&o.forEach(u=>{u.parentGoal==l&&a.push(u)}),a},r=[];return e.forEach(l=>{var n,s,c,G;let a={label:`${l.id}- ${l==null?void 0:l.title.trim()}(${l==null?void 0:l.priority})`,color:`${l==null?void 0:l.bgcolor}`,prio:l==null?void 0:l.priority,children:[]},u=t(l.id);for(let d=0;d<u.length;d++){let Q=u[d].inDefaults?"D":"#",B=u[d].canMove?"M":"#";a.children.push({label:`${u[d].id}-- ${(n=u[d])==null?void 0:n.title.trim()}(${(s=u[d])==null?void 0:s.score}) at ${(c=u[d])==null?void 0:c.time}..${(G=u[d])==null?void 0:G.duration} ::${Q}${B}`})}r.push(a)}),r}function j(){let e=this.getAllDates;if(!e)return[];let o=this.getMainGoals,t=this.getSubGoals,r={};for(let n in e){let s=e[n];for(let c in s)r[c]||(r[c]=[]),r[c].push({date:n,logged:H(s[c].duration)})}let l=n=>{let s=[];return t&&t.forEach(c=>{c.parentGoal==n&&s.push(c)}),s},a=(n,s=null)=>{let c={children:[],title:s?`${n.title.trim()}(${n.score})`:`${n.title.trim()} !${n.priority}!`,key:s?`${s}-${n.id}`:n.id,logged:[],expanded:!1,color:n==null?void 0:n.bgcolor,isChild:!!s};if(s){let G=r[n.id]||[];c.logged=[...G]}return c},u=[];return o.forEach(n=>{let s=a(n),c=l(n.id);for(let G=0;G<c.length;G++){let d=a(c[G],n.id);if(d.logged.length==0){console.log(`Oooh no logged for parent ${n.title}`,d);continue}s.logged.push(...d.logged),s.children.push(d)}u.push(s)}),u}return{headers:O,headerRefs:v,getHeaders:y,getMainGoals:$,getSubGoals:T,getAllDates:b,addMainGoal:m,addSubGoal:M,editSubGoal:D,getGoalByTitle:S,saveSubProp:I,saveDailySchedule:p,resetSub:E,resetMain:x,resetAll:N,removeSubgoal:i,removeMaingoal:h,getEventsForDate:J,hasEventsForDate:R,fetchAllTaskSummary:j,fetchGoalsWithMinScore:F,fetchAllPrio:w,fetchDefaults:L,fetchGoalsTree:Y}});export{Z as Q,_ as u};
