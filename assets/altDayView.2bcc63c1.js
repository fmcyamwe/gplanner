import{j as ze,U as We,W as qe,r as x,c as ne,w as Me,n as Qe,h as me,k as Te,ay as Ke,D as Ye,g as Xe,az as Ze,ad as Ee,v as et,aA as tt,aa as pe,aC as _e,ab as Re,Z as it,_ as ot,$ as re,L as le,E as _,F as X,G as $,M as J,H as N,O as I,I as G,N as ke,K as W,J as U,a1 as se,Q as De,a2 as Se,a3 as Z,bs as lt,P as Be,R as fe,a5 as ge,a4 as ae,aS as we,f as st,a6 as nt,a7 as rt}from"./index.90b4fdeb.js";import{w as L,c as he,p as at,a as dt,b as ht,Q as ye}from"./utiFunc.d3e12448.js";import{T as ct,Q as ut,a as ft}from"./QSelect.fb2dbc3b.js";import{c as Ne,a as gt,u as mt,Q as Ae}from"./goalStorage.e06597d2.js";import{t as ve,E as xe,b as Q,c as $e,a as k,p as ee,d as te,U as Y,i as Le,V as pt,m as Pe,l as de,Q as St,e as yt}from"./QCalendarTask.9762cace.js";import{a as Ot}from"./QCalendar.9e76946c.js";/* empty css                             */import"./touch.70a9dd44.js";import"./QItem.643b1653.js";var Ie=ze({name:"QSplitter",props:{...We,modelValue:{type:Number,required:!0},reverse:Boolean,unit:{type:String,default:"%",validator:i=>["%","px"].includes(i)},limits:{type:Array,validator:i=>i.length!==2||typeof i[0]!="number"||typeof i[1]!="number"?!1:i[0]>=0&&i[0]<=i[1]},emitImmediately:Boolean,horizontal:Boolean,disable:Boolean,beforeClass:[Array,String,Object],afterClass:[Array,String,Object],separatorClass:[Array,String,Object],separatorStyle:[Array,String,Object]},emits:["update:modelValue"],setup(i,{slots:e,emit:t}){const{proxy:{$q:o}}=Xe(),l=qe(i,o),s=x(null),n={before:x(null),after:x(null)},a=ne(()=>`q-splitter no-wrap ${i.horizontal===!0?"q-splitter--horizontal column":"q-splitter--vertical row"} q-splitter--${i.disable===!0?"disabled":"workable"}`+(l.value===!0?" q-splitter--dark":"")),g=ne(()=>i.horizontal===!0?"height":"width"),p=ne(()=>i.reverse!==!0?"before":"after"),C=ne(()=>i.limits!==void 0?i.limits:i.unit==="%"?[10,90]:[50,1/0]);function T(r){return(i.unit==="%"?r:Math.round(r))+i.unit}const v=ne(()=>({[p.value]:{[g.value]:T(i.modelValue)}}));let y,b,D,m,O;function w(r){if(r.isFirst===!0){const S=s.value.getBoundingClientRect()[g.value];y=i.horizontal===!0?"up":"left",b=i.unit==="%"?100:S,D=Math.min(b,C.value[1],Math.max(C.value[0],i.modelValue)),m=(i.reverse!==!0?1:-1)*(i.horizontal===!0?1:o.lang.rtl===!0?-1:1)*(i.unit==="%"?S===0?0:100/S:1),s.value.classList.add("q-splitter--active");return}if(r.isFinal===!0){O!==i.modelValue&&t("update:modelValue",O),s.value.classList.remove("q-splitter--active");return}const d=D+m*(r.direction===y?-1:1)*r.distance[i.horizontal===!0?"y":"x"];O=Math.min(b,C.value[1],Math.max(C.value[0],d)),n[p.value].value.style[g.value]=T(O),i.emitImmediately===!0&&i.modelValue!==O&&t("update:modelValue",O)}const h=ne(()=>[[ct,w,void 0,{[i.horizontal===!0?"vertical":"horizontal"]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function c(r,d){r<d[0]?t("update:modelValue",d[0]):r>d[1]&&t("update:modelValue",d[1])}return Me(()=>i.modelValue,r=>{c(r,C.value)}),Me(()=>i.limits,()=>{Qe(()=>{c(i.modelValue,C.value)})}),()=>{const r=[me("div",{ref:n.before,class:["q-splitter__panel q-splitter__before"+(i.reverse===!0?" col":""),i.beforeClass],style:v.value.before},Te(e.before)),me("div",{class:["q-splitter__separator",i.separatorClass],style:i.separatorStyle,"aria-disabled":i.disable===!0?"true":void 0},[Ke("div",{class:"q-splitter__separator-area absolute-full"},Te(e.separator),"sep",i.disable!==!0,()=>h.value)]),me("div",{ref:n.after,class:["q-splitter__panel q-splitter__after"+(i.reverse===!0?"":" col"),i.afterClass],style:v.value.after},Te(e.after))];return me("div",{class:a.value,ref:s},Ye(e.default,r))}}}),vt=Ze({name:"touch-hold",beforeMount(i,e){const{modifiers:t}=e;if(t.mouse!==!0&&Ee.has.touch!==!0)return;const o={handler:e.value,noop:et,mouseStart(s){typeof o.handler=="function"&&tt(s)===!0&&(pe(o,"temp",[[document,"mousemove","move","passiveCapture"],[document,"click","end","notPassiveCapture"]]),o.start(s,!0))},touchStart(s){if(s.target!==void 0&&typeof o.handler=="function"){const n=s.target;pe(o,"temp",[[n,"touchmove","move","passiveCapture"],[n,"touchcancel","end","notPassiveCapture"],[n,"touchend","end","notPassiveCapture"]]),o.start(s)}},start(s,n){o.origin=_e(s);const a=Date.now();Ee.is.mobile===!0&&(document.body.classList.add("non-selectable"),Ne(),o.styleCleanup=g=>{o.styleCleanup=void 0;const p=()=>{document.body.classList.remove("non-selectable")};g===!0?(Ne(),setTimeout(p,10)):p()}),o.triggered=!1,o.sensitivity=n===!0?o.mouseSensitivity:o.touchSensitivity,o.timer=setTimeout(()=>{o.timer=void 0,Ne(),o.triggered=!0,o.handler({evt:s,touch:n!==!0,mouse:n===!0,position:o.origin,duration:Date.now()-a})},o.duration)},move(s){const{top:n,left:a}=_e(s);o.timer!==void 0&&(Math.abs(a-o.origin.left)>=o.sensitivity||Math.abs(n-o.origin.top)>=o.sensitivity)&&(clearTimeout(o.timer),o.timer=void 0)},end(s){Re(o,"temp"),o.styleCleanup!==void 0&&o.styleCleanup(o.triggered),o.triggered===!0?s!==void 0&&it(s):o.timer!==void 0&&(clearTimeout(o.timer),o.timer=void 0)}},l=[600,5,7];if(typeof e.arg=="string"&&e.arg.length>0&&e.arg.split(":").forEach((s,n)=>{const a=parseInt(s,10);a&&(l[n]=a)}),[o.duration,o.touchSensitivity,o.mouseSensitivity]=l,i.__qtouchhold=o,t.mouse===!0){const s=t.mouseCapture===!0||t.mousecapture===!0?"Capture":"";pe(o,"main",[[i,"mousedown","mouseStart",`passive${s}`]])}Ee.has.touch===!0&&pe(o,"main",[[i,"touchstart","touchStart",`passive${t.capture===!0?"Capture":""}`],[i,"touchend","noop","notPassiveCapture"]])},updated(i,e){const t=i.__qtouchhold;t!==void 0&&e.oldValue!==e.value&&(typeof e.value!="function"&&t.end(),t.handler=e.value)},beforeUnmount(i){const e=i.__qtouchhold;e!==void 0&&(Re(e,"main"),Re(e,"temp"),e.timer!==void 0&&clearTimeout(e.timer),e.styleCleanup!==void 0&&e.styleCleanup(),delete i.__qtouchhold)}});const bt=()=>!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);let ce,j;function Ct(){ce={},j=gt()}function Tt(){ce.pGoalsMap==null;const i=new Map;let e=Ue();return e?(e.forEach(t=>{i.set(t.id,t)}),ce.pGoalsMap=i,i):(console.log("Repo:: parentGoalsMap is empty or null",e),i)}function Et(i){return j.hasEventsForDate(i)}function Ge(i){return j.getEventsForDate(i)}function Ue(){return j.getMainGoals}function Rt(){return ce.subGoals==null&&(ce.subGoals=j.getSubGoals),ce.subGoals}function Dt(){return j.fetchAlternativeEvts()}function wt(){return j.currentBalance()}function Nt(){return j.fetchGoalsTree()}function At(){let i=j.fetchAllPrio();return!i.size>0?(console.log("ERROR...no Priority goals?",i),[]):Array.from(i.values()).sort()}function $t(i){return j.fetchGoalsUpToMaxScore(i)}function Ve(i,e=null,t=null){j.saveSubProp(i,e,t)}function Pt(){return j.getGoalByTitle("Misc")}function Fe(i){j.setBalance(i)}function Je(i,e){j.saveDailySchedule(i,e)}function Mt(i,e,t,o){return j.addMainGoal(i,e,t,o)}function Oe(i,e,t,o,l,s,n,a,g){return j.addSubGoal(i,e,t,o,l,s,n,a,g)}function _t(i,e,t=null){let o=i,l=e.id,s=e,n=t,a=i.duration,g=i.time,p=null,C=null;return{id:l,duration:a,time:g,date:()=>p,datey:T,score:v(),atScore:o.atScore,getGoal:()=>s,getPGoal:()=>n,data:()=>o,setData:r=>o=r,setMoods:r=>C=r,getMoods:m,setNotes:r=>r,hasNote:y,setDura:r=>a=r,setTime:r=>g=r,setDate:r=>p=r,durationChanged:b,timeChanged:D,parsedScore:O,withPropsEventsTo:h,addPropsEventsTo:c};function T(){return p}function v(){return o.atScore||e.score}function y(){return i.notes!==void 0}function b(){return i.duration!==e.duration}function D(){return i.time!==e.time}function m(){return"byMood"in o&&(C=o.byMood),C}function O(){const r=v().split(/on/);return r.length!=2?-89:r[1]-r[0]}function w(r){if(!r)return"";let d=r.split(":");return parseInt(d[0])>=12?r+"PM":r+"AM"}function h(r,d=null){let u=Object.assign({},{...this});return u.bgcolor=r.bgcolor,u.jeSuis?u.details=`Of '${r.title.trim()}' :: << ${u.jeSuis.join(",")} >>`:u.details=`Of '${r.title.trim()}' :: ${w(u==null?void 0:u.time)} -> ${u==null?void 0:u.duration}min -- ${u!=null&&u.inDefaults?"Dft:":":"}${u!=null&&u.canMove?":Mv:":":"}${u!=null&&u.isAlternative?":Alt":":"}`,console.log("withProps",JSON.parse(JSON.stringify(u)),u.datey(),u.date(),u.title,u.details),u}function c(r){if(!n){console.log("addProps:: ERROR no parentGoal",this.data);return}this.data,getGoal();let d=Object.assign({},{...sav});return d.bgcolor=t.bgcolor,d.jeSuis?d.details=`Of '${t.title.trim()}' :: << ${d.jeSuis.join(",")} >>`:d.details=`Of '${t.title.trim()}' :: ${w(d==null?void 0:d.time)} -> ${d==null?void 0:d.duration}min -- ${d!=null&&d.inDefaults?"Dft:":":"}${d!=null&&d.canMove?":Mv:":":"}${d!=null&&d.isAlternative?":Alt":":"}`,console.log("addProps",JSON.parse(JSON.stringify(d)),d.datey(),d.date(),d.title,d.details),d}}class kt{constructor(e,t){this.showReloadBtn=!1,this.showClearBtn=!1,this.showLoadDefaults=!0,this.showScoreBtn=!0,this.showPrioBtn=!0,this.showOneEachBtn=!1,this.disablePrioBtn=!0,this.disableScoreBtn=!0,this.disableSaveSchedule=!0,this.chosenScore=null,this.chosenPrio=null,this._dailyScheduled=new Map,this._endTimesSet=new Set,this._startTimesSet=new Set,this.savedRawEvts=[],this.actualEvts=[],this.usingMoods={},this.isDisabledScoreEdit={},this.hasStarted={},this.mobileEnableScore={},this.showMobileDialog={},this.currentDate=e,this.mobile=t,Ct()}allPGoals(){return Ue()}getAllEvts(){return this.actualEvts}showEvtNoteScoreMobile(e){return this.mobileEnableScore[e]&&this.showMobileDialog[e]}toggleEvtNoteScoreMobile(e){(this.isViewingPast()||this.isViewingToday())&&(this.showMobileDialog[e]=!0)}euhHidin(e){this.showMobileDialog[e]=!1}getCurrentSchedTimesSets(){return{endSet:this._endTimesSet,startSet:this._startTimesSet}}isViewingPast(){let e=ve();if(this.currentDate&&this.currentDate==e)return!1;let t=xe(Q(e));return!(xe(Q(this.currentDate))>=t)}isViewingToday(){return ve()==this.currentDate}toggle(){this.showReloadBtn=!this.showReloadBtn}getProps(){return{showReloadBtn:this.showReloadBtn,showClearBtn:this.showClearBtn,showLoadDefaults:this.showLoadDefaults,showScoreBtn:this.showScoreBtn,showPrioBtn:this.showPrioBtn,showOneEachBtn:this.showOneEachBtn,disablePrioBtn:this.disablePrioBtn,disableScoreBtn:this.disableScoreBtn,chosenScore:this.chosenScore,chosenPrio:this.chosenPrio}}saveBtnEnabled(){return this.disableSaveSchedule}fetchGoalsTree(){return Nt()}getCurrentBalance(){return wt()}getAllPrio(){return At()}getSubGoals(){return Rt()}getCurrentMoods(){return this.usingMoods}getSubGoalByID(e){let t=this.getSubGoals(),o=parseInt(e);for(let l=0;l<t.length;l++)if(t[l].id===o)return t[l];return null}getOriginalEvtTime(e){let t=this.getSubGoalByID(e);return t?t.time:""}getStoredRawEvt(e){return e in this.savedRawEvts?this.savedRawEvts[e]:null}getAltEvts(){return Dt()}getEventsForDate(e){return Ge(e)}updateDaySchedule(e,t){Je(e,t)}parentGoalsMap(){return Tt()}parentGoalById(e){return this.parentGoalsMap().has(e)?this.parentGoalsMap().get(e):null}findSchedEvent(e){return this._dailyScheduled.has(e)?this._dailyScheduled.get(e):null}findEvent(e){for(let t=0;t<this.actualEvts.length;t++)if(this.actualEvts[t].id===e)return this.actualEvts[t];return null}hasEventsForDate(){return Et(this.currentDate)}currentSchedEventsMap(){const e={};return this.actualEvts.forEach(t=>{let o=t.date;if(e[o]||(e[o]=[]),e[o].push(t),t.days){console.log(`currentSchedEventsMap multiple days? event for ${t.date}`,t.days);let l=$e(t.date),s=t.days;do l=k(l,{day:1}),map[l.date]||(map[l.date]=[]),map[l.date].push(t);while(--s>0)}}),e}schedEvtWithProps(e,t,o){if(!e.getPGoal()){console.log("schedEvtWithProps:: ERROR no parentGoal",e.data);return}let l=e.data(),s=e.getGoal(),n=e.getPGoal(),a={...s};(e.timeChanged()||e.durationChanged())&&(a.time=l.time,a.duration=l.duration),e.setDate(this.currentDate);let g=e.getMoods();if(g){//!==
this.usingMoods[a.id]=g}return a.date=this.currentDate,a.bgcolor=n.bgcolor,a.icon=n.icon,a.start=t,a.end=o,a.jeSuis&&a.jeSuis.length>0?a.details=`Of '${n.title.trim()}' :: << ${a.jeSuis.join(",")} >>`:a.details=`Of '${n.title.trim()}' :: ${L(a==null?void 0:a.time)} -> ${a==null?void 0:a.duration}min -- ${a!=null&&a.inDefaults?"Dft:":":"}${a!=null&&a.canMove?":Mv:":":"}${a!=null&&a.isAlternative?":Alt":":"}`,e.hasNote()&&(a.notes=l.notes),a}doProppy(e,t){let o=this.parentGoalById(e.parentGoal);if(!o){console.log("doProppy:: ERROR no Pgoal found ?!?",e);return}let l=k(Q(t),{minute:ee(e.time)}),s=k(l,{minute:e.duration}),n=Object.assign({},{...e,date:t,bgcolor:o.bgcolor,start:l,end:s,icon:o.icon});return e.jeSuis&&e.jeSuis.length>0?n.details=`Of '${o.title.trim()}' :: << ${e.jeSuis.join(",")} >>`:n.details=`Of '${o.title.trim()}' :: ${L(e==null?void 0:e.time)} -> ${e==null?void 0:e.duration}min -- ${e!=null&&e.inDefaults?"Dft:":":"}${e!=null&&e.canMove?":Mv:":":"}${e!=null&&e.isAlternative?":Alt":":"}`,n.sortTime=l,"byMood"in e&&(console.log("doProppy::BYMOOD found!! ERROR?!?",JSON.parse(JSON.stringify(e))),this.usingMoods[n.id]=e.byMood),n}addGoalsToSchedule(e,t){let o={};return e.forEach(l=>{let s=this.addToSchedule(l,t,!1);s?Array.isArray(s)&&(o[l.id]=s):console.log("addGoalsToSchedule:: ERROR Evt NOT added",s,t,l.id,l.title)}),this.massageOverlapObj(o)}addToSchedule(e,t,o=!1){if(this._dailyScheduled.has(e.id))return!1;{let l=k(Q(this.currentDate),{minute:ee(e.time)}),s=k(l,{minute:e.duration});if(t){let g=this.hasOverlappingEvent(e.id,l,s);if(g.length>0)return g}let n=o?this.schedEvtWithProps(e,l,s):this.doProppy(e,this.currentDate);n.sortTime=l,this.actualEvts.push(n);let a={...n,for:n.duration,start:l,end:s};o&&e.atScore&&(a.atScore=e.atScore),this._dailyScheduled.set(n.id,a),this._endTimesSet.add(s.time),this._startTimesSet.add(l.time),this.enableNoteScoreEdit(n.id,l,s)}return!0}enrichAddToSchedule(){let e={},t=this.isViewingToday();console.log("enrichAddToSchedule",Object.keys(this.savedRawEvts).length,"overlapCheck:"+t);for(let o in this.savedRawEvts){let l=this.savedRawEvts[o],s=this.getSubGoalByID(o);if(!s){console.log(`enrichAddToSchedule:: No goal found for key: ${o}...skipping!`);continue}let n=this.parentGoalById(s.parentGoal),a=_t(l,s,n),g=this.addToSchedule(a,t,!0);g?Array.isArray(g)&&(e[s.id]=g):console.log("enrichAddToSchedule..ERROR?!? not added",g,s)}return this.massageOverlapObj(e)}loadEvtsForDay(e){return e||this.resetSchedule(!0),this.savedRawEvts=Ge(this.currentDate),this.savedRawEvts?{overlaps:this.enrichAddToSchedule(),canContinue:!1}:{overlaps:null,canContinue:!0}}onChangeViewDate(e){let t=e==this.currentDate;return this.currentDate=e,this.enableActionBtns(),this.loadEvtsForDay(t)}resetSchedule(e=!1){this.savedRawEvts=[],this.actualEvts=[],this._dailyScheduled=new Map,this._endTimesSet=new Set,this._startTimesSet=new Set,e&&(this.usingMoods={}),this.showReloadBtn=!1,this.showClearBtn=!1,this.disableSaveSchedule=!0}unscheduledDefaults(){return this.getSubGoals().filter(t=>(t==null?void 0:t.inDefaults)&&(t==null?void 0:t.time)!=""&&!this.actualEvts.find(o=>o.id==t.id))}unscheduled(){return this.getSubGoals().filter(t=>!this.actualEvts.find(o=>o.id==t.id))}subGoalsOfParent(e){return this.getSubGoals().filter(o=>o.parentGoal==e)}chosenScoreLabel(){return this.chosenScore==null?"By Score":`Score <= ${this.chosenScore}`}chosenPrioLabel(){return this.chosenPrio==null?"By Priority":`Prio = ${this.chosenPrio}`}onChoosenPrio(e){let t=this.chosenPrio;t&&t==e?this.disablePrioBtn=!0:(this.chosenPrio=e,this.disablePrioBtn=!1)}onChoosenScore(e){let t=this.chosenScore;t&&t==e?this.disableScoreBtn=!0:(this.chosenScore=e,this.disableScoreBtn=!1)}scheduleByScore(e){const t=()=>{let n=[];return this.actualEvts.forEach(a=>{let g=he(a.score);g>-1&&g<=this.chosenScore&&n.push(a)}),n};let o=[];if(e=="filter")o=t(),this.resetSchedule();else{const n=$t(this.chosenScore);e=="add"?o=n.filter(a=>!this.actualEvts.find(g=>g.id==a.id)):(o=n,this.resetSchedule(!0))}if(console.log(`scheduleByScore::AFTER flag ${e} from size: ${this.actualEvts.length} to some evts = ${o.length}`),o.length<1)return this.toggleActionBtns(!1,"byScore"),{overlaps:null,canContinue:!1};let l=this.addGoalsToSchedule(o,this.isViewingToday()),s=Object.keys(l).length;return this.updateCurrentMoods(),this.toggleActionBtns(o.length>0,"byScore"),{overlaps:l,canContinue:!(s>0)}}scheduleSamePrio(e){const t=()=>this.actualEvts.filter(n=>{var a;return((a=this.parentGoalById(n.parentGoal))==null?void 0:a.priority)==this.chosenPrio});let o=[];if(e=="filter")o=t(),this.resetSchedule();else{let n=this.getSubGoals();for(let a of n){let g=this.parentGoalById(a.parentGoal);(g==null?void 0:g.priority)==this.chosenPrio&&o.push(a)}e=="add"?o=o.filter(a=>!this.actualEvts.find(g=>g.id==a.id)):this.resetSchedule(!0)}if(o.length<1)return this.toggleActionBtns(!1,"byPrio"),{overlaps:null,canContinue:!1};let l=this.addGoalsToSchedule(o,this.isViewingToday()),s=Object.keys(l).length;return this.updateCurrentMoods(),this.toggleActionBtns(o.length>0,"byPrio"),{overlaps:l,canContinue:!(s>0)}}massageOverlapObj(e){let t={};for(let o in e){let l=e[o];if(l.length>0){let s=0;do{let n=l[s];t[n.inConflict]||(t[n.inConflict]=[]),t[n.inConflict].push(n),s>0&&(n.inConflict in t&&delete t[n.inConflict],l[s-1].inConflict in t&&delete t[l[s-1].inConflict],t[n.target]?(t[n.target].push(n),console.log("WOAH WOAH,massageOverlapObj::obj.id already present! ERROR?",n.target)):t[n.target]=[n],t[n.target].unshift(l[s-1]),t.withID||(t.withID=[]),t.withID.push(n.target))}while(++s<l.length)}}return t}massageSingleOverlapArr(e){let t={};for(let o=0;o<e.length;o++){let l=e[o];t[l==null?void 0:l.inConflict]?t[l==null?void 0:l.inConflict].push(l):t[l==null?void 0:l.inConflict]=[l],o>0&&(console.log("WOAH WOAH,massageSingleOverlapArr..multiple overlaps with same target>>",e[o].target),l.inConflict in t&&(console.log("WOAH deleting inConflict",l.inConflict),delete t[l.inConflict]),e[o-1].inConflict in t&&(console.log("WOAH deleting PREV inConflict",e[o-1].inConflict),delete t[e[o-1].inConflict]),t[l.target]?(t[l.target].push(l),console.log("WOAH obj.id already present?",l.target)):t[l.target]=[l],t[l.target].unshift(e[o-1]),t.withID||(t.withID=[]),t.withID.push(l.target))}return t}scheduleOneEach(e){const t=a=>{let g=[];return this.parentGoalsMap().forEach((p,C,T)=>{let v=this.subGoalsOfParent(p.id);if(v.length>0){let y=null,b=v.length;if(a)y=v[Math.floor(Math.random()*b)];else{let D=0;for(;this.actualEvts.some(m=>v[b].id==m.id);)if(D++,b=Math.floor(Math.random()*v.length),console.log(`selectOneFromP::index ${b} scheduled...new random> At try> `+D,v.length),D>2){console.log("selectOneFromP::random...TOO MANY TRIES..ERROR?",D,b,v.length,v);break}y=v[b],console.log("selectOneFromP::NO Random at index: "+b,D,y)}g.push(y)}else console.log("scheduleOneEach::selectOneFromP...huh no subgoals for parentGoal",p)}),g},o=()=>{let a=this.unscheduled(),g=[];return this.parentGoalsMap().forEach((p,C,T)=>{let v=a.filter(b=>b.parentGoal==p.id),y=v.length;if(y>0){let b=v[Math.floor(Math.random()*y)];g.push(b)}else console.log("scheduleOneEach::NO SUBGOAL for",C,p==null?void 0:p.title)}),g};let l=[];if(e=="add"?(l=o(),console.log("scheduleOneEach...TOADD>> "+l.length)):(this.resetSchedule(!0),l=t(!0)),l.length<1)return console.log("Empty for OneEach :("),this.toggleActionBtns(!1,"oneEach"),{overlaps:null,canContinue:!1};let s=this.addGoalsToSchedule(l,this.isViewingToday()),n=Object.keys(s).length;return this.toggleActionBtns(l.length>0,"oneEach"),{overlaps:s,canContinue:!(n>0)}}scheduleByMood(e){var s;let t=[];for(let n=0;n<e.length;n++){let a=this.getSubGoalByID(e[n].id);a&&a.time!=""&&(t.push(a),this.usingMoods[e[n].id]=(s=e[n])==null?void 0:s.mood)}if(t.length<1)return console.log("Empty for Mood :("),this.toggleActionBtns(!1,"ByMood"),{overlaps:null,canContinue:!1};let o=this.addGoalsToSchedule(t,this.isViewingToday()),l=Object.keys(o).length;return l>0&&console.log(`scheduleByMood overlaps!! to ${t.length}. overlaps =${l}`),this.toggleActionBtns(t.length>0,"ByMood"),{overlaps:o,canContinue:!(l>0)}}scheduleDefaults(e){let t=null;e=="add"?t=this.unscheduledDefaults():(this.resetSchedule(!0),t=this.unscheduledDefaults()),this.showReloadBtn=this.hasEventsForDate(),this.showClearBtn=!this.isViewingPast()&&t.length>0;let o=this.addGoalsToSchedule(t,this.isViewingToday()),l=Object.keys(o).length;return l>0&&console.log(`scheduleDefaults:: Overlaps!! for ${t.length}...overlaps =${l}`),this.toggleActionBtns(t.length>0,"defaults"),{overlaps:o,canContinue:!(l>0)}}saveNewGoal(e,t,o,l,s){if(console.log(`saveNewGoal:${t} :${l}: from ${e.time}.Duration:${s}`,o),l=="self"){let n=this.addParentGoal(t,t,"purple-10",2);return n?Oe(n,t,"1on5",e.time,s,!0,!1,s<30):(console.log("ERROR? no pID",n),null)}else if(o){return console.log("with parentGoal "+o.id,o==null?void 0:o.title),Oe(o.id,t,"1on5",e.time,s,!1,!1,s<30);//!canMove and notInDefaults. isAlternative when duration<30
}else{let n=Pt();if(n)return Oe(n.id,t,"1on5",e.time,s,!1,!1,s<30);{let a=this.addParentGoal("Misc","Miscellaneous","grey-10",2);if(a)return Oe(a,t,"1on5",e.time,s,!0,!1,s<30)}}}addParentGoal(e,t,o="red-14",l=2){let s=[];this.parentGoalsMap().forEach((g,p,C)=>{let T=g.bgcolor;s.push(T)});let n=at(),a=s.length;if(a>1){let g=a,p=0;for(;s.some(T=>n[g]==T);)p++,g=Math.floor(Math.random()*a),p>7&&console.log("addParentGoal::TOO MANY TRIES..Break?",p,g,a);let C=n[g];console.log(`addParentGoal::bgcolor..index ${g} from ${o} to:`,C),o=C||o}return Mt(e,t,o,l)}onPickEvent(e,t,o,l,s=null){const n=()=>{l&&(this.removeFromBalance(e==null?void 0:e.duration),console.log("onPickEvent...useBalance","force?"+o));let C=this.addToSchedule({...e,time:t.time},!1);return this.isViewingPast()||l?this.saveDaySchedule():this.toggleActionBtns(!0,"onPickEvt"),{overlaps:C,canContinue:!0}};let a=k(t,{minute:e.duration}),g=this.hasOverlappingEvent(e.id,t,a),p=g.length;if(p>0){console.log("onPickEvent::OVERLAPS!!"+p,"with force "+o,JSON.parse(JSON.stringify(g)));let C={overlaps:this.massageSingleOverlapArr(g),canContinue:!1};return p>1||!o?C:(s&&s(`onPickEvent::OVERLAPS!! ${p}`),this.recurChangeTime(g[0].inConflict,e,t,!0,s),l&&this.removeFromBalance(e==null?void 0:e.duration),this.isViewingPast()||l?this.saveDaySchedule():this.toggleActionBtns(!0,"onPickEvt"),{overlaps:null,canContinue:!0})}else return n()}onAdHocEvent(e,t,o,l=null){const s=p=>(o&&(this.removeFromBalance(p==null?void 0:p.duration),console.log("onAdHocEvent...using Balance",p==null?void 0:p.duration)),this.saveDaySchedule(),{overlaps:null,canContinue:!0});let n=this.getSubGoalByID(e);if(!n)return{overlaps:null,canContinue:!1};let a=this.addToSchedule(n,!0),g=Array.isArray(a);if(!a||g){console.log("onAdHocEvent::Overlaps!!",JSON.parse(JSON.stringify(a)));let p={overlaps:a?this.massageSingleOverlapArr(a):null,canContinue:!1};return g&&a.length>1?p:g&&a.length==1?(console.log("onAdHocEvent::Overlaps!!--FORCING",n,t.time),l&&l(`onAdHocEvent::OVERLAPS!! ${a.length}`),this.recurChangeTime(a[0].inConflict,n,t,!0,l),s(n)):p}return s(n)}recurChangeTime(e,t,o,l=!1,s=null){var a,g,p,C,T,v,y;let n=this.findSchedEvent(e);if(n){let b=ee(n.start.time)-ee(o.time),D=`${b>0?"DOWN":"UP"}`,m=null;if(b>=0){m=k(o,{minute:parseInt(t.duration)+10});let r=k(o,{minute:parseInt(n.for)+10});console.log(`recurChangeTime::(${e}) '${n==null?void 0:n.title}' going FORWARD ${D} for ${b} due to evt:(${t.id})${(a=t==null?void 0:t.title)==null?void 0:a.trim()} at ${o.time} 
          
 doAdd?:${l} >`,JSON.parse(JSON.stringify(m.time)),"alt:",r.time);let d=te(r,m);d>0&&(Math.floor(d/1e3/60)<=b?console.log(`recurChangeTime::(${e})....with duration:${n.for} vs evtDura:${t.duration}...NOT using alternative!!`):(console.log(`recurChangeTime::DIFFY>>${d}...gonna use Alternative`,r.time),m=r))}else{m=k(o,{minute:-(parseInt(n.for)+10)});let r=k(o,{minute:-(parseInt(t.duration)+10)});console.log(`recurChangeTime::(${e}) '${n==null?void 0:n.title}' going BACKWARD ${D} for ${b} due to evt:(${t.id})${(g=t==null?void 0:t.title)==null?void 0:g.trim()} at ${o.time}
          
 doAdd?:${l}`,m.time,"alt:"+r.time)}let O=this.hasOverlappingEvent(e,m,k(m,{minute:n.for})),w=O.length;if(w>0){console.log(`WARNING WARNING::Extra Overlaps of ${w} for OVERLAPPED ${e} at ${m.time}`,O);let r=0,d=this.findEvent(e);console.log(d?`Cascading time change while ${l?"Adding":"Moving"} (${e}) '${d==null?void 0:d.title}' due to ${t.id}-'${(p=t==null?void 0:t.title)==null?void 0:p.trim()}'`:`ERROR::recurChangeTime ${e} not found`),s&&s(`${w} Extra Overlaps handling (${e}) '${d==null?void 0:d.title}' as ${l?"Adding":"Moving"} '${(C=t==null?void 0:t.title)==null?void 0:C.trim()}'`);do{if(console.log(`${r} CASCADING timeChange (${e}) ${d==null?void 0:d.title} at: ${m.time} now at: ${n.start.time}  till ${n.end.time}`,O[r]),O[r].inConflict==t.id){console.log(`EUUUH...::recurChangeTime::self overlap?!?${e} ...breaking!`,O[r]);break}this.recurChangeTime(O[r].inConflict,d,m,!1,s)}while(++r<w)}this.changeEvtTime(n,m),console.log(`recurChangeTime::OVERLAPPED (${e}) '${n==null?void 0:n.title}' >> ${D} to ${m.time} >> DONE`);let h=o;if(console.log(`recurChangeTime::TARGET>>(${t.id})${(T=t==null?void 0:t.title)==null?void 0:T.trim()} going ${D} >> by ${l?"Adding at":"Moving to"} >> ${h.time}`),!l){this.changeEvtTime(t,h);return}let c=this.addGoalsToSchedule([{...t,time:h.time}],this.isViewingToday());if(Object.keys(c).length>0){console.log(`recurChangeTime::EXTRA OVERLAP ${l?"Adding":"Moving"} ${D} TARGET ${(v=t==null?void 0:t.title)==null?void 0:v.trim()} of size=${Object.keys(c).length}`,JSON.parse(JSON.stringify(c))),s&&s(`EXTRA OVERLAPS ${l?"Adding":"Moving"} TARGET ${(y=t==null?void 0:t.title)==null?void 0:y.trim()} ${D}`);for(let r in c){let d=c[r];if(!d[0]){console.log("recurChangeTime::TARGET EXTRA OVERLAP...SKIPPING key",r);continue}let S=d.length;if(S>0){let u=0;do{if(console.log(`recurChangeTime::TARGET CASCADING OVERLAP: ${t.id}-${t==null?void 0:t.title} at: ${h.time}`,d[u].targetStart,d[u].direction),d[u].inConflict==t.id){console.log("EUUUH...::recurChangeTime::TARGET>>OVERLAP::self overlap?!?...breaking!",d[u].inConflict,t.id,d[u].targetStart);break}this.recurChangeTime(d[u].inConflict,t,h,l,s)}while(++u<S)}}}}else console.log("recurChangeTime::ERROR >> overlapped event not found!","doAdd? "+l,e,t)}hasOverlappingEvent(e,t,o){const l=[];return this._dailyScheduled.forEach((s,n,a)=>{if(n!=e){let g=this.checkOverlapByTime(t,o,s.start,s.end);g&&(this._startTimesSet.has(t.time)&&console.log(`hasOverlappingEvent ${e} same start`,t.time),l.push({target:e,targetStart:t,direction:g,inConflict:n}))}}),l}checkOverlapByTime(e,t,o,l){let s=this.getTimeyNumber(e),n=this.getTimeyNumber(t),a=this.getTimeyNumber(o),g=this.getTimeyNumber(l);if(s===!1||a===!1||n===!1||g===!1)return console.log("ERROR... checkOverlapByTime error",s,n,a,g),!1;let p=!1;s>a&&s<g&&(p="bas"),n>a&&n<g&&(p="haut");let C=a>=s&&n>=g,T=s>=a&&n<=g;return(C||T)&&(p="surrounding"),p}canDropEvent(e,t){let o=k(e,{minute:t.duration}),l=this.hasOverlappingEvent(t.id,e,o);return l.length>0?{overlaps:this.massageSingleOverlapArr(l),canContinue:!1}:(this.toggleActionBtns(!0,"canDropEvent"),{overlaps:null,canContinue:!0})}toggleActionBtns(e,t){this.disableSaveSchedule=!e,this.showReloadBtn=this.hasEventsForDate(),this.showClearBtn=!this.isViewingPast()&&e}resetChosen(){this.chosenScore=null,this.chosenPrio=null}enableActionBtns(){let e=this.isViewingPast();this.showOneEachBtn=!e,this.showLoadDefaults=!e,this.showScoreBtn=!e,this.showPrioBtn=!e}tooClose(e,t){let o=k(e,{minute:0}),l=this.getTimeNumber(o),s=k(e,{day:1}),n=new Date(s.date);n.setHours(24),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0);let a=Y(n),g=Math.floor(te(o,a)/1e3/60);if(g<t)return console.log("tooClose to midnight eh...:(",g),!0;let p=!1;return this._dailyScheduled.forEach((C,T,v)=>{let b=this.getTimeNumber(C.start)-l,D=te(o,C.start);Math.floor(D/1e3/60)<=10&&b>0&&(p=T)}),p}changeEvtTime(e,t,o){return o=="ok"&&Ve(e.id,t.time,null),this.doUpdateSchedule(e,t),o}doUpdateSchedule(e,t){let o=this.findSchedEvent(e.id),l=this.findEvent(e.id);if(!o||!l){console.log("doUpdateSchedule-ERROR NOT found",e.id,o,l);return}let s=k(Q(l.date),{minute:ee(t.time)}),n=k(s,{minute:l.duration});this._endTimesSet.delete(o.end.time)?this._endTimesSet.add(n.time):console.log("doUpdateSchedule-endTimesSet NOT FOUND?!?"),this._startTimesSet.delete(o.start.time)?this._startTimesSet.add(s.time):console.log("doUpdateSchedule-startTimesSet NOT FOUND?!?",e.id,t),this._dailyScheduled.set(e.id,{...o,for:l.duration,start:s,end:n}),l.time=t.time,l.sortTime=s,this.updateDetz(l),this.enableNoteScoreEdit(e.id,s,n)}saveDaySchedule(){let e={};this._dailyScheduled.size<1?e=null:this._dailyScheduled.forEach((t,o,l)=>{e[o]={time:t.start.time,duration:t.for,atScore:t==null?void 0:t.atScore},this.usingMoods[o]&&(e[o].byMood=this.usingMoods[o]),t.notes!==void 0&&(t==null?void 0:t.notes)!==""&&(e[o].notes=t==null?void 0:t.notes)}),console.log("saveDaySchedule",e?Object.keys(e).length:"CLEARED"),Je(this.currentDate,e),this.disableSaveSchedule=!0,this.showReloadBtn=!1,this.showClearBtn=e!=null&&!this.isViewingPast()}updateMinEndNowBtn(e,t,o){for(let[l,s]of this._dailyScheduled)(t?s.end.time:s.start.time)==e&&(this.hasStarted[l]=!t,this.isDisabledScoreEdit[l]=!t,this.mobile&&(console.log(`updateMinEndNowBtn..MOBILE::good?>>${o}::${t}`,e),this.showMobileDialog[l]=!t))}reduceEvtDuration(e,t){let o=this.findSchedEvent(e);if(!o){console.log("ERROR:: reduceEvtDuration Evt not found!!!",e);return}const l=Y(new Date);let s=o.start,n=o.end;this._dailyScheduled.set(e,{...o,for:t,duration:t,end:l}),this._endTimesSet.delete(n.time)||console.log("ERROR endTimesSet item does not exist?!?",o,this._endTimesSet),this._endTimesSet.add(l.time);let a=this.findEvent(e);a.duration=t,this.updateDetz(a),this.enableNoteScoreEdit(e,s,l),this.saveDaySchedule()}updateEvtMinsEndNowBtns(e,t,o){const l=Y(new Date);let s=k(l,{minute:0}),n=this.getTimeNumber(s),a=this.getTimeNumber(t),g=this.getTimeNumber(o);if(a!==!1&&g!==!1){let p=n>=a&&n<g,C=n>=g;p&&(this.hasStarted[e]=!0),C&&this.disableEvtScoreEdit(e,C)}else console.log(`ERROR?!:${e} has no start/end?.`)}canEndNow(e){let t=this.findSchedEvent(e);if(!t)return console.log("ERROR canEndNow Evt not found!!!",e),!1;const o=Y(new Date);let l=t.start,s=t.end;if(!Le(o,l,s,!0))return console.log("umm aint in the middle of this event! Nothing to do...canEndNow::ERROR?",o.time,l.time,s.time),!1;let n=k(o,{minute:0}),a=te(l,n),g=Math.floor(a/1e3/60);return console.log(`canEndNow:: ${e} duration from ${t.for} to: ${g}`),g<10?g:this.reduceEvtDuration(e,g)}updateNoteScore(e,t,o=""){let l=this.findSchedEvent(e);if(l){l.score==t||(Ve(e,null,t),l.atScore=t);let n=this.findEvent(e);n?n.score=t:console.log("onSaveScore ERROR not found",n,e),o!==""&&(l.notes=o,n.notes=o),this.isViewingPast()?this.saveDaySchedule():this.toggleActionBtns(!0,"updateNoteScore")}else console.log(`ERROR ERROR::updateNoteScore could not find event ${e}?!?`)}updateDetz(e){var o,l;let t=(l=(o=this.parentGoalById(e.parentGoal))==null?void 0:o.title)==null?void 0:l.trim();e.jeSuis&&e.jeSuis.length>0?e.details=`Of '${t}' :: << ${e.jeSuis.join(",")} >>`:e.details=`Of '${t}' :: ${L(e==null?void 0:e.time)} -> ${e==null?void 0:e.duration}min -- ${e!=null&&e.inDefaults?"Dft:":":"}${e!=null&&e.canMove?":Mv:":":"}${e!=null&&e.isAlternative?":Alt":":"}`}addMinsToEvt(e,t,o=null){const l=(T,v,y)=>{let b=this.findEvent(e),D=T.end;if(!b){console.log("addMinsToEvt::ERROR not found?!?",T,e,v,y);return}return b.duration=v,this.updateDetz(b),this._dailyScheduled.set(e,{...T,for:v,end:y}),this._endTimesSet.delete(D.time)||console.log("ERROR endTimesSet item does not exist?!?"+D.time,T,this._endTimesSet),this._endTimesSet.add(y.time),this.saveDaySchedule(),{overlaps:null,canContinue:!0}};let s=this.findSchedEvent(e);if(!s){console.log("ERROR addMinsToEvt EVT not found!!!",e);return}let n=s.end,a=k(n,{minute:parseInt(t)}),g=parseInt(t)+s.for;console.log(`addMinsToEvt::(${e}) add ${t} from ${s.for} to> ${g}`,n.time,a.time);let p=this.hasOverlappingEvent(e,s.start,a),C=p.length;if(C>0){console.log("addMinsToEvt::OVERLAPS of size "+C,JSON.parse(JSON.stringify(p)));let T={overlaps:this.massageSingleOverlapArr(p),canContinue:!1};if(o&&o(`addMinsToEvt::OVERLAPS of size ${C}`),C>1)return T;let v=this.findEvent(p[0].inConflict);if(!v)return console.log("addMinsToEvt::ERROR conflict evt not found?!?"+C,p[0].inConflict),T;let y=(v==null?void 0:v.inDefaults)||!(v!=null&&v.canMove);if(console.log("addMinsToEvt::OVERLAPS>>askUser","default? "+(v==null?void 0:v.inDefaults),"!canMove? "+!(v!=null&&v.canMove),y,p[0].targetStart.time),y)return T;{let b=this.findEvent(e);this.recurChangeTime(p[0].inConflict,{...b,duration:g},p[0].targetStart,!1)}}return l(s,g,a)}deleteEvtMood(e){if(this.usingMoods[e]){delete this.usingMoods[e],console.log("deleteEvtMood::>> "+e);return}}updateCurrentMoods(){for(let e in this.usingMoods)this.actualEvts.find(t=>t.id==e)||this.deleteEvtMood(e)}removeScheduledEvt(e){let t=this.getAllEvts().length;if(!e){console.log("ERROR doRemove, NO evt to delete?!?",e);return}let o=0;for(o;o<t;o++)if(this.actualEvts[o].id==e.id){this.actualEvts.splice(o,1);let l=null;if(this._dailyScheduled.has(e.id)?(l=this._dailyScheduled.get(e.id),this._dailyScheduled.delete(e.id)):console.log("removeScheduledEvt ::> dailyScheduled has no such evt?@? ERROR",e),l){let s=this._startTimesSet.delete(l.start.time),n=this._endTimesSet.delete(l.end.time);(!s||!n)&&console.log(`removeScheduledEvt ::> ERROR? scheduleSets has no such evt?@? start:${s}...end:${n}`,l,e.id+" "+(e==null?void 0:e.title.trim())+" "+(e==null?void 0:e.details)),this.deleteEvtMood(e.id)}break}}addToBalance(e){let o=this.getCurrentBalance()-parseInt(e==null?void 0:e.duration);Fe(o)}removeFromBalance(e){let o=this.getCurrentBalance()+parseInt(e);Fe(o)}disableEvtScoreEdit(e,t){this.isDisabledScoreEdit[e]=!t,this.mobileEnableScore[e]=t}enableNoteScoreEdit(e,t,o){const l=Y(new Date);let s=te(l,o),n=k(l,{minute:0});this.getTimeNumber(n),s>0?(this.isDisabledScoreEdit[e]=!0,this.mobileEnableScore[e]=!1):(this.hasStarted[e]=!1,this.mobile&&(this.showMobileDialog[e]=!1),this.mobileEnableScore[e]=!0,this.isDisabledScoreEdit[e]=!1),Le(l,t,o,!0)?this.hasStarted[e]=!0:this.hasStarted[e]=!1}getTimeyNumber(e){return e!==null?pt(e):!1}getTimeNumber(e){return e!==null?Pe(e):!1}doLog(e,t){console.log(e,JSON.parse(JSON.stringify(t)))}}function He(i){return i.button===0}const Bt={name:"altDayCalendar",components:{NavigationBar:re(()=>ae(()=>import("./NavigationBar.2fe4eb89.js"),["assets/NavigationBar.2fe4eb89.js","assets/index.90b4fdeb.js","assets/index.4f70e4de.css"])),QCalendarDay:Ot,GoalyEnd:re(()=>ae(()=>import("./goalyEnd.c6c1d2b7.js"),["assets/goalyEnd.c6c1d2b7.js","assets/goalyEnd.bf51d2cd.css","assets/index.90b4fdeb.js","assets/index.4f70e4de.css","assets/goalStorage.e06597d2.js","assets/QSelect.fb2dbc3b.js","assets/touch.70a9dd44.js","assets/QItem.643b1653.js"])),schedBtn:re(()=>ae(()=>import("./schedBtn.aa6f7126.js"),["assets/schedBtn.aa6f7126.js","assets/schedBtn.32a55c93.css","assets/index.90b4fdeb.js","assets/index.4f70e4de.css"])),dropDwnBtn:re(()=>ae(()=>import("./dropDwnBtn.2c636b07.js"),["assets/dropDwnBtn.2c636b07.js","assets/dropDwnBtn.35a7a0b5.css","assets/QItem.643b1653.js","assets/index.90b4fdeb.js","assets/index.4f70e4de.css","assets/QList.4eb8f90a.js","assets/QSelect.fb2dbc3b.js","assets/touch.70a9dd44.js","assets/goalStorage.e06597d2.js"])),schedDialog:re(()=>ae(()=>import("./schedDialog.6fc1e5db.js"),["assets/schedDialog.6fc1e5db.js","assets/schedDialog.71a622d2.css","assets/index.90b4fdeb.js","assets/index.4f70e4de.css","assets/QSpace.25d94c95.js"])),mobileNoteScore:re(()=>ae(()=>import("./onScoreEditDialog.da7e3493.js"),["assets/onScoreEditDialog.da7e3493.js","assets/onScoreEditDialog.b00fdc3d.css","assets/index.90b4fdeb.js","assets/index.4f70e4de.css"]))},data(){return mt(),x(null),x(null),x(null),x(null),x(null),{splitterPage:x(35),splitterLegend:x(40),timeStartPos:x(0),showTree:x(!1),treeGoals:x([]),expanded:x([]),filter:x([]),filterRef:x(null),calendar:x(null),showEvtDialog:x(!1),currentDate:x(ve()),scoreOptions:x([1,2,3,4,5,6,7,8]),anchorTimestamp:x(null),otherTimestamp:x(null),mouseDown:x(!1),mobile:x(!0),daSchedule:x(null)}},beforeMount(){this.mobile=bt(),this.daSchedule=new kt(this.currentDate,this.mobile),this.constructTree()},mounted(){this.adjustCurrentTime(),this.intervalId=setInterval(()=>{this.adjustCurrentTime()},6e4)},beforeUnmount(){clearInterval(this.intervalId)},computed:{chosenScoreLabel(){return this.daSchedule.chosenScoreLabel()},chosenPrioLabel(){return this.daSchedule.chosenPrioLabel()},style(){return{top:this.timeStartPos+"px"}},showSchedInstru(){return this.getDateEvents(this.currentDate).length<1},showRemInstru(){return this.getDateEvents(this.currentDate).length>0&&!this.isViewingPast()},defaultLabels(){let e=this.daSchedule.unscheduled().filter(t=>(t==null?void 0:t.inDefaults)&&(t==null?void 0:t.time)!="").length;return e>0?e+" Defaults":"Defaults"},showDefaultBtn(){return this.daSchedule.unscheduledDefaults().length>0&&!this.isViewingPast()},saveScheduleDisabled(){return this.daSchedule.saveBtnEnabled()},showTreeForm(){return this.showTree||this.constructTree(),this.showTree},filterString(){return this.filter.join()},currentBalance(){return this.daSchedule.getCurrentBalance()},canbeScheduled(){let i=this.daSchedule.unscheduled(),e=(t,o)=>{if(t.parentGoal>o.parentGoal)return 1;if(t.parentGoal==o.parentGoal)return 0;if(t.parentGoal<o.parentGoal)return-1};if(i.length==0){let t=this.daSchedule.getSubGoals();return t.sort(e),t}return i.sort(e),i},scheduleMoodsLabel(){let i="",e=this.daSchedule.getCurrentMoods();if(!Object.keys(e).length>0)return i;let t=new Set;for(let l in e)t.add(e[l].join());let o=0;for(let l of t)o<1?i=l:i=i+", "+l,o++;return i},startEndTimes(){const i=[];return this.anchorDayTimeIdentifier!==!1&&this.otherDayTimeIdentifier!==!1&&(this.anchorDayTimeIdentifier<=this.otherDayTimeIdentifier?i.push(de(this.anchorTimestamp),de(this.otherTimestamp)):i.push(de(this.otherTimestamp),de(this.anchorTimestamp))),i},anchorDayTimeIdentifier(){return this.anchorTimestamp!==null?Pe(this.anchorTimestamp):!1},otherDayTimeIdentifier(){return this.otherTimestamp!==null?Pe(this.otherTimestamp):!1},eventsMap(){return this.daSchedule.currentSchedEventsMap()}},methods:{showEvtMobile(i){return this.daSchedule.showEvtNoteScoreMobile(i)},klikaj(i){console.log("klikaj...",this.currentDate,i)},adjustCurrentTime(){var l,s;const i=Y(new Date);if(this.currentDate!==i.date){this.timeStartPos=-10,this.currentTime="";return}this.currentDate=i.date,this.currentTime=i.time,this.timeStartPos=(s=(l=this.$refs)==null?void 0:l.calendar)==null?void 0:s.timeStartPos(i.time,!1);let e=this.daSchedule.getCurrentSchedTimesSets(),t=e.endSet&&e.endSet.has(i.time),o=e.startSet&&e.startSet.has(i.time);(t||o)&&(this.daSchedule.updateMinEndNowBtn(this.currentTime,t,o),o&&(this.scrollToTime(i,"slow"),this.doNotify("Event Starting :)","positive","top")))},hasDate(i){return this.currentDate?i.find(e=>e.date===this.currentDate):!1},getDateEvents(i){let e=(o,l)=>{let s=te(o.sortTime,l.sortTime);if(s>0)return-1;if(s==0)return 0;if(s<0)return 1};const t=this.eventsMap[i]||[];return t.length===1?t[0].side="full":t.length,t.sort(e)},constructTree(){this.treeGoals=this.daSchedule.fetchGoalsTree()},resetGoalEvts(){return this.daSchedule.getSubGoals()},allMainGPrio(){return this.daSchedule.getAllPrio()},resetFilter(){var i;this.filter=[],(i=this.filterRef)==null||i.focus()},myFilterMethod(i,e){if(i.isChildren&&(i==null?void 0:i.moods.length)>0){const t=this.filter.map(l=>l.toLowerCase());let o=i==null?void 0:i.moods.some(l=>t.indexOf(l.toLowerCase())>-1);return i.label&&o}},labelGoals(i){let e=0;if(i=="s"){for(const o in this.treeGoals)e+=this.treeGoals[o].children.length;return`Scheduled => ${this.daSchedule.getAllEvts().length} out of ${e} 
`}return`Balance: ${this.daSchedule.getCurrentBalance()||0} 
`},badgeClasses(i,e){return dt(i,e)},styleDragLine(i,e=void 0,t=void 0){let o=e(i.time),l=t(i.duration),s=o+l;this.timeStartPos+l;const n={};return e&&t&&(n.top=s+"px",n.height=l+"px"),n["align-items"]="flex-start",n},badgeStyles(i,e,t=void 0,o=void 0){return ht(i,e,t,o)},classyColor(i){return`row items-center ${i.isChildren?"text-":"text-white bg-"}${i.color} `},isViewingPast(){return this.daSchedule.isViewingPast()},onMoodAdd(){let i=[];const e=this.filter.map(t=>t.toLowerCase());if(this.treeGoals.filter(t=>{if(t.children.length>0)return t.children.filter(o=>{if((o==null?void 0:o.moods.length)>0&&(o==null?void 0:o.moods.some(l=>e.indexOf(l.toLowerCase())>-1))){let l=o==null?void 0:o.moods.filter(s=>{if(e.indexOf(s.toLowerCase())>-1)return s});return i.push({id:o.id,mood:l}),o}})}),i.length>0){i=i.filter(o=>!this.daSchedule.getAllEvts().find(l=>l.id==o.id));let t=i.length;if(t>0){let o=this.daSchedule.scheduleByMood(i);console.log("onMoodAdd>>>",e,i),o.canContinue?this.doNotify(`Added ${t} Evts by Mood...doSave eh`,"positive"):o.overlaps&&Object.keys(o.overlaps).length>0?this.handleOverlaps(o.overlaps,null,"byMood"):this.doNotify("Empty as no Moods :(","warning","bottom")}else this.doNotify(`Evts of Mood '${this.filterString}' already scheduled!`,"warning","top")}else this.doNotify("Nothing to add :(","warning","top")},onScheduleOneEach(){let i=t=>{let o=this.daSchedule.scheduleOneEach(t);o.canContinue?this.doNotify("Add by OneEach ...doSave eh","positive"):o.overlaps&&Object.keys(o.overlaps).length>0?this.handleOverlaps(o.overlaps,null,"oneEach"):this.doNotify("Empty? for OneEach :(","warning","bottom")},e=()=>{console.log("onScheduleOneEach..Aborting",this.daSchedule.getAllEvts()),this.reset()};if(this.daSchedule.getAllEvts().length>0){let t=[{label:"Add one Evt from Each parent Goals",value:"add"},{label:"Reset schedule and add one randomly Evt from Each parent Goals",value:"overwrite"}];this.radioChoiceDialog("Warning!!",`Date: ${this.currentDate} already have scheduled Events...`,t,"",i,e)}else i("overwrite")},onReloadSaved(){let i=this.daSchedule.hasEventsForDate(),e=()=>{console.log("Aborting",this.currentDate,this.scheduledEvents,i)},t=()=>{let o=this.daSchedule.loadEvtsForDay(!1);o.canContinue||(o.overlaps&&Object.keys(o.overlaps).length>0?(console.log("onReloadSaved::OVERLAPPS",o.overlaps),this.handleOverlaps(o.overlaps,null,"view")):(this.doNotify(`Reloaded schedule for ${this.currentDate}`,"positive","bottom"),(this.isViewingPast()||this.currentDate!==ve())&&this.adjustCurrentTime())),this.reset()};if(this.daSchedule.getAllEvts().length>0&&!this.isViewingPast()){let o=i?"Reload? saved schedule of: "+this.currentDate:"Overwrite current Evts?";this.confirmAction("",o,"OK",t,e)}else t()},onClearDay(){let i=this.daSchedule.hasEventsForDate();if(this.isViewingPast()){this.doNotify("Editing past is no no!");return}this.daSchedule.resetSchedule(!0);let e=i?"Cleared...Can still Reload saved":"Resetting...";this.doNotify(e,"warning","top"),this.reset(),this.daSchedule.toggleActionBtns(i,"view")},onLoadDefault(){let i=e=>{let t=this.daSchedule.scheduleDefaults(e);t.canContinue?this.doNotify("Add of Defaults ...doSave eh","positive"):t.overlaps&&Object.keys(t.overlaps).length>0?this.handleOverlaps(t.overlaps,null,"byDefaults"):this.doNotify("Empty? as no Defaults:(","warning","bottom")};if(this.daSchedule.getAllEvts().length>0){let e=this.daSchedule.unscheduledDefaults(),t=[{label:`Add ${e==null?void 0:e.length} Default Evts to current schedule`,value:"add"},{label:"Reset and only schedule Defaults",value:"overwrite"}];this.radioChoiceDialog("Warning!!",`Date: ${this.currentDate} already have scheduled Events...`,t,"",function(o){i(o)},function(){console.log("onLoadDefaults::Aborting")})}else i("overwrite")},onChoosenPrio(i){this.daSchedule.onChoosenPrio(i)},onChoosenScore(i){this.daSchedule.onChoosenScore(i)},doLog(i,e){console.log(i,JSON.parse(JSON.stringify(e)))},doReloadWithPrio(){if(this.daSchedule.chosenPrio==null){this.doNotify("Ayo select a priority!");return}let i=()=>{console.log("doReloadWithPrio..cancelling"),this.reset()},e=o=>{let l=this.daSchedule.scheduleSamePrio(o);l.canContinue?this.doNotify(`${o} for Priority == ${this.daSchedule.chosenPrio} ...doSave eh`,"positive"):(this.doLog("doReloadWithPrio::OVERLAPS?",l.overlaps),l.overlaps&&Object.keys(l.overlaps).length>0?this.handleOverlaps(l.overlaps,null,"byPrio"):this.doNotify(`Empty for Priority == ${this.daSchedule.chosenPrio} :(`,"warning","bottom"))},t=this.daSchedule.chosenPrio;if(this.daSchedule.getAllEvts().length>0){let o=[{label:`Filter scheduled Evts by priority == ${t}`,value:"filter"},{label:`Add to schedule Evts with priority == ${t}`,value:"add"},{label:`Reset current and Only schedule Evts with priority == ${t}`,value:"overwrite"}],l=`Reload Schedule by Priority == ${t}`;this.radioChoiceDialog("",l,o,"",e,i)}else e("overwrite");this.daSchedule.disablePrioBtn=!0},doReloadWithScore(){if(this.daSchedule.chosenScore==null){this.doNotify("Ayo select a score!");return}let i=()=>{console.log("doReloadWithScore..cancelling",this.daSchedule.getAllEvts()),this.reset()},e=o=>{let l=this.daSchedule.scheduleByScore(o);l.canContinue?this.doNotify(`${o} for Score <= ${this.daSchedule.chosenScore} ...doSave eh`,"positive"):l.overlaps&&Object.keys(l.overlaps).length>0?this.handleOverlaps(l.overlaps,null,"byScore"):this.doNotify(`Empty for Score <= ${this.daSchedule.chosenScore} :(`,"warning","bottom")},t=this.daSchedule.chosenScore;if(this.daSchedule.getAllEvts().length>0){let o=[{label:`Filter scheduled Evts by Interval Score <= ${t}`,value:"filter"},{label:`Add to schedule Evts with Interval Score <= ${t}`,value:"add"},{label:`Reset current and Only schedule Evts with Interval Score <= ${t}`,value:"overwrite"}],l=`Reload Schedule by Interval Score <= ${t}`;this.radioChoiceDialog("",l,o,"",e,i)}else e("overwrite");this.daSchedule.disableScoreBtn=!0},doSaveSchedule(){this.daSchedule.saveDaySchedule(),this.doNotify(`Schedule saved for ${this.currentDate}`,"positive","top")},doDroppy(i,e){if(i&&e){let t=this.daSchedule.tooClose(i,e.duration);if(t&&(console.log("doDroppy::tooClose to>>",t),t===!0)){this.doNotify("Dropping event TOO close to midnight!"),this.reset();return}let o=this.daSchedule.canDropEvent(i,e),l=this.daSchedule.getOriginalEvtTime(e.id);if(o.canContinue)if((e==null?void 0:e.inDefaults)||!(e!=null&&e.canMove)){let n=e!=null&&e.inDefaults?"Default at ":"Cannot Move from ",a=[`Evt "${e.title.trim()}" ${n} ${L(l)}.`,`
Also Save Evt default time to ${L(i.time)}?`,`
Cancel or Dismiss to undo!`,`
No selection to keep at ${L(e.time)}`].join(`
`);const g=this.daSchedule,p=this.doCleanup;this.confirmTimeChange("Changing Evt's time",a,"Change","Temp.Move",function(C){g.changeEvtTime(e,i,C),p()},function(){console.log(`doDroppy::onCancel..>doing nothing for ${e.id})'${e.title.trim()}'`),p()},function(){console.log(`doDroppy::onDismiss..keep as is>> ${e.id})'${e.title.trim()}'`),p()})}else this.daSchedule.changeEvtTime(e,i,!1),this.doCleanup();else this.doLog("doDroppy::CANNOT Drop",o),this.movedIntoConflict(o.overlaps,null,from)}else{console.log("doDroppy null ERROR?",i,this.targetDrop,e,this.selectedItem);return}},canAutoSchedule(i,e){let t=i.title.trim().toLowerCase().includes(e.title.trim().toLowerCase()),o=e.title.trim().toLowerCase().includes(i.title.trim().toLowerCase()),l=this.daSchedule.parentGoalById(i.parentGoal),s=this.daSchedule.parentGoalById(e.parentGoal),n=i.title.trim().toLowerCase().includes(s.title.trim().toLowerCase()),a=e.title.trim().toLowerCase().includes(l.title.trim().toLowerCase());return(n||a)&&console.log("canAutoSchedule:: WOAH PARENT AUTO schedule?--TODO***",n,a,"Normal AUTO>>",t,o),t||o?{addIncSched:t,schdIncToAdd:o}:!1},movedIntoConflict(i,e,t,o=0){console.log("movedIntoConflict >>",JSON.parse(JSON.stringify(i)),"from:"+t,o);const l=(h,c)=>{if(h!=null&&h.parentGoal){let r=this.daSchedule.parentGoalById(h.parentGoal);return c?`Of '${r==null?void 0:r.title.trim()}' (${r==null?void 0:r.priority})`:`Of '${r==null?void 0:r.title.trim()}'`}return console.log("prioLabel..ERROR no PARENT found?",h),""},s=(h,c)=>{switch(c){case"score":return`${l(h,!1)} > "${h.title.trim()}" with Score:: ${h.score} = ${he(h.score)}`;case"prio":return`"${h.title.trim()}" ${l(h,!0)}`;default:return`"${h.title.trim()}" ${l(h,!0)} && Score:: ${h.score} for ${h.duration} mins`}},n=(h,c=!1)=>{this.doNotify(h,c?"warning":"positive","top")},a=h=>{this.daSchedule.deleteEvtMood(h)},g=h=>{console.log(`movedIntoConflict::doRemove ${h.id}:${h.title}`),this.daSchedule.removeScheduledEvt(h)};let p=h=>{console.log("onDismissy::from "+t,h,O),this.scheduleMoodsLabel,this.doCleanup(),this.daSchedule.toggleActionBtns(!0,t)};const C=(h,c,r)=>{if(console.log(`movedIntoConflict::removeReplace >> replacing>> ${h.id}) '${h.title.trim()}' WITH ${c.id}) ${c.title.trim()}`,r,"from>"+t),e){if(console.log("movedIntoConflict::removeReplace...OVERRIDE from>>"+t),t=="onDrop"){g(h);return}console.log("movedIntoConflict::removeReplace....OVERRIDE updating..."+t),this.daSchedule.doUpdateSchedule(c,r.targetStart);return}if(g(h),t=="onDrop")console.log("movedIntoConflict::removeReplace for onDrop...just updating schedule",c.id,r.targetStart.time),this.daSchedule.doUpdateSchedule(c,r.targetStart);else{console.log("movedIntoConflict::removeReplace >>addGoalsToSchedule from "+t);let d=this.daSchedule.getStoredRawEvt(r.target);d&&(JSON.parse(JSON.stringify(c)),Object.assign(c,d,{time:r.targetStart.time}));let S=this.daSchedule.addGoalsToSchedule([{...c,time:r.targetStart.time}],!0),u=Object.keys(S).length;if(u>0)return console.log(`movedIntoConflict::removeReplace:: OVERLAPS again of size:${u} from >${t}>`+c.title,JSON.parse(JSON.stringify(S))),this.doNotify(`Extra Overlaps while removing to add '${c.title.trim()}' `,"warning","top"),this.movedIntoConflict(S,e,t+"nah")}},T=(h,c)=>{let r=this.daSchedule.findEvent(c.target);if(!r){console.log("movedIntoConflict::forceAddMins>>NOT FOUND?!?",c.target);return}let d=this.daSchedule.getStoredRawEvt(c.target);if(d){let S=r.duration+parseInt(o);JSON.parse(JSON.stringify(r)),Object.assign(r,d,{duration:S})}else console.log("movedIntoConflict::forceAddMins >>NEWLY ADDED?!? Error?",r.id,r,d),Object.assign(r,{duration:newDura});this.daSchedule.recurChangeTime(h.id,r,c.targetStart,!1,this.doNotify),this.daSchedule.saveDaySchedule()},v=(h,c,r)=>{console.log(`movedIntoConflict::forceAdd:${t} >>${c.id})'${c.title}' at ${c.time} to ${r.targetStart.time}
          
Changing >>${h.id} from ${h.time}`);let d=this.daSchedule.getStoredRawEvt(r.target);d&&(JSON.parse(JSON.stringify(c)),Object.assign(c,d,{time:r.targetStart.time}));let S=this.daSchedule.recurChangeTime(h.id,c,r.targetStart,t!="onDrop",this.doNotify);if(S){let u=Object.keys(S).length;if(u>0)return console.log(`movedIntoConflict::forceAdd:: OVERLAPS again of size:${u} from >${t}>`+c.title,JSON.parse(JSON.stringify(S))),this.doNotify(`Extra Overlaps while adding '${c.title.trim()}'`,"negative","top"),this.movedIntoConflict(S,e,t+"nah")}p("ForceAdd")};let y=(h,c,r,d,S)=>{O.push(c),c==r.id?(C(d,r,S),n(`by ${h}, ${t=="onDrop"?"Moving":"Adding"} '${r.title.trim()}'`,!0)):(console.log(`onOkChoice::by ${h},chose scheduled ${c} ...with override?`,e,t),n(`by ${h}, Keeping '${d.title.trim()}'`),t.indexOf("byMood")>-1&&a(r.id),t=="onDrop"&&g(r))},b=(h,c)=>{if(e){if(console.log("movedIntoConflict::cancelChoice::OVERRIDE...coolios!!from:"+t,h.title.trim()),t=="onDrop"){n("Umm...not moving then...."),this.daSchedule.toggleActionBtns(!1,"view");return}g(h),n(`Keeping '${c.title.trim()}'`);return}t.indexOf("byMood")>-1&&a(h.id),this.daSchedule.toggleActionBtns(!0,"view"),n(`Keeping scheduled '${c.title.trim()}'`)};const D=(h,c,r,d)=>{if(h=="opt3"){let S="Pick one event...",u=[{label:s(c,"def"),value:c.id,color:"secondary"},{label:s(r,"def"),value:r.id}];this.radioChoiceDialog("",S,u,"",function(B){y("Choice",B,c,r,d)},null,function(){p("resolveChoice::byEvent... dismissing")})}else if(h=="opt2"){let S="Pick event by Score",u=[{label:s(c,"score"),value:c.id,color:"secondary"},{label:s(r,"score"),value:r.id}];this.radioChoiceDialog("",S,u,"",function(B){y("Score",B,c,r,d)},null,function(){p("resolveChoice::byScore... dismissing")})}else if(h=="opt1"){let S="Pick event by Priority",u=[{label:s(c,"prio"),value:c.id,color:"secondary"},{label:s(r,"prio"),value:r.id}];this.radioChoiceDialog("",S,u,"",function(B){y("Priority",B,c,r,d)},null,function(){p("resolveChoice::byPriority... dismissing")})}else h=="opt0"?(console.log("resolveChoice::it's a drop?...keeping as is....",t),n("Umm...keeping as is then!"),this.doCleanup()):v(r,c,d)},m=(h,c,r,d,S)=>{d.direction!=="surrounding"&&!S&&(t.indexOf("nah")>-1?console.log("movedIntoConflict::manualSolve NOT adding Force as from "+t):h.push({label:`Force in '${c.title.trim()}'`,value:"opt4"}));let u=`${t=="onDrop"?"Moving":"Adding"} '${c.title.trim()}' at ${L(d.targetStart.time)} Overlaps with Scheduled '${r.title.trim()}' at ${L(r==null?void 0:r.time)}.
          
Cancel to keep '${r.title.trim()}' `,B=S?"Choose Auto Resolution":"Resolve Overlapping Events";this.radioChoiceDialog(B,u,h,"opt1",function(P){D(P,c,r,d)},function(){console.log("movedIntoConflict>>manualSolve::cancelChoice? Notif?>> from: "+t,O[0]),n("Umm...keeping as is then!")})};let O=[],w=Object.keys(i).length;for(let h in i){if(!i[h]||!i[h][0]){console.log("movedIntoConflict...ERROR::skipping unknown key",h);continue}if(h=="withID"){console.log("movedIntoConflict...skipping withID key",h,i.withID);continue}let c=i[h];if(c.length>1){if("withID"in i){i.withID.find(P=>P==h)?(console.log(`movedIntoConflict::WITHID>>using oneToManyConflict as ${c.length} of`+w,i.withID),this.fixConflicts(c,t,!0,w)):(console.log(`movedIntoConflict::WITHID>>using manyToOneConflictas ${c.length} of`+w,i.withID),this.fixConflicts(c,t,!1,w));continue}console.log(`movedIntoConflict::NORMAL>>using manyToOneConflictas ${c.length} of`+w,i.withID),this.fixConflicts(c,t,!1,w);continue}let r=[{label:"Choose one event",value:"opt3"}];t=="onDrop"?r.unshift({label:"Leave as is!",value:"opt0"},{label:"Choose by Priority",value:"opt1",color:"secondary"},{label:"Choose by Score",value:"opt2"}):r.unshift({label:"Choose by Priority",value:"opt1",color:"secondary"},{label:"Choose by Score",value:"opt2"});const d=c.pop();let S=this.daSchedule.getSubGoalByID(d.target),u=this.daSchedule.findEvent(d.inConflict);if(!u||!S){console.log("movedIntoConflict...ERROR ERROR no evts found!!!",d);return}let B=this.canAutoSchedule(S,u);if(t=="onAddMins"){let P=u!=null&&u.inDefaults?"In Defaults":u!=null&&u.canMove?"":"Cannot move",V=`Adding ${o} mins to "${S.title.trim()}" Overlaps with Scheduled "${u.title.trim()}" at ${L(u.time)} as ${P}.
            
Force?
            
Cancel/Dismiss to Leave as is.`;this.confirmAction("",V,"Add",function(){T(u,d)},function(){n("Keeping as Is...")},function(){console.log("movedIntoConflict >>onAddMins>> onDismiss")})}else if(B){console.log("movedIntoConflict:: can AUTO schedule",B.addIncSched,B.schdIncToAdd,"direction == surrounding? >>",d.direction=="surrounding"),this.scrollToTime(d==null?void 0:d.targetStart,"slow");let P=`"${S.title.trim()}" at ${L(S.time)} related to Scheduled "${u.title.trim()}" at ${L(u.time)}.
            
Auto resolve Overlap?
            
Cancel/Dismiss to manually choose.`;this.confirmAction("",P,"Auto",function(){var V;B.addIncSched?(console.log("Auto resolve::removeReplace..with TIMES>>",S.time,u.time,(V=d==null?void 0:d.targetStart)==null?void 0:V.time),C(u,S,d),n(`Removing Scheduled to Add '${S.title.trim()}'`,!0),O.push(S.id)):(console.log("Auto resolve::cancelChoice >> from: ",t),b(S,u),O.push(u.id))},function(){m(r,S,u,d,!0)},function(){p("Auto-dismiss")})}else m(r,S,u,d,!1)}},handleOverlaps(i,e=null,t=""){let o=Object.keys(i).length;this.doLog("handleOverlaps from: "+t+" > "+o,i);for(let l in i){if(l=="withID")continue;let s=i[l];if("withID"in i){i.withID.find(n=>n==l)?(console.log(`handleOverlaps::WITHID>> ${o} >>oneToManyConflict=`+s.length,l),this.fixConflicts(s,t,!0,o-1)):(console.log(`handleOverlaps::WITHID>> ${o} >>manyToOneConflict=`+s.length,l),this.fixConflicts(s,t,!1,o-1));continue}this.fixConflicts(s,t,!1,o)}},oneToManyConflict(i,e=null,t=""){var c;let o=null,l=[],s=[],n=new Map,a=null,g=new Map,p=[{label:"Pick one event",value:"opt3"}];const C=r=>this.findhighestPrio(r);let T=r=>this.getSmallestScoreInterval(r),v=(r,d)=>{let S=[];if(d.forEach((u,B,P)=>{if(r.find(V=>V.id==u.id))if(u.id==o.id)if(console.log("oneToManyConflict::removeConflicts::toAdd kept!>"+a.time,u==null?void 0:u.title.trim(),"at orig: "+(u==null?void 0:u.time),t),t=="onDrop")console.log("oneToManyConflict::removeConflicts...NOTHING to do? as from"+t);else{let V=n.has(u.id)?n.get(u.id):"",H=this.daSchedule.getStoredRawEvt(u.id);H&&(JSON.parse(JSON.stringify(u)),Object.assign(u,H,{time:a.time}));let q=this.daSchedule.addGoalsToSchedule([{...u,time:a.time}],!1);if(Object.keys(q).length>0)console.log("oneToManyConflict::removeConflicts::OVERLAP on add",q,u,a.time),S.push(q);else{console.log("oneToManyConflict::removeConflicts::Great NO overlap",u==null?void 0:u.title.trim());let Ce=`${V} Adding '${u==null?void 0:u.title.trim()}' at ${L(a.time)}`;this.doNotify(Ce,"positive","top")}}else{console.log("oneToManyConflict::removeConflicts....Keeping scheduled Evt!!",a,u.id);let V=`${n.has(u.id)?n.get(u.id):""} Keeping scheduled '${u==null?void 0:u.title.trim()}'`;this.doNotify(V,"positive","top")}else u.id!=o.id?(console.log("oneToManyConflict::removing scheduled",u.id,u.title,u.time),this.daSchedule.removeScheduledEvt(u),this.doNotify(`Removed scheduled '${u==null?void 0:u.title.trim()}'`,"warning","bottom")):console.log("removeConflicts::NOT adding original target",o.id)}),this.daSchedule.toggleActionBtns(!0,t),S.length>0)return console.log(`${t}> oneToManyConflict::removeConflict:: OVERLAPS again=${S.length}`,S),this.doNotify("More Overlaps to fix!= "+S.length,"negative","top"),this.handleOverlaps(S[0],e,t+"nah")};const y=(r,d)=>{console.log(`oneToManyConflict::forceAdd:${r.id} ${r.title} at ${d.time} from ${r.time} >>`+t,"conflict="+l.length);let S=this.daSchedule.getStoredRawEvt(r.id);S&&(JSON.parse(JSON.stringify(r)),Object.assign(r,S,{time:d.time}));let u=l.find(P=>P.id!=r.id),B=this.daSchedule.recurChangeTime(u.id,r,d,!0,this.doNotify);if(B&&Object.keys(B).length>0)return console.log("oneToManyConflict::forceAdd:: OVERLAPS "+t,JSON.parse(JSON.stringify(B))),this.doNotify(`Extra Overlaps while force adding '${r==null?void 0:r.title.trim()}'`,"negative","top"),this.handleOverlaps(B,e,t+"nah");this.scheduleMoodsLabel,this.daSchedule.toggleActionBtns(!0,t)};let b=r=>{this.radioChoiceDialog("","Choose one Event to keep",r.map(this.getEvtLabel),"",function(d){let S=r.find(u=>u.id==d);if(S)s.push(S),n.set(S.id,"By choice,");else{console.log("chooseEvt::ERROR NOT FOUND!!",d);return}return console.log(`chooseEvt::onOk >>${d} >> ${S==null?void 0:S.title.trim()}`),S},null,function(){s.length>0&&(console.log("chooseEvt::onDismiss >>set removeConflicts out of total="+r.length,JSON.parse(JSON.stringify(s))),setTimeout(()=>{v(s,r)},0))})};t=="byScore"?p.unshift({label:"Resolve by Highest Priority",value:"opt1",color:"secondary"}):t=="byPrio"?p.unshift({label:"Resolve by Shortest Score Interval",value:"opt2"}):p.unshift({label:"Resolve by Highest Priority",value:"opt1",color:"secondary"},{label:"Resolve by Shortest Score Interval",value:"opt2"});let D=!1,m=[];for(;i.length;){const r=i.pop();console.log("oneToManyConflict::Handling:> "+t,JSON.parse(JSON.stringify(r)));let d=this.daSchedule.findEvent(r.inConflict);if(!d){console.log("oneToManyConflict...ERROR ERROR no evts found!!!",r);return}if(l.push(d),m.push(`'${d==null?void 0:d.title.trim()}'`),a?a.time!=((c=r==null?void 0:r.targetStart)==null?void 0:c.time)&&console.log("oneToManyConflict...ERROR Not same targetStart?!?",a,r==null?void 0:r.targetStart,r.direction):a=r==null?void 0:r.targetStart,g.set(r.target,r==null?void 0:r.targetStart),o)o.id!=r.target?console.log("oneToManyConflict::ERROR?...Not same target ID?!?",o,r.target):console.log("oneToManyConflict::ToAdd Good!",o.id);else{let S=this.daSchedule.getSubGoalByID(r.target);if(!S){console.log("oneToManyConflict...ERROR ERROR local evt not found!!!",r);return}o=S}r.direction=="surrounding"?D=!0:D=D}let O=m.join(" and "),w=m.length<2?this.canAutoSchedule(o,l[0]):!1;w&&(console.log("oneToManyConflict::CAN AUTO!!",w),p.unshift({label:"Auto resolve Overlap?",value:"opt0"})),D||t.indexOf("nah")>-1?console.log("oneToManyConflict::NOT adding Force as from "+t,D,l,o):p.push({label:`Force in > '${o.title.trim()}'`,value:"opt4"});let h=`'${o==null?void 0:o.title.trim()}' conflicts with scheduled ${O} 
`;l.unshift(o),a?this.scrollToTime(a,"slow"):console.log("oneToManyConflict::cant scrolly as null",a),this.radioChoiceDialog("Overlaps!!",h,p,"",function(r){var d;if(r=="opt3")b(l);else if(r=="opt2"){let S=T(l);console.log("oneToManyConflict::ByScore",S.id,S==null?void 0:S.title.trim(),S.score),s.push(S),n.set(S.id,`By shortest score interval (${S.score}),`)}else if(r=="opt1"){let S=C(l);console.log("oneToManyConflict::ByPriority",S.e.id,(d=S==null?void 0:S.e)==null?void 0:d.title.trim()),s.push(S.e),n.set(S.e.id,`By highest priority (${S.prio}),`)}else r=="opt0"?(console.log("oneToManyConflict...YEEE--auto:solve",w,l[1],l[0]),w.addIncSched?(s.push(o),n.set(o.id,"By Auto-Solve,")):(s.push(l[1]),n.set(l[1].id,"By Auto-Solve,"))):y(o,a)},null,function(){s.length>0&&(console.log("oneToManyConflict::onDismiss Main >> removeConflicts from total="+l.length,JSON.parse(JSON.stringify(s))),setTimeout(()=>{v(s,l)},0))})},fixConflicts(i,e,t,o){const l=R=>this.daSchedule.findEvent(R),s=R=>this.daSchedule.getSubGoalByID(R),n=R=>{if(!R){console.log("fixConflicts::scrollToConflict ERROR >>empty time",R);return}this.scrollToTime(R,"slow")},a=R=>{this.doNotifyTimeout(R,"negative","top",1e4)},g=R=>this.findhighestPrio(R);let p=R=>this.getSmallestScoreInterval(R),C=R=>{if(console.log("onDismissy>> "+e,R,O),w.length>0)setTimeout(()=>{t?T(w,r):v(w,r)},0);else{console.log("fixConflicts::onDismissy::SCROLLING!! >>"+t,w.length,m,h,c),n(t?m.get(h.id):m.get(c.id));return}},T=(R,M)=>{console.log(`fixConflicts::removeWithID with toKeep=${R.length} `);let E=[];for(M.forEach((f,F,K)=>{if(R.find(A=>A.id==f.id))if(f.id==h.id){let A=O.has(f.id)?O.get(f.id):"",z=m.has(f.id)?m.get(f.id):m.get(h.id);console.log("fixConflicts::removeWithID:KEEEP..TIME? by>"+A,f.id,f==null?void 0:f.title.trim(),f==null?void 0:f.time,z==null?void 0:z.time,m.has(f.id));let ue=this.daSchedule.getStoredRawEvt(f.id);if(ue){let oe=JSON.parse(JSON.stringify(f));console.log("fixConflicts::removeWithID:: SAVED for:"+f.id,oe),Object.assign(f,ue,{time:z.time})}let ie=this.daSchedule.addGoalsToSchedule([{...f,time:z.time}],!1);if(Object.keys(ie).length>0)console.log("fixConflicts::removeWithID::OVERLAP on add",ie,f,z.time),E.push(ie);else{console.log("fixConflicts::removeWithID::Great NO overlap",f==null?void 0:f.title.trim());let oe=`${A} Adding '${f==null?void 0:f.title.trim()}' at ${L(z.time)}`;this.doNotify(oe,"positive","top")}}else{console.log("fixConflicts::removeWithID....Keeping scheduled Evt!!",f.id);let A=`${O.has(f.id)?O.get(f.id):""} Keeping scheduled '${f==null?void 0:f.title.trim()}'`;this.doNotify(A,"positive","top")}else f.id!=h.id?(console.log("fixConflicts::removeWithID >>removing scheduled",f.id,f.title,f.time),this.daSchedule.removeScheduledEvt(f),this.doNotify(`Removed scheduled '${f==null?void 0:f.title.trim()}'`,"warning","bottom")):(console.log("fixConflicts::removeWithID >>NOT adding original target",h.id),this.daSchedule.deleteEvtMood(h.id),this.resetFilter())}),this.daSchedule.toggleActionBtns(!0,e);E.length;){const f=E.pop();this.doLog(`${e}> fixConflicts::removeWithID:: OVERLAPS`,f),this.doNotify("EXTRA Overlaps to fix!"+E.length,"negative","top");let F=f.direction=="surrounding"?e+"nah":e;return this.handleOverlaps(f,null,F)}},v=(R,M)=>{console.log(`fixConflicts::removeConflicts with toKeep=${R.length} `);let E=[];for(M.forEach((f,F,K)=>{if(R.find(A=>A.id==f.id)){let A=O.has(f.id)?O.get(f.id):"",z=m.has(f.id)?m.get(f.id):null;if(f.id!=c.id){let ue=this.daSchedule.getStoredRawEvt(f.id);if(ue){let oe=JSON.parse(JSON.stringify(f));console.log("fixConflicts::removeConflicts::SAVED for:"+f.id,oe,z),Object.assign(f,ue,{time:z.time})}let ie=this.daSchedule.addGoalsToSchedule([{...f,time:z.time}],R.length<2);if(ie&&Object.keys(ie).length>0)E.push(ie),this.doNotify(`Extra Overlaps while adding '${f==null?void 0:f.title.trim()}'`,"negative","top");else{let oe=`${A} Adding '${f==null?void 0:f.title.trim()}' at ${L(z.time)}`;this.doNotify(oe,"positive","top")}}else this.doNotify(`${A} Keeping scheduled '${f==null?void 0:f.title.trim()}' `,"positive","top")}else f.id==c.id?(this.daSchedule.removeScheduledEvt(f),this.doNotify(`Removed scheduled '${f==null?void 0:f.title.trim()}' `,"warning","top")):(console.log("fixConflicts::removeConflicts >> NOT adding target ",f.id,f.title),this.daSchedule.deleteEvtMood(f.id),this.resetFilter())}),this.daSchedule.toggleActionBtns(!0,e),this.scheduleMoodsLabel;E.length;){const f=E.pop();this.doLog(`fixConflicts::removeConflicts::EXTRA OVERLAPS from ${e} `,f),this.doNotify("EXTRA Overlaps to fix","negative","top");let F=f.direction=="surrounding"?e+"nah":e;return this.handleOverlaps(f,null,F)}};const y=R=>{let M=[];for(this.doLog(`fixConflicts::forceAdd of ${R.length} withID: ${t}`,R),R.forEach(E=>{if(c.id!=E.id){let f=m.has(E.id)?m.get(E.id):null;console.log(`fixConflicts::forceAdd...NEW:${E.id} '${E.title.trim()}' dura= ${E.duration} 
 
              origAt: ${E.time} added at>>`,f==null?void 0:f.time,"from>>"+e);let F=this.daSchedule.getStoredRawEvt(E.id);if(F){let A=JSON.parse(JSON.stringify(E));Object.assign(E,F,{time:f.time}),console.log("fixConflicts::forceAdd >>HAD SAVED!"+E.id,A)}let K=this.daSchedule.recurChangeTime(c.id,E,f,!0,a);if(K&&Object.keys(K).length>0)console.log("fixConflicts::forceAdd >>OVERLAP on add",K,E,f.time),M.push(K);else{let A=`Force Added '${E==null?void 0:E.title.trim()}' at ${L(f.time)}`;this.doNotify(A,"positive","top")}}}),this.scheduleMoodsLabel,this.daSchedule.toggleActionBtns(!0,e);M.length;){const E=M.pop();this.doLog("fixConflicts::forceAdd:: EXTRA OVERLAPS "+e,E),this.doNotify("EXTRA Overlaps to fix "+M.length,"negative","top");let f=E.direction=="surrounding"?e+"nah":e;return this.handleOverlaps(E,null,f)}};let b=(R,M)=>{switch(R){case"score":this.radioChoiceDialog("","Choose one event by Score",M.map(E=>this.betterEvtLabel(E,"score",!1)),"",function(E){let f=M.find(F=>F.id==E);if(f)w.push(f),O.set(f.id,`By Score Interval (${f.score}),`);else{console.log("chooseOneEvt::ERROR NOT FOUND!!",E);return}return f},null,function(){C("chooseOneEvt::Dismissing >>byScore...")});return;case"prio":this.radioChoiceDialog("","Choose one event by Priority",M.map(E=>this.betterEvtLabel(E,"prio",!1)),"",function(E){let f=M.find(F=>F.id==E);if(f)w.push(f),O.set(f.id,"By Priority,");else{console.log("chooseOneEvt::ERROR NOT FOUND!!",E);return}return f},null,function(){C("chooseOneEvt::Dismissing >>byPriority...")});return;default:this.radioChoiceDialog("","Choose which Event to keep",M.map(E=>this.betterEvtLabel(E,"default",!1)),"",function(E){let f=M.find(F=>F.id==E);if(f)w.push(f),O.set(f.id,"By pick,");else{console.log("chooseOneEvt::ERROR NOT FOUND!!",E);return}return f},null,function(){C("chooseOneEvt::Dismissing >>byPick...")});return}},D=(R,M,E,f,F)=>{var K;if(console.log("fixConflicts::resolveChoice >> SCROLLING withID="+t,R,"canChooseOne: ",F),n(t?m.get(h.id):m.get(c.id)),R=="opt3")b("default",f);else if(R=="opt2")if(F)b("score",f);else{let A=p(f);console.log("fixConflicts::ByScore >>AUTO ",A.id,A==null?void 0:A.title.trim(),A.score),w.push(A),O.set(A.id,`By Shortest Score Interval (${A.score}),`)}else if(R=="opt1")if(F)b("prio",f);else{let A=g(f);console.log("fixConflicts::ByPriority >> AUTO ",A.e.id,(K=A==null?void 0:A.e)==null?void 0:K.title.trim()),w.push(A.e),O.set(A.e.id,`By Highest Priority (${A.prio}),`)}else R=="opt0"?(console.log("constructOptions...YEEE--AUTO:SOLVE ",h,c,E,f[1],f[0]),M.addIncSched?t?(w.push(h),O.set(h.id,"By Auto-Solve,")):(w.push(f[0]),O.set(f[0].id,"By Auto-Solve,")):t?(w.push(f[0]),O.set(f[0].id,"By Auto-Solve,")):(w.push(f[1]),O.set(f[1].id,"By Auto-Solve,"))):y(E)},m=new Map,O=new Map,w=[],h=null,c=null,r=[],d=[],S=!1,u=[];for(;i.length;){const R=i.pop();let M=l(R.inConflict);if(!M){console.log("constructOptions...ERROR ERROR no evts found!!!",R);return}let E=s(R.target);if(!E){console.log("constructOptions...ERROR ERROR target evt not found!!!",R);return}m.set(R.target,R==null?void 0:R.targetStart),t?(u.push(`'${M==null?void 0:M.title.trim()}'`),h?h.id!=R.target&&console.log("fixConflicts::ERROR?...Not same target ID?!?",h,R,d,m):(h=E,d.push(E),r.unshift(E),c=M),r.push(M)):(u.push(`'${E==null?void 0:E.title.trim()}'`),c?c.id!=M.id&&console.log("fixConflicts::ERROR::ERROR Not same inConflict",c.id,M.id,d):(c=M,r.unshift(M),m.set(R.inConflict,R==null?void 0:R.targetStart)),d.push(E),r.push(E)),R.direction=="surrounding"?S=!0:S=S}console.log("fixConflicts::FINAL>> ",t?"oneToManyConflict":"manyToOneConflicts",JSON.parse(JSON.stringify(h)),JSON.parse(JSON.stringify(c)),JSON.parse(JSON.stringify(d)),m,JSON.parse(JSON.stringify(r)));let B=u.join(" and "),P=u.length<2&&o<3,V=!1;P&&(V=t?this.canAutoSchedule(h,r[0]):this.canAutoSchedule(d[0],c)),console.log(`fixConflicts::CANCHOOSE ${P?"ONE":"MULTIPLE"}--handling>> `,u.length,o);let H=[],q=P?"Pick one event via ":"Auto-Resolve via ";if(V?(this.doLog("fixConflicts::AUTO-RESOLVE!!",V),H.unshift({label:"Auto resolve Overlap?",value:"opt0"}),H.push({label:"Choose one event",value:"opt3"})):P?(console.log("fixConflicts::CanChooseOne",P),H.push({label:"Choose one event",value:"opt3"})):(H.push({label:"Choose one event",value:"opt3"}),e=="byScore"?H.unshift({label:q+`${P?"Priority":"Highest Priority"}`,value:"opt1",color:"secondary"}):e=="byPrio"?H.unshift({label:q+`${P?"Score Interval":"Shortest Score Interval"}`,value:"opt2"}):H.unshift({label:q+`${P?"Priority":"Highest Priority"}`,value:"opt1",color:"secondary"},{label:q+`${P?"Score Interval":"Shortest Score Interval"}`,value:"opt2"})),!S&&!e.indexOf("nah")>-1){console.log(`fixConflicts::FORCE as surrounding == ${S} from `+e,t);let R=t?`Force in > '${h==null?void 0:h.title.trim()}'`:`Force in > ${u.join()}`;H.push({label:R,value:"opt4"})}let Ce=t?`'${h==null?void 0:h.title.trim()}' conflicts with scheduled ${B} 
`:`${u.join()} conflicts with scheduled '${c==null?void 0:c.title.trim()}' at ${L(c==null?void 0:c.time)}.
`,je=t?"oneToMany Conflicts":"manyToOne Conflicts";this.radioChoiceDialog(je,Ce,H,"",function(R){D(R,V,d,r,P)},null,function(){C("fixConflicts::MAIN")})},manyToOneConflict(i,e=null,t=""){let o=[],l=null,s=[],n=new Map,a=new Map,g=[{label:"Pick one event",value:"opt3"}];const p=h=>this.findhighestPrio(h);let C=h=>this.getSmallestScoreInterval(h),T=(h,c)=>{console.log(`manyToOneConflict::removeConflicts with toKeep=${h.length} out of total:${c.length}`,JSON.parse(JSON.stringify(c)));let r=[];if(c.forEach((d,S,u)=>{if(h.find(B=>B.id==d.id)){let B=a.has(d.id)?a.get(d.id):"",P=n.has(d.id)?n.get(d.id):null;if(P?this.scrollToTime(P,"slow"):console.log("removeConflicts::cant scrolly as null",P),d.id!=l.id){let V=this.daSchedule.getStoredRawEvt(d.id);V&&(JSON.parse(JSON.stringify(d)),Object.assign(d,V,{time:P.time}));let H=this.daSchedule.addGoalsToSchedule([{...d,time:P.time}],!0);if(H&&Object.keys(H).length>0)r.push(H),this.doNotify(`Extra Overlaps while adding '${d==null?void 0:d.title.trim()}'`,"negative","top");else{let q=`${B} Adding '${d==null?void 0:d.title.trim()}' at ${L(P.time)}`;this.doNotify(q,"warning","top")}}else this.doNotify(`${B} Keeping scheduled '${d==null?void 0:d.title.trim()}' `,"positive","top")}else d.id==l.id&&(console.log("manyToOneConflict::removeConflicts...removing scheduled!!",d.id,d.title),this.daSchedule.removeScheduledEvt(d))}),r.length>0)return console.log(`manyToOneConflict::removeConflicts::extra OVERLAPS from ${t} > keeping ${h.length} overlaps =${r.length}`,r),this.doNotify("More Overlaps to fix= "+r.length,"negative","top"),this.handleOverlaps(r[0],e,t+"nah");this.daSchedule.toggleActionBtns(!0,t)};const v=h=>{let c=[];if(console.log(`manyToOneConflict::forceAdd total:${h.length}`),h.forEach(r=>{if(l.id!=r.id){let d=n.has(r.id)?n.get(r.id):null;console.log(`manyToOneConflict::forceAdd...NEW:${r.id} '${r.title.trim()}' dura= ${r.duration} origAt: ${r.time} to>>`,d.time,"from>>"+t),this.scrollToTime(d,"slow");let S=this.daSchedule.getStoredRawEvt(r.id);S&&(JSON.parse(JSON.stringify(r)),Object.assign(r,S,{time:d.time}));let u=this.daSchedule.recurChangeTime(l.id,r,d,!0,this.doNotify);if(u&&Object.keys(u).length>0)console.log("manyToOneConflict::forceAdd >>OVERLAP on add",u,r,d.time),c.push(u);else{console.log("manyToOneConflict::forceAdd::Great NO overlap",r==null?void 0:r.title.trim());let B=`Force Added '${r==null?void 0:r.title.trim()}' at ${L(d.time)}`;this.doNotify(B,"positive","top")}}}),this.scheduleMoodsLabel,this.daSchedule.toggleActionBtns(!0,t),c.length>0)return console.log(`manyToOneConflict::forceAdd:: OVERLAPS again=${c.length} `+t,c),this.doNotify("More Overlaps to fix = "+c.length,"negative","top"),this.handleOverlaps(c[0],e,t+"nah")};let y=h=>{this.radioChoiceDialog("","Choose one Event to schedule",h.map(c=>this.getEvtLabel(c,!1)),"",function(c){let r=h.find(d=>d.id==c);if(r)s.push(r),a.set(r.id,"By pick,");else{console.log("chooseEvt::ERROR NOT FOUND!!",c);return}return r},null,function(){s.length>0&&(console.log("chooseEvt::onDismiss >> LAST?",JSON.parse(JSON.stringify(s))),setTimeout(()=>{T(s,h)},0))})};t=="byScore"?g.unshift({label:"Resolve by Highest Priority",value:"opt1",color:"secondary"}):t=="byPrio"?g.unshift({label:"Resolve by Shortest Score Interval",value:"opt2"}):g.unshift({label:"Resolve by Highest Priority",value:"opt1",color:"secondary"},{label:"Resolve by Shortest Score Interval",value:"opt2"});let b=!1,D=[];for(;i.length;){const h=i.pop();console.log("manyToOneConflict::handling:>"+t,JSON.parse(JSON.stringify(h)));let c=this.daSchedule.findEvent(h.inConflict);if(!c){console.log("manyToOneConflict...ERROR ERROR no evts found!!!",h);return}l?l.id!=c.id&&console.log("manyToOneConflict::ERROR::ERROR Not same inConflict",l.id,c.id):l=c;let r=this.daSchedule.getSubGoalByID(h.target);if(!r){console.log("manyToOneConflict...ERROR ERROR local evt not found!!!",h);return}D.push(`'${r==null?void 0:r.title.trim()}'`),o.push(r),n.set(h.target,h==null?void 0:h.targetStart),h.direction=="surrounding"?b=!0:b=b}let m=D.join(" and "),O=D.length<2?this.canAutoSchedule(o[0],l):!1;O&&(console.log("manyToOneConflict::CAN AUTO!!",O),g.unshift({label:"Auto resolve Overlap?",value:"opt0"})),b||t.indexOf("nah")>-1||g.push({label:`Force in > ${m}`,value:"opt4"});let w=`${m} conflicts with scheduled '${l==null?void 0:l.title.trim()}' at ${L(l==null?void 0:l.time)}.
`;o.unshift(l),this.radioChoiceDialog("Overlaps!",w,g,"",function(h){if(h=="opt3")y(o);else if(h=="opt2"){let c=C(o);s.push(c),a.set(c.id,`By Shortest score interval (${c.score}),`)}else if(h=="opt1"){let c=p(o);s.push(c.e),a.set(c.e.id,`By highest priority (${c.prio}),`)}else h=="opt0"?(console.log("manyToOneConflict...YEEE--auto-solve",O,o[1],o[0]),O.addIncSched?(s.push(o[1]),a.set(o[1].id,"By Auto-Solve,")):(s.push(l),a.set(l.id,"By Auto-Solve,"))):v(o)},null,function(){s.length>0&&(console.log("manyToOneConflict::onDismiss Main >> LAST?",s),setTimeout(()=>{T(s,o)},0))})},onPickEvent(i,e,t,o){if(this.closingDialog(),!i||!i.id){console.log("onPickEvent...ERROR nothing!",i,e,t,o),this.doNotify("No Goal selected..."),this.reset();return}let l=this.daSchedule.isViewingPast()?!0:e,s=o!=i.duration,n=this.daSchedule.tooClose(this.targetDrop.timestamp,s?o:i.duration);if(n){if(console.log("onPickEvent::tooClose check FAIL!",n),n===!0){this.doNotify("Picking event TOO close to midnight!"),this.reset();return}if(l)this.doNotify(`'${i.title.trim()}' TOO close Buuut..FORCING!`,"warning","top");else{this.doNotify(`'${i.title.trim()}' Not added as TOO close to a scheduled Evt`),this.reset();return}}s&&(i.duration=o);let a=this.daSchedule.onPickEvent(i,this.targetDrop.timestamp,l,t,this.doNotify);a.canContinue?t&&this.doNotify("What is Owed PAID! gg!","positive","top"):(console.log("onPickEvent::OVERLAPS!"+t,JSON.parse(JSON.stringify(a))),a.overlaps&&Object.keys(a.overlaps).length>0?(t&&this.doNotify("Overlaps!-Balance Not Used!","warning","top"),this.handleOverlaps(a.overlaps,null,"onPickEvt")):this.doNotify("Error? onPickEvt :(","negative","bottom"))},onAddHocEvent(i,e,t,o,l){if(this.possibleRange||(this.possibleRange=this.startEndTimes),i.trim()==""){this.doNotify("Empty Goal title..."),this.closingDialog(),this.reset();return}let s=$e(this.possibleRange[0]),n=o>15?k(s,{minute:parseInt(o)}):k($e(this.possibleRange[1]),{minute:15}),a=Math.floor(te(s,n)/1e3/60),g=this.daSchedule.tooClose(s,a);if(g){if(console.log("onAddHocEvent::tooClose check FAIL!!",g),this.closingDialog(),g===!0){this.doNotify(`'${i}' Not added as over midnight!`);return}this.doNotify(`'${i}' too close to a scheduled Evt--Forcing!!`,"warning")}this.closingDialog();let p=this.daSchedule.saveNewGoal(s,i,e,t,a);if(p){let C=this.daSchedule.onAdHocEvent(p,s,l,this.doNotify);if(C.canContinue)this.constructTree(),this.reset(),this.doNotify("New adHoc Evt added!","positive","top"),this.mobile&&this.adjustCurrentTime();else if(console.log("onAdHocEvent::OVERLAPS?",JSON.parse(JSON.stringify(C))),C.overlaps==null){this.doNotify("Error Adding this event :(","negative"),console.log("onAdHocEvent::ERROR not found?");return}else l&&this.doNotify("Overlaps!-Balance Not Used!","warning","top"),this.handleOverlaps(C.overlaps,null,"adHocEvt")}else console.log("onAdHocEvent::BOO ERROR no subID :(",p),this.doNotify("Error creating and adding this event :(","negative")},onEndNow(i){const e=()=>{let l=this.daSchedule.findEvent(i);this.daSchedule.removeScheduledEvt(l),this.daSchedule.saveDaySchedule(),this.doNotify(`Removing "${l==null?void 0:l.title.trim()}" Saving Schedule...`,"positive","top")},t=l=>{console.log("onEndNow::reducing!!!",i,Number.isInteger(l)),this.daSchedule.reduceEvtDuration(i,l)};let o=this.daSchedule.canEndNow(i);o?this.confirmAction("",`Less than 10mins remove?
 Cancel to just EndNow`,"OK",e,function(){t(o)}):console.log("onEndNow...Can NOT end?",i,o,Number.isInteger(o))},onSaveScore(i,e,t=""){let o=he(i);if(o<-1){o==-89?(console.log("onSaveScore parsing error",o,i),this.doNotify("Score Parsing Error... YOU FOO! ")):this.doNotify("Score Error: higher# on lower#");return}this.daSchedule.updateNoteScore(e,i,t)},onAddMins(i,e){let t=this.daSchedule.addMinsToEvt(i,e,this.doNotify);if(!t.canContinue){if(t.overlaps&&Object.keys(t.overlaps).length>0)return console.log("onAddMins::OVERLAPS!!"+e,t),this.doNotify("Bumped into some Evts","warning","top"),this.movedIntoConflict(t.overlaps,!0,"onAddMins",e);this.doNotify("Add ERROR:(","negative","bottom")}},removeEvtInSchedule(i,e=!0){let t=!1,o=()=>{if(this.daSchedule.removeScheduledEvt(i),t||e){console.log("removeEvtInSchedule::SAVE for: "+i.title,t,e),e&&(this.daSchedule.addToBalance(i),this.doNotify(`Balance change after removing '${i.title}'`,"warning","top")),this.daSchedule.saveDaySchedule();return}this.daSchedule.toggleActionBtns(!0,"view")};if(this.daSchedule.isViewingPast()){if(i.duration<30){this.doNotify("Removing from the past... Check BALANCE!"),this.daSchedule.addToBalance(i),t=!0,o();return}this.chooseAlternatives(i);return}if(!this.daSchedule.isViewingToday()&&!this.mobile){t=this.daSchedule.getCurrentMoods()[i.id],console.log("Removing future evt"),o();return}let l=`Remove "${i.title}" ?`,s=this.daSchedule.getCurrentMoods()[i.id];s&&(t=!0,l=l+` With Moods: '${s}'`),l=e?l+" (Balance affected)":l,this.confirmAction("Schedule Change",l,"Remove",o,function(){console.log("Cancelled remove")})},getEvtLabel(i,e=null){let t=this.daSchedule.parentGoalById(i.parentGoal),o=`Of '${t==null?void 0:t.title.trim()}' "${i.title.trim()}" (${i.score}) `;return o+=e?`@ ${L(i==null?void 0:i.time)} ++ ${i==null?void 0:i.duration} mins`:`for ${i==null?void 0:i.duration} mins`,{label:o,value:i.id}},betterEvtLabel(i,e,t=null){const o=(s,n)=>{if(s!=null&&s.parentGoal){let a=this.daSchedule.parentGoalById(s.parentGoal);return n?`Of '${a==null?void 0:a.title.trim()}' (${a==null?void 0:a.priority})`:`Of '${a==null?void 0:a.title.trim()}'`}return console.log("prioLabel..ERROR no PARENT found?",s),""};let l="";switch(e){case"score":return l=`${o(i,!1)} > "${i.title.trim()}" with Score:: ${i.score} = ${he(i.score)} `,l+=t?`@ ${L(i==null?void 0:i.time)} ++ ${i==null?void 0:i.duration} mins`:`for ${i==null?void 0:i.duration} mins`,{label:l,value:i.id};case"prio":return l=`"${i.title.trim()}" ${o(i,!0)} `,l+=t?`@ ${L(i==null?void 0:i.time)} ++ ${i==null?void 0:i.duration} mins`:`for ${i==null?void 0:i.duration} mins`,{label:l,value:i.id};default:return l=`"${i.title.trim()}" ${o(i,!0)} && Score:: ${i.score} = ${he(i.score)} ${t?` @ ${L(i==null?void 0:i.time)} ++ ${i==null?void 0:i.duration} mins`:`for ${i.duration} mins`}`,{label:l,value:i.id}}},getSmallestScoreInterval(i){let e=9,t=null;for(let o of i){let l=he(o.score);l>-1&&l<=e&&(e=l,t=o)}if(t)return t;console.log("ERROR ERROR getSmallestScoreInterval::No current set?",e,t,i)},findhighestPrio(i){let e=0,t=null;for(let o of i)if(o.parentGoal){let l=this.daSchedule.parentGoalById(o.parentGoal);l?l.priority>e&&(e=l.priority,t=o):console.log("findhighestPrio::ERROR no PARENT found?",o)}else console.log("findhighestPrio::ERROR EVT not found?",o);return{e:t,prio:e}},chooseAlternatives(i){let e=(T,v)=>{if(T.parentGoal>v.parentGoal)return 1;if(T.parentGoal==v.parentGoal)return 0;if(T.parentGoal<v.parentGoal)return-1},t=this.daSchedule.getAltEvts().sort(e),o=Y(new Date),l=i.time,s=o.date,n=i.title;const a=T=>T.filter(v=>!this.daSchedule.getAllEvts().find(y=>y.id==v.id)),g=T=>{let v=k(Q(s),{day:0}),y=k(Q(v.date),{day:1}),b=this.daSchedule.getEventsForDate(v.date),D={},m=null;b?D=b:console.log("chooseAlternatives::addInFutur EMPTY for >>...",v.date),T.forEach(O=>{if(m=this.daSchedule.getSubGoalByID(O),D[O]){console.log("addInFutur...ALREADY PRESENT",O,v.date,m==null?void 0:m.title.trim()),this.doNotify(`Alternative '${m==null?void 0:m.title.trim()}' already present on ${v.date}. Moving it to next day`,"warning");let w=this.daSchedule.getEventsForDate(y.date);if(w)if(!w[O])w[O]={duration:m==null?void 0:m.duration,time:l,notes:`Alt replace for '${n}'`};else{console.log("addInFutur...STILL PRESENT in next day:"+y.date,m.title.trim()),this.doNotify(`Booo! Alt '${m==null?void 0:m.title.trim()}' also present on ${y.date} :(( ...Check BALANCE!`),this.daSchedule.addToBalance(m);return}else w={},w[O]={duration:m.duration,time:l,notes:`Alt replace for '${n}'`};this.daSchedule.updateDaySchedule(y.date,w),this.doNotify(`Saving ${m.title} in ${y.date}`,"positive","bottom")}else D[O]={duration:m.duration,time:l,notes:`Alt replace for '${n}'`}}),this.daSchedule.updateDaySchedule(v.date,D)},p=T=>{this.daSchedule.removeScheduledEvt(i);let v=t.find(D=>D.id==T);console.log("remReplace...Add at:",l,v.title,"usually at:"+v.time);let y=this.daSchedule.addGoalsToSchedule([{...v,time:l,notes:`Alt replace for '${n}'`}],!0),b=Object.keys(y).length;if(b>0)return console.log(`chooseAlternatives::removeReplace:: OVERLAPS again from ${v.length} overlaps =${b}`,v,y),this.doNotify(`Extra Overlaps while adding ${v[0].title.trim()}`,"warning","top"),this.handleOverlaps(y,null,"alts");this.daSchedule.saveDaySchedule(),this.doNotify(`Added Alt replacement '${v==null?void 0:v.title}' at ${l}`,"positive","bottom")},C=T=>{this.doNotify(T)};if(t=a(t),t.length==0){C("Removing not allowed! Alternatives already present!");return}this.checkBoxDialog("Gotta pick alternative!","Select the first Evt to replace Removed + an Extra evt for next day (today)!",t.map(T=>this.betterEvtLabel(T,"default",!1)),t[0].id,function(T){console.log("chooseAlternatives::opt",T),p(T.shift()),T.length>0?g(T):(console.log("chooseAlternatives::onOk...nothing to add?!?",t.length,T.length,t.length-T.length),C("No Alternative scheduled later :("))},function(){console.log("chooseAlternatives::onCancel")})},reset(){this.selectedItem=null,this.targetDrop=null,this.touchedItem=null,this.daSchedule.resetChosen(),this.possibleRange=null},closingDialog(){this.showEvtDialog=!1},onPrev(){let i=()=>{this.$refs.calendar.prev()},e=()=>{setTimeout(i,1e3),this.doSaveSchedule()};this.saveScheduleDisabled?i():this.confirmAction("",`Save day: ${this.currentDate} changes?`,"Save",e,i)},onToday(){let i=()=>{this.$refs.calendar.moveToToday()},e=()=>{setTimeout(i,1e3),this.doSaveSchedule()};this.saveScheduleDisabled?i():this.confirmAction("",`Save day: ${this.currentDate} changes?`,"Save",e,i)},onNext(){let i=()=>{this.$refs.calendar.next()},e=()=>{setTimeout(i,1e3),this.doSaveSchedule()};this.saveScheduleDisabled?i():this.confirmAction("",`Save day: ${this.currentDate} changes?`,"Save",e,i)},onChange(){const i=t=>{setTimeout(()=>{let o=Y(new Date);this.scrollToTime(o,t?"slow":"fast")},t?0:1e3)};let e=this.daSchedule.onChangeViewDate(this.currentDate);if(!e.canContinue){if(e.overlaps&&Object.keys(e.overlaps).length>0)return this.handleOverlaps(e.overlaps,null,"view");this.doNotify(`Loaded schedule for ${this.currentDate}`,"positive","bottom"),this.adjustCurrentTime()}i(e.canContinue)},onDragStart(i,e){if(this.daSchedule.isViewingPast()){this.doNotify("Editing past is no no!"),i.preventDefault();return}this.selectedItem=e},onDragEnter(i,e,t){if(e==="goal-item")i.preventDefault();else{if(this.targetDrop&&this.targetDrop.timestamp.time==t.timestamp.time)console.log("onDragEnter...calendar,SAME",this.targetDrop.timestamp.time);else{let o=i.target;o.style.background=this.selectedItem.bgcolor.includes("-")?"grey":this.selectedItem.bgcolor,this.lastTarget=o}this.targetDrop=t,i.preventDefault()}return!0},onDragOver(i,e,t){return i.preventDefault(),!0},onDragLeave(i,e,t){let o=i.target;return o.style.background="",!1},onDragEnd(i){},doCleanup(){this.lastTarget&&(this.lastTarget.style.background="",this.lastTarget=null)},onDrop(i,e,t){let o=this.daSchedule.findEvent(this.selectedItem.id);if(!o){console.log("onDrop ERROR",o,this.selectedItem);return}let l=null;if(e==="interval")l=t.timestamp;else if(e==="goal-item"&&this.targetDrop)l=this.targetDrop.timestamp;else{console.log("Cannot drop here YO!!",i,e,t,this.targetDrop);return}if(!l){console.log("ERROR...no timestamp YO!!",i,e,t,this.targetDrop);return}this.doDroppy(l,this.selectedItem)},onClickTime(i){this.showEvtDialog=!0,this.targetDrop=i.scope},onClickDate(i){console.log("onClickDate",i)},onClickInterval(i){console.log("onClickInterval",i)},onClickHeadIntervals(i){console.log("onClickHeadIntervals",i)},onClickHeadDay(i){console.log("onClickHeadDay",i)},onMouseDownTime({scope:i,event:e}){if(He(e)){if(this.mobile===!0&&this.anchorTimestamp!==null&&this.otherTimestamp!==null&&de(this.anchorTimestamp)===de(this.otherTimestamp)){this.otherTimestamp=i.timestamp,this.mouseDown=!1;return}this.mouseDown=!0,this.anchorTimestamp=i.timestamp,this.otherTimestamp=i.timestamp}},onMouseUpTime({scope:i,event:e}){if(this.mobile!==!0&&He(e)&&(this.otherTimestamp=i.timestamp,this.mouseDown=!1),!this.mousedown){let t=this.startEndTimes;if(t[1]==t[0])return;this.possibleRange=t,console.log("onMouseUpTime range change",this.possibleRange)}},onMouseMoveTime({scope:i,event:e}){this.mobile!==!0&&this.mouseDown===!0&&(this.otherTimestamp=i.timestamp)},onDblClickEvent(i,e){if(this.isViewingPast()){if(console.log("onDblClickEvent::ERROR?",e),e.duration<30){console.log("onDblClickEvent..baah too smoll smoll",e.title,e.duration),this.doNotify("umm Removing from the past..Soo Check BALANCE!"),this.daSchedule.addToBalance(e),this.daSchedule.removeScheduledEvt(e);return}this.chooseAlternatives(e),i.preventDefault();return}this.removeEvtInSchedule(e,!1),i.preventDefault()},onTouchStart(i,e){if(i.type=="touchstart"){this.selectedItem=e;let t=document.elementFromPoint(i.changedTouches[0].clientX,i.changedTouches[0].clientY);if(t.parentNode.classList.contains("my-event"))t.parentNode.classList.add("my-event-drag"),this.touchedItem=t;else if(t.closest(".my-event"),t=t.parentNode,t.parentNode.classList.contains("my-event"))t.parentNode.classList.add("my-event-drag"),this.touchedItem=t;else{this.touchedItem=!1;return}return i.preventDefault(),!0}console.log("onTouchStart::ERROR...UNKNOWN",i)},onTouchEvt(i,e){const t=l=>{let s=l.split(" "),n=s[s.length-2],a=k(Q(this.currentDate),{minute:ee(n)});return s[s.length-1]=="PM"?a.hour==12?a:k(Q(this.currentDate),{hour:12,minute:ee(n)}):a.hour==12?k(Q(this.currentDate),{hour:-12,minute:ee(n)}):a};let o=l=>{let s=l.closest(".my-event");s.classList.contains("my-event-drag")&&s.classList.toggle("my-event-drag")};if(this.selectedItem||(console.log("onTouchEvt NULL Item >>ERROR?!? "+i.type,this.selectedItem,this.touchedItem),e=this.selectedItem),this.isViewingPast()){this.doNotify("Editing past is no no!"),o(this.touchedItem),i.preventDefault(),i.stopPropagation();return}if(i.type=="touchmove"){let l=document.elementFromPoint(i.changedTouches[0].clientX,i.changedTouches[0].clientY);if(l.ariaLabel){let s=t(l.ariaLabel);if(this.targetDrop){let n=te(this.targetDrop,s);if(JSON.stringify(this.targetDrop)===JSON.stringify(s)&&n==0)return;this.lastTarget?(this.lastTarget.style.background="",l.style.background=this.selectedItem.bgcolor.includes("-")?"grey":this.selectedItem.bgcolor,this.lastTarget=l):(this.lastTarget=l,l.style.background=this.selectedItem.bgcolor.includes("-")?"grey":this.selectedItem.bgcolor)}this.targetDrop=s,i.preventDefault();return}return}if(i.type=="touchend"){let l=document.elementFromPoint(i.changedTouches[0].clientX,i.changedTouches[0].clientY);if(!this.touchedItem)return;if(l.parentNode.classList.contains("my-event-drag"))console.log("onTouchEvt::END >>removing my-event-drag","isDisabledScoreEdit>> "+this.daSchedule.isDisabledScoreEdit[e.id],"mobileEnableScore>> "+this.daSchedule.mobileEnableScore[e.id]),l.parentNode.classList.remove("my-event-drag");else{let s=this.touchedItem.parentNode.classList.contains("my-event-drag");s?this.touchedItem.parentNode.classList.remove("my-event-drag"):console.log("onTouchEvt::END...target NO my-event-drag?",s,l,l.parentNode)}if(l.ariaLabel){let s=t(l.ariaLabel);this.targetDrop=s,this.doDroppy(this.targetDrop,this.selectedItem)}else(l.classList.contains("title")||l.classList.contains("my-event"))&&this.targetDrop&&this.doDroppy(this.targetDrop,this.selectedItem);i.preventDefault(),i.stopPropagation();return}console.log("onTouchEvt::UNKNOWN",i)},onTouchHold({evt:i,...e},t){if(!this.mobile)return console.log("onTouchHold>>NOT MOBILE",i.type,"mobileEnableScore>> "+this.daSchedule.mobileEnableScore[t.id]),!0;let o=document.elementFromPoint(i.changedTouches[0].clientX,i.changedTouches[0].clientY);this.daSchedule.toggleEvtNoteScoreMobile(t.id);let l=o.closest(".my-event");o.classList.contains("title")&&o.parentNode.classList.contains("my-event-drag")?(console.log("onTouchHold...REMOVING my-event-drag"),o.parentNode.classList.remove("my-event-drag")):l&&l.classList.contains("my-event-drag")?l.classList.toggle("my-event-drag"):this.touchedItem&&(l=this.touchedItem.closest(".my-event"),l&&l.classList.contains("my-event-drag")?l.classList.toggle("my-event-drag"):console.log("ERROR...onTouchHold--class not found on Target!!",o,this.touchedItem)),this.daSchedule.isDisabledScoreEdit[t.id]&&!this.daSchedule.mobileEnableScore[t.id]&&this.onDblClickEvent(i,t)},scrollToEvent(i){this.$refs.calendar.scrollToTime(i.time,350)},scrollToTime(i,e=null){var t;if(this.$refs.calendar){let o=k(i,{minute:-30});(t=this.$refs.calendar)==null||t.scrollToTime(o.time,e?e=="fast"?400:1e3:500)}else setTimeout(()=>{let o=Y(new Date);console.log("scrollToTime::NO SCROLLY at",i.time,"Now going to: "+o.time),this.scrollToTime(o,"slow")},1e3)},confirmTimeChange(i,e,t,o,l,s,n=null){this.$q.dialog({title:i,message:e,cancel:!1,ok:t,options:{type:"radio",model:"",items:[{label:t+" and "+o,value:"ok"},{label:o,value:"alt"}]},class:"overflow-wrap: break-word;",style:""}).onOk(a=>{if(a==""){console.log("confirmTimeChange onOk with no selection >>onDismiss"),this.doNotify("No selection made...Leaving as is","positive","bottom"),n?n():console.log("confirmTimeChange:: No Dismiss func to execute!");return}return l(a)}).onCancel(()=>{s()})},radioChoiceDialog(i,e,t,o,l=null,s=null,n=null){this.$q.dialog({title:i,cancel:!!s,persistent:!0,message:e,options:{type:"radio",model:o,items:t}}).onOk(a=>{l&&(a==""?this.radioChoiceDialog(i,e,t,o,l,s,n):l(a))}).onCancel(()=>{s&&s()}).onDismiss(()=>{n&&n()})},checkBoxDialog(i,e,t,o,l=null,s=null,n=null){let a=t.length,g=a>2?2:a;this.$q.dialog({title:i,message:e,options:{type:"checkbox",model:[],isValid:p=>p.length>0&&p.length>=g,items:t},cancel:!0,persistent:!0}).onOk(p=>{l(p)}).onCancel(()=>{s&&s()}).onDismiss(()=>{n&&n()})},confirmAction(i,e,t,o,l,s=null){this.$q.dialog({title:i,cancel:!0,ok:t,message:e}).onOk(()=>{o()}).onCancel(()=>{l()}).onDismiss(()=>{if(s){s();return}})},doNotifyTimeout(i,e=void 0,t="top",o=null){this.$q.notify({color:e!==void 0?e:"negative",position:t,message:i,icon:e==null?"report_problem":"thumb_up",timeout:o||5e3})},doNotify(i,e=void 0,t="top"){this.$q.notify({color:e!==void 0?e:"negative",position:t,message:i,icon:e==null?"report_problem":"thumb_up"})},withDismissNotify(i,e=void 0,t="top",o=null,l=null){this.$q.notify({color:e!==void 0?e:"negative",position:t,message:i,icon:e==null?"report_problem":"thumb_up",timeout:o!=null?o:5e3,closeBtn:"Okey",onDismiss:l})}}},be=i=>(nt("data-v-422e35d1"),i=i(),rt(),i),xt={class:"subcontent"},Lt={class:"q-px-md boxy"},It={key:0},Gt={key:1},Vt={key:2},Ft={key:3},Jt={key:4},Ht={key:5},Ut={class:"row justify-center"},jt=be(()=>J("br",null,null,-1)),zt=be(()=>J("br",null,null,-1)),Wt={key:0,class:"q-pa-sm bg-grey-12",style:{"max-width":"400px"}},qt={class:"q-pa-sm row justify-center"},Qt={class:"row justify-center"},Kt=be(()=>J("br",null,null,-1)),Yt={key:0,class:"q-gutter-md"},Xt={class:"q-mr-sm text-weight-bold",size:"28px"},Zt={key:0},ei={class:"text-weight-bold"},ti={key:1,class:"text-weight-light text-black"},ii={key:1,class:"q-pa-md q-gutter-sm bg-grey-12",style:{"max-width":"400px"}},oi={key:0,class:"q-ma-xl column items-center instru"},li={key:1,class:"q-ma-xl column items-center instru"},si={key:0,class:"row"},ni={class:"row justify-center"},ri={class:"q-gutter-md",style:{display:"flex","max-width":"800px",width:"100%",height:"600px"}},ai={style:{display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"2px"}},di={class:"heady q-calendar__ellipsis"},hi=["onDblclick","onDragstart","onTouchstart","onTouchmove","onTouchend"],ci=be(()=>J("br",null,null,-1));function ui(i,e,t,o,l,s){const n=le("sched-btn"),a=le("drop-dwn-btn"),g=le("navigation-bar"),p=le("goaly-end"),C=le("mobileNoteScore"),T=le("q-calendar-day"),v=le("sched-dialog");return _(),X(St,{padding:""},{default:$(()=>[J("div",xt,[N(Ie,{modelValue:l.splitterPage,"onUpdate:modelValue":e[9]||(e[9]=y=>l.splitterPage=y),limits:[30,70]},{before:$(()=>[N(Ie,{modelValue:l.splitterLegend,"onUpdate:modelValue":e[3]||(e[3]=y=>l.splitterLegend=y),horizontal:"",limits:[20,80],style:{height:"100%"}},{before:$(()=>[J("div",Lt,[l.daSchedule.getProps().showReloadBtn?(_(),I("div",It,[N(n,{"text-label":"Reload",class:"sched-btn","text-color":"green",onDoBtnAction:s.onReloadSaved},null,8,["onDoBtnAction"])])):G("",!0),l.daSchedule.getProps().showClearBtn?(_(),I("div",Gt,[N(n,{"text-label":"Clear",class:"sched-btn","text-color":"lime-5",onDoBtnAction:s.onClearDay},null,8,["onDoBtnAction"])])):G("",!0),s.showDefaultBtn?(_(),I("div",Vt,[N(n,{textLabel:s.defaultLabels,class:"sched-btn","text-color":"blue",onDoBtnAction:s.onLoadDefault},null,8,["textLabel","onDoBtnAction"])])):G("",!0),l.daSchedule.getProps().showScoreBtn?(_(),I("div",Ft,[N(a,{class:"sched-drop-btn","text-color":"teal",disableBtn:l.daSchedule.disableScoreBtn,optionLabel:s.chosenScoreLabel,daOptions:l.scoreOptions,onDoReload:s.doReloadWithScore,onChooseOption:s.onChoosenScore},null,8,["disableBtn","optionLabel","daOptions","onDoReload","onChooseOption"])])):G("",!0),l.daSchedule.getProps().showPrioBtn?(_(),I("div",Jt,[N(a,{class:"sched-drop-btn","text-color":"teal",disableBtn:l.daSchedule.getProps().disablePrioBtn,optionLabel:s.chosenPrioLabel,daOptions:s.allMainGPrio(),onDoReload:s.doReloadWithPrio,onChooseOption:s.onChoosenPrio},null,8,["disableBtn","optionLabel","daOptions","onDoReload","onChooseOption"])])):G("",!0),l.daSchedule.getProps().showOneEachBtn?(_(),I("div",Ht,[N(n,{"text-label":"One Each",class:"sched-btn","text-color":"brown",onDoBtnAction:s.onScheduleOneEach},null,8,["onDoBtnAction"])])):G("",!0)]),J("div",Ut,[N(ke,{class:"q-mt-md","text-color":s.saveScheduleDisabled?"grey":"blue",elevated:"",push:"",align:"evenly",label:"SaveSchedule",disable:s.saveScheduleDisabled,onClick:s.doSaveSchedule,"no-caps":""},null,8,["text-color","disable","onClick"]),N(ke,{class:"q-mt-md","text-color":"green",elevated:"",push:"",align:"evenly",label:l.showTree?"HideTree":"ShowTree",onClick:e[0]||(e[0]=y=>l.showTree=!l.showTree),"no-caps":""},null,8,["label"])]),jt]),after:$(()=>[zt,l.treeGoals.length>0?(_(),I("div",Wt,[J("div",qt,W(s.labelGoals("s")),1),J("div",Qt,[N(ye,{color:"secondary","multi-line":""},{default:$(()=>[U(W(s.labelGoals("b"))+" mins ",1)]),_:1})]),N(se),Kt,s.showTreeForm?(_(),I("div",Yt,[N(ut,{label:"'je-suis'",hint:"Keyword >> Enter","hide-hint":"",ref:"filterRef",modelValue:l.filter,"onUpdate:modelValue":e[1]||(e[1]=y=>l.filter=y),"use-input":"","use-chips":"",multiple:"",disable:s.isViewingPast(),"hide-dropdown-icon":"","input-debounce":"0","new-value-mode":"add-unique",class:"q-gutter-sm"},{"selected-item":$(y=>[N(ft,{removable:"",dense:"",onRemove:b=>y.removeAtIndex(y.index),tabindex:y.tabindex,"text-color":"black",class:"q-ma-none",style:{width:"80px"}},{default:$(()=>[U(W(y.opt),1)]),_:2},1032,["onRemove","tabindex"])]),append:$(()=>[l.filter.length>0?(_(),X(De,{key:0,name:"clear",class:"cursor-pointer",onClick:s.resetFilter},null,8,["onClick"])):G("",!0)]),_:1},8,["modelValue","disable"]),N(yt,{nodes:l.treeGoals,"node-key":"label",filter:s.filterString,"filter-method":s.myFilterMethod,expanded:l.expanded,"onUpdate:expanded":e[2]||(e[2]=y=>l.expanded=y),"no-connectors":"",dense:""},{"default-header":$(y=>[J("div",{class:Se(s.classyColor(y.node))},[y.node.isChildren?G("",!0):(_(),X(De,{key:0,name:y.expanded?"expand_less":"expand_more",size:"28px",right:""},null,8,["name"])),J("div",Xt,W(y.node.label),1),N(De,{name:y.node.icon},null,8,["name"])],2)]),"default-body":$(y=>[y.node.isChildren?(_(),I("div",Zt,[J("span",ei," >> "+W(y.node.details),1),y.node.moods.length>0?(_(),X(Ae,{key:0},{default:$(()=>[U(W("Moods::> "+y.node.moods.join(",")),1)]),_:2},1024)):G("",!0)])):(_(),I("span",ti,W(y.node.details),1))]),_:1},8,["nodes","filter","filter-method","expanded"])])):G("",!0),l.filter.length>0?(_(),I("div",ii,[N(n,{"text-label":"Add Mood Evts",class:"q-mt-xl sched-btn","text-color":"red",onDoBtnAction:s.onMoodAdd},null,8,["onDoBtnAction"])])):G("",!0)])):G("",!0)]),_:1},8,["modelValue"]),s.showRemInstru?(_(),I("div",oi,[N(Z,null,{default:$(()=>[U(" Double click upcoming evt to remove it ")]),_:1}),N(se),N(Z,null,{default:$(()=>[U(" For mobile, Long press hold to remove or start drag ")]),_:1}),N(se),N(Z,null,{default:$(()=>[U(" Can also add note to a finished evt or remove it ")]),_:1}),N(se),N(Z,null,{default:$(()=>[U(" Click on time intervals to add events to schedule ")]),_:1}),N(se),N(Z,null,{default:$(()=>[U(" ShowTree to filter goals by mood keywords. ")]),_:1})])):G("",!0),s.showSchedInstru?(_(),I("div",li,[N(Z,null,{default:$(()=>[U(" Use above Scheduling buttons to add events to schedule ")]),_:1}),N(se),N(Z,null,{default:$(()=>[U(" Can also use mood keyworks to filter/add associated goals. ")]),_:1}),N(se),N(Z,null,{default:$(()=>[U(" Click on time intervals to add events to schedule ")]),_:1})])):G("",!0)]),separator:$(()=>[N(lt,{color:"primary",class:"q-px-md","text-color":"white",size:"40px",icon:"drag_indicator",style:{position:"relative",top:"70%"}})]),after:$(()=>[N(g,{onToday:s.onToday,onPrev:s.onPrev,onNext:s.onNext},null,8,["onToday","onPrev","onNext"]),s.scheduleMoodsLabel!=""?(_(),I("div",si,[U(" By moods: "),N(ye,{color:"secondary","multi-line":""},{default:$(()=>[U(W(s.scheduleMoodsLabel),1)]),_:1})])):G("",!0),J("div",ni,[J("div",ri,[N(T,{ref:"calendar",view:"day",modelValue:l.currentDate,"onUpdate:modelValue":e[8]||(e[8]=y=>l.currentDate=y),"drag-enter-func":s.onDragEnter,"drag-over-func":s.onDragOver,"drag-leave-func":s.onDragLeave,"drop-func":s.onDrop,animated:"",bordered:"",hoverable:"","no-active-date":"","transition-next":"slide-left","transition-prev":"slide-right","time-clicks-clamped":"","interval-minutes":15,"interval-count":96,"interval-height":28,"selected-start-end-dates":s.startEndTimes,onChange:s.onChange,onClickDate:s.onClickDate,onClickTime:s.onClickTime,onClickInterval:s.onClickInterval,onClickHeadIntervals:s.onClickHeadIntervals,onClickHeadDay:s.onClickHeadDay,onMousedownTime:s.onMouseDownTime,onMouseupTime:s.onMouseUpTime,onMousemoveTime:s.onMouseMoveTime},{"head-day-event":$(({scope:{timestamp:y}})=>[J("div",ai,[(_(!0),I(fe,null,Be(s.eventsMap[y.date],b=>(_(),I(fe,{key:b.id},[b.time?(_(),X(ye,{key:1,class:Se(s.badgeClasses(b,"header")),style:ge([s.badgeStyles(b,"header"),{margin:"1px",width:"10px","max-width":"10px",height:"10px","max-height":"10px",cursor:"pointer"}]),onClick:D=>s.scrollToEvent(b)},{default:$(()=>[N(Ae,null,{default:$(()=>[U(W(b.title+" ("+b.duration+" min) >>"+b.time+" - "+b.end.time),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"])):(_(),X(ye,{key:0,class:Se(s.badgeClasses(b,"header")),style:ge([s.badgeStyles(b,"header"),{width:"100%",cursor:"pointer",height:"12px","font-size":"10px",margin:"1px"}])},{default:$(()=>[J("div",di,[U(W(b.title)+" ",1),N(Ae,null,{default:$(()=>[U(W(b.details),1)]),_:2},1024)])]),_:2},1032,["class","style"]))],64))),128))])]),"day-container":$(({scope:{days:y}})=>[s.hasDate(y)?(_(),I(fe,{key:0},[J("div",{class:"day-view-current-time-indicator",style:ge(s.style)},null,4),J("div",{class:"day-view-current-time-line",style:ge(s.style)},null,4)],64)):G("",!0)]),"day-body":$(({scope:{timestamp:y,timeStartPos:b,timeDurationHeight:D}})=>[(_(!0),I(fe,null,Be(s.getDateEvents(y.date),m=>(_(),I(fe,{key:m.id},[m.time!==void 0?(_(),I("div",{key:0,class:Se(["my-event",s.badgeClasses(m,"body")]),style:ge(s.badgeStyles(m,"body",b,D)),draggable:!0,onDblclick:we(O=>s.onDblClickEvent(O,m),["prevent"]),onDragstart:we(O=>s.onDragStart(O,m),["stop"]),onDragend:e[4]||(e[4]=we((...O)=>s.onDragEnd&&s.onDragEnd(...O),["stop"])),onDrop:e[5]||(e[5]=O=>s.onDrop(O,"goal-item",i.scope)),onDragenter:e[6]||(e[6]=O=>s.onDragEnter(O,"goal-item",i.scope)),onDragover:e[7]||(e[7]=O=>s.onDragOver(O,"goal-item",i.scope)),onTouchstart:O=>s.onTouchStart(O,m),onTouchmove:O=>s.onTouchEvt(O,m),onTouchend:O=>s.onTouchEvt(O,m)},[st(N(p,{disabledScore:l.daSchedule.isDisabledScoreEdit[m.id],title:m.title,id:m.id,startTime:m.time,score:m.score,details:m.details,notes:m.notes,icon:m.icon,happeningNow:l.daSchedule.hasStarted[m.id]?l.daSchedule.hasStarted[m.id]:!1,onEndNow:s.onEndNow,onSaveScore:s.onSaveScore,onAddMins:s.onAddMins,onDeleteNow:O=>s.removeEvtInSchedule(m)},null,8,["disabledScore","title","id","startTime","score","details","notes","icon","happeningNow","onEndNow","onSaveScore","onAddMins","onDeleteNow"]),[[vt,O=>s.onTouchHold(O,m),"400:12:15"]]),s.showEvtMobile(m.id)?(_(),X(C,{key:0,title:m.title,id:m.id,startTime:m.time,score:m.score,details:m.details,notes:m.notes,"show-dialog":s.showEvtMobile(m.id),onSaveScore:s.onSaveScore,onDeleteNow:O=>s.removeEvtInSchedule(m),onEuhHidin:O=>l.daSchedule.euhHidin(m.id)},null,8,["title","id","startTime","score","details","notes","show-dialog","onSaveScore","onDeleteNow","onEuhHidin"])):G("",!0)],46,hi)):G("",!0)],64))),128))]),_:1},8,["modelValue","drag-enter-func","drag-over-func","drag-leave-func","drop-func","selected-start-end-dates","onChange","onClickDate","onClickTime","onClickInterval","onClickHeadIntervals","onClickHeadDay","onMousedownTime","onMouseupTime","onMousemoveTime"])])]),ci]),_:1},8,["modelValue"]),l.showEvtDialog?(_(),X(v,{key:0,parentGoals:l.daSchedule.allPGoals(),canBeScheduled:s.canbeScheduled,balance:s.currentBalance,onAdHocEvent:s.onAddHocEvent,onOnPickEvent:s.onPickEvent,onEuhHidin:s.closingDialog},null,8,["parentGoals","canBeScheduled","balance","onAdHocEvent","onOnPickEvent","onEuhHidin"])):G("",!0)])]),_:1})}var Ci=ot(Bt,[["render",ui],["__scopeId","data-v-422e35d1"]]);export{Ci as default};
