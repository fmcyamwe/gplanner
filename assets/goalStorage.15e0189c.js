import{W as w,r as U,c as d}from"./index.1553c8f3.js";import{u as W}from"./use-quasar.a1a5fbdb.js";const q=w("allGoals",()=>{const h=U([{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}]),v=[{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}],n=W(),m=d(()=>v),G=d(()=>{let e=JSON.parse(n.localStorage.getItem("mainGoals"));return S(e)}),b=d(()=>{let e=JSON.parse(n.localStorage.getItem("subGoals"));return S(e)}),p=d(()=>JSON.parse(n.localStorage.getItem("AllDates")));function S(e){return e?[...e]:[]}function y(e,t,l,s){console.log(e.value+" "+t.value+" "+l.value+" "+s.value);let o=this.getMainGoals;if(!o){console.log("umm no mainGoals...adding"),n.localStorage.set("mainGoals",JSON.stringify([{id:0,title:e.value,details:t.value,priority:s.value,bgcolor:l.value,icon:"fas fa-utensils"}]));return}let r=o.length+1;for(;o.some(i=>i.id===r);)r=Math.floor(Math.random()*1e3);o.unshift({id:r,title:e.value,details:t.value,priority:s.value,bgcolor:l.value,icon:"fas fa-utensils"}),n.localStorage.set("mainGoals",JSON.stringify(o)),console.log("done adding mainGoal")}function D(e,t,l,s,o,r){console.log(e+" "+t.value+" "+l.value+" "+s.value+" "+o.value+" "+r.value);let i=this.getSubGoals;if(!i){n.localStorage.set("subGoals",JSON.stringify([{id:0,parentGoal:e,title:t.value,score:l.value,time:s.value,duration:o.value,canMove:r.value}]));return}let a=i.length+1;for(;i.some(u=>u.id===a);)a=Math.floor(Math.random()*1e3);i.unshift({id:a,parentGoal:e,title:t.value,score:l.value,time:s.value,duration:o.value,canMove:r.value}),n.localStorage.set("subGoals",JSON.stringify(i))}function O(e,t,l,s,o,r){let i=this.getSubGoals;i.forEach(a=>{a.id===e&&(a.title=t.value,a.score=l.value,a.time=s.value,a.duration=o.value,a.canMove=r.value,console.log("editSubGoal for",a))}),n.localStorage.set("subGoals",JSON.stringify(i))}function x(){n.localStorage.remove("mainGoals"),console.log("removed all mainGoal")}function A(){n.localStorage.remove("subGoals"),console.log("removed all subGoals")}function N(){n.localStorage.remove("subGoals"),n.localStorage.remove("mainGoals"),console.log("removed ALL")}function I(e,t=null,l=null){let s=this.getSubGoals;s.forEach(o=>{o.id===e&&(o.time=t||o.time,o.score=l||o.score)}),n.localStorage.set("subGoals",JSON.stringify(s))}function M(e){let t=this.getSubGoals;for(var l=0;l<t.length;l++)t[l].id===e&&(t.splice(l,1),console.log("removeSubgoal spliced!"));return n.localStorage.set("subGoals",JSON.stringify(t)),t}function J(e,t){let l=this.getMainGoals;for(var s=0;s<l.length;s++)l[s].id===e&&(l.splice(s,1),console.log("removeMaingoal spliced!"));return n.localStorage.set("mainGoals",JSON.stringify(l)),l}function $(e,t){let l=this.getAllDates;l?(l[`${e}`]=t,n.localStorage.set("AllDates",JSON.stringify(l))):(console.log(`Adding new schedule for ${e}`),l={},l[`${e}`]=t,n.localStorage.set("AllDates",JSON.stringify(l)))}function T(e){let t=this.getAllDates;if(t)return t[`${e}`]}function E(e){let t=this.getAllDates;return t?!!t[`${e}`]:!1}function R(e){const t=[];let l=function(o){const r=o.split(/on/);return r.length!=2?(console.log(`parseScore error?${o}`,r),-1):r[1]-r[0]},s=this.getSubGoals;return s&&s.forEach(o=>{if(o.score=="")console.log(`no score event added: ${o.title}`,o.score),t.push(o);else{let r=l(o.score);r>-1&&r>=e&&t.push(o)}}),t}function F(e){const l=(e/60).toFixed(2);return parseFloat(l)}function L(){let e=this.getAllDates;if(!e)return console.log("no savedTaskSummary..ERROR"),[];let t=this.getMainGoals,l=this.getSubGoals,s={};for(let a in e){let u=e[a];for(let c in u)s[c]||(s[c]=[]),s[c].push({date:a,logged:F(u[c].duration)})}let o=a=>{let u=[];return l&&l.forEach(c=>{c.parentGoal==a&&u.push(c)}),u},r=(a,u=null)=>{let c={children:[],title:u?`${a.title}:(${a.score})`:a.title,key:u?`${u}-${a.id}`:a.id,logged:[],expanded:!1};if(u){let f=s[a.id]||[];c.logged=[...f]}return c},i=[];return t.forEach(a=>{let u=r(a),c=o(a.id);for(let f=0;f<c.length;f++){let g=r(c[f],a.id);if(g.logged.length==0){console.log(`Oooh no logged for parent ${a.title}`,g);continue}u.logged.push(...g.logged),u.children.push(g)}i.push(u)}),i}return{headers:v,headerRefs:h,getHeaders:m,getMainGoals:G,getSubGoals:b,getAllDates:p,addMainGoal:y,addSubGoal:D,editSubGoal:O,saveSubProp:I,saveDailySchedule:$,resetSub:A,resetMain:x,resetAll:N,removeSubgoal:M,removeMaingoal:J,getEventsForDate:T,hasEventsForDate:E,fetchAllTaskSummary:L,fetchGoalsWithMinScore:R}});export{q as u};
