import{j as gt,R as ri,U as ai,r as x,c as H,w as Mt,n as Ci,h as te,k as at,ax as Oi,y as di,g as mt,l as wi,m as bt,p as Ei,f as ze,br as Di,by as Tt,aI as Ri,aJ as Ni,i as $i,bz as _t,aM as Pi,ay as hi,ac as Ct,O as Mi,az as Ai,a9 as lt,aB as zt,aa as Ot,X as Bi,d as ki,z as ci,A as W,B as oe,C as _,D as I,I as Q,G as de,a3 as dt,bA as xi,bB as Ii,a2 as ui,E as se,bC as ht,J as $e,a5 as At,bw as Li,a1 as Re,H as Te,bD as _i,bE as zi,K as ae,F as ye,Q as wt,a4 as je,aX as ke,M as xe,L as Et,a6 as nt,_ as Ne}from"./index.1bde7470.js";import{Q as Ft,b as Fi}from"./QItem.9c617eab.js";import{T as ct,b as Je,Q as Gi,a as qi}from"./QSelect.7bad7c28.js";import{d as Dt,a as Vi,u as Hi,Q as Wi,b as Rt}from"./goalStorage.eaf7c117.js";import{i as Ui,Q as ji}from"./isMobile.3d7b0ad3.js";import{Q as Nt}from"./QBadge.295c4452.js";import{Q as Ji}from"./QScrollObserver.012323a9.js";import{a as Qi}from"./index.86ea5f6b.js";import{t as ut,I as Gt,b as ge,a as q,p as ee,T as Ce,P as he,N as Bt,O as Ki,c as kt,g as fe,F as st}from"./QCalendarTask.13a7f0cd.js";/* empty css                             */import{p as Pe,w as j,h as _e,c as Yi,a as Xi,b as Zi,d as eo}from"./utiFunc.f569f737.js";import{L as Ie}from"./notifHelper.1ee70d57.js";import{N as qt}from"./actions.9a4d5535.js";import"./touch.9135741d.js";var Vt=gt({name:"QSplitter",props:{...ri,modelValue:{type:Number,required:!0},reverse:Boolean,unit:{type:String,default:"%",validator:i=>["%","px"].includes(i)},limits:{type:Array,validator:i=>i.length!==2||typeof i[0]!="number"||typeof i[1]!="number"?!1:i[0]>=0&&i[0]<=i[1]},emitImmediately:Boolean,horizontal:Boolean,disable:Boolean,beforeClass:[Array,String,Object],afterClass:[Array,String,Object],separatorClass:[Array,String,Object],separatorStyle:[Array,String,Object]},emits:["update:modelValue"],setup(i,{slots:e,emit:t}){const{proxy:{$q:o}}=mt(),n=ai(i,o),l=x(null),r={before:x(null),after:x(null)},s=H(()=>`q-splitter no-wrap ${i.horizontal===!0?"q-splitter--horizontal column":"q-splitter--vertical row"} q-splitter--${i.disable===!0?"disabled":"workable"}`+(n.value===!0?" q-splitter--dark":"")),a=H(()=>i.horizontal===!0?"height":"width"),c=H(()=>i.reverse!==!0?"before":"after"),m=H(()=>i.limits!==void 0?i.limits:i.unit==="%"?[10,90]:[50,1/0]);function h(u){return(i.unit==="%"?u:Math.round(u))+i.unit}const T=H(()=>({[c.value]:{[a.value]:h(i.modelValue)}}));let g,C,y,S,D;function p(u){if(u.isFirst===!0){const w=l.value.getBoundingClientRect()[a.value];g=i.horizontal===!0?"up":"left",C=i.unit==="%"?100:w,y=Math.min(C,m.value[1],Math.max(m.value[0],i.modelValue)),S=(i.reverse!==!0?1:-1)*(i.horizontal===!0?1:o.lang.rtl===!0?-1:1)*(i.unit==="%"?w===0?0:100/w:1),l.value.classList.add("q-splitter--active");return}if(u.isFinal===!0){D!==i.modelValue&&t("update:modelValue",D),l.value.classList.remove("q-splitter--active");return}const v=y+S*(u.direction===g?-1:1)*u.distance[i.horizontal===!0?"y":"x"];D=Math.min(C,m.value[1],Math.max(m.value[0],v)),r[c.value].value.style[a.value]=h(D),i.emitImmediately===!0&&i.modelValue!==D&&t("update:modelValue",D)}const d=H(()=>[[ct,p,void 0,{[i.horizontal===!0?"vertical":"horizontal"]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function b(u,v){u<v[0]?t("update:modelValue",v[0]):u>v[1]&&t("update:modelValue",v[1])}return Mt(()=>i.modelValue,u=>{b(u,m.value)}),Mt(()=>i.limits,()=>{Ci(()=>{b(i.modelValue,m.value)})}),()=>{const u=[te("div",{ref:r.before,class:["q-splitter__panel q-splitter__before"+(i.reverse===!0?" col":""),i.beforeClass],style:T.value.before},at(e.before)),te("div",{class:["q-splitter__separator",i.separatorClass],style:i.separatorStyle,"aria-disabled":i.disable===!0?"true":void 0},[Oi("div",{class:"q-splitter__separator-area absolute-full"},at(e.separator),"sep",i.disable!==!0,()=>d.value)]),te("div",{ref:r.after,class:["q-splitter__panel q-splitter__after"+(i.reverse===!0?"":" col"),i.afterClass],style:T.value.after},at(e.after))];return te("div",{class:s.value,ref:l},di(e.default,u))}}});const to={position:{type:String,default:"bottom-right",validator:i=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(i)},offset:{type:Array,validator:i=>i.length===2},expand:Boolean};function io(){const{props:i,proxy:{$q:e}}=mt(),t=wi(Ei,bt);if(t===bt)return console.error("QPageSticky needs to be child of QLayout"),bt;const o=H(()=>{const h=i.position;return{top:h.indexOf("top")!==-1,right:h.indexOf("right")!==-1,bottom:h.indexOf("bottom")!==-1,left:h.indexOf("left")!==-1,vertical:h==="top"||h==="bottom",horizontal:h==="left"||h==="right"}}),n=H(()=>t.header.offset),l=H(()=>t.right.offset),r=H(()=>t.footer.offset),s=H(()=>t.left.offset),a=H(()=>{let h=0,T=0;const g=o.value,C=e.lang.rtl===!0?-1:1;g.top===!0&&n.value!==0?T=`${n.value}px`:g.bottom===!0&&r.value!==0&&(T=`${-r.value}px`),g.left===!0&&s.value!==0?h=`${C*s.value}px`:g.right===!0&&l.value!==0&&(h=`${-C*l.value}px`);const y={transform:`translate(${h}, ${T})`};return i.offset&&(y.margin=`${i.offset[1]}px ${i.offset[0]}px`),g.vertical===!0?(s.value!==0&&(y[e.lang.rtl===!0?"right":"left"]=`${s.value}px`),l.value!==0&&(y[e.lang.rtl===!0?"left":"right"]=`${l.value}px`)):g.horizontal===!0&&(n.value!==0&&(y.top=`${n.value}px`),r.value!==0&&(y.bottom=`${r.value}px`)),y}),c=H(()=>`q-page-sticky row flex-center fixed-${i.position} q-page-sticky--${i.expand===!0?"expand":"shrink"}`);function m(h){const T=at(h.default);return te("div",{class:c.value,style:a.value},i.expand===!0?T:[te("div",T)])}return{$layout:t,getStickyContent:m}}var oo=gt({name:"QPageSticky",props:to,setup(i,{slots:e}){const{getStickyContent:t}=io();return()=>t(e)}}),lo=gt({props:["store","barStyle","verticalBarStyle","horizontalBarStyle"],setup(i){return()=>[te("div",{class:i.store.scroll.vertical.barClass.value,style:[i.barStyle,i.verticalBarStyle],"aria-hidden":"true",onMousedown:i.store.onVerticalMousedown}),te("div",{class:i.store.scroll.horizontal.barClass.value,style:[i.barStyle,i.horizontalBarStyle],"aria-hidden":"true",onMousedown:i.store.onHorizontalMousedown}),ze(te("div",{ref:i.store.scroll.vertical.ref,class:i.store.scroll.vertical.thumbClass.value,style:i.store.scroll.vertical.style.value,"aria-hidden":"true"}),i.store.thumbVertDir),ze(te("div",{ref:i.store.scroll.horizontal.ref,class:i.store.scroll.horizontal.thumbClass.value,style:i.store.scroll.horizontal.style.value,"aria-hidden":"true"}),i.store.thumbHorizDir)]}});const Ht=["vertical","horizontal"],$t={vertical:{offset:"offsetY",scroll:"scrollTop",dir:"down",dist:"y"},horizontal:{offset:"offsetX",scroll:"scrollLeft",dir:"right",dist:"x"}},Wt={prevent:!0,mouse:!0,mouseAllDir:!0},Ut=i=>i>=250?50:Math.ceil(i/5);var no=gt({name:"QScrollArea",props:{...ri,thumbStyle:Object,verticalThumbStyle:Object,horizontalThumbStyle:Object,barStyle:[Array,String,Object],verticalBarStyle:[Array,String,Object],horizontalBarStyle:[Array,String,Object],verticalOffset:{type:Array,default:[0,0]},horizontalOffset:{type:Array,default:[0,0]},contentStyle:[Array,String,Object],contentActiveStyle:[Array,String,Object],delay:{type:[String,Number],default:1e3},visible:{type:Boolean,default:null},tabindex:[String,Number],onScroll:Function},setup(i,{slots:e,emit:t}){const o=x(!1),n=x(!1),l=x(!1),r={vertical:x(0),horizontal:x(0)},s={vertical:{ref:x(null),position:x(0),size:x(0)},horizontal:{ref:x(null),position:x(0),size:x(0)}},{proxy:a}=mt(),c=ai(i,a.$q);let m=null,h;const T=x(null),g=H(()=>"q-scrollarea"+(c.value===!0?" q-scrollarea--dark":""));Object.assign(r,{verticalInner:H(()=>r.vertical.value-i.verticalOffset[0]-i.verticalOffset[1]),horizontalInner:H(()=>r.horizontal.value-i.horizontalOffset[0]-i.horizontalOffset[1])}),s.vertical.percentage=H(()=>{const R=s.vertical.size.value-r.vertical.value;if(R<=0)return 0;const P=Je(s.vertical.position.value/R,0,1);return Math.round(P*1e4)/1e4}),s.vertical.thumbHidden=H(()=>(i.visible===null?l.value:i.visible)!==!0&&o.value===!1&&n.value===!1||s.vertical.size.value<=r.vertical.value+1),s.vertical.thumbStart=H(()=>i.verticalOffset[0]+s.vertical.percentage.value*(r.verticalInner.value-s.vertical.thumbSize.value)),s.vertical.thumbSize=H(()=>Math.round(Je(r.verticalInner.value*r.verticalInner.value/s.vertical.size.value,Ut(r.verticalInner.value),r.verticalInner.value))),s.vertical.style=H(()=>({...i.thumbStyle,...i.verticalThumbStyle,top:`${s.vertical.thumbStart.value}px`,height:`${s.vertical.thumbSize.value}px`,right:`${i.horizontalOffset[1]}px`})),s.vertical.thumbClass=H(()=>"q-scrollarea__thumb q-scrollarea__thumb--v absolute-right"+(s.vertical.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),s.vertical.barClass=H(()=>"q-scrollarea__bar q-scrollarea__bar--v absolute-right"+(s.vertical.thumbHidden.value===!0?" q-scrollarea__bar--invisible":"")),s.horizontal.percentage=H(()=>{const R=s.horizontal.size.value-r.horizontal.value;if(R<=0)return 0;const P=Je(Math.abs(s.horizontal.position.value)/R,0,1);return Math.round(P*1e4)/1e4}),s.horizontal.thumbHidden=H(()=>(i.visible===null?l.value:i.visible)!==!0&&o.value===!1&&n.value===!1||s.horizontal.size.value<=r.horizontal.value+1),s.horizontal.thumbStart=H(()=>i.horizontalOffset[0]+s.horizontal.percentage.value*(r.horizontalInner.value-s.horizontal.thumbSize.value)),s.horizontal.thumbSize=H(()=>Math.round(Je(r.horizontalInner.value*r.horizontalInner.value/s.horizontal.size.value,Ut(r.horizontalInner.value),r.horizontalInner.value))),s.horizontal.style=H(()=>({...i.thumbStyle,...i.horizontalThumbStyle,[a.$q.lang.rtl===!0?"right":"left"]:`${s.horizontal.thumbStart.value}px`,width:`${s.horizontal.thumbSize.value}px`,bottom:`${i.verticalOffset[1]}px`})),s.horizontal.thumbClass=H(()=>"q-scrollarea__thumb q-scrollarea__thumb--h absolute-bottom"+(s.horizontal.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),s.horizontal.barClass=H(()=>"q-scrollarea__bar q-scrollarea__bar--h absolute-bottom"+(s.horizontal.thumbHidden.value===!0?" q-scrollarea__bar--invisible":""));const C=H(()=>s.vertical.thumbHidden.value===!0&&s.horizontal.thumbHidden.value===!0?i.contentStyle:i.contentActiveStyle);function y(){const R={};return Ht.forEach(P=>{const z=s[P];Object.assign(R,{[P+"Position"]:z.position.value,[P+"Percentage"]:z.percentage.value,[P+"Size"]:z.size.value,[P+"ContainerSize"]:r[P].value,[P+"ContainerInnerSize"]:r[P+"Inner"].value})}),R}const S=Di(()=>{const R=y();R.ref=a,t("scroll",R)},0);function D(R,P,z){if(Ht.includes(R)===!1){console.error("[QScrollArea]: wrong first param of setScrollPosition (vertical/horizontal)");return}(R==="vertical"?_t:Tt)(T.value,P,z)}function p({height:R,width:P}){let z=!1;r.vertical.value!==R&&(r.vertical.value=R,z=!0),r.horizontal.value!==P&&(r.horizontal.value=P,z=!0),z===!0&&w()}function d({position:R}){let P=!1;s.vertical.position.value!==R.top&&(s.vertical.position.value=R.top,P=!0),s.horizontal.position.value!==R.left&&(s.horizontal.position.value=R.left,P=!0),P===!0&&w()}function b({height:R,width:P}){s.horizontal.size.value!==P&&(s.horizontal.size.value=P,w()),s.vertical.size.value!==R&&(s.vertical.size.value=R,w())}function u(R,P){const z=s[P];if(R.isFirst===!0){if(z.thumbHidden.value===!0)return;h=z.position.value,n.value=!0}else if(n.value!==!0)return;R.isFinal===!0&&(n.value=!1);const le=$t[P],me=(z.size.value-r[P].value)/(r[P+"Inner"].value-z.thumbSize.value),ie=R.distance[le.dist],ce=h+(R.direction===le.dir?1:-1)*ie*me;E(ce,P)}function v(R,P){const z=s[P];if(z.thumbHidden.value!==!0){const le=P==="vertical"?i.verticalOffset[0]:i.horizontalOffset[0],me=R[$t[P].offset]-le,ie=z.thumbStart.value-le;if(me<ie||me>ie+z.thumbSize.value){const ce=me-z.thumbSize.value/2,ue=Je(ce/(r[P+"Inner"].value-z.thumbSize.value),0,1);E(ue*Math.max(0,z.size.value-r[P].value),P)}z.ref.value!==null&&z.ref.value.dispatchEvent(new MouseEvent(R.type,R))}}function w(){o.value=!0,m!==null&&clearTimeout(m),m=setTimeout(()=>{m=null,o.value=!1},i.delay),i.onScroll!==void 0&&S()}function E(R,P){T.value[$t[P].scroll]=R}let M=null;function A(){M!==null&&clearTimeout(M),M=setTimeout(()=>{M=null,l.value=!0},a.$q.platform.is.ios?50:0)}function $(){M!==null&&(clearTimeout(M),M=null),l.value=!1}let X=null;Mt(()=>a.$q.lang.rtl,R=>{T.value!==null&&Tt(T.value,Math.abs(s.horizontal.position.value)*(R===!0?-1:1))}),Ri(()=>{X={top:s.vertical.position.value,left:s.horizontal.position.value}}),Ni(()=>{if(X===null)return;const R=T.value;R!==null&&(Tt(R,X.left),_t(R,X.top))}),$i(S.cancel),Object.assign(a,{getScrollTarget:()=>T.value,getScroll:y,getScrollPosition:()=>({top:s.vertical.position.value,left:s.horizontal.position.value}),getScrollPercentage:()=>({top:s.vertical.percentage.value,left:s.horizontal.percentage.value}),setScrollPosition:D,setScrollPercentage(R,P,z){D(R,P*(s[R].size.value-r[R].value)*(R==="horizontal"&&a.$q.lang.rtl===!0?-1:1),z)}});const O={scroll:s,thumbVertDir:[[ct,R=>{u(R,"vertical")},void 0,{vertical:!0,...Wt}]],thumbHorizDir:[[ct,R=>{u(R,"horizontal")},void 0,{horizontal:!0,...Wt}]],onVerticalMousedown(R){v(R,"vertical")},onHorizontalMousedown(R){v(R,"horizontal")}};return()=>te("div",{class:g.value,onMouseenter:A,onMouseleave:$},[te("div",{ref:T,class:"q-scrollarea__container scroll relative-position fit hide-scrollbar",tabindex:i.tabindex!==void 0?i.tabindex:void 0},[te("div",{class:"q-scrollarea__content absolute",style:C.value},di(e.default,[te(Ft,{debounce:0,onResize:b})])),te(Ji,{axis:"both",onScroll:d})]),te(Ft,{debounce:0,onResize:p}),te(lo,{store:O,barStyle:i.barStyle,verticalBarStyle:i.verticalBarStyle,horizontalBarStyle:i.horizontalBarStyle})])}});let so=0,Qe;function jt(i,e){Qe===void 0&&(Qe=document.createElement("div"),Qe.style.cssText="position: absolute; left: 0; top: 0",document.body.appendChild(Qe));const t=i.getBoundingClientRect(),o=Qe.getBoundingClientRect(),{marginLeft:n,marginRight:l,marginTop:r,marginBottom:s}=window.getComputedStyle(i),a=parseInt(n,10)+parseInt(l,10),c=parseInt(r,10)+parseInt(s,10);return{left:t.left-o.left,top:t.top-o.top,width:t.right-t.left,height:t.bottom-t.top,widthM:t.right-t.left+(e===!0?0:a),heightM:t.bottom-t.top+(e===!0?0:c),marginH:e===!0?a:0,marginV:e===!0?c:0}}function rt(i){return{width:i.scrollWidth,height:i.scrollHeight}}const Jt=["Top","Right","Bottom","Left"],Qt=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],ro=/-block|-inline|block-|inline-/,ao=/(-block|-inline|block-|inline-).*:/;function Kt(i,e){const t=window.getComputedStyle(i),o={};for(let n=0;n<e.length;n++){const l=e[n];if(t[l]==="")if(l==="cssText"){const r=t.length;let s="";for(let a=0;a<r;a++)ro.test(t[a])!==!0&&(s+=t[a]+": "+t[t[a]]+"; ");o[l]=s}else if(["borderWidth","borderStyle","borderColor"].indexOf(l)!==-1){const r=l.replace("border","");let s="";for(let a=0;a<Jt.length;a++){const c="border"+Jt[a]+r;s+=t[c]+" "}o[l]=s}else if(l==="borderRadius"){let r="",s="";for(let a=0;a<Qt.length;a++){const c=t[Qt[a]].split(" ");r+=c[0]+" ",s+=(c[1]===void 0?c[0]:c[1])+" "}o[l]=r+"/ "+s}else o[l]=t[l];else l==="cssText"?o[l]=t[l].split(";").filter(r=>ao.test(r)!==!0).join(";"):o[l]=t[l]}return o}const ho=["absolute","fixed","relative","sticky"];function Yt(i){let e=i,t=0;for(;e!==null&&e!==document;){const{position:o,zIndex:n}=window.getComputedStyle(e),l=Number(n);l>t&&(e===i||ho.includes(o)===!0)&&(t=l),e=e.parentNode}return t}function co(i){return{from:i.from,to:i.to!==void 0?i.to:i.from}}function uo(i){return typeof i=="number"?i={duration:i}:typeof i=="function"&&(i={onEnd:i}),{...i,waitFor:i.waitFor===void 0?0:i.waitFor,duration:isNaN(i.duration)===!0?300:parseInt(i.duration,10),easing:typeof i.easing=="string"&&i.easing.length!==0?i.easing:"ease-in-out",delay:isNaN(i.delay)===!0?0:parseInt(i.delay,10),fill:typeof i.fill=="string"&&i.fill.length!==0?i.fill:"none",resize:i.resize===!0,useCSS:i.useCSS===!0||i.usecss===!0,hideFromClone:i.hideFromClone===!0||i.hidefromclone===!0,keepToClone:i.keepToClone===!0||i.keeptoclone===!0,tween:i.tween===!0,tweenFromOpacity:isNaN(i.tweenFromOpacity)===!0?.6:parseFloat(i.tweenFromOpacity),tweenToOpacity:isNaN(i.tweenToOpacity)===!0?.5:parseFloat(i.tweenToOpacity)}}function Xt(i){const e=typeof i;return e==="function"?i():e==="string"?document.querySelector(i):i}function Zt(i){return i&&i.ownerDocument===document&&i.parentNode!==null}function fo(i){let e=()=>!1,t=!1,o=!0;const n=co(i),l=uo(i),r=Xt(n.from);if(Zt(r)!==!0)return e;typeof r.qMorphCancel=="function"&&r.qMorphCancel();let s,a,c,m;const h=r.parentNode,T=r.nextElementSibling,g=jt(r,l.resize),{width:C,height:y}=rt(h),{borderWidth:S,borderStyle:D,borderColor:p,borderRadius:d,backgroundColor:b,transform:u,position:v,cssText:w}=Kt(r,["borderWidth","borderStyle","borderColor","borderRadius","backgroundColor","transform","position","cssText"]),E=r.classList.toString(),M=r.style.cssText,A=r.cloneNode(!0),$=l.tween===!0?r.cloneNode(!0):void 0;$!==void 0&&($.className=$.classList.toString().split(" ").filter(O=>/^bg-/.test(O)===!1).join(" ")),l.hideFromClone===!0&&A.classList.add("q-morph--internal"),A.setAttribute("aria-hidden","true"),A.style.transition="none",A.style.animation="none",A.style.pointerEvents="none",h.insertBefore(A,T),r.qMorphCancel=()=>{t=!0,A.remove(),$!==void 0&&$.remove(),l.hideFromClone===!0&&A.classList.remove("q-morph--internal"),r.qMorphCancel=void 0};const X=()=>{const O=Xt(n.to);if(t===!0||Zt(O)!==!0){typeof r.qMorphCancel=="function"&&r.qMorphCancel();return}r!==O&&typeof O.qMorphCancel=="function"&&O.qMorphCancel(),l.keepToClone!==!0&&O.classList.add("q-morph--internal"),A.classList.add("q-morph--internal");const{width:R,height:P}=rt(h),{width:z,height:le}=rt(O.parentNode);l.hideFromClone!==!0&&A.classList.remove("q-morph--internal"),O.qMorphCancel=()=>{t=!0,A.remove(),$!==void 0&&$.remove(),l.hideFromClone===!0&&A.classList.remove("q-morph--internal"),l.keepToClone!==!0&&O.classList.remove("q-morph--internal"),r.qMorphCancel=void 0,O.qMorphCancel=void 0};const me=()=>{if(t===!0){typeof O.qMorphCancel=="function"&&O.qMorphCancel();return}l.hideFromClone!==!0&&(A.classList.add("q-morph--internal"),A.innerHTML="",A.style.left=0,A.style.right="unset",A.style.top=0,A.style.bottom="unset",A.style.transform="none"),l.keepToClone!==!0&&O.classList.remove("q-morph--internal");const ie=O.parentNode,{width:ce,height:ue}=rt(ie),V=O.cloneNode(l.keepToClone);V.setAttribute("aria-hidden","true"),l.keepToClone!==!0&&(V.style.left=0,V.style.right="unset",V.style.top=0,V.style.bottom="unset",V.style.transform="none",V.style.pointerEvents="none"),V.classList.add("q-morph--internal");const N=O===r&&h===ie?A:O.nextElementSibling;ie.insertBefore(V,N);const{borderWidth:L,borderStyle:B,borderColor:k,borderRadius:f,backgroundColor:U,transform:J,position:F,cssText:G}=Kt(O,["borderWidth","borderStyle","borderColor","borderRadius","backgroundColor","transform","position","cssText"]),Z=O.classList.toString(),re=O.style.cssText;O.style.cssText=G,O.style.transform="none",O.style.animation="none",O.style.transition="none",O.className=Z.split(" ").filter(Y=>/^bg-/.test(Y)===!1).join(" ");const K=jt(O,l.resize),Oe=g.left-K.left,we=g.top-K.top,Ke=g.width/(K.width>0?K.width:10),Ye=g.height/(K.height>0?K.height:100),Se=C-R,ve=y-P,qe=ce-z,Ve=ue-le,Ee=Math.max(g.widthM,Se),De=Math.max(g.heightM,ve),Ae=Math.max(K.widthM,qe),Be=Math.max(K.heightM,Ve),Xe=r===O&&["absolute","fixed"].includes(F)===!1&&["absolute","fixed"].includes(v)===!1;let Ze=F==="fixed",et=ie;for(;Ze!==!0&&et!==document;)Ze=window.getComputedStyle(et).position==="fixed",et=et.parentNode;if(l.hideFromClone!==!0&&(A.style.display="block",A.style.flex="0 0 auto",A.style.opacity=0,A.style.minWidth="unset",A.style.maxWidth="unset",A.style.minHeight="unset",A.style.maxHeight="unset",A.classList.remove("q-morph--internal")),l.keepToClone!==!0&&(V.style.display="block",V.style.flex="0 0 auto",V.style.opacity=0,V.style.minWidth="unset",V.style.maxWidth="unset",V.style.minHeight="unset",V.style.maxHeight="unset"),V.classList.remove("q-morph--internal"),typeof l.classes=="string"&&(O.className+=" "+l.classes),typeof l.style=="string")O.style.cssText+=" "+l.style;else if(Pi(l.style)===!0)for(const Y in l.style)O.style[Y]=l.style[Y];const tt=Yt(A),it=Yt(O),ot=Ze===!0?document.documentElement:{scrollLeft:0,scrollTop:0};O.style.position=Ze===!0?"fixed":"absolute",O.style.left=`${K.left-ot.scrollLeft}px`,O.style.right="unset",O.style.top=`${K.top-ot.scrollTop}px`,O.style.margin=0,l.resize===!0&&(O.style.minWidth="unset",O.style.maxWidth="unset",O.style.minHeight="unset",O.style.maxHeight="unset",O.style.overflow="hidden",O.style.overflowX="hidden",O.style.overflowY="hidden"),document.body.appendChild(O),$!==void 0&&($.style.cssText=w,$.style.transform="none",$.style.animation="none",$.style.transition="none",$.style.position=O.style.position,$.style.left=`${g.left-ot.scrollLeft}px`,$.style.right="unset",$.style.top=`${g.top-ot.scrollTop}px`,$.style.margin=0,$.style.pointerEvents="none",l.resize===!0&&($.style.minWidth="unset",$.style.maxWidth="unset",$.style.minHeight="unset",$.style.maxHeight="unset",$.style.overflow="hidden",$.style.overflowX="hidden",$.style.overflowY="hidden"),document.body.appendChild($));const Lt=Y=>{r===O&&o!==!0?(O.style.cssText=M,O.className=E):(O.style.cssText=re,O.className=Z),V.parentNode===ie&&ie.insertBefore(O,V),A.remove(),V.remove(),$!==void 0&&$.remove(),e=()=>!1,r.qMorphCancel=void 0,O.qMorphCancel=void 0,typeof l.onEnd=="function"&&l.onEnd(o===!0?"to":"from",Y===!0)};if(l.useCSS!==!0&&typeof O.animate=="function"){const Y=l.resize===!0?{transform:`translate(${Oe}px, ${we}px)`,width:`${Ee}px`,height:`${De}px`}:{transform:`translate(${Oe}px, ${we}px) scale(${Ke}, ${Ye})`},He=l.resize===!0?{width:`${Ae}px`,height:`${Be}px`}:{},pt=l.resize===!0?{width:`${Ee}px`,height:`${De}px`}:{},yt=l.resize===!0?{transform:`translate(${-1*Oe}px, ${-1*we}px)`,width:`${Ae}px`,height:`${Be}px`}:{transform:`translate(${-1*Oe}px, ${-1*we}px) scale(${1/Ke}, ${1/Ye})`},St=$!==void 0?{opacity:l.tweenToOpacity}:{backgroundColor:b},vt=$!==void 0?{opacity:1}:{backgroundColor:U};m=O.animate([{margin:0,borderWidth:S,borderStyle:D,borderColor:p,borderRadius:d,zIndex:tt,transformOrigin:"0 0",...Y,...St},{margin:0,borderWidth:L,borderStyle:B,borderColor:k,borderRadius:f,zIndex:it,transformOrigin:"0 0",transform:J,...He,...vt}],{duration:l.duration,easing:l.easing,fill:l.fill,delay:l.delay}),a=$===void 0?void 0:$.animate([{opacity:l.tweenFromOpacity,margin:0,borderWidth:S,borderStyle:D,borderColor:p,borderRadius:d,zIndex:tt,transformOrigin:"0 0",transform:u,...pt},{opacity:0,margin:0,borderWidth:L,borderStyle:B,borderColor:k,borderRadius:f,zIndex:it,transformOrigin:"0 0",...yt}],{duration:l.duration,easing:l.easing,fill:l.fill,delay:l.delay}),s=l.hideFromClone===!0||Xe===!0?void 0:A.animate([{margin:`${ve<0?ve/2:0}px ${Se<0?Se/2:0}px`,width:`${Ee+g.marginH}px`,height:`${De+g.marginV}px`},{margin:0,width:0,height:0}],{duration:l.duration,easing:l.easing,fill:l.fill,delay:l.delay}),c=l.keepToClone===!0?void 0:V.animate([Xe===!0?{margin:`${ve<0?ve/2:0}px ${Se<0?Se/2:0}px`,width:`${Ee+g.marginH}px`,height:`${De+g.marginV}px`}:{margin:0,width:0,height:0},{margin:`${Ve<0?Ve/2:0}px ${qe<0?qe/2:0}px`,width:`${Ae+K.marginH}px`,height:`${Be+K.marginV}px`}],{duration:l.duration,easing:l.easing,fill:l.fill,delay:l.delay});const be=We=>{s!==void 0&&s.cancel(),a!==void 0&&a.cancel(),c!==void 0&&c.cancel(),m.cancel(),m.removeEventListener("finish",be),m.removeEventListener("cancel",be),Lt(We),s=void 0,a=void 0,c=void 0,m=void 0};r.qMorphCancel=()=>{r.qMorphCancel=void 0,t=!0,be()},O.qMorphCancel=()=>{O.qMorphCancel=void 0,t=!0,be()},m.addEventListener("finish",be),m.addEventListener("cancel",be),e=We=>t===!0||m===void 0?!1:We===!0?(be(!0),!0):(o=o!==!0,s!==void 0&&s.reverse(),a!==void 0&&a.reverse(),c!==void 0&&c.reverse(),m.reverse(),!0)}else{const Y=`q-morph-anim-${++so}`,He=document.createElement("style"),pt=l.resize===!0?`
            transform: translate(${Oe}px, ${we}px);
            width: ${Ee}px;
            height: ${De}px;
          `:`transform: translate(${Oe}px, ${we}px) scale(${Ke}, ${Ye});`,yt=l.resize===!0?`
            width: ${Ae}px;
            height: ${Be}px;
          `:"",St=l.resize===!0?`
            width: ${Ee}px;
            height: ${De}px;
          `:"",vt=l.resize===!0?`
            transform: translate(${-1*Oe}px, ${-1*we}px);
            width: ${Ae}px;
            height: ${Be}px;
          `:`transform: translate(${-1*Oe}px, ${-1*we}px) scale(${1/Ke}, ${1/Ye});`,be=$!==void 0?`opacity: ${l.tweenToOpacity};`:`background-color: ${b};`,We=$!==void 0?"opacity: 1;":`background-color: ${U};`,Si=$===void 0?"":`
            @keyframes ${Y}-from-tween {
              0% {
                opacity: ${l.tweenFromOpacity};
                margin: 0;
                border-width: ${S};
                border-style: ${D};
                border-color: ${p};
                border-radius: ${d};
                z-index: ${tt};
                transform-origin: 0 0;
                transform: ${u};
                ${St}
              }

              100% {
                opacity: 0;
                margin: 0;
                border-width: ${L};
                border-style: ${B};
                border-color: ${k};
                border-radius: ${f};
                z-index: ${it};
                transform-origin: 0 0;
                ${vt}
              }
            }
          `,vi=l.hideFromClone===!0||Xe===!0?"":`
            @keyframes ${Y}-from {
              0% {
                margin: ${ve<0?ve/2:0}px ${Se<0?Se/2:0}px;
                width: ${Ee+g.marginH}px;
                height: ${De+g.marginV}px;
              }

              100% {
                margin: 0;
                width: 0;
                height: 0;
              }
            }
          `,bi=Xe===!0?`
            margin: ${ve<0?ve/2:0}px ${Se<0?Se/2:0}px;
            width: ${Ee+g.marginH}px;
            height: ${De+g.marginV}px;
          `:`
            margin: 0;
            width: 0;
            height: 0;
          `,Ti=l.keepToClone===!0?"":`
            @keyframes ${Y}-to {
              0% {
                ${bi}
              }

              100% {
                margin: ${Ve<0?Ve/2:0}px ${qe<0?qe/2:0}px;
                width: ${Ae+K.marginH}px;
                height: ${Be+K.marginV}px;
              }
            }
          `;He.innerHTML=`
          @keyframes ${Y} {
            0% {
              margin: 0;
              border-width: ${S};
              border-style: ${D};
              border-color: ${p};
              border-radius: ${d};
              background-color: ${b};
              z-index: ${tt};
              transform-origin: 0 0;
              ${pt}
              ${be}
            }

            100% {
              margin: 0;
              border-width: ${L};
              border-style: ${B};
              border-color: ${k};
              border-radius: ${f};
              background-color: ${U};
              z-index: ${it};
              transform-origin: 0 0;
              transform: ${J};
              ${yt}
              ${We}
            }
          }

          ${vi}

          ${Si}

          ${Ti}
        `,document.head.appendChild(He);let pe="normal";A.style.animation=`${l.duration}ms ${l.easing} ${l.delay}ms ${pe} ${l.fill} ${Y}-from`,$!==void 0&&($.style.animation=`${l.duration}ms ${l.easing} ${l.delay}ms ${pe} ${l.fill} ${Y}-from-tween`),V.style.animation=`${l.duration}ms ${l.easing} ${l.delay}ms ${pe} ${l.fill} ${Y}-to`,O.style.animation=`${l.duration}ms ${l.easing} ${l.delay}ms ${pe} ${l.fill} ${Y}`;const Me=Ue=>{Ue===Object(Ue)&&Ue.animationName!==Y||(O.removeEventListener("animationend",Me),O.removeEventListener("animationcancel",Me),Lt(),He.remove())};r.qMorphCancel=()=>{r.qMorphCancel=void 0,t=!0,Me()},O.qMorphCancel=()=>{O.qMorphCancel=void 0,t=!0,Me()},O.addEventListener("animationend",Me),O.addEventListener("animationcancel",Me),e=Ue=>t===!0||!O||!A||!V?!1:Ue===!0?(Me(),!0):(o=o!==!0,pe=pe==="normal"?"reverse":"normal",A.style.animationDirection=pe,$.style.animationDirection=pe,V.style.animationDirection=pe,O.style.animationDirection=pe,!0)}};l.waitFor>0||l.waitFor==="transitionend"||l.waitFor===Object(l.waitFor)&&typeof l.waitFor.then=="function"?(l.waitFor>0?new Promise(ce=>setTimeout(ce,l.waitFor)):l.waitFor==="transitionend"?new Promise(ce=>{const ue=()=>{V!==null&&(clearTimeout(V),V=null),O&&(O.removeEventListener("transitionend",ue),O.removeEventListener("transitioncancel",ue)),ce()};let V=setTimeout(ue,400);O.addEventListener("transitionend",ue),O.addEventListener("transitioncancel",ue)}):l.waitFor).then(me).catch(()=>{typeof O.qMorphCancel=="function"&&O.qMorphCancel()}):me()};return typeof i.onToggle=="function"&&i.onToggle(),requestAnimationFrame(X),O=>e(O)}const ft={},go=["duration","delay","easing","fill","classes","style","duration","resize","useCSS","hideFromClone","keepToClone","tween","tweenFromOpacity","tweenToOpacity","waitFor","onEnd"],mo=["resize","useCSS","hideFromClone","keepToClone","tween"];function Fe(i,e){i.clsAction!==e&&(i.clsAction=e,i.el.classList[e]("q-morph--invisible"))}function fi(i){if(i.animating===!0||i.queue.length<2)return;const[e,t]=i.queue;i.animating=!0,e.animating=!0,t.animating=!0,Fe(e,"remove"),Fe(t,"remove");const o=fo({from:e.el,to:t.el,onToggle(){Fe(e,"add"),Fe(t,"remove")},...t.opts,onEnd(n,l){t.opts.onEnd!==void 0&&t.opts.onEnd(n,l),l!==!0&&(e.animating=!1,t.animating=!1,i.animating=!1,i.cancel=void 0,i.queue.shift(),fi(i))}});i.cancel=()=>{o(!0),i.cancel=void 0}}function gi(i,e){const t=e.opts;mo.forEach(o=>{t[o]=i[o]===!0})}function po(i,e){const t=typeof i=="string"&&i.length!==0?i.split(":"):[];e.name=t[0],e.group=t[1],Object.assign(e.opts,{duration:isNaN(t[2])===!0?300:parseFloat(t[2]),waitFor:t[3]})}function yo(i,e){i.group!==void 0&&(e.group=i.group),i.name!==void 0&&(e.name=i.name);const t=e.opts;go.forEach(o=>{i[o]!==void 0&&(t[o]=i[o])})}function So(i,e){if(e.name===i){const t=ft[e.group];t===void 0?(ft[e.group]={name:e.group,model:i,queue:[e],animating:!1},Fe(e,"remove")):t.model!==i&&(t.model=i,t.queue.push(e),t.animating===!1&&t.queue.length===2&&fi(t));return}e.animating===!1&&Fe(e,"add")}function ei(i,e){let t;Object(e)===e?(t=""+e.model,yo(e,i),gi(e,i)):t=""+e,t!==i.model?(i.model=t,So(t,i)):i.animating===!1&&i.clsAction!==void 0&&i.el.classList[i.clsAction]("q-morph--invisible")}var Pt=hi({name:"morph",mounted(i,e){const t={el:i,animating:!1,opts:{}};gi(e.modifiers,t),po(e.arg,t),ei(t,e.value),i.__qmorph=t},updated(i,e){ei(i.__qmorph,e.value)},beforeUnmount(i){const e=i.__qmorph,t=ft[e.group];t!==void 0&&t.queue.indexOf(e)!==-1&&(t.queue=t.queue.filter(n=>n!==e),t.queue.length===0&&(t.cancel!==void 0&&t.cancel(),delete ft[e.group])),e.clsAction==="add"&&i.classList.remove("q-morph--invisible"),delete i.__qmorph}}),vo=hi({name:"touch-hold",beforeMount(i,e){const{modifiers:t}=e;if(t.mouse!==!0&&Ct.has.touch!==!0)return;const o={handler:e.value,noop:Mi,mouseStart(l){typeof o.handler=="function"&&Ai(l)===!0&&(lt(o,"temp",[[document,"mousemove","move","passiveCapture"],[document,"click","end","notPassiveCapture"]]),o.start(l,!0))},touchStart(l){if(l.target!==void 0&&typeof o.handler=="function"){const r=l.target;lt(o,"temp",[[r,"touchmove","move","passiveCapture"],[r,"touchcancel","end","notPassiveCapture"],[r,"touchend","end","notPassiveCapture"]]),o.start(l)}},start(l,r){o.origin=zt(l);const s=Date.now();Ct.is.mobile===!0&&(document.body.classList.add("non-selectable"),Dt(),o.styleCleanup=a=>{o.styleCleanup=void 0;const c=()=>{document.body.classList.remove("non-selectable")};a===!0?(Dt(),setTimeout(c,10)):c()}),o.triggered=!1,o.sensitivity=r===!0?o.mouseSensitivity:o.touchSensitivity,o.timer=setTimeout(()=>{o.timer=void 0,Dt(),o.triggered=!0,o.handler({evt:l,touch:r!==!0,mouse:r===!0,position:o.origin,duration:Date.now()-s})},o.duration)},move(l){const{top:r,left:s}=zt(l);o.timer!==void 0&&(Math.abs(s-o.origin.left)>=o.sensitivity||Math.abs(r-o.origin.top)>=o.sensitivity)&&(clearTimeout(o.timer),o.timer=void 0)},end(l){Ot(o,"temp"),o.styleCleanup!==void 0&&o.styleCleanup(o.triggered),o.triggered===!0?l!==void 0&&Bi(l):o.timer!==void 0&&(clearTimeout(o.timer),o.timer=void 0)}},n=[600,5,7];if(typeof e.arg=="string"&&e.arg.length!==0&&e.arg.split(":").forEach((l,r)=>{const s=parseInt(l,10);s&&(n[r]=s)}),[o.duration,o.touchSensitivity,o.mouseSensitivity]=n,i.__qtouchhold=o,t.mouse===!0){const l=t.mouseCapture===!0||t.mousecapture===!0?"Capture":"";lt(o,"main",[[i,"mousedown","mouseStart",`passive${l}`]])}Ct.has.touch===!0&&lt(o,"main",[[i,"touchstart","touchStart",`passive${t.capture===!0?"Capture":""}`],[i,"touchend","noop","notPassiveCapture"]])},updated(i,e){const t=i.__qtouchhold;t!==void 0&&e.oldValue!==e.value&&(typeof e.value!="function"&&t.end(),t.handler=e.value)},beforeUnmount(i){const e=i.__qtouchhold;e!==void 0&&(Ot(e,"main"),Ot(e,"temp"),e.timer!==void 0&&clearTimeout(e.timer),e.styleCleanup!==void 0&&e.styleCleanup(),delete i.__qtouchhold)}});let Ge,ne;function bo(){Ge={},ne=Vi()}function mi(){Ge.pGoalsMap==null;const i=new Map;let e=pi();return e?(e.forEach(t=>{i.set(t.id,t)}),Ge.pGoalsMap=i,i):(console.log("Repo:: parentGoalsMap is empty or null",e),i)}function To(i){return ne.hasEventsForDate(i)}function Co(i){return ne.getEventsForDate(i)}function pi(){return ne.getMainGoals}function xt(){return Ge.subGoals==null&&(Ge.subGoals=ne.getSubGoals),Ge.subGoals}function Oo(){return ne.fetchAlternativeEvts()}function wo(){return ne.currentBalance()}function Eo(){return ne.fetchGoalsTree()}function Do(){let i=ne.fetchAllPrio();return!i.size>0?[]:Array.from(i.values()).sort()}function ti(i,e){const t=[];let o=xt();return o&&o.forEach(n=>{if(n.score=="")console.log(`ERROR::empty score event added: ${n.title}`,n.score),t.push(n);else{let l=Pe(n.score);switch(i){case"lesserThan":l>-1&&l<=e&&t.push(n);break;case"equalTo":l>-1&&l==e&&t.push(n);break;case"greaterThan":l>-1&&l>=e&&t.push(n);break;default:console.log(`ERROR::goalsByScore::UNKNOWN sign>>${i} event added: ${n.title}`,n.score),t.push(n)}}}),t}function ii(i,e){let t=[],o=xt(),n=mi();if(!o||!n)return t;const l=r=>n.has(r)?n.get(r):null;switch(i){case"lesserThan":t=o.filter(r=>{var s;return((s=l(r.parentGoal))==null?void 0:s.priority)<=e});break;case"equalTo":t=o.filter(r=>{var s;return((s=l(r.parentGoal))==null?void 0:s.priority)==e});break;case"greaterThan":t=o.filter(r=>{var s;return((s=l(r.parentGoal))==null?void 0:s.priority)>=e});break;default:console.log(`ERROR::goalsByPriority::UNKNOWN sign>>${i} all events added`,e),t=o}return t}function oi(i,e=null,t=null){ne.saveSubProp(i,e,t)}function Ro(){return ne.getGoalByTitle("Misc")}function li(i){ne.setBalance(i)}function ni(i,e){ne.saveDailySchedule(i,e)}function No(i,e,t,o){return ne.addMainGoal(i,e,t,o)}function Le(i,e,t,o,n,l,r,s,a){return ne.addSubGoal(i,e,t,o,n,l,r,s,a)}function $o(i,e,t=null){let o=i,n=e.id,l=e,r=t,s=i.duration,a=i.time,c=null,m=null;return{id:n,duration:s,time:a,date:()=>c,datey:h,score:T(),atScore:o.atScore,getGoal:()=>l,getPGoal:()=>r,data:()=>o,setData:u=>o=u,setMoods:u=>m=u,getMoods:S,setNotes:u=>u,hasNote:g,setDura:u=>s=u,setTime:u=>a=u,setDate:u=>c=u,durationChanged:C,timeChanged:y,parsedScore:D,withPropsEventsTo:d,addPropsEventsTo:b};function h(){return c}function T(){return o.atScore||e.score}function g(){return i.notes!==void 0}function C(){return i.duration!==e.duration}function y(){return i.time!==e.time}function S(){return"byMood"in o&&(m=o.byMood),m}function D(){const u=T().split(/on/);return u.length!=2?-89:u[1]-u[0]}function p(u){if(!u)return"";let v=u.split(":");return parseInt(v[0])>=12?u+"PM":u+"AM"}function d(u,v=null){let E=Object.assign({},{...this});return E.bgcolor=u.bgcolor,E.jeSuis?E.details=`Of '${u.title.trim()}' :: << ${E.jeSuis.join(",")} >>`:E.details=`Of '${u.title.trim()}' :: ${p(E==null?void 0:E.time)} -> ${E==null?void 0:E.duration}min -- ${E!=null&&E.inDefaults?"Dft:":":"}${E!=null&&E.canMove?":Mv:":":"}${E!=null&&E.isAlternative?":Alt":":"}`,console.log("withProps",JSON.parse(JSON.stringify(E)),E.datey(),E.date(),E.title,E.details),E}function b(u){if(!r){console.log("addProps:: ERROR no parentGoal",this.data);return}this.data,getGoal();let v=Object.assign({},{...sav});return v.bgcolor=t.bgcolor,v.jeSuis?v.details=`Of '${t.title.trim()}' :: << ${v.jeSuis.join(",")} >>`:v.details=`Of '${t.title.trim()}' :: ${p(v==null?void 0:v.time)} -> ${v==null?void 0:v.duration}min -- ${v!=null&&v.inDefaults?"Dft:":":"}${v!=null&&v.canMove?":Mv:":":"}${v!=null&&v.isAlternative?":Alt":":"}`,console.log("addProps",JSON.parse(JSON.stringify(v)),v.datey(),v.date(),v.title,v.details),v}}class Po{constructor(e,t){this.showReloadBtn=!1,this.showClearBtn=!1,this.showActionBtns=!0,this.disablePrioBtn=!0,this.disableScoreBtn=!0,this.disableSaveSchedule=!0,this.chosenScore=null,this.chosenPrio=null,this._dailyScheduled=new Map,this._endTimesSet=new Set,this._startTimesSet=new Set,this.savedRawEvts=[],this.unsavedChanges=!1,this.dayWithDeleted=!1,this.usingMoods={},this.isDisabledScoreEdit={},this.hasStarted={},this.mobileEnableScore={},this.showMobileDialog={},this.currentDate=e,this.mobile=t,bo()}allPGoals(){return pi()}getAllEvts(){return this._dailyScheduled}getScheduledEvts(){let e=new Map;for(let[t,o]of this._dailyScheduled)o.start.time.indexOf("NaN")>-1||e.set(t,o);return e}labelScheduled(){let e=this.getSubGoals().length,t=this.getScheduledEvts(),o=this.getAllEvts().size-t.size;return{sched:`Scheduled => ${t.size} out of ${e} Evts
`,noTime:o>0?o:null}}showEvtNoteScoreMobile(e){return this.mobileEnableScore[e]&&this.showMobileDialog[e]}toggleEvtNoteScoreMobile(e){(this.isViewingPast()||this.isViewingToday())&&(this.showMobileDialog[e]=!0)}euhHidin(e){this.showMobileDialog[e]=!1}getCurrentSchedTimesSets(){return{endSet:this._endTimesSet,startSet:this._startTimesSet}}isViewingPast(){let e=ut();if(this.currentDate&&this.currentDate==e)return!1;let t=Gt(ge(e));return!(Gt(ge(this.currentDate))>=t)}isViewingToday(){return ut()==this.currentDate}toggle(){this.showReloadBtn=!this.showReloadBtn}actionBtnsEnabled(){return this.showActionBtns}getProps(){return{showReloadBtn:this.showReloadBtn,showClearBtn:this.showClearBtn,disablePrioBtn:this.disablePrioBtn,disableScoreBtn:this.disableScoreBtn,chosenScore:this.chosenScore,chosenPrio:this.chosenPrio}}saveBtnEnabled(){return this.disableSaveSchedule}hasUnsavedChanges(){var o;let e=this.getEventsForDate(this.currentDate),t=(o=e&&Object.keys(e).length!=this._dailyScheduled.size&&!this.dayWithDeleted)!=null?o:!1;return this.unsavedChanges||t}fetchGoalsTree(){return Eo()}getCurrentBalance(){return wo()}getAllPrio(){return Do()}getSubGoals(){return xt()}getCurrentMoods(){return this.usingMoods}getSubGoalByID(e){let t=this.getSubGoals(),o=parseInt(e);for(let n=0;n<t.length;n++)if(t[n].id===o)return t[n];return null}unscheduledDefaults(){return this.getSubGoals().filter(t=>(t==null?void 0:t.inDefaults)&&!this._dailyScheduled.has(t.id))}unscheduledDefaultEvts(){return this.unscheduledDefaults().length}unscheduled(){return this.getSubGoals().filter(t=>!this._dailyScheduled.has(t.id));//!this.actualEvts.find(item => item.id == x.id)
}subGoalsOfParent(e){return this.getSubGoals().filter(o=>o.parentGoal==e)}getOriginalEvtTime(e){let t=this.getSubGoalByID(e);return t?t.time:""}getStoredRawEvt(e){return this.savedRawEvts&&e in this.savedRawEvts?this.savedRawEvts[e]:null}availableEvtsToSchedule(){let e=(o,n)=>{if(o.parentGoal>n.parentGoal)return 1;if(o.parentGoal==n.parentGoal)return 0;if(o.parentGoal<n.parentGoal)return-1},t=this.unscheduled();return t.length<1?(console.log("availableEvtsToSchedule >NO available on",this.currentDate,t),this.getSubGoals().sort(e)):t.sort(e)}getAlternatives(){let e=(t,o)=>{if(t.parentGoal>o.parentGoal)return 1;if(t.parentGoal==o.parentGoal)return 0;if(t.parentGoal<o.parentGoal)return-1};return Oo().sort(e)}getEventsForDate(e){return Co(e)}updateDaySchedule(e,t){ni(e,t)}parentGoalsMap(){return mi()}parentGoalById(e){return this.parentGoalsMap().has(e)?this.parentGoalsMap().get(e):null}findSchedEvent(e){return this._dailyScheduled.has(e)?this._dailyScheduled.get(e):null}hasEventsForDate(){return To(this.currentDate)}scheduledEventsMap(){const e={};return this._dailyScheduled.forEach((t,o,n)=>{let l=t.date;e[l]||(e[l]=[]),e[l].push(t)}),e}schedEvtWithProps(e,t,o){if(!e.getPGoal()){console.log("schedEvtWithProps:: ERROR no parentGoal",e.data);return}let n=e.data(),l=e.getGoal(),r=e.getPGoal(),s={...l};(e.timeChanged()||e.durationChanged())&&(s.time=n.time,s.duration=n.duration),e.setDate(this.currentDate);let a=e.getMoods();if(a){//!==
this.usingMoods[s.id]=a}s.date=this.currentDate,s.bgcolor=r.bgcolor,s.icon=r.icon,s.start=t,s.end=o;let c=`Of '${r.title.trim()}' :: ${j(s==null?void 0:s.time)} -> ${s==null?void 0:s.duration}min -- ${s!=null&&s.inDefaults?"Dft:":":"}${s!=null&&s.canMove?":Mv:":":"}${s!=null&&s.isAlternative?":Alt":":"}`;return s.jeSuis&&s.jeSuis.length>0&&(c+=a?` <>Mood:'${a}' >>${s.jeSuis.join(",")}`:` << ${s.jeSuis.join(",")} >>`),s.details=c,e.hasNote()&&(s.notes=n.notes),s}doProppy(e,t){let o=this.parentGoalById(e.parentGoal);if(!o){console.log("doProppy:: ERROR no Pgoal found ?!?",e);return}let n=q(ge(t),{minute:ee(e.time)}),l=q(n,{minute:e.duration}),r=Object.assign({},{...e,date:t,bgcolor:o.bgcolor,start:n,end:l,icon:o.icon});return e.jeSuis&&e.jeSuis.length>0?r.details=`Of '${o.title.trim()}' :: << ${e.jeSuis.join(",")} >>`:r.details=`Of '${o.title.trim()}' :: ${j(e==null?void 0:e.time)} -> ${e==null?void 0:e.duration}min -- ${e!=null&&e.inDefaults?"Dft:":":"}${e!=null&&e.canMove?":Mv:":":"}${e!=null&&e.isAlternative?":Alt":":"}`,"byMood"in e&&(console.log("doProppy::BYMOOD found!! "+r.id,JSON.parse(JSON.stringify(e))),this.usingMoods[r.id]=e.byMood),r}updateDetz(e){var n,l;let o=`Of '${(l=(n=this.parentGoalById(e.parentGoal))==null?void 0:n.title)==null?void 0:l.trim()}' :: ${j(e==null?void 0:e.time)} -> ${e==null?void 0:e.duration}min -- ${e!=null&&e.inDefaults?"Dft:":":"}${e!=null&&e.canMove?":Mv:":":"}${e!=null&&e.isAlternative?":Alt":":"}`;return e.jeSuis&&e.jeSuis.length>0&&(o+=this.usingMoods[e.id]?` <> Mood:'${this.usingMoods[e.id]}' >>${e.jeSuis.join(",")}`:` << ${e.jeSuis.join(",")} >>`),e.details=o,e}massageManyToOneOverlaps(e){let t=[],o=()=>{let s=[];return e.filter(a=>{a[0]=="oneToMany"&&s.push(a[1])}),s},n=e.filter(s=>s[0]!="oneToMany"),l=o(),r=[];for(let s=0;s<n.length;s++){let a=n[s][0];if(l.some(m=>m==a))r.push(...n[s][1]);else if(t.find(h=>h[0]==a)){let h=t.findIndex(T=>T[0]==a);t[h]=[a,[...t[h][1],...n[s][1]]]}else t.push([a,[...n[s][1]]])}if(t.length<1&&r.length>0)return this.doLog("massageManyToOneOverlaps::ONETOMANY!! returning original >> "+t.length+" vs "+r.length,e),e;if(r.length>0){this.doLog("massageManyToOneOverlaps::ADD SAMEY",r);let s=null,a=[];for(let m=0;m<r.length;m++){let h=r[m];t.find(g=>g[0]==h.inConflict)||(h.target!=s?(t.push([h.inConflict,[h]]),a.push(h.target)):console.log("massageManyToOneOverlaps::INCONF same current target? ERROR?",s,h))}let c=l.filter(m=>!a.some(h=>h==m));if(c.length>0){let m=0;do{let h=c[m],T=r.filter(g=>g.target==h);console.log("massageManyToOneOverlaps::ADDING",h,T),t.push([h,[...T]]),t.find(g=>g[0]=="oneToMany")?console.log("WOAH WOAH massageManyToOneOverlaps::oneToMany already present?!!ERROR ",t):t.push(["oneToMany",h])}while(++m<c.length)}}return this.doLog("massageManyToOneOverlaps::RETURNING",t),t}massageOneToMany(e){let t=[],o={};for(let n=0;n<e.length;n++){let l=e[n],r=t.find(s=>s[0]==l.inConflict);if(r){let s=t.findIndex(a=>a[0]==l.inConflict);t[s]=[l.inConflict,[...r[1],l]]}else if(!o[l.target])o[l.target]=[],o[l.target].push(l),t.push([l.inConflict,[l]]);else{let s=t.find(a=>a[0]=="oneToMany");if(s){let a=t.findIndex(m=>m[0]=="oneToMany"),c=t.findIndex(m=>m[0]==l.target);t[c]=[l.target,[...t[c][1],l]],l.target==s[1]||(t[a]=["oneToMany",[t[a][1],l.target]])}else{let a=t.pop();t.push([l.target,[...a[1],l]]),t.push(["oneToMany",l.target])}}}return t}addGoalsToSchedule(e,t){let o=[];return e.sort(function(n,l){return ee(n.time)-ee(l.time)}),e.forEach(n=>{let l=this.addToSchedule(n,t,!1);if(!l)console.log("addGoalsToSchedule:: ERROR Evt NOT added",l,t,n.id,n.title,n.time);else if(Array.isArray(l)){let r=l.length>1&&l.find(a=>a[0]=="oneToMany"),s={e:n,ov:l[0],oneToMany:r};o.push(s)}}),this.recheckOverlaps(o)}addToSchedule(e,t,o=!1){if(this._dailyScheduled.has(e.id))return console.log("addToSchedule--NOT added! present?!!?",t,e.title),!1;{let n=q(ge(this.currentDate),{minute:ee(e.time)}),l=q(n,{minute:e.duration});if(t){let a=this.hasOverlappingEvent(e.id,n,l);if(a.length>0)return this.massageOneToMany(a)}let r=o?this.schedEvtWithProps(e,n,l):this.doProppy(e,this.currentDate);r.sortTime=n;let s={...r,start:n,end:l};return this._dailyScheduled.set(r.id,s),this._endTimesSet.add(l.time),this._startTimesSet.add(n.time),this.enableNoteScoreEdit(r.id,n,l),!0}}stillInSchedule(e){let t=this.findSchedEvent(e),o=this.getStoredRawEvt(e);return{inSched:t,inStore:o}}doSortingByTime(e){let t=(n,l)=>{let r=ee(n[1].time),s=ee(l[1].time);return r<s?-1:s>r?1:0};const o=[];for(let n in e)o.push([n,e[n]]);return o.sort(t),this.doLog("doSortingByTime---After",o),Object.fromEntries(o)}anotherSorting(e){return Object.entries(e).sort(([,o],[,n])=>ee(o.time)-ee(n.time))}enrichAddToSchedule(){let e=[],t=this.isViewingToday();console.log("enrichAddToSchedule",Object.keys(this.savedRawEvts).length,"overlapCheck:"+t,JSON.stringify(Ie.getState()));let o=this.anotherSorting(this.savedRawEvts);for(let n=0;n<o.length;n++){let l=o[n][0],r=o[n][1],s=this.getSubGoalByID(l);if(!s){console.log(`enrichAddToSchedule:: ERROR No goal found for key: ${l}...skipping!`),this.dayWithDeleted=!0;continue}let a=this.parentGoalById(s.parentGoal),c=$o(r,s,a),m=this.addToSchedule(c,t,!0);if(!m)console.log("enrichAddToSchedule..ERROR?!? not added",m,s);else if(Array.isArray(m)){let h=m.length>1&&m.find(g=>g[0]=="oneToMany"),T={e:c,ov:m[0],oneToMany:h};e.push(T)}}return this.recheckOverlaps(e)}recheckOverlaps(e){let t=[];const o=l=>{let r=t.find(s=>s[0]==l[0]);if(r){let s=t.findIndex(a=>a[0]==l[0]);t[s]=[l[0],[...r[1],...l[1]]]}else t.push(l)};let n=null;for(let l=0;l<e.length;l++){let r=e[l].e,s=e[l].ov;if(s[1].length>1){this.doLog("recheckOverlaps::MULTI Overlaps!!...skipping"+r.id,s),e[l].oneToMany?(t.push(s),t.push(e[l].oneToMany)):this.doLog("recheckOverlaps::MULTI Overlaps!!...umm NOT oneToMany?!?ERROR?",e[l]);continue}let a=e.filter(T=>T.ov[0]==s[0]);if(a.length>1){if(e[l].oneToMany&&this.doLog("recheckOverlaps::filter >>Multiple oneToMany?!?ERROR?"+r.id+" "+s[0],a),s[0]==n)continue;let T=0;do o(a[T].ov);while(++T<a.length);n=s[0];continue}let c=q(ge(this.currentDate),{minute:ee(r.time)}),m=q(c,{minute:r.duration}),h=this.hasOverlappingEvent(r.id,c,m);h.length>0?h.length>s[1].length?t.push(...this.massageOneToMany(h)):o(s):console.log("recheckOverlaps::ERROR>>hasOverlappingEvent no overlap?!?",r.id,h)}return t}loadEvtsForDay(e){return e||(this.resetSchedule(!0),this.unsavedChanges=!1,this.dayWithDeleted=!1),this.savedRawEvts=this.getEventsForDate(this.currentDate),this.savedRawEvts?{overlaps:this.enrichAddToSchedule(),canContinue:!1}:{overlaps:null,canContinue:!0}}onChangeViewDate(e){let t=e==this.currentDate;return this.currentDate=e,this.enableActionBtns(),this.loadEvtsForDay(t)}scheduleLater(){if(this.isViewingPast()){console.log("scheduleLater >>NOT IN PAST",this.currentDate);return}if(this.isViewingToday()){let e=[];const t=Ce(new Date);this._dailyScheduled.forEach((o,n,l)=>{o.start.time.indexOf("NaN")>-1||he(t,o.start)>0&&e.push(o)}),Ie.addPendingEvts(e,this.currentDate),e.length>0&&Ie.scheduleLater(),console.log("scheduleLater >> #"+e.length,JSON.stringify(Ie.getState()))}else console.log("scheduleLater >>IN FUTURE...what to do?!?",this.currentDate)}removeScheduledNotif(e){Ie.cancel(e)}resetSchedule(e=!1){this.savedRawEvts=[],this._dailyScheduled=new Map,this._endTimesSet=new Set,this._startTimesSet=new Set,e&&(this.usingMoods={}),this.unsavedChanges=this.hasEventsForDate(),this.showReloadBtn=!1,this.showClearBtn=!1,this.disableSaveSchedule=!0}chosenScoreLabel(){return this.chosenScore==null?"By Score":this.bySign.score?`Score ${this.bySign.score.label} ${this.chosenScore}`:`Score <= ${this.chosenScore}`}chosenPrioLabel(){return this.chosenPrio==null?"By Priority":this.bySign.prio?`Prio ${this.bySign.prio.label} ${this.chosenPrio}`:`Prio == ${this.chosenPrio}`}filterSchedToCurrentPrio(e="equalTo"){let t=[];return this._dailyScheduled.forEach((o,n,l)=>{var r,s,a;switch(e){case"lesserThan":((r=this.parentGoalById(o.parentGoal))==null?void 0:r.priority)<=this.chosenPrio&&t.push(o);break;case"equalTo":((s=this.parentGoalById(o.parentGoal))==null?void 0:s.priority)==this.chosenPrio&&t.push(o);break;case"greaterThan":((a=this.parentGoalById(o.parentGoal))==null?void 0:a.priority)>=this.chosenPrio&&t.push(o);break;default:console.log(`ERROR::filterSchedToCurrentPrio::UNKNOWN sign>>${e} event added: ${o.title}`,this.chosenPrio),t.push(o)}}),t}calculatePrioEvts(e="equalTo"){let t=ii(e,this.chosenPrio),o=t.filter(n=>!this._dailyScheduled.has(n.id));//!this.actualEvts.find(item => item.id == x.id)
this.byPrio={prio:this.chosenPrio,toAdd:o,reset:t,filter:this.filterSchedToCurrentPrio(e)}}onChoosenPrio(e){let t=this.chosenPrio;t&&t==e?this.disablePrioBtn=!0:(this.chosenPrio=e,this.disablePrioBtn=!1,this.calculatePrioEvts())}scheduleSamePrio(e,t=!1){const o=c=>{console.log("scheduleSamePrio::RECALCULATE?!?",c,this.chosenPrio,this.byPrio);let m=ii("equalTo",this.chosenPrio);return c=="reset"?m:m.filter(h=>!this._dailyScheduled.has(h.id));//!this.actualEvts.find(item => item.id == x.id)
};let n=[];if(e=="filter"?(n=this.byPrio?this.byPrio.filter:this.filterSchedToCurrentPrio(),this.resetSchedule()):(this.byPrio?e=="add"?n=this.byPrio.toAdd:n=this.byPrio.reset:n=o(e),e!="add"&&this.resetSchedule()),n.length<1)return{overlaps:null,canContinue:!1};let l=n.filter(c=>c.time==""),r=this.addGoalsToSchedule(n,!t),s=r.length;this.updateCurrentMoods();let a=n.length-s-l.length;return this.toggleActionBtns(a>0,"byPrio"),this.unsavedChanges=a>0,{overlaps:r,canContinue:!(s>0),added:a,noTime:l.length>0?l.length:null}}filterSchedToCurrentScore(e="lesserThan"){let t=[];return this._dailyScheduled.forEach((o,n,l)=>{let r=Pe(o.score);switch(e){case"lesserThan":r>-1&&r<=this.chosenScore&&t.push(o);break;case"equalTo":r>-1&&r==this.chosenScore&&t.push(o);break;case"greaterThan":r>-1&&r>=this.chosenScore&&t.push(o);break;default:console.log(`ERROR::filterSchedToCurrentScore::UNKNOWN sign>>${e} event added: ${o.title}`,o.score,this.chosenScore),t.push(o)}}),t}calculateScoreEvts(e="lesserThan"){let t=ti(e,this.chosenScore),o=t.filter(n=>!this._dailyScheduled.has(n.id));//!this.actualEvts.find(item => item.id == x.id)
this.byScore={score:this.chosenScore,toAdd:o,reset:t,filter:this.filterSchedToCurrentScore(e)}}onScheduleBy(e,t,o){e=="score"?(this.bySign=Object.assign({},{...this.bySign,score:t}),this.chosenScore=o,this.calculateScoreEvts(t.name)):(this.bySign=Object.assign({},{...this.bySign,prio:t}),this.chosenPrio=o,this.calculatePrioEvts(t.name))}onChoosenScore(e){let t=this.chosenScore;t&&t==e?this.disableScoreBtn=!0:(this.chosenScore=e,this.disableScoreBtn=!1,this.calculateScoreEvts())}scheduleByScore(e,t=!1){const o=c=>{console.log("scheduleByScore::ERROR::RECALCULATE?!?",c,this.chosenScore,this.byScore);let m=ti("lesserThan",this.chosenScore);return c=="reset"?m:m.filter(h=>!this._dailyScheduled.has(h.id))};let n=[];if(e=="filter"?(n=this.byScore?this.byScore.filter:this.filterSchedToCurrentScore(),this.resetSchedule()):(this.byScore?e=="add"?n=this.byScore.toAdd:n=this.byScore.reset:n=o(e),e!="add"&&this.resetSchedule()),n.length<1)return{overlaps:null,canContinue:!1};let l=n.filter(c=>c.time==""),r=this.addGoalsToSchedule(n,!t),s=r.length;this.updateCurrentMoods();let a=n.length-s-l.length;return this.toggleActionBtns(a>0,"byScore"),this.unsavedChanges=a>0,{overlaps:r,canContinue:!(s>0),added:a,noTime:l.length>0?l.length:null}}scheduleOneEach(e,t=!1,o=null){const n=h=>{let T=[];return this.parentGoalsMap().forEach((g,C,y)=>{let S=this.subGoalsOfParent(g.id);if(S.length>0){let D=null,p=S.length;if(h)D=S[Math.floor(Math.random()*p)];else{let d=0;for(;this._dailyScheduled.has(S[p].id);)if(d++,p=Math.floor(Math.random()*S.length),console.log(`selectOneFromP::index ${p} scheduled...new random> At try> `+d,S.length),d>2){console.log("selectOneFromP::random...TOO MANY TRIES..ERROR?",d,p,S.length,S);break}D=S[p],console.log("selectOneFromP::NO Random at index: "+p,d,D)}T.push(D)}else o&&o(`No Evt goal for Parent: '${g==null?void 0:g.title}'`,"warning")}),T},l=()=>{let h=this.unscheduled(),T=[];return this.parentGoalsMap().forEach((g,C,y)=>{let S=h.filter(p=>p.parentGoal==g.id),D=S.length;if(D>0){let p=S[Math.floor(Math.random()*D)];T.push(p)}else{let p=this.subGoalsOfParent(g.id).length>0,d=p?`All goals for Parent: '${g==null?void 0:g.title}' already scheduled`:`Parent: '${g==null?void 0:g.title}' has No Goals :(`;o&&o(d,p?"info":"warning")}}),T};let r=[];if(e=="add"?(r=l(),console.log("scheduleOneEach...TOADD>> "+r.length)):(this.resetSchedule(),r=n(!0)),r.length<1)return console.log("Empty for OneEach :("),{overlaps:null,canContinue:!1};let s=r.filter(h=>h.time==""),a=this.addGoalsToSchedule(r,!t),c=a.length;this.updateCurrentMoods();let m=r.length-c-s.length;return this.toggleActionBtns(m>0,"oneEach"),this.unsavedChanges=m>0,{overlaps:a,canContinue:!(c>0),added:m,noTime:s.length>0?s.length:null}}scheduleByMood(e){var r;let t=[];for(let s=0;s<e.length;s++){let a=this.getSubGoalByID(e[s].id);a&&(t.push(a),this.usingMoods[e[s].id]=(r=e[s])==null?void 0:r.mood)}if(t.length<1)return this.doLog("scheduleByMood::Error? as Empty Moods with toAdd ",e),{overlaps:null,canContinue:!1};let o=t.filter(s=>s.time==""),n=this.addGoalsToSchedule(t,this.isViewingToday()),l=n.length;return l>0||this.toggleActionBtns(t.length-l>0,"ByMood"),{overlaps:n,canContinue:!(l>0),added:t.length,noTime:o.length>0?o.length:null}}scheduleDefaults(e,t=!1){let o=[];e=="add"?o=this.unscheduledDefaults():(this.resetSchedule(),o=this.unscheduledDefaults()),this.showReloadBtn=this.hasEventsForDate(),this.showClearBtn=!this.isViewingPast()&&o.length>0;let n=o.filter(a=>a.time==""),l=this.addGoalsToSchedule(o,!t),r=l.length,s=o.length-r-n.length;return this.updateCurrentMoods(),this.toggleActionBtns(s>0,"defaults"),this.unsavedChanges=s>0,{overlaps:l,canContinue:!(r>0),added:s,noTime:n.length>0?n.length:null}}onPickEvent(e,t,o,n,l=null){const r=()=>{n&&(this.removeFromBalance(e==null?void 0:e.duration),console.log("onPickEvent...useBalance","force?"+o));let m=this.addToSchedule({...e,time:t.time},!1);return m?(this.unsavedChanges=!0,this.isViewingPast()||n?(l&&l(`onPickEvent::Added ${e==null?void 0:e.title}...Saving schedule`,"info"),this.saveDaySchedule()):this.toggleActionBtns(!0,"onPickEvt"),{overlaps:m,canContinue:!0}):(console.log("onPickEvent::ERROR>>NOT added>exists?",e==null?void 0:e.title,m),l&&l(`${e==null?void 0:e.title} already scheduled :(`,"warning"),{overlaps:null,canContinue:!0})};let s=q(t,{minute:e.duration}),a=this.hasOverlappingEvent(e.id,t,s),c=a.length;if(c>0){console.log("onPickEvent::OVERLAPS!!"+c,"with force "+o,JSON.parse(JSON.stringify(a)));let m=this.massageOneToMany(a),h={overlaps:m,canContinue:!1};if(c>1||!o)return h;l&&l(`onPickEvent:: ${c} OVERLAPS! Forcing...`,"info"),this.toggleActionBtns(!0,"onPickEvt");for(let T=0;T<c;T++){let g=m[T][1],C=0;do this.recurChangeTime(g[C].inConflict,e,t,!0,l);while(++C<g.length)}return n&&this.removeFromBalance(e==null?void 0:e.duration),this.isViewingPast()||n?this.saveDaySchedule():this.toggleActionBtns(!0,"onPickEvt"),{overlaps:null,canContinue:!0}}else return r()}onAdHocEvent(e,t,o,n=null){const l=c=>(o||this.isViewingPast()?(this.removeFromBalance(c==null?void 0:c.duration),console.log("onAdHocEvent...using Balance",c==null?void 0:c.duration),this.saveDaySchedule(),n&&n(`New adHoc Evt!! Saving Schedule ${o?"with new balance":""} ....`,"positive")):(this.unsavedChanges=!0,n&&(n("New adHoc Evt added!! ...doSave eh","info"),this.toggleActionBtns(!0,"onAdHoc"))),{overlaps:null,canContinue:!0});let r=this.getSubGoalByID(e);if(!r)return{overlaps:null,canContinue:!1};let s=this.addToSchedule(r,!0),a=Array.isArray(s);if(!s||a){let c={overlaps:s,canContinue:!1},m=s.length;if(a&&m>1)return c;if(a&&m==1){n&&n(`onAdHocEvent:: ${m} OVERLAPS! Forcing...`,"warning");for(let h=0;h<m;h++){let T=s[h][1],g=0;do this.recurChangeTime(T[g].inConflict,r,t,!0,n);while(++g<T.length)}return l(r)}return c}return l(r)}addMinsToEvt(e,t,o=null){const n=(h,T,g)=>{let C=h.end,y=this.updateDetz({...h,duration:T,end:g});return this._dailyScheduled.set(e,y),this._endTimesSet.delete(C.time)||console.log("ERROR endTimesSet item does not exist?!?"+C.time,h,this._endTimesSet),this._endTimesSet.add(g.time),o&&o(`${t} mins added to '${h==null?void 0:h.title}' Saving...`,"info"),this.saveDaySchedule(),{overlaps:null,canContinue:!0}};let l=this.findSchedEvent(e);if(!l){console.log("ERROR addMinsToEvt EVT not found!!!",e);return}let r=l.end,s=q(r,{minute:parseInt(t)}),a=parseInt(t)+l.duration,c=this.hasOverlappingEvent(e,l.start,s);return c.length>0?{overlaps:this.massageOneToMany(c),canContinue:!1}:n(l,a,s)}saveNewGoal(e,t,o,n,l){if(n=="self"){let r=this.addParentGoal(t,t,"red-14",2);return r?Le(r,t,"1on5",e.time,l,!0,!1,l<30):(console.log("ERROR? no pID",r),r===0?Le(r,t,"1on5",e.time,l,!0,!1,l<30):null)}else if(o){return console.log("with parentGoal "+o.id,o==null?void 0:o.title),Le(o.id,t,"1on5",e.time,l,!1,!1,l<30);//!canMove and notInDefaults. isAlternative when duration<30
}else{let r=Ro();if(r)return Le(r.id,t,"1on5",e.time,l,!1,!1,l<30);{let s=this.addParentGoal("Misc","Miscellaneous","grey-10",2);return s?Le(s,t,"1on5",e.time,l,!0,!1,l<30):(console.log("ERROR? no pID",s),s===0?Le(s,t,"1on5",e.time,l,!0,!1,l<30):null)}}}addParentGoal(e,t,o,n=2){let l=[];this.parentGoalsMap().forEach((s,a,c)=>{let m=s.bgcolor;l.push(m)});let r=Yi().filter(s=>!l.some(a=>a==s));if(r.length>1){let s=Math.floor(Math.random()*r.length),a=r[s];console.log(`addParentGoal::bgcolor..index ${s} from ${o} to:`,a),o=a}else console.log("addParentGoal::NONE available",r,AllColors);return No(e,t,o,n)}recurChangeTime(e,t,o,n=!1,l=null){var s,a,c,m;let r=this.findSchedEvent(e);if(r){let h=ee(r.start.time)-ee(o.time),T=`${h>0?"DOWN":"UP"}`,g=null;if(h>=0){g=q(o,{minute:parseInt(t.duration)+10});let p=q(o,{minute:parseInt(r.duration)+10});console.log(`recurChangeTime::START>>(${e}) '${r==null?void 0:r.title}' ${r==null?void 0:r.duration} mins going FORWARD ${T} for ${h} due to evt:(${t.id})${(s=t==null?void 0:t.title)==null?void 0:s.trim()} at ${o.time} 
          
 doAdd?:${n} >`,JSON.parse(JSON.stringify(g.time)),"alt:",p.time);let d=he(p,g);if(d>0){let b=Math.floor(d/1e3/60);b<=h?console.log(`recurChangeTime::(${e}) duration: ${r.duration} vs Target evtDura:${t.duration}...USING overlappedEvtNew ${g.time}!! ${b} <= dragInterval ${h} `,p.time):(console.log(`recurChangeTime::DIFFY = ${d} and ${b} >= dragInterval ${h}...
COULD USE ALTERNATIVE as duration:${r.duration} vs evtDura:${t.duration}`,g.time,p.time),h==0?g=p:console.log("recurChangeTime::NOT USING ALTERNATIVE",p.time))}}else{g=q(o,{minute:-(parseInt(r.duration)+10)});let p=q(o,{minute:-(parseInt(t.duration)+10)});console.log(`recurChangeTime::START>>(${e}) '${r==null?void 0:r.title}' going BACKWARD ${T} for ${h} due to evt:(${t.id})${(a=t==null?void 0:t.title)==null?void 0:a.trim()} at ${o.time}
          
 doAdd?:${n}`,g.time,"alt:"+p.time);let d=he(p,g),b=d>0?Math.floor(d/1e3/60):0;console.log(`recurChangeTime::BACKWARD ${T} for ${h}`,b)}if(this.pastMidnight(g,r.duration)){l&&l(`'${r==null?void 0:r.title}' bleeds PAST Midnight ${T} for ${h}...Returning!!`);return}let C=this.hasOverlappingEvent(e,g,q(g,{minute:r.duration})),y=C.length;if(y>0){let p=0;do{if(console.log(`CASCADING OVERLAPPED >> ${p} (${e}) at: ${g.time} now at: ${r.start.time} till ${r.end.time}`,C[p]),C[p].inConflict==t.id){console.log(`EUUUH...ERROR::recurChangeTime::self overlap?!?OVERLAPPED:${e} ...break `+p,y,C[p].inConflict,t.id);break}this.recurChangeTime(C[p].inConflict,r,g,!1,l)}while(++p<y)}this.changeEvtTime(r,g);let S=o;if(!n){this.changeEvtTime(t,S);return}let D=this.addToSchedule({...t,time:S.time},this.isViewingToday());if(D.length>0){this.doLog(`recurChangeTime::TARGET extra OVERLAP ${n?"Adding":"Moving"} ${(c=t==null?void 0:t.title)==null?void 0:c.trim()}`,D);let p=D.find(u=>u[0]=="oneToMany");p&&(D=D.filter(u=>u[0]!="oneToMany"),this.doLog("recurChangeTime::TARGET::WITHID!!!Now>>",D.length)),l&&l(`EXTRA ${D.length} OVERLAPS ${p?"::OneToMany::":""} Adding TARGET ${(m=t==null?void 0:t.title)==null?void 0:m.trim()}`);let d=D.length,b=0;do{let u=D[b][1],v=u.length-1;for(;v>=0;v--){if(u[v].inConflict==t.id){console.log("EUUUH...::recurChangeTime::TARGET>>OVERLAP::self overlap?!?...breaking!",u[v].inConflict,t.id,u[v].targetStart);break}this.recurChangeTime(u[v].inConflict,t,S,n,l)}}while(++b<d)}}else console.log("recurChangeTime::ERROR ERROR >> overlapped event not found!","doAdd? "+n,e,t)}hasOverlappingEvent(e,t,o){const n=[];return this._dailyScheduled.forEach((l,r,s)=>{if(r!=e){let a=this.checkOverlapByTime(t,o,l.start,l.end,e);a&&n.push({target:e,targetStart:t,direction:a,inConflict:r})}}),n}checkOverlapByTime(e,t,o,n,l){let r=this.getTimeyNumber(e),s=this.getTimeyNumber(t),a=this.getTimeyNumber(o),c=this.getTimeyNumber(n);if(r===!1||a===!1||s===!1||c===!1)return console.log("ERROR... checkOverlapByTime error",r,s,a,c),!1;let m=!1;r>a&&r<c&&(m="bas"),s>a&&s<c&&(m="haut");let h=a>=r&&s>=c,T=r>=a&&s<=c;return(h||T)&&(m="surrounding"),m}canDropEvent(e,t){let o=q(e,{minute:t.duration}),n=this.hasOverlappingEvent(t.id,e,o);return n.length>0?{overlaps:this.massageOneToMany(n),canContinue:!1}:{overlaps:null,canContinue:!0}}toggleActionBtns(e,t){this.disableSaveSchedule=!e,this.showReloadBtn=this.hasEventsForDate()&&e,this.showClearBtn=!this.isViewingPast()&&e}resetChosen(){this.chosenScore=null,this.chosenPrio=null,this.bySign=null}enableActionBtns(){let e=this.isViewingPast();this.showActionBtns=!e}pastMidnight(e,t){let o=q(e,{minute:0}),n=q(e,{day:1}),l=new Date(n.date);l.setHours(24),l.setMinutes(0),l.setSeconds(0),l.setMilliseconds(0);let r=Ce(l),s=Math.floor(he(o,r)/1e3/60);return s<t?(console.log("pastMidnight eh...:(",s),!0):!1}tooClose(e,t){if(this.pastMidnight(e,t))return!0;let o=q(e,{minute:0}),n=this.getTimeNumber(o),l=q(o,{minute:t}),r=this.getTimeNumber(l),s=[],a=[];return this._dailyScheduled.forEach((c,m,h)=>{let T=this.getTimeNumber(c.start),g=this.getTimeNumber(c.end),C=T-n,y=he(o,c.start),S=Math.floor(y/1e3/60);if(S<=10&&C>0&&(console.log("tooClose...:("+m,C,y,S),s.push(m)),!(n>=g||r<=T)){let p=T>=n&&r>=g,d=n>=T&&r<=g;console.log(`Scheduled '${c==null?void 0:c.title}' PROLLY overlap?`,"At: "+c.start.time+" vs "+o.time,"Ends: "+c.end.time+" vs "+l.time,p,d),a.push({inConflict:m,surround:p||d})}}),{tooClose:s,overlap:a}}changeEvtTime(e,t,o=""){return o=="ok"&&oi(e.id,t.time,null),this.doUpdateSchedule(e,t),this.unsavedChanges=!0,o}doUpdateSchedule(e,t){let o=this.findSchedEvent(e.id);if(!o){console.log("doUpdateSchedule-ERROR NOT found",e.id,o);return}let n=q(ge(o.date),{minute:ee(t.time)}),l=q(n,{minute:o.duration}),r=this._endTimesSet.delete(o.end.time);this._endTimesSet.add(l.time),r||console.log("doUpdateSchedule-endTimesSet NOT FOUND?!?",o.id,l.time),this._startTimesSet.delete(o.start.time),this._startTimesSet.add(n.time),o.time=t.time,o.sortTime=n;let s=this.updateDetz({...o,time:t.time,start:n,end:l});this._dailyScheduled.set(e.id,s),this.enableNoteScoreEdit(e.id,n,l)}saveDaySchedule(){let e={};this._dailyScheduled.size<1?e=null:this._dailyScheduled.forEach((t,o,n)=>{t.start.time.indexOf("NaN")>-1||(e[o]={time:t.start.time,duration:t.duration,atScore:t==null?void 0:t.atScore},this.usingMoods[o]&&(e[o].byMood=this.usingMoods[o]),t.notes!==void 0&&(t==null?void 0:t.notes)!==""&&(e[o].notes=t==null?void 0:t.notes))}),console.log("saveDaySchedule",e?Object.keys(e).length:"CLEARED"),ni(this.currentDate,e),this.unsavedChanges=!1,this.disableSaveSchedule=!0,this.showReloadBtn=!1,this.showClearBtn=e!=null&&!this.isViewingPast()}updateMinEndNowBtn(e,t,o){for(let[n,l]of this._dailyScheduled)if((t?l.end.time:l.start.time)==e){this.hasStarted[n]=!t,this.isDisabledScoreEdit[n]=!t,this.mobile&&(console.log(`updateMinEndNowBtn..MOBILE::good?>>${o}::${t}`,e),this.showMobileDialog[n]=!t),this.showNotification(l,t);break}}showNotification(e,t){let o=q(Ce(new Date),{minute:1}),n=Date.parse(`${o.date} ${o.time}`),l=new Date(n),r=t?`Evt Ending ${j(e.end.time)}`:`Evt Starting ${j(e.start.time)}`;Ie.schedule({notifications:[{title:r,body:e.title,id:e.id,largeBody:`${e.title} from ${j(e.start.time)} to ${j(e.end.time)}`,schedule:{at:l},actionTypeId:t?"atEnd":"atStart",iconColor:_e(e.bgcolor),extra:{duration:e.duration,scorey:e.score}}]})}reduceEvtDuration(e,t){let o=this.findSchedEvent(e);if(!o){console.log("ERROR:: reduceEvtDuration Evt not found!!!",e);return}const n=Ce(new Date);let l=o.start,r=o.end,s=this.updateDetz({...o,duration:t,end:n});this._dailyScheduled.set(e,s),this._endTimesSet.delete(r.time)||console.log("ERROR endTimesSet item does not exist?!?",o,this._endTimesSet),this._endTimesSet.add(n.time),this.enableNoteScoreEdit(e,l,n),this.saveDaySchedule()}canEndNow(e){let t=this.findSchedEvent(e);if(!t)return console.log("ERROR canEndNow Evt not found!!!",e),!1;const o=Ce(new Date);let n=t.start,l=t.end;if(!Bt(o,n,l,!0))return console.log("umm aint in the middle of this event! Nothing to do...canEndNow::ERROR?",o.time,n.time,l.time),!1;let r=q(o,{minute:0}),s=he(n,r),a=Math.floor(s/1e3/60);return console.log(`canEndNow:: ${e} duration from ${t.duration} to: ${a}`),a<10?a:this.reduceEvtDuration(e,a)}updateNoteScore(e,t,o=""){let n=this.findSchedEvent(e);n?(n.score==t||(oi(e,null,t),n.atScore=t),n.score=t,o!==""&&(n.notes=o,this.unsavedChanges=!0),this.isViewingPast()?this.saveDaySchedule():this.toggleActionBtns(!0,"updateNoteScore")):console.log(`ERROR ERROR::updateNoteScore could not find event ${e}?!?`)}deleteEvtMood(e){if(this.usingMoods[e]){delete this.usingMoods[e],console.log("deleteEvtMood::>> "+e);return}}updateCurrentMoods(){for(let e in this.usingMoods)this._dailyScheduled.has(parseInt(e))||this.deleteEvtMood(e)}removeScheduledEvt(e){if(!e){console.log("ERROR removeScheduledEvt, NO evt to delete!",e);return}let t=null;if(this._dailyScheduled.has(e.id))t=this._dailyScheduled.get(e.id),this._dailyScheduled.delete(e.id);else{console.log("removeScheduledEvt:: ERROR NO evt?@? ERROR",e);return}if(t){let o=this._startTimesSet.delete(t.start.time),n=this._endTimesSet.delete(t.end.time);(!o||!n)&&console.log(`removeScheduledEvt ::> ERROR? scheduleSets has no such evt?@? start:${o}...end:${n}`,t,e.id+" "+(e==null?void 0:e.title.trim())+" "+(e==null?void 0:e.details)),this.deleteEvtMood(e.id),this.unsavedChanges=!0}}addToBalance(e){let o=this.getCurrentBalance()-parseInt(e==null?void 0:e.duration);li(o)}removeFromBalance(e){let o=this.getCurrentBalance()+parseInt(e);li(o)}disableEvtScoreEdit(e,t){this.isDisabledScoreEdit[e]=!t,this.mobileEnableScore[e]=t}enableNoteScoreEdit(e,t,o){const n=Ce(new Date);let l=he(n,o),r=q(n,{minute:0});this.getTimeNumber(r),l>0?(this.isDisabledScoreEdit[e]=!0,this.mobileEnableScore[e]=!1):(this.hasStarted[e]=!1,this.mobile&&(this.showMobileDialog[e]=!1),this.mobileEnableScore[e]=!0,this.isDisabledScoreEdit[e]=!1),Bt(n,t,o,!0)?this.hasStarted[e]=!0:this.hasStarted[e]=!1}getTimeyNumber(e){return e!==null?Ki(e):!1}getTimeNumber(e){return e!==null?kt(e):!1}doLog(e,t){console.log(e,t?JSON.parse(JSON.stringify(t)):"")}}const Mo=()=>!0;function Ao(i){const e={};return i.forEach(t=>{e[t]=Mo}),e}function It(){const{emit:i,proxy:e}=mt(),t=x(null);function o(){t.value.show()}function n(){t.value.hide()}function l(s){i("ok",s),n()}function r(){i("hide")}return Object.assign(e,{show:o,hide:n}),{dialogRef:t,onDialogHide:r,onDialogOK:l,onDialogCancel:n}}const yi=["ok","hide"];It.emits=yi;It.emitsObject=Ao(yi);const Bo=ki({name:"scheduleBy",props:{title:String,message:String,options:Array,selectedO:String},emits:["onCancel","onOk","ok","hide"],data(){return{mess:this.message,daOptions:this.options,skipOvCheck:x(!1),optGroup:this.selectedO}},setup(){const{dialogRef:i,onDialogHide:e,onDialogOK:t,onDialogCancel:o}=It();return{dialogRef:i,onDialogHide:e,onDialogOK:t,onCancelClick:o}},computed:{oCheck:{get(){return this.skipOvCheck},set(i){this.skipOvCheck=i}},oChoice:{get(){return this.optGroup},set(i){this.optGroup=i}}},methods:{show(){this.$refs.dialogRef.show()},hide(){this.$refs.dialogRef.hide()},onDialogHidey(){this.$emit("hide"),this.onDialogHide()},onOKyClick(){this.$emit("ok",{choice:this.oChoice,skipOCheck:this.oCheck}),this.hide()},onCancelyClick(){this.$emit("onCancel"),this.hide(),this.showy=!1}}}),ko={class:"q-ma-md title"},xo={class:"q-ma-md message"};function Io(i,e,t,o,n,l){return W(),oe(Li,{ref:"dialogRef","transition-show":"rotate","transition-hide":"rotate",onHide:i.onDialogHidey},{default:_(()=>[I(At,{class:"my-dialog"},{default:_(()=>[Q("div",ko,de(i.title),1),Q("div",xo,de(i.mess),1),I(dt,{dark:""}),I(xi,{class:"q-gutter-md"},{default:_(()=>[Q("div",null,[I(Ii,{modelValue:i.oChoice,"onUpdate:modelValue":e[0]||(e[0]=r=>i.oChoice=r),options:i.daOptions},null,8,["modelValue","options"])]),i.oChoice!="filter"?(W(),oe(ui,{key:0,modelValue:i.oCheck,"onUpdate:modelValue":e[1]||(e[1]=r=>i.oCheck=r),label:"Skip Overlap Check?","left-label":""},null,8,["modelValue"])):se("",!0)]),_:1}),I(dt,{dark:""}),I(ht,{align:"center",class:"q-mx-md"},{default:_(()=>[I($e,{label:"Cancel",flat:"",color:"primary",onClick:i.onCancelyClick},null,8,["onClick"]),I(dt,{vertical:!0}),I($e,{label:"Ok",flat:"",color:"primary",onClick:i.onOKyClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"])}var Lo=ci(Bo,[["render",Io],["__scopeId","data-v-5e3dbdf4"]]);function si(i){return i.button===0}const _o={name:"altDayCalendar",components:{NavigationBar:Re(()=>Ne(()=>import("./NavigationBar.22cf37af.js"),["assets/NavigationBar.22cf37af.js","assets/NavigationBar.bf3d18d0.css","assets/index.1bde7470.js","assets/index.f80becc5.css"])),QCalendarDay:Qi,GoalyEnd:Re(()=>Ne(()=>import("./goalyEnd.092c13a3.js"),["assets/goalyEnd.092c13a3.js","assets/goalyEnd.3c0921de.css","assets/index.1bde7470.js","assets/index.f80becc5.css","assets/goalStorage.eaf7c117.js","assets/utiFunc.f569f737.js","assets/QSelect.7bad7c28.js","assets/touch.9135741d.js","assets/QItem.9c617eab.js"])),daInstructions:Re(()=>Ne(()=>import("./instructions.f6fc3321.js"),["assets/instructions.f6fc3321.js","assets/index.1bde7470.js","assets/index.f80becc5.css"])),schedBtn:Re(()=>Ne(()=>import("./schedBtn.fa63389f.js"),["assets/schedBtn.fa63389f.js","assets/goalStorage.eaf7c117.js","assets/index.1bde7470.js","assets/index.f80becc5.css","assets/utiFunc.f569f737.js"])),schedDialog:Re(()=>Ne(()=>import("./schedDialog.af81a1c3.js"),["assets/schedDialog.af81a1c3.js","assets/schedDialog.02a8bef2.css","assets/index.1bde7470.js","assets/index.f80becc5.css","assets/QSpace.17d00046.js"])),mobileNoteScore:Re(()=>Ne(()=>import("./onScoreEditDialog.3de4295e.js"),["assets/onScoreEditDialog.3de4295e.js","assets/onScoreEditDialog.ad6c0624.css","assets/index.1bde7470.js","assets/index.f80becc5.css"])),actionBtns:Re(()=>Ne(()=>import("./actionBtns.a52074c9.js"),["assets/actionBtns.a52074c9.js","assets/actionBtns.36de916f.css","assets/index.1bde7470.js","assets/index.f80becc5.css"])),scheduleDayLabel:Re(()=>Ne(()=>import("./dayLabels.eb6dc840.js"),["assets/dayLabels.eb6dc840.js","assets/dayLabels.b4b0fdf7.css","assets/index.1bde7470.js","assets/index.f80becc5.css","assets/QBadge.295c4452.js"]))},data(){return Hi(),x(null),x(null),x(null),x(null),x(null),{splitterPage:x(35),splitterLegend:x(40),timeStartPos:x(0),showTree:x(!1),treeGoals:x([]),expanded:x([]),possibleRange:null,filter:x([]),filterRef:x(null),nextMorphStep:x({btn:"card1",card1:"card2",card2:"btn"}),morphGroupModel:x("btn"),draggingFab:x(!1),fabPos:x([0,10]),calendar:x(null),showEvtDialog:x(!1),currentDate:x(ut()),scoreOptions:x([1,2,3,4,5,6,7,8]),anchorTimestamp:x(null),otherTimestamp:x(null),mouseDown:x(!1),mobile:x(!0),daSchedule:x(null),showInstru:x(!1)}},beforeMount(){this.mobile=Ui(),this.mobile&&(this.splitterPage=0),this.daSchedule=new Po(this.currentDate,this.mobile),this.constructTree()},mounted(){this.adjustCurrentTime(),this.intervalId=setInterval(()=>{this.adjustCurrentTime()},6e4),qt.addListener("pauseReceived",()=>{console.log("altDayCalendar::listener work?"),this.daSchedule.scheduleLater()})},beforeUnmount(){clearInterval(this.intervalId);let i=()=>{this.daSchedule.scheduleLater(),console.log("altDayCalendar::removinnn listeners"),qt.removeAllListeners()},e=()=>{console.log("dayView::beforeUnmount...no saving requiered")},t=()=>{setTimeout(i,500),this.daSchedule.saveDaySchedule()};this.hasUnsavedChanges()?this.confirmAction("",`Save changes of day: ${this.currentDate} before Nav away?`,"Save",t,e):i()},computed:{chosenScoreLabel(){return this.daSchedule.chosenScoreLabel()},chosenPrioLabel(){return this.daSchedule.chosenPrioLabel()},style(){return{top:this.timeStartPos+"px"}},fabClass(){return this.hasUnsavedChanges()?"absolute-top-left q-mx-md unsaved doBounce":"absolute-top-left q-mx-md allGood"},splitterLimits(){return this.mobile?[0,100]:[30,70]},showSchedInstru(){return this.getDateEvents(this.currentDate).length<1},showRemInstru(){return this.getDateEvents(this.currentDate).length>0},defaultBtnLabel(){let i=this.daSchedule.unscheduledDefaultEvts();return i>0?i+" Defaults":"Defaults"},isDefaultBtnEnabled(){return!this.daSchedule.unscheduledDefaultEvts()>0||this.isViewingPast()},doShowActionBtns(){return this.daSchedule.actionBtnsEnabled()},scheduleProps(){return this.daSchedule.getProps()},saveScheduleDisabled(){return this.daSchedule.hasUnsavedChanges(),this.daSchedule.saveBtnEnabled()},showTreeForm(){return this.showTree||this.constructTree(),this.showTree},filterString(){return this.filter.join()},currentBalance(){return this.daSchedule.getCurrentBalance()},canbeScheduled(){return this.daSchedule.availableEvtsToSchedule()},scheduleMoodsLabel(){let i=this.daSchedule.getCurrentMoods();if(!Object.keys(i).length>0)return null;let e=new Map;for(let o in i){let n=i[o].join();e.set(o,n)}let t={};for(let[o,n]of e){let l=this.daSchedule.findSchedEvent(parseInt(o));t[o]={m:n,bg:l==null?void 0:l.bgcolor}}return t},startEndTimes(){const i=[];if(this.anchorDayTimeIdentifier!==!1&&this.otherDayTimeIdentifier!==!1){if(this.anchorDayTimeIdentifier==this.otherDayTimeIdentifier)return i.push(fe(this.anchorTimestamp),fe(this.otherTimestamp)),i;this.anchorDayTimeIdentifier<this.otherDayTimeIdentifier?i.push(fe(this.anchorTimestamp),fe(this.otherTimestamp)):i.push(fe(this.otherTimestamp),fe(this.anchorTimestamp))}return i},anchorDayTimeIdentifier(){return this.anchorTimestamp!==null?kt(this.anchorTimestamp):!1},otherDayTimeIdentifier(){return this.otherTimestamp!==null?kt(this.otherTimestamp):!1},eventsMap(){return this.daSchedule.scheduledEventsMap()}},methods:{dismissy(){},moveFab(i){this.draggingFab=i.isFirst!==!0&&i.isFinal!==!0,this.fabPos=[this.fabPos[0]+i.delta.x,this.fabPos[1]+i.delta.y]},prevMorph(){this.morphGroupModel=this.nextMorphStep.btn},nextMorph(){this.morphGroupModel=this.nextMorphStep[this.morphGroupModel]},morphClose(){this.morphGroupModel=this.nextMorphStep.card2},showEvtMobile(i){return this.daSchedule.showEvtNoteScoreMobile(i)},selectedTimeInterval(){return this.targetDrop.timestamp.time},selectedTimeRange(){var n,l,r;console.log("selectedTimeRange",this.startEndTimes,this.currentDate+" "+this.targetDrop.timestamp.time,(n=this.possibleRange)!=null?n:"");let i=this.possibleRange?(l=this.possibleRange[0])!=null?l:this.startEndTimes[0]:this.startEndTimes[0],e=this.possibleRange?(r=this.possibleRange[1])!=null?r:this.startEndTimes[1]:this.startEndTimes[1],t=i==e,o=0;if(!t){let s=q(st(i),{minute:0}),a=q(st(e),{minute:15});o=Math.floor(he(s,a)/1e3/60),e=fe(a)}return{start:i,end:e,isSame:t,duration:o,onMobile:this.mobile}},hasUnsavedChanges(){return this.daSchedule.hasUnsavedChanges()},adjustCurrentTime(){var n,l;const i=Ce(new Date);if(this.currentDate!==i.date){this.timeStartPos=-10,this.currentTime="";return}this.currentDate=i.date,this.currentTime=i.time,this.timeStartPos=(l=(n=this.$refs)==null?void 0:n.calendar)==null?void 0:l.timeStartPos(i.time,!1);let e=this.daSchedule.getCurrentSchedTimesSets(),t=e.endSet&&e.endSet.has(i.time),o=e.startSet&&e.startSet.has(i.time);(t||o)&&(this.daSchedule.updateMinEndNowBtn(this.currentTime,t,o),o&&this.scrollToTime(i,"slow"))},hasDate(i){return this.currentDate?i.find(e=>e.date===this.currentDate):!1},getDateEvents(i){let e=(o,n)=>{let l=he(o.sortTime,n.sortTime);if(l>0)return-1;if(l==0)return 0;if(l<0)return 1};const t=this.eventsMap[i]||[];return t.length===1?t[0].side="full":t.length,t.sort(e)},constructTree(){this.treeGoals=this.daSchedule.fetchGoalsTree()},allMainGPrio(){return this.daSchedule.getAllPrio()},resetFilter(){var i;this.filter=[],(i=this.filterRef)==null||i.focus()},myFilterMethod(i,e){const t=this.filter.map(o=>o.toLowerCase());if(i.isChildren&&(i==null?void 0:i.moods.length)>0){let o=i==null?void 0:i.moods.some(n=>t.indexOf(n.toLowerCase())>-1);return i.label&&o}},labelScheduled(){return this.daSchedule.labelScheduled()},labelBalance(){return`Balance: ${this.daSchedule.getCurrentBalance()||0} 
`},badgeClasses(i,e){return Xi(i,e)},badgeStyles(i,e,t=void 0,o=void 0){return Zi(i,e,t,o)},classyColor(i){return`row items-center ${i.isChildren?"text-":"text-white bg-"}${i.color} `},isViewingPast(){return this.daSchedule.isViewingPast()},isViewingToday(){return this.daSchedule.isViewingToday()},onMoodAdd(){let i=[];const e=this.filter.map(t=>t.toLowerCase());if(this.treeGoals.filter(t=>{if(t.children.length>0)return t.children.filter(o=>{if((o==null?void 0:o.moods.length)>0&&(o==null?void 0:o.moods.some(n=>e.indexOf(n.toLowerCase())>-1))){let n=o==null?void 0:o.moods.filter(l=>{if(e.indexOf(l.toLowerCase())>-1)return l});return i.push({id:o.id,mood:n}),o}})}),i.length>0)if(i=i.filter(o=>!this.daSchedule.getScheduledEvts().has(o.id)),i.length>0){let o=this.daSchedule.scheduleByMood(i);if(o.canContinue)this.doNotify(`Added ${o==null?void 0:o.added} Evts by Mood...doSave eh`,"info");else{if(o.overlaps&&Object.keys(o.overlaps).length>0)return(o==null?void 0:o.added)>0&&this.doNotify(`${o==null?void 0:o.added} Evts added ${o!=null&&o.noTime?"Plus "+(o==null?void 0:o.noTime)+" Without time":""} BUT some Overlaps to fix!`,"warning"),this.handleOverlaps(o.overlaps,"byMood");this.doNotify("Empty as no Mood Evts :(","warning")}}else this.doNotify(`Evts of Mood '${this.filterString}' already scheduled!`,"warning","top");else this.doNotify("Nothing to add :(","warning","top")},onScheduleOneEach(){let i=o=>{let n=this.daSchedule.scheduleOneEach(o.choice,o.skipOCheck,this.doNotify);if(n.canContinue)this.doNotify(`${n==null?void 0:n.added} Evts by Each ParentGoal...doSave eh`,"info");else{if(n.overlaps&&Object.keys(n.overlaps).length>0)return(n==null?void 0:n.added)>0&&this.doNotify(`${n==null?void 0:n.added} Evts added ${n!=null&&n.noTime?"Plus "+(n==null?void 0:n.noTime)+" Without time":""} BUT some Overlaps to fix!`,"warning"),this.handleOverlaps(n.overlaps,"oneEach");this.doNotify("Empty None for OneEach :(","warning")}t>0||(n==null?void 0:n.added)>0?this.daSchedule.toggleActionBtns(!0,"oneEach"):console.log("onScheduleOneEach::no Evts and no toggling for flag>> ",o.choice,n==null?void 0:n.added)},e=()=>{console.log("onScheduleOneEach..Aborting"),this.reset()},t=this.daSchedule.getScheduledEvts().size;if(t>0){let o=[{label:"Add one Evt from Each parent Goals",value:"add"},{label:"Reset schedule and add one random Evt from Each parent Goals",value:"reset"}];this.scheduleByDialog("Schedule One of Each","One Random Evt per Parent Goal",o,"",i,e)}else i({choice:"reset",skipOCheck:!this.isViewingToday()})},onReloadSaved(){let i=this.daSchedule.hasEventsForDate(),e=()=>{console.log("Aborting reload!",this.currentDate,i)},t=()=>{let o=this.daSchedule.loadEvtsForDay(!1);o.canContinue||(o.overlaps&&Object.keys(o.overlaps).length>0?(console.log("onReloadSaved::OVERLAPS",o.overlaps),this.handleOverlaps(o.overlaps,"view")):(this.doNotify(`Reloaded schedule for ${this.currentDate}`,"positive"),(this.isViewingPast()||this.currentDate!=ut())&&this.adjustCurrentTime())),this.reset()};if(this.daSchedule.getScheduledEvts().size>0&&!this.isViewingPast()){let o=i?`Reload saved schedule of: ${this.currentDate} ?`:"Reset current Schedule?";this.confirmAction("",o,"OK",t,e)}else t()},onClearDay(){let i=this.daSchedule.hasEventsForDate();if(this.isViewingPast()){this.doNotify("Editing past is a no no!");return}this.daSchedule.resetSchedule(!0);let e=i?"Cleared...Can still Reload saved":"Resetting...";this.doNotify(e,"warning","top"),this.reset(),this.daSchedule.toggleActionBtns(i,"view"),this.daSchedule.showClearBtn=!1},onLoadDefault(){let i=o=>{let n=this.daSchedule.scheduleDefaults(o.choice,o.skipOCheck);if(n.canContinue)this.doNotify(`Defaults added ${n==null?void 0:n.added} ...doSave eh`,"info");else{if(n.overlaps&&Object.keys(n.overlaps).length>0)return(n==null?void 0:n.added)>0&&this.doNotify(`${n==null?void 0:n.added} Default Evts added ${n!=null&&n.noTime?"Plus "+(n==null?void 0:n.noTime)+" Without time":""} BUT some Overlaps to fix!`,"warning"),this.handleOverlaps(n.overlaps,"byDefaults");this.doNotify("Empty as No Defaults :(","warning")}e>0||(n==null?void 0:n.added)>0?this.daSchedule.toggleActionBtns(!0,"byDefaults"):console.log("onLoadDefault::no Evts and no toggling for flag>> ",o.choice,n==null?void 0:n.added)},e=this.daSchedule.getScheduledEvts().size,t=this.daSchedule.unscheduledDefaults();if(e>0||(t==null?void 0:t.length)>7){let o=[{label:`Add ${t==null?void 0:t.length} Default Evts to current schedule`,value:"add"}];e>0&&o.push({label:"Reset and schedule All Defaults",value:"reset"}),this.scheduleByDialog("Schedule Default Evts","",o,"",function(n){i(n)},function(){console.log("onLoadDefaults::Aborting")})}else i({choice:"reset",skipOCheck:!this.isViewingToday()})},doReload(i,e,t){this.daSchedule.onScheduleBy(i,e,t),i=="score"?this.doReloadWithScore():this.doReloadWithPrio()},onChoosenPrio(i){console.log("onChoosenPrio::ERROR?!?",i)},currentScheduleBySign(i){var e,t,o,n;return i=="score"?((t=(e=this.daSchedule.bySign)==null?void 0:e.score)==null?void 0:t.label)||"":((n=(o=this.daSchedule.bySign)==null?void 0:o.prio)==null?void 0:n.label)||""},doReloadWithPrio(){var m,h,T,g,C,y,S,D;let i=this.daSchedule.chosenPrio;if(i==null){this.doNotify("Ayo select a priority!");return}let e=()=>{this.reset()},t=p=>{let d=this.daSchedule.scheduleSamePrio(p.choice,p.skipOCheck);if(d.canContinue)this.doNotify(`${d==null?void 0:d.added} Evts with Priority ${n} ${i} ...doSave eh`,"info");else{if(d.overlaps&&Object.keys(d.overlaps).length>0)return(d==null?void 0:d.added)>0&&this.doNotify(`${d==null?void 0:d.added} Evts added ${d!=null&&d.noTime?"Plus "+(d==null?void 0:d.noTime)+" Without time":""} BUT some Overlaps to fix!`,"warning"),this.handleOverlaps(d.overlaps,"byPrio");this.doNotify(`No Evts with Priority ${n} ${i} :(`,"warning","top")}l>0||(d==null?void 0:d.added)>0?this.daSchedule.toggleActionBtns(!0,"byPrio"):console.log("doReloadWithPrio::no Evts and no toggling for flag>> ",p.choice,d==null?void 0:d.added)},o=this.daSchedule.byPrio,n=this.currentScheduleBySign("prio"),l=this.daSchedule.getScheduledEvts().size,r=`By Goal's Parent Priority ${n} ${i}`,s=[];if(!o){console.log("doReloadWithPrio::ERROR? >> no options",o),s=this.defaultScheduleByOpts(),this.scheduleByDialog("Schedule by Priority",r,s,"",t,e);return}let a=((m=o==null?void 0:o.filter)==null?void 0:m.length)>0&&((h=o==null?void 0:o.filter)==null?void 0:h.length)!=l,c=((T=o==null?void 0:o.reset)==null?void 0:T.length)>0&&l>0;if(a&&s.push({label:`Filter out of ${l} scheduled to ${(g=o==null?void 0:o.filter)==null?void 0:g.length} Evts`,value:"filter"}),((C=o==null?void 0:o.toAdd)==null?void 0:C.length)>0&&s.push({label:`Add ${(y=o==null?void 0:o.toAdd)==null?void 0:y.length} Evts to current schedule`,value:"add"}),c&&s.push({label:`Reset current and schedule ${(S=o==null?void 0:o.reset)==null?void 0:S.length} Evts.`,value:"reset"}),!s.length>0){this.doNotify(`No Evts with Priority ${n} ${i} :(`,"warning","top");return}l>0?this.scheduleByDialog("Reload by Priority",r,s,"",t,e):((D=o==null?void 0:o.toAdd)==null?void 0:D.length)>7?this.scheduleByDialog("Schedule by Priority",r,s,"",t,e):t({choice:"reset",skipOCheck:!this.isViewingToday()}),this.daSchedule.disablePrioBtn=!0},onChoosenScore(i){console.log("onChoosenScore::ERROR?",i)},onScheduleByScore(i,e=!1){let t=[],o=!1,n=null;const l=this.daSchedule;let r=()=>[{label:"Keep Evt with Highest Priority",value:"opt1",color:"secondary"},{label:"Manually Choose one event",value:"opt3"}];const s=h=>this.findhighestPrio(h),a=(h,T)=>this.betterEvtLabel(h,T,!1);let c=(h,T,g)=>{this.confirmChoiceDialog("","Choose which Event to keep",h.map(C=>a(C,"default")),"",function(C){let y=h.find(S=>S.id==C);if(!y){console.log("chooseOneEvt::ERROR NOT FOUND!!",C);return}if(T.id==y.id){h.forEach(D=>{D.id!=y.id&&l.removeScheduledEvt(D)});let S=l.addToSchedule(T,!e,!1);//!skipOvCheck
console.log("chooseOneEvt::ADDED",C,g,S)}else h.forEach(S=>{T.id==S.id?console.log("chooseOneEvt,not adding target",S.id,y.id):S.id!=y.id?l.removeScheduledEvt(S):console.log("chooseOneEvt,not adding scheduled",S.id,y.id)});return g=C,g},null,function(){console.log("onScheduleByScore::onDismiss >>chooseOne",g,n),n=g})};i.sort(function(h,T){return ee(h.time)-ee(T.time)}),i.forEach((h,T,g)=>{let C=l.addToSchedule(h,!e,!1);if(C&&Array.isArray(C))if(C.length>1){console.log("onScheduleByScore::OVERLAP >> oneToMany",h,C),o=!0;let y=null;if(C.find(S=>S[0]=="oneToMany")){C=C.filter(S=>S[0]!="oneToMany");for(let S=0;S<C.length;S++){C[S][0];let D=C[S][1];y=D[0].targetStart,this.scrollToTime(y,"slow");let p=[],d=[],b=!1;for(;D.length;){const w=D.pop();let E=this.daSchedule.findSchedEvent(w.inConflict);p.push(`(${E==null?void 0:E.id}) '${E==null?void 0:E.title.trim()}'`),h.id!=w.target&&console.log("onScheduleByScore::ERROR ERROR:: NOT same target ID?!?",h,w),d.push(E),w.direction=="surrounding"?b=!0:b=b}d.unshift(h);let u=`Adding (${h==null?void 0:h.id}) '${h==null?void 0:h.title.trim()}' at ${j(h==null?void 0:h.time)} Conflicts with scheduled ${p.join(" and ")}. `,v=r();b||v.push({label:`Force in > '${h==null?void 0:h.title.trim()}' ?`,value:"opt4"}),this.confirmChoiceDialog("OneToMany Conflicts",u,v,"",function(w){var E;switch(w){case"opt1":let M=s(d);if(console.log("onScheduleByScore::ByPriority >> AUTO ",M.e.id,(E=M==null?void 0:M.e)==null?void 0:E.title.trim()),h.id==M.e.id){d.forEach(X=>{X.id!=M.e.id&&l.removeScheduledEvt(X)});let $=l.addToSchedule(h,!e,!1);//!skipOvCheck
console.log("onScheduleByScore::ByPriority>>ADDED",n,$)}else d.forEach($=>{$.id!=M.e.id?l.removeScheduledEvt($):console.log("onScheduleByScore::ByPrio,not adding target?",$.id,M.e.id)});n=w;return;case"opt4":let A=d.find($=>$.id!=h.id);l.recurChangeTime(A.id,h,y,!0),n=w;return;default:c(d,h,n);return}},null,function(){console.log("onScheduleByScore::onDismiss >> OneToMany",n)})}}else console.log("onScheduleByScore::OVERLAP! ERROR not oneToMany?!?",C)}else t.push(...C);else C===!0||console.log("onScheduleByScore::adding...FAILED?>>",h,C)});const m=()=>{this.doLog("onScheduleByScore::doContinue",t),t.length>0&&this.doNotify(`${t.length} EXTRA Overlaps to fix!`,"negative","top"),this.doNotify("Added byScore!..doSave eh","info","top")};if(o){let h=setInterval(()=>{n&&(setTimeout(()=>{clearInterval(h)},0),m())},3e3)}else m()},doReloadWithScore(){var m,h,T,g,C,y,S,D;let i=this.daSchedule.chosenScore;if(i==null){this.doNotify("Ayo select a score!");return}let e=()=>{this.reset()},t=p=>{let d=this.daSchedule.scheduleByScore(p.choice,p.skipOCheck);if(d.canContinue)this.doNotify(`${d==null?void 0:d.added} Evts with Interval Score ${n} ${i} ...doSave eh`,"info");else{if(d.overlaps&&Object.keys(d.overlaps).length>0)return(d==null?void 0:d.added)>0&&this.doNotify(`${d==null?void 0:d.added} Evts added ${d!=null&&d.noTime?"Plus "+(d==null?void 0:d.noTime)+" Without time":""} BUT some Overlaps to fix!`,"warning"),this.handleOverlaps(d.overlaps,"byScore");this.doNotify(`No Evts with Interval Score ${n} ${i} :(`,"warning")}l>0||(d==null?void 0:d.added)>0?this.daSchedule.toggleActionBtns(!0,"byScore"):console.log("doReloadWithScore::no Evts and no toggling for flag>> ",p.choice,d==null?void 0:d.added)},o=this.daSchedule.byScore,n=this.currentScheduleBySign("score"),l=this.daSchedule.getScheduledEvts().size,r=`Goals with Interval Score ${n} ${i}`,s=[];if(!o){console.log("doReloadWithScore::ERROR? >> no options",o),s=this.defaultScheduleByOpts(),this.scheduleByDialog("Schedule by Score",r,s,"",t,e);return}let a=((m=o==null?void 0:o.filter)==null?void 0:m.length)>0&&((h=o==null?void 0:o.filter)==null?void 0:h.length)!=l,c=((T=o==null?void 0:o.reset)==null?void 0:T.length)>0&&l>0;if(a&&s.push({label:`Filter out of ${l} scheduled to ${(g=o==null?void 0:o.filter)==null?void 0:g.length} Evts`,value:"filter"}),((C=o==null?void 0:o.toAdd)==null?void 0:C.length)>0&&s.push({label:`Add ${(y=o==null?void 0:o.toAdd)==null?void 0:y.length} Evts to current schedule.`,value:"add"}),c&&s.push({label:`Reset current and schedule ${(S=o==null?void 0:o.reset)==null?void 0:S.length} Evts.`,value:"reset"}),!s.length>0){this.doNotify(`No Evts with Interval Score ${n} ${i} :(`,"warning");return}l>0?this.scheduleByDialog("Reload by Score",r,s,"",t,e):((D=o==null?void 0:o.toAdd)==null?void 0:D.length)>10?this.scheduleByDialog("Schedule by Score",r,s,"",t,e):t({choice:"reset",skipOCheck:!this.isViewingToday()}),this.daSchedule.disableScoreBtn=!0},doSaveSchedule(){var o;if(!this.daSchedule.getScheduledEvts().size>0&&!this.daSchedule.hasEventsForDate()){this.doNotify("Nothing to Save :(","warning");return}let e=(o=this.labelScheduled())==null?void 0:o.noTime;this.daSchedule.saveDaySchedule();let t=`Schedule saved for ${this.currentDate}`;e&&(t+=` 
Except for ${e} without time!`),this.doNotify(t,e?"info":"positive"),this.resetFilter()},addNewToSchedule(i,e){let t=this.daSchedule.findSchedEvent(e.id);if(t){this.doNotify(`${t==null?void 0:t.title} is already scheduled`),this.doCleanup(),this.reset();return}let o=this.daSchedule.addGoalsToSchedule([{...e,time:i.time}],this.isViewingToday()||this.isViewingPast());if(o.length>0){if(this.isViewingPast()){let n="No Overlaps allowed in past!!",l=`Evt '${e==null?void 0:e.title.trim()}' NOT added.`;this.doNotifyCaption(n,l,"warning"),this.doCleanup(),this.reset();return}return this.handleOverlaps(o,"addNew")}if(this.isViewingPast()){this.daSchedule.saveDaySchedule(),this.doNotify(`${e==null?void 0:e.title} Added and Schedule saved!`,"info");return}this.doNotify(`${e==null?void 0:e.title} Added!..doSave eh`,"positive"),this.daSchedule.toggleActionBtns(!0,"addNew"),this.doCleanup()},doDroppy(i,e){if(i&&e){let t=e.evt,o=this.daSchedule.tooClose(i,t.duration);if(o){if(o===!0){this.doNotify("Dropping event TOO close to midnight!"),this.reset();return}console.log("doDroppy::tooClose OVERLAP?",JSON.stringify(o))}if(e.type=="tree-item")return this.addNewToSchedule(i,t);let n=this.daSchedule.canDropEvent(i,t);if(n.canContinue){let l=(t==null?void 0:t.inDefaults)||!(t!=null&&t.canMove),r=this.daSchedule.getOriginalEvtTime(t.id),s=!r||(t==null?void 0:t.time)=="";if(l&&!s){let a=t!=null&&t.inDefaults?"Default at ":"Cannot Move from ",c=[`Evt "${t.title.trim()}" ${a} ${j(r)}.`,`
Also Save Evt default time to ${j(i.time)}?`,`
Cancel or No selection to keep at ${j(t.time)}`].join(`
`);const m=this.daSchedule,h=this.doCleanup;this.confirmTimeChange(`${t!=null&&t.inDefaults?"Changing Default Evt's time":"Evt's Cannot move"}`,c,"Change","Temp.Move",function(T){m.changeEvtTime(t,i,T),m.toggleActionBtns(!0,"doDroppy"),h()},function(){h()},function(){console.log(`doDroppy::onDismiss..keep as is>> ${t.id})'${t.title.trim()}'`),h()})}else this.daSchedule.changeEvtTime(t,i,!1),this.daSchedule.toggleActionBtns(!0,"doDroppy"),this.doCleanup()}else this.handleOverlaps(n.overlaps,"onDrop")}else{console.log("doDroppy null ERROR?",i,this.targetDrop,e,this.selectedItem);return}},titleIncludes(i,e){return{includer:i.trim().toLowerCase().includes(e.trim().toLowerCase()),included:e.trim().toLowerCase().includes(i.trim().toLowerCase())}},canAutoSchedule(i,e){let t=this.titleIncludes(i.title,e.title),o=t.includer,n=t.included,l=this.daSchedule.parentGoalById(i.parentGoal),r=this.daSchedule.parentGoalById(e.parentGoal),s=this.titleIncludes(i.title,r.title),a=this.titleIncludes(e.title,l.title);return(s||a)&&console.log("canAutoSchedule:: WOAH PARENT AUTO schedule?--TODO***",s,a),o||n?{addIncSched:o,schdIncToAdd:n}:!1},movedIntoConflict(i,e,t,o=0){console.log("movedIntoConflict >>",JSON.parse(JSON.stringify(i)),"from:"+t,o);const n=(d,b)=>{if(d!=null&&d.parentGoal){let u=this.daSchedule.parentGoalById(d.parentGoal);return b?`Of '${u==null?void 0:u.title.trim()}' (${u==null?void 0:u.priority})`:`Of '${u==null?void 0:u.title.trim()}'`}return console.log("prioLabel..ERROR no PARENT found?",d),""},l=(d,b)=>{switch(b){case"score":return`${n(d,!1)} > "${d.title.trim()}" with Score:: ${d.score} = ${Pe(d.score)}`;case"prio":return`"${d.title.trim()}" ${n(d,!0)}`;default:return`"${d.title.trim()}" ${n(d,!0)} && Score:: ${d.score} for ${d.duration} mins`}},r=(d,b=!1)=>{this.doNotify(d,b?"warning":"positive","top")},s=d=>{this.daSchedule.deleteEvtMood(d)},a=d=>{console.log(`movedIntoConflict::doRemove ${d.id}:${d.title}`),this.daSchedule.removeScheduledEvt(d)};let c=d=>{console.log("onDismissy::from "+t,d,D),this.doCleanup(),this.daSchedule.toggleActionBtns(!0,t)};const m=(d,b,u)=>{if(console.log(`movedIntoConflict::removeReplace >> replacing>> ${d.id}) '${d.title.trim()}' WITH ${b.id}) ${b.title.trim()}`,u,"from>"+t),e){if(console.log("movedIntoConflict::removeReplace...OVERRIDE from>>"+t),t=="onDrop"){a(d);return}console.log("movedIntoConflict::removeReplace....OVERRIDE updating..."+t),this.daSchedule.doUpdateSchedule(b,u.targetStart);return}if(a(d),t=="onDrop")console.log("movedIntoConflict::removeReplace for onDrop...just updating schedule",b.id,u.targetStart.time),this.daSchedule.doUpdateSchedule(b,u.targetStart);else{console.log("movedIntoConflict::removeReplace >>addGoalsToSchedule from "+t);let v=this.daSchedule.getStoredRawEvt(u.target);v&&(JSON.parse(JSON.stringify(b)),Object.assign(b,v,{time:u.targetStart.time}));let w=this.daSchedule.addGoalsToSchedule([{...b,time:u.targetStart.time}],!0),E=Object.keys(w).length;if(E>0)return console.log(`movedIntoConflict::removeReplace:: OVERLAPS again of size:${E} from >${t}>`+b.title,JSON.parse(JSON.stringify(w))),this.doNotify(`Extra Overlaps while removing to add '${b.title.trim()}' `,"warning","top"),this.movedIntoConflict(w,e,t+"nah")}},h=(d,b)=>{let u=this.daSchedule.findSchedEvent(b.target);if(!u){console.log("movedIntoConflict::forceAddMins>>NOT FOUND?!?",b.target);return}let v=this.daSchedule.getStoredRawEvt(b.target);if(v){let w=u.duration+parseInt(o);JSON.parse(JSON.stringify(u)),Object.assign(u,v,{duration:w})}else console.log("movedIntoConflict::forceAddMins >>NEWLY ADDED?!? Error?",u.id,u,v),Object.assign(u,{duration:newDura});this.daSchedule.recurChangeTime(d.id,u,b.targetStart,!1,this.doNotify),this.doSaveSchedule()},T=(d,b,u)=>{console.log(`movedIntoConflict::forceAdd:${t} >>${b.id})'${b.title}' at ${b.time} to ${u.targetStart.time}
        
Changing >>${d.id} from ${d.time}`);let v=this.daSchedule.getStoredRawEvt(u.target);v&&(JSON.parse(JSON.stringify(b)),Object.assign(b,v,{time:u.targetStart.time}));let w=this.daSchedule.recurChangeTime(d.id,b,u.targetStart,t!="onDrop",this.doNotify);if(w){let E=Object.keys(w).length;if(E>0)return console.log(`movedIntoConflict::forceAdd:: OVERLAPS again of size:${E} from >${t}>`+b.title,JSON.parse(JSON.stringify(w))),this.doNotify(`Extra Overlaps while adding '${b.title.trim()}'`,"negative","top"),this.movedIntoConflict(w,e,t+"nah")}c("ForceAdd")};let g=(d,b,u,v,w)=>{D.push(b),b==u.id?(m(v,u,w),r(`by ${d}, ${t=="onDrop"?"Moving":"Adding"} '${u.title.trim()}'`,!0)):(console.log(`onOkChoice::by ${d},chose scheduled ${b} ...with override?`,e,t),r(`by ${d}, Keeping '${v.title.trim()}'`),t.indexOf("byMood")>-1&&s(u.id),t=="onDrop"&&a(u))},C=(d,b)=>{if(e){if(console.log("movedIntoConflict::cancelChoice::OVERRIDE...coolios!!from:"+t,d.title.trim()),t=="onDrop"){r("Umm...not moving then...."),this.daSchedule.toggleActionBtns(!1,"view");return}a(d),r(`Keeping '${b.title.trim()}'`);return}t.indexOf("byMood")>-1&&s(d.id),this.daSchedule.toggleActionBtns(!0,"view"),r(`Keeping scheduled '${b.title.trim()}'`)};const y=(d,b,u,v)=>{if(d=="opt3"){let w="Pick one event...",E=[{label:l(b,"def"),value:b.id,color:"secondary"},{label:l(u,"def"),value:u.id}];this.confirmChoiceDialog("",w,E,"",function(M){g("Choice",M,b,u,v)},null,function(){c("resolveChoice::byEvent... dismissing")})}else if(d=="opt2"){let w="Pick event by Score",E=[{label:l(b,"score"),value:b.id,color:"secondary"},{label:l(u,"score"),value:u.id}];this.confirmChoiceDialog("",w,E,"",function(M){g("Score",M,b,u,v)},null,function(){c("resolveChoice::byScore... dismissing")})}else if(d=="opt1"){let w="Pick event by Priority",E=[{label:l(b,"prio"),value:b.id,color:"secondary"},{label:l(u,"prio"),value:u.id}];this.confirmChoiceDialog("",w,E,"",function(M){g("Priority",M,b,u,v)},null,function(){c("resolveChoice::byPriority... dismissing")})}else d=="opt0"?(console.log("resolveChoice::it's a drop?...keeping as is....",t),r("Umm...keeping as is then!"),this.doCleanup()):T(u,b,v)},S=(d,b,u,v,w)=>{v.direction!=="surrounding"&&!w&&(t.indexOf("nah")>-1?console.log("movedIntoConflict::manualSolve NOT adding Force as from "+t):d.push({label:`Force in '${b.title.trim()}'`,value:"opt4"}));let E=`${t=="onDrop"?"Moving":"Adding"} '${b.title.trim()}' at ${j(v.targetStart.time)} Overlaps with Scheduled '${u.title.trim()}' at ${j(u==null?void 0:u.time)}.
        
Cancel to keep '${u.title.trim()}' `,M=w?"Choose Auto Resolution":"Resolve Overlapping Events";this.confirmChoiceDialog(M,E,d,"opt1",function(A){y(A,b,u,v)},function(){console.log("movedIntoConflict>>manualSolve::cancelChoice? Notif?>> from: "+t,D[0]),r("Umm...keeping as is then!")})};let D=[],p=Object.keys(i).length;i.find(d=>d[0]=="oneToMany");for(let d=0;d<p;d++){let b=i[d][0];if(b=="oneToMany"){console.log("movedIntoConflict...skipping oneToMany key",b,i.oneToMany);continue}let u=i[d][1],v=[{label:"Choose one event",value:"opt3"}];t=="onDrop"?v.unshift({label:"Leave as is!",value:"opt0"},{label:"Choose by Priority",value:"opt1",color:"secondary"},{label:"Choose by Score",value:"opt2"}):v.unshift({label:"Choose by Priority",value:"opt1",color:"secondary"},{label:"Choose by Score",value:"opt2"});const w=u.pop();let E=this.daSchedule.getSubGoalByID(w.target),M=this.daSchedule.findSchedEvent(w.inConflict);if(!M||!E){console.log("movedIntoConflict...ERROR ERROR no evts found!!!",w);return}let A=this.canAutoSchedule(E,M);if(t=="onAddMins"){let $=M!=null&&M.inDefaults?"In Defaults":M!=null&&M.canMove?"":"Cannot move",X=`Adding ${o} mins to "${E.title.trim()}" Overlaps with Scheduled "${M.title.trim()}" at ${j(M.time)} as ${$}.
          
Force?
          
Cancel/Dismiss to Leave as is.`;this.confirmAction("",X,"Add",function(){h(M,w)},function(){r("Keeping as Is...")})}else if(A){console.log("movedIntoConflict:: can AUTO schedule",A.addIncSched,A.schdIncToAdd,"direction == surrounding? >>",w.direction=="surrounding"),this.scrollToTime(w==null?void 0:w.targetStart,"slow");let $=`"${E.title.trim()}" at ${j(E.time)} related to Scheduled "${M.title.trim()}" at ${j(M.time)}.
          
Auto resolve Overlap?
          
Cancel/Dismiss to manually choose.`;this.confirmAction("",$,"Auto",function(){var X;A.addIncSched?(console.log("Auto resolve::removeReplace..with TIMES>>",E.time,M.time,(X=w==null?void 0:w.targetStart)==null?void 0:X.time),m(M,E,w),r(`Removing Scheduled to Add '${E.title.trim()}'`,!0),D.push(E.id)):(console.log("Auto resolve::cancelChoice >> from: ",t),C(E,M),D.push(M.id))},function(){S(v,E,M,w,!0)},function(){c("Auto-dismiss")})}else S(v,E,M,w,!1)}},handleOverlaps(i,e=""){let t=i.length;i.reverse(),this.doLog("handleOverlaps::ORIGNL from: "+e+" >> "+t,i);let o=i.filter(l=>l[0]=="oneToMany");o&&(i=i.filter(l=>l[0]!="oneToMany"),t=i.length);const n=eo(i);for(let l=0;l<t;l++){let r=i[l][0],s=i[l][1],a=null;l>0?a=n[l-1][1][0].targetStart:a=null,l==t-1&&(e.indexOf("nah")>-1?console.log("handleOverlaps...NO END SCROLL::FROM",e,r):this.scrollToTime(s[0].targetStart,"slow")),o&&o.find(c=>c[1]==r)?this.fixConflicts(s,e,!0,[t,l],a):this.fixConflicts(s,e,!1,[t,l],a)}},fixConflicts(i,e,t,o,n=null){var V;const l=N=>this.daSchedule.findSchedEvent(N),r=N=>this.daSchedule.getSubGoalByID(N),s=(N,L)=>{if(!N){console.log("fixConflicts::scrollToConflict ERROR >>empty time hasOneToMany="+t,L,N);return}setTimeout(()=>{this.scrollToTime(N,"slow")},1e3)},a=N=>{this.doNotifyTimeout(N,"negative")},c=(N,L=!1)=>{this.doNotify(N,L?"warning":"positive","top")},m=N=>this.findhighestPrio(N);let h=N=>this.getSmallestScoreInterval(N),T=N=>{console.log("onDismissy>> ",N,u.length),u.length>0&&setTimeout(()=>{t?g(u,E):C(u,E)},0),this.doCleanup()},g=(N,L)=>{console.log(`fixConflicts::removeWithID with toKeep=${N.length} `,n==null?void 0:n.time);let B=[],k=!1;for(L.forEach((f,U,J)=>{if(N.find(F=>F.id==f.id))if(f.id==v.id){let F=b.has(f.id)?b.get(f.id):"",G=d.has(f.id)?d.get(f.id):d.get(v.id),Z=this.daSchedule.getStoredRawEvt(f.id);Z&&(JSON.parse(JSON.stringify(f)),Object.assign(f,Z,{time:G.time}));let re=e=="onDrop"?this.daSchedule.doUpdateSchedule(f,G)||{}:this.daSchedule.addGoalsToSchedule([{...f,time:G.time}],!1);if(Object.keys(re).length>0)console.log("fixConflicts::removeWithID::OVERLAP on add",re,f,G.time),B.push(re);else{let K=`${F} ${le?"Moving":"Adding"} '${f==null?void 0:f.title.trim()}' at ${j(G.time)}`;this.doNotify(K,"positive","top")}k=!0}else{console.log("fixConflicts::removeWithID....Keeping scheduled Evt!!",f.id,f.title,f.time,d.get(f.id));let F=this.daSchedule.stillInSchedule(f.id);if(F.inSched){let G=`${b.has(f.id)?b.get(f.id):""} Keeping scheduled '${f==null?void 0:f.title.trim()}'`;this.doNotify(G,"positive","top")}else{this.doLog("fixConflicts::removeWithID>>ERROR::scheduled was removed: "+f.id+" "+f.title,F),this.doNotify(`Re-adding ${f.title}`,"warning"),F.inStore?Object.assign(f,F.inStore):console.log("fixConflicts::removeWithID>>scheduled was removed >>NOT STORED!!TODO**");let G=this.daSchedule.addGoalsToSchedule([f],!0);G.length>0?B.push(G):console.log("fixConflicts::removeWithID>>scheduled was removed >>NO Overlaps!!")}}else if(f.id!=v.id){console.log("fixConflicts::removeWithID >>removing scheduled",f.id,f.title,f.time);let F=this.daSchedule.getCurrentMoods()[f.id];this.daSchedule.removeScheduledEvt(f);let G=`Removed scheduled '${f==null?void 0:f.title.trim()}'`;G=F?G+` With Moods: '${F}'`:G,this.doNotify(G,F?"negative":"warning"),k=!0}else e=="onDrop"?(console.log("fixConflicts::removeWithID >>Removing target onDrop!!",f.id,f.title,f.time),this.daSchedule.removeScheduledEvt(f)):console.log("fixConflicts::removeWithID >>NOT adding original target",v.id),this.daSchedule.deleteEvtMood(v.id),this.resetFilter()}),e=="onDrop"||k?(this.daSchedule.toggleActionBtns(!0,e),this.doCleanup()):console.log("fixConflicts::removeWithID...NO TOGGLING",e);B.length;){const f=B.pop();this.doLog(`${e}> fixConflicts::removeWithID:: OVERLAPS`,f),this.doNotify("EXTRA Overlaps to fix!","negative","top");let U=e.indexOf("view")>-1?e:e+"nah";return this.handleOverlaps(f,U)}return n?s(n,"removeWithID"):console.log("fixConflicts::removeWithID >> NO SCROLLING after conflicts",e,n,k),"removeWithID"},C=(N,L)=>{console.log(`fixConflicts::removeConflicts with toKeep=${N.length}`,n==null?void 0:n.time);let B=[],k=!1;for(L.forEach((f,U,J)=>{if(N.find(F=>F.id==f.id)){let F=b.has(f.id)?b.get(f.id):"",G=d.has(f.id)?d.get(f.id):null;if(f.id!=w.id){let Z=this.daSchedule.getStoredRawEvt(f.id);Z&&(JSON.parse(JSON.stringify(f)),Object.assign(f,Z,{time:G.time}));let re=e=="onDrop"?this.daSchedule.doUpdateSchedule(f,G)||{}:this.daSchedule.addGoalsToSchedule([{...f,time:G.time}],this.isViewingToday());if(re&&Object.keys(re).length>0)B.push(re),this.doNotify(`Extra Overlaps while adding '${f==null?void 0:f.title.trim()}'`,"negative","top");else{let K=`${F} ${le?"Moving":"Adding"} '${f==null?void 0:f.title.trim()}' at ${j(G.time)}`;this.doNotify(K,"positive","top")}k=!0}else{let Z=this.daSchedule.stillInSchedule(f.id);if(Z.inSched)this.doNotify(`${F} Keeping scheduled '${f==null?void 0:f.title.trim()}' `,"positive","top");else{this.doLog("fixConflicts::removeConflicts>>ERROR::scheduled was removed: "+f.id+" "+f.title,Z),this.doNotify(`Re-adding ${f.title}`,"warning"),Z.inStore?Object.assign(f,Z.inStore):console.log("fixConflicts::removeConflicts>>scheduled was removed >>NOT STORED!!TODO**");let re=this.daSchedule.addGoalsToSchedule([f],!0);re.length>0?B.push(re):console.log("fixConflicts::removeConflicts>>scheduled was removed >>NO Overlaps!!")}}}else if(f.id==w.id){let F=this.daSchedule.getCurrentMoods()[f.id];this.daSchedule.removeScheduledEvt(f);let G=`Removed scheduled '${f==null?void 0:f.title.trim()}'`;G=F?G+` With Moods: '${F}'`:G,this.doNotify(G,F?"negative":"warning"),k=!0}else console.log("fixConflicts::removeConflicts >> NOT adding target ",f.id,f.title),this.daSchedule.deleteEvtMood(f.id),this.resetFilter()}),e.indexOf("view")>-1||k?this.daSchedule.toggleActionBtns(!0,e):console.log("fixConflicts::removeConflicts...NO TOGGLING",e,k);B.length;){const f=B.pop();this.doLog(`fixConflicts::removeConflicts::EXTRA OVERLAPS from ${e} `,f),this.doNotify("EXTRA Overlaps to fix","negative","top");let U=e.indexOf("view")>-1?e:e+"nah";return this.handleOverlaps(f,U)}return n?s(n,"removeConflicts"):console.log("removeConflicts::NO SCROLLING after conflicts",n,e,k),"removeConflicts"};const y=(N,L)=>{let B=[],k=L.filter(f=>!N.some(U=>U.id==f.id));for(console.log(`fixConflicts::forceAdd of ${N.length} hasOneToMany=${t} `+e,"allConflicts= "+L.length,n==null?void 0:n.time),L.forEach(f=>{if(N.find(U=>U.id==f.id)){let U=d.has(f.id)?d.get(f.id):null,J=this.daSchedule.getStoredRawEvt(f.id);J&&Object.assign(f,J,{time:U.time});let F=k.length>0?k[0]:null;F||(console.log("fixConflicts::forceAdd::ERROR as no scheduled?!?",k),F=L.find(Z=>Z.id!=f.id)),console.log(`fixConflicts::forceAdd...NEW:${f.id} '${f.title.trim()}' dura= ${f.duration} 
 
            origAt: ${f.time} added at>>`,U==null?void 0:U.time,"from>>"+e,`
 >> USING for change `+F.id+" "+(F==null?void 0:F.title),"hasOneToMany "+t);let G=this.daSchedule.recurChangeTime(F.id,f,U,e!="onDrop",a);if(G&&Object.keys(G).length>0)console.log("fixConflicts::forceAdd >>OVERLAP on add",G,f,U.time),B.push(G);else{let Z=`Force ${le?"Moved":"Added"}  '${f==null?void 0:f.title.trim()}' at ${j(U.time)}`;this.doNotify(Z,"positive","top")}}else t?e=="onDrop"?this.daSchedule.recurChangeTime(f.id,N[0],d.get(N[0].id),e!="onDrop",a):console.log("fixConflicts::forceAdd >> WITHID but nothing to do?",t,f.id):console.log("fixConflicts::forceAdd >>not WITHID >> NOTHING for scheduled",f.id,"Not onDrop: "+e!="onDrop")}),this.daSchedule.toggleActionBtns(!0,e);B.length;){const f=B.pop();return this.doLog("fixConflicts::forceAdd:: EXTRA OVERLAPS "+e,f),this.doNotify("EXTRA Overlaps to fix!","negative","top"),this.handleOverlaps(f,e+"nah")}return n&&s(n,"forceAdd"),"forceAdd"};let S=(N,L)=>{switch(N){case"score":this.confirmChoiceDialog("","Choose one event by Score",L.map(B=>this.betterEvtLabel(B,"score",!1)),"",function(B){let k=L.find(f=>f.id==B);if(k)u.push(k),b.set(k.id,`By Score Interval (${k.score}),`);else{console.log("chooseOneEvt::ERROR NOT FOUND!!",B);return}return k},null,function(){T("chooseOneEvt::>>byScore...")});return;case"prio":this.confirmChoiceDialog("","Choose one event by Priority",L.map(B=>this.betterEvtLabel(B,"prio",!1)),"",function(B){let k=L.find(f=>f.id==B);if(k)u.push(k),b.set(k.id,"By Priority,");else{console.log("chooseOneEvt::ERROR NOT FOUND!!",B);return}return k},null,function(){T("chooseOneEvt::>>byPriority...")});return;default:this.confirmChoiceDialog("","Choose which Event to keep",L.map(B=>this.betterEvtLabel(B,"default",!1)),"",function(B){let k=L.find(f=>f.id==B);if(k)u.push(k),b.set(k.id,"By pick,");else{console.log("chooseOneEvt::ERROR NOT FOUND!!",B);return}return k},null,function(){T("chooseOneEvt::>>byPick...")});return}},D=(N,L,B,k,f)=>{var U;if(N=="opt3")S("default",k);else if(N=="opt2")if(f)S("score",k);else{let J=h(k);J?(u.push(J),b.set(J.id,`By Shortest Score Interval (${J.score}),`)):(console.log("ERROR ERROR::fixConflicts >> smallestScoreInterval::No current set?",k),c("Umm...Score Error",!0),S("score",k))}else if(N=="opt1")if(f)S("prio",k);else{let J=m(k);console.log("fixConflicts::ByPriority >> AUTO "+e,J.e.id,(U=J==null?void 0:J.e)==null?void 0:U.title.trim()),u.push(J.e),b.set(J.e.id,`By Highest Priority (${J.prio}),`)}else N=="opt0"?(console.log("fixConflicts::AUTO:SOLVE >>",v,w,B,k),L.addIncSched?t?(u.push(v),b.set(v.id,"By Title Auto-Solve,")):(u.push(B[0]),b.set(B[0].id,"By Title Auto-Solve,")):t?(u.push(k[0]),b.set(k[0].id,"By Title Auto-Solve,")):(u.push(w),b.set(w.id,"By Title Auto-Solve,"))):y(B,k)},p=()=>{if(e=="onDrop"){c("Umm...not moving then...."),this.doCleanup();return}if(e.indexOf("byMood")>-1){console.log("fixConflicts::cancelChoice >>Mood update? canChooseOne:"+O+" hasOneToMany "+t,v.id),this.daSchedule.deleteEvtMood(v.id);return}if(t){console.log("fixConflicts::cancelChoice::hasOneToMany from> ",e),c("Keeping Schedule as-is...");return}u.push(w)},d=new Map,b=new Map,u=[],v=null,w=null,E=[],M=[],A=!1,$=[];for(i.length;i.length;){const N=i.pop();let L=l(N.inConflict);if(!L){console.log("fixConflicts...ERROR ERROR no evts found!!!",N);return}let B=r(N.target);if(!B){console.log("fixConflicts...ERROR ERROR target evt not found!!!",N);return}d.set(N.target,N==null?void 0:N.targetStart),t?(v?v.id!==N.target&&console.log("fixConflicts::ERROR ERROR:: oneToManyConflict >>Not same target ID?!?",v,N,M,d):(v=B,M.push(B),E.unshift(B)),$.push(`'${L==null?void 0:L.title.trim()}'`),E.push(L),this.titleIncludes(v.title,L==null?void 0:L.title)):(w?w.id!==L.id&&console.log("fixConflicts::ERROR ERROR::manyToOneConflict Not same schedule?!?",w.id,L.id,N,M):(w=L,E.unshift(L),d.set(N.inConflict,N==null?void 0:N.targetStart)),$.push(`'${B==null?void 0:B.title.trim()}'`),this.titleIncludes(B==null?void 0:B.title,w==null?void 0:w.title),M.push(B),E.push(B)),N.direction=="surrounding"?A=!0:A=A}let X=$.join(" and "),O=o[0]<3,R=!1;$.length<2&&(R=t?this.canAutoSchedule(v,E[0]):this.canAutoSchedule(M[0],w));let P=[],z=O?"Pick one event via ":"Auto-Resolve to keep Evt with ";if(R?(this.doLog("fixConflicts::AUTO-RESOLVE!! "+w.id+"hasOneToMany:"+t,R),P.unshift({label:"By Title Auto-resolve?",value:"opt0"}),P.push({label:"Manually Choose one event",value:"opt3"})):O?P.push({label:"Manually Choose one event",value:"opt3"}):(P.push({label:"Manually Choose one event",value:"opt3"}),e=="byScore"?P.unshift({label:z+`${O?"Priority":"Highest Priority"}`,value:"opt1",color:"secondary"}):e=="byPrio"?P.unshift({label:z+`${O?"Score Interval":"Shortest Score Interval"}`,value:"opt2"}):P.unshift({label:z+`${O?"Priority":"Highest Priority"}`,value:"opt1",color:"secondary"},{label:z+`${O?"Score Interval":"Shortest Score Interval"}`,value:"opt2"})),!A&&!e.indexOf("nah")>-1){let N=t?`Force in > '${v==null?void 0:v.title.trim()}' ?`:`Force in > ${$.join()}`;P.push({label:N,value:"opt4"})}else{let N=e.indexOf("view")>-1&&O;A&&O&&(e.indexOf("onPickEvt")>-1||e.indexOf("adHocEvt")>-1||N)&&P.push({label:"Force in ?",value:"opt4"})}let le=e.indexOf("onDrop")>-1,me=e.indexOf("byMood")>-1,ie=`${le?"Cancel to keep as-is":O&&P.length<=2||R||me?"Cancel to keep scheduled":""}`,ce=t?`${le?"Moving":"Adding"} (${v==null?void 0:v.id}) '${v==null?void 0:v.title.trim()}' at ${j((V=d.get(v.id))==null?void 0:V.time)} Conflicts with scheduled ${X}. 
 ${ie}`:`${le?"Moving":"Adding"} ${X} Conflicts with scheduled (${w==null?void 0:w.id}) '${w==null?void 0:w.title.trim()}' at ${j(w==null?void 0:w.time)}. 
 ${ie}`,ue=t?`OneToMany Conflicts #${o[1]+1}`:`ManyToOne Conflicts #${o[1]+1}`;this.radioChoiceDialog(ue,ce,P,"",function(N){D(N,R,M,E,O)},ie!=""?p:null,function(){T("Main!")})},onPickEvent(i,e,t,o){if(this.closingDialog(),!i||!i.id){console.log("onPickEvent...ERROR nothing!",i,e,t,o),this.doNotify("No Goal selected..."),this.reset();return}const n=()=>{r&&(i.duration=o);let a=this.daSchedule.onPickEvent(i,this.targetDrop.timestamp,l,t,this.doNotifyTimeout);a.canContinue?t&&this.doNotify("What is Owed PAID! gg!","info","top"):a.overlaps&&Object.keys(a.overlaps).length>0?(t&&this.doNotify("Overlaps!-Balance Not Used!","negative","top"),this.handleOverlaps(a.overlaps,"onPickEvt")):this.doNotify("Error? onPickEvt :(","negative","bottom"),this.reset()};let l=this.isViewingPast()?!0:e,r=o!=i.duration,s=this.daSchedule.tooClose(this.targetDrop.timestamp,r?o:i.duration);if(s){if(s===!0){this.doNotify("Picking event TOO close to midnight!"),this.reset();return}console.log("onPickEvent::tooClose OVERLAP?",JSON.stringify(s));let a=s==null?void 0:s.overlap,c=s==null?void 0:s.tooClose;if(a.length>0||c.length>0)if(console.log("onPickEvent::tooClose close",a.length,c.length),l)this.doNotify(`'${i.title.trim()}' TOO close Buuut..FORCING!`,"warning","top");else{this.withActionNotify(`'${i.title.trim()}' TOO close to an Evt!!`,function(){console.log("onPickEvent::Force eh"),n()});return}}n()},onAddyHocEvent(i,e,t,o,n,l){var g;if(i.trim()==""){this.doNotify("Empty Goal title..."),this.closingDialog(),this.reset();return}let r=this.selectedTimeRange();console.log("onAddyHocEvent >>",i,l,o,JSON.stringify(r));let s=null,a=0;this.possibleRange?r?(s=st((g=r==null?void 0:r.start)!=null?g:this.startEndTimes[0]),a=l?o:r.duration):console.log("onAddyHocEvent::ERROR for range selection"):(console.log("umm onAddyHocEvent... not a range selection: "+l,o,this.startEndTimes),s=st(this.startEndTimes[0]),a=o),this.closingDialog();const c=()=>{let C=this.daSchedule.saveNewGoal(s,i,e,t,a);return console.log("onAddyHocEvent::doSaveGoooooal "+C,s.time),this.doNotify(`AdHoc Evt '${i}' Stored!`,"positive","top"),C};let m=()=>{this.closingDialog(),this.constructTree(),this.reset(),this.mobile&&this.adjustCurrentTime()};const h=()=>{let C=c();if(C===0||C){let y=this.daSchedule.onAdHocEvent(C,s,n,this.doNotifyTimeout);if(!y.canContinue)if(console.log("onAddyHocEvent::OVERLAPS?",JSON.parse(JSON.stringify(y))),y.overlaps==null){this.doNotify("Error Adding this event :(","negative"),console.log("onAddyHocEvent::ERROR not found?");return}else return n&&this.doNotify("Overlaps!-Balance Not Used!","warning","top"),m(),this.handleOverlaps(y.overlaps,"adHocEvt");m();return}else console.log("onAddyHocEvent::BOO ERROR no subID :(",C),this.doNotify("Error adding :(  Add Evt by select!","negative"),m()};let T=this.daSchedule.tooClose(s,a);if(T){if(T===!0){this.doNotify(`'${i}' Not added as over midnight!`),this.closingDialog(),this.reset();return}console.log("onAddyHocEvent::tooClose OVERLAP?",JSON.stringify(T));let C=T==null?void 0:T.overlap,y=T==null?void 0:T.tooClose;if(C.length>0||y.length>0){if(C.filter(D=>D.surround==!0)){this.withActionNotify(`'${i}' Surround a Scheduled Evt!! Dismiss to Save...`,function(){h()},null,null,function(){c(),m()});return}this.doNotify(`'${i}' too close to a scheduled Evt--Forcing!!`,"warning"),h();return}}h()},onEndNow(i){const e=()=>{let r=this.daSchedule.findSchedEvent(i);this.daSchedule.removeScheduledEvt(r),this.doNotify(`Removing "${r==null?void 0:r.title.trim()}" and Saving...`,"info"),this.doSaveSchedule()},t=r=>{this.daSchedule.reduceEvtDuration(i,r),this.doNotify("Reducing and Saving...","info")},o=r=>{const s=Ce(new Date);let a=r.start,c=r.end;if(!Bt(s,a,c,!0))return console.log("onEndNow::ERROR >> not in the middle of event?!? Nothing to do...",s.time,a.time,c.time,r),!1;let m=q(s,{minute:0}),h=he(a,m);return Math.floor(h/1e3/60)};let n=this.daSchedule.findSchedEvent(i);if(!n){console.log("onEndNow::ERROR Evt not found!!!",i,n),this.doNotify("Error evt not in schedule?!","negative");return}let l=o(n);l?l<10?this.confirmAction("",`Less than 10mins remove?
 Cancel to just EndNow`,"Remove",e,function(){t(l)}):t(l):console.log("onEndNow...END",i,l,Number.isInteger(l))},onUpdateNoteScorey(i,e,t=""){let o=Pe(e);if(o<-1){o==-89?(console.log("onUpdateNoteScorey parsing error",o,e),this.doNotify("Score Parsing Error... YOU FOO! ")):this.doNotify("Score Error: higher# on lower#");return}this.daSchedule.updateNoteScore(i,e,t),t!==""&&!this.isViewingPast()&&this.doNotify("Note added...do Save eh!","warning","bottom")},onAddMins(i,e){let t=this.daSchedule.addMinsToEvt(i,e,this.doNotify);if(!t.canContinue){if(t.overlaps&&Object.keys(t.overlaps).length>0)return this.doNotify("Bumped into some Evts","warning","top"),this.movedIntoConflict(t.overlaps,!0,"onAddMins",e);this.doNotify("Add ERROR:(","negative","bottom")}},removeEvtInSchedule(i,e=!0){let t=!1,o=()=>{if(this.daSchedule.removeScheduledEvt(i),t||e){e&&(this.daSchedule.addToBalance(i),this.doNotify(`Balance change after removing '${i.title}'`,"warning","top")),this.doSaveSchedule(),s?this.daSchedule.removeScheduledNotif(i.id):console.log("removeEvtInSchedule::Evt Wasnt Saved so no notif removal");return}this.daSchedule.toggleActionBtns(!0,"view")},n=()=>{console.log("Cancelled remove.."),this.reset()},l=()=>this.chooseAlternatives(i);if(this.isViewingPast()){if(i.duration<30){this.doNotify("Removing from the past... Check BALANCE!"),this.daSchedule.addToBalance(i),t=!0,o();return}this.chooseAlternatives(i);return}if(!this.isViewingToday()&&!this.mobile){t=this.daSchedule.getCurrentMoods()[i.id],console.log("Removing future evt"),o();return}let r=`Remove "${i.title}" ?`,s=this.daSchedule.getStoredRawEvt(i.id),a=this.daSchedule.getCurrentMoods()[i.id];a&&(t=!!s,r=r+` With Moods: '${a}'`),s||(e=!1);let c=e?"Remove (Balance affected)":"Schedule Change";i.duration>=30&&e?this.confirmCancelAction(c,r+` 
 Or choose an alternative?`,"Remove","Choose",o,l):this.confirmAction(c,r,"Remove",o,n)},defaultScheduleByOpts(){return[{label:"Filter out of current scheduled Evts",value:"filter"},{label:"Add Evts to current schedule",value:"add"},{label:"Reset current schedule",value:"reset"}]},betterEvtLabel(i,e,t=null){const o=(l,r)=>{if(l!=null&&l.parentGoal){let s=this.daSchedule.parentGoalById(l.parentGoal);return r?`Of '${s==null?void 0:s.title.trim()}' (${s==null?void 0:s.priority})`:`Of '${s==null?void 0:s.title.trim()}'`}return console.log("prioLabel..ERROR no PARENT found?",l),""};let n="";switch(e){case"score":return n=`${o(i,!1)} > "${i.title.trim()}" with Score:: ${i.score} = ${Pe(i.score)} `,n+=t?`@ ${j(i==null?void 0:i.time)} ++ ${i==null?void 0:i.duration} mins`:`for ${i==null?void 0:i.duration} mins`,{label:n,value:i.id};case"prio":return n=`"${i.title.trim()}" ${o(i,!1)} `,n+=t?`@ ${j(i==null?void 0:i.time)} ++ ${i==null?void 0:i.duration} mins`:`for ${i==null?void 0:i.duration} mins`,{label:n,value:i.id};default:return n=`"${i.title.trim()}" ${o(i,!0)} && Score:: ${i.score} = ${Pe(i.score)} ${t?` @ ${j(i==null?void 0:i.time)} ++ ${i==null?void 0:i.duration} mins`:`for ${i.duration} mins`}`,{label:n,value:i.id}}},getLargestScoreInterval(i){let e=0,t=null;for(let o of i){let n=Pe(o.score);n>-1&&n>=e&&(e=n,t=o)}return t},expandAll(){for(let i of this.treeGoals)this.expanded[i.label]=!0},getSmallestScoreInterval(i){let e=9,t=null;for(let o of i){let n=Pe(o.score);n>-1&&n<=e&&(e=n,t=o)}return t},findhighestPrio(i){let e=0,t=null;for(let o of i)if(o.parentGoal){let n=this.daSchedule.parentGoalById(o.parentGoal);n?n.priority>e&&(e=n.priority,t=o):console.log("findhighestPrio::ERROR no PARENT found?",o)}else console.log("findhighestPrio::ERROR EVT not found?",o);return{e:t,prio:e}},chooseAlternatives(i){let e=this.daSchedule.getAlternatives(),t=Ce(new Date),o=i.time,n=t.date,l=i.title,r=this.isViewingToday();const s=g=>g.filter(C=>!this.daSchedule.getScheduledEvts().has(C.id)),a=g=>{let C=q(ge(n),{day:r?1:0}),y=q(ge(C.date),{day:1}),S=this.daSchedule.getEventsForDate(C.date),D={},p=null;S?D=S:console.log("chooseAlternatives::addInFutur EMPTY for >>...",C.date),g.forEach(d=>{if(p=this.daSchedule.getSubGoalByID(d),D[d]){console.log("addInFutur...ALREADY PRESENT",d,C.date,p==null?void 0:p.title.trim()),this.doNotify(`Alternative '${p==null?void 0:p.title.trim()}' already present on ${C.date}. Moving it to next day`,"warning");let b=this.daSchedule.getEventsForDate(y.date);if(b)if(!b[d])b[d]={duration:p==null?void 0:p.duration,time:o,notes:`Alt replace for '${l}'`};else{console.log("addInFutur...STILL PRESENT in next day:"+y.date,p.title.trim()),this.doNotify(`Booo! Alt '${p==null?void 0:p.title.trim()}' also present on ${y.date} :(( ...Check BALANCE!`),this.daSchedule.addToBalance(p);return}else b={},b[d]={duration:p.duration,time:o,notes:`Alt replace for '${l}'`};this.daSchedule.updateDaySchedule(y.date,b),this.doNotify(`Saving ${p.title} in ${y.date}`,"info","bottom")}else D[d]={duration:p.duration,time:o,notes:`Alt replace for '${l}'`}}),this.daSchedule.updateDaySchedule(C.date,D)},c=g=>{this.daSchedule.removeScheduledEvt(i);let C=e.find(D=>D.id==g);console.log("remReplace...Add at:",o,C.title,"usually at:"+C.time);let y=this.daSchedule.addGoalsToSchedule([{...C,time:o,notes:`Alt replace for '${l}'`}],!0),S=Object.keys(y).length;if(S>0)return console.log(`chooseAlternatives::removeReplace:: OVERLAPS again from ${C.length} overlaps =${S}`,C,y),this.doNotify(`Extra Overlaps while adding ${C.title.trim()}`,"negative"),this.handleOverlaps(y,"alts");this.daSchedule.saveDaySchedule(),this.doNotify(`Added Alt replacement '${C==null?void 0:C.title}' at ${o}`,"info")},m=g=>{this.doNotify(g)},h=()=>{this.daSchedule.removeScheduledEvt(i),this.daSchedule.addToBalance(i),this.doNotify(`Balance change after removing '${i.title}'`,"warning","top"),this.doSaveSchedule()};if(e=s(e),e.length==0){this.withActionNotify("...Alternatives already present!",h);return}let T=`First Evt to replace Removed ${r?"(today)":""} + an Extra evt for next day! ${r?"":"(today)"}`;this.checkBoxDialog(`Alternative for '${l}'`,T,e.map(g=>this.betterEvtLabel(g,"default",!1)),function(g){console.log("chooseAlternatives::opt",g),c(g.shift()),g.length>0?a(g):(console.log("chooseAlternatives::onOk...nothing to add?!?",e.length,g.length,e.length-g.length),m("No Alternative scheduled later :("))},function(){console.log("chooseAlternatives::onCancel")})},reset(){this.selectedItem=null,this.targetDrop=null,this.touchedItem=null,this.daSchedule.resetChosen(),this.possibleRange=null},doCleanup(){this.lastTarget&&(this.lastTarget.style.background="",this.lastTarget=null)},closeDialogWithReset(){console.log("closeDialogWithReset"),this.showEvtDialog=!1,this.selectedItem=null,this.targetDrop=null,this.touchedItem=null,this.possibleRange=null},closingDialog(){if(this.showEvtDialog=!1,!this.anchorTimestamp||!this.otherTimestamp){console.log("closingDialog NULL TIMEYS",JSON.stringify(this.anchorTimestamp),JSON.stringify(this.otherTimestamp));return}fe(this.anchorTimestamp)!=fe(this.otherTimestamp)&&(this.anchorTimestamp=null,this.otherTimestamp=null,this.possibleRange=null)},doLog(i,e){console.log(i,JSON.parse(JSON.stringify(e)))},onPrev(){let i=()=>{this.$refs.calendar.prev(),this.adjustCurrentTime()},e=()=>{setTimeout(i,1e3),this.doSaveSchedule()};this.saveScheduleDisabled?i():this.confirmAction("",`Save changes of day: ${this.currentDate} ?`,"Save",e,i)},onToday(){let i=()=>{this.$refs.calendar.moveToToday(),this.adjustCurrentTime()},e=()=>{setTimeout(i,1e3),this.doSaveSchedule()};this.saveScheduleDisabled?i():this.confirmAction("",`Save changes of day: ${this.currentDate} ?`,"Save",e,i)},onNext(){let i=()=>{this.$refs.calendar.next(),this.adjustCurrentTime()},e=()=>{setTimeout(i,1e3),this.doSaveSchedule()};this.saveScheduleDisabled?i():this.confirmAction("",`Save changes of day: ${this.currentDate} ?`,"Save",e,i)},onChange(){let i=this.daSchedule.onChangeViewDate(this.currentDate);if(!i.canContinue){if(i.overlaps&&i.overlaps.length>0)return this.handleOverlaps(i.overlaps,"view");this.doNotify(`Loaded schedule for ${this.currentDate}`,"positive"),this.adjustCurrentTime()}},onDragStart(i,e,t){if(this.isViewingPast()&&e!="tree-item"){this.doNotifyCaption("Editing past is a no no!","Use Drag & Drop from Tree or manually add Evts"),i.preventDefault();return}if(e=="tree-item"){let o=this.daSchedule.getSubGoalByID(t.id);this.selectedItem={evt:{...o,color:t.color},type:e};return}this.selectedItem={evt:t,type:e}},onDragEnter(i,e,t){var o;if(e==="goal-item")i.preventDefault();else{if(this.targetDrop&&this.targetDrop.timestamp.time==t.timestamp.time)console.log("onDragEnter...calendar,SAME",this.targetDrop.timestamp.time);else{let n=i.target,l=(o=this.selectedItem.evt.bgcolor)!=null?o:this.selectedItem.evt.color;n.style.background=_e(l),this.lastTarget=n}this.targetDrop=t,i.preventDefault()}return!0},onDragOver(i,e,t){return i.preventDefault(),!0},onDragLeave(i,e,t){let o=i.target;return o.style.background="",!1},onDragEnd(i){},onDrop(i,e,t){let o=null;if(e==="interval")o=t.timestamp;else if(e==="goal-item"&&this.targetDrop)o=this.targetDrop.timestamp;else{console.log("Cannot drop here YO!!",i,e,t,this.targetDrop);return}if(!o){console.log("ERROR...no timestamp YO!!",i,e,t,this.targetDrop);return}this.doDroppy(o,this.selectedItem)},onClickTime(i){this.targetDrop=i.scope,this.showEvtDialog=!0},onClickDate(i){console.log("onClickDate",i)},onClickInterval(i){console.log("onClickInterval",i)},onClickHeadIntervals(i){console.log("onClickHeadIntervals",i)},onClickHeadDay(i){console.log("onClickHeadDay",i)},onMouseDownTime({scope:i,event:e}){if(si(e)){if(this.mobile===!0&&this.anchorTimestamp!==null&&this.otherTimestamp!==null&&fe(this.anchorTimestamp)===fe(this.otherTimestamp)){this.otherTimestamp=i.timestamp,this.mouseDown=!1;return}this.mouseDown=!0,this.anchorTimestamp=i.timestamp,this.otherTimestamp=i.timestamp}},onMouseUpTime({scope:i,event:e}){if(this.mobile!==!0&&si(e)&&(this.otherTimestamp=i.timestamp,this.mouseDown=!1),!this.mousedown){let t=this.startEndTimes;if(t[1]==t[0])return;this.possibleRange=t,console.log("onMouseUpTime range change",this.possibleRange)}},onMouseMoveTime({scope:i,event:e}){this.mobile!==!0&&this.mouseDown===!0&&(this.otherTimestamp=i.timestamp)},onDblClickEvent(i,e){if(this.isViewingPast()){if(console.log("onDblClickEvent::ERROR?",e),e.duration<30){console.log("onDblClickEvent..baah too smoll smoll",e.title,e.duration),this.doNotify("umm Removing from the past..Soo Check BALANCE!"),this.daSchedule.addToBalance(e),this.daSchedule.removeScheduledEvt(e);return}this.chooseAlternatives(e),i.preventDefault();return}this.removeEvtInSchedule(e,!1),i.preventDefault()},onTouchHStart(i,e,t){if(e=="tree-item"){let o=this.daSchedule.getSubGoalByID(t.id);return console.log("onTouchHStart::TreeItem "+e,JSON.parse(JSON.stringify(t)),JSON.parse(JSON.stringify(o))),this.selectedItem={evt:{...o,color:t.color},type:e},i.preventDefault(),!0}return this.selectedItem={evt:t,type:e},i.target.classList.add("my-header-drag"),this.touchedItem=i.target,i.preventDefault(),!0},onTouchStart(i,e,t){if(i.type=="touchstart"){this.selectedItem={evt:t,type:e};let o=document.elementFromPoint(i.changedTouches[0].clientX,i.changedTouches[0].clientY);if(o.parentNode.classList.contains("my-event"))o.parentNode.classList.add("my-event-drag"),this.touchedItem=o;else if(o=o.parentNode,o.parentNode.classList.contains("my-event"))o.parentNode.classList.add("my-event-drag"),this.touchedItem=o;else{this.touchedItem=!1,console.log("onTouchStart:ERROR...Btn?",o,o.parentNode);return}return i.preventDefault(),!0}console.log("onTouchStart::ERROR...UNKNOWN",i)},onTouchHEvt(i,e){var t;if(i.type=="touchmove"){let o=document.elementFromPoint(i.changedTouches[0].clientX,i.changedTouches[0].clientY);if(o.ariaLabel){let n=this.getLabelTime(o.ariaLabel);if(this.targetDrop){let l=he(this.targetDrop,n);if(JSON.stringify(this.targetDrop)===JSON.stringify(n)&&l==0)return;let s=(t=this.selectedItem.evt.bgcolor)!=null?t:this.selectedItem.evt.color;this.lastTarget?(this.lastTarget.style.background="",o.style.background=_e(s),this.lastTarget=o):(this.lastTarget=o,o.style.background=_e(s))}this.targetDrop=n}return i.preventDefault(),!0}if(i.type=="touchend"){let o=document.elementFromPoint(i.changedTouches[0].clientX,i.changedTouches[0].clientY);if(this.touchedItem.classList.contains("my-header-drag")?this.touchedItem.classList.remove("my-header-drag"):console.log("onTouchHEvt::touchend>>No Header?!?",this.touchedItem),o.ariaLabel){let n=this.getLabelTime(o.ariaLabel);this.targetDrop=n,this.doDroppy(this.targetDrop,this.selectedItem)}else this.targetDrop&&this.doDroppy(this.targetDrop,this.selectedItem);i.preventDefault(),i.stopPropagation();return}console.log("onTouchHEvt::UNKNOWN",i)},resetDraggedItem(i){if(!i){console.log("resetDraggedItem::ERROR::ERROR?",i);return}let e=i.closest(".my-event");e.classList.contains("my-event-drag")&&e.classList.toggle("my-event-drag")},onTouchEvt(i,e){var t;if(!this.selectedItem){console.log("onTouchEvt NULL Item >>ERROR?!? "+i.type,this.selectedItem,this.touchedItem);return}if(this.isViewingPast()){this.doNotify("Editing past is a no no!"),this.resetDraggedItem(this.touchedItem),i.preventDefault(),i.stopPropagation();return}if(i.type=="touchmove"){let o=document.elementFromPoint(i.changedTouches[0].clientX,i.changedTouches[0].clientY);if(o&&o.ariaLabel){let n=this.getLabelTime(o.ariaLabel);if(this.targetDrop){let l=he(this.targetDrop,n);if(JSON.stringify(this.targetDrop)===JSON.stringify(n)&&l==0)return;let s=(t=this.selectedItem.evt.bgcolor)!=null?t:this.selectedItem.evt.color;this.lastTarget?(this.lastTarget.style.background="",o.style.background=_e(s),this.lastTarget=o):(this.lastTarget=o,o.style.background=_e(s))}this.targetDrop=n,i.preventDefault();return}return}if(i.type=="touchend"){let o=document.elementFromPoint(i.changedTouches[0].clientX,i.changedTouches[0].clientY);if(!this.touchedItem)return;if(o.parentNode.classList.contains("my-event-drag"))console.log("onTouchEvt::END >>removing my-event-drag","isDisabledScoreEdit>> "+this.daSchedule.isDisabledScoreEdit[e.id],"mobileEnableScore>> "+this.daSchedule.mobileEnableScore[e.id]),o.parentNode.classList.remove("my-event-drag");else{let n=this.touchedItem.parentNode.classList.contains("my-event-drag");n?this.touchedItem.parentNode.classList.remove("my-event-drag"):console.log("onTouchEvt::END...target NO my-event-drag?",n,o,o.parentNode)}if(o.ariaLabel){let n=this.getLabelTime(o.ariaLabel);this.targetDrop=n,this.doDroppy(this.targetDrop,this.selectedItem)}else(o.classList.contains("title")||o.classList.contains("my-event"))&&this.targetDrop&&this.doDroppy(this.targetDrop,this.selectedItem);i.preventDefault(),i.stopPropagation();return}console.log("onTouchEvt::UNKNOWN",i)},getLabelTime(i){let e=i.split(" "),t=e[e.length-2],o=q(ge(this.currentDate),{minute:ee(t)});return e[e.length-1]=="PM"?o.hour==12?o:q(ge(this.currentDate),{hour:12,minute:ee(t)}):o.hour==12?q(ge(this.currentDate),{hour:-12,minute:ee(t)}):o},onTouchHold({evt:i,...e},t){if(!this.mobile)return console.log("onTouchHold>>NOT MOBILE",i.type,"mobileEnableScore>> "+this.daSchedule.mobileEnableScore[t.id]),!0;let o=document.elementFromPoint(i.changedTouches[0].clientX,i.changedTouches[0].clientY);this.daSchedule.toggleEvtNoteScoreMobile(t.id);let n=o.closest(".my-event");o.classList.contains("title")&&o.parentNode.classList.contains("my-event-drag")?o.parentNode.classList.remove("my-event-drag"):n&&n.classList.contains("my-event-drag")?n.classList.toggle("my-event-drag"):this.touchedItem&&(n=this.touchedItem.closest(".my-event"),n&&n.classList.contains("my-event-drag")?n.classList.toggle("my-event-drag"):console.log("ERROR...onTouchHold--class not found on Target!!",o,this.touchedItem)),this.daSchedule.isDisabledScoreEdit[t.id]&&!this.daSchedule.mobileEnableScore[t.id]&&this.onDblClickEvent(i,t)},scrollToEvent(i){this.$refs.calendar.scrollToTime(i.time,350)},scrollToTime(i,e=null){var t;if(this.$refs.calendar){let o=q(i,{minute:-10});(t=this.$refs.calendar)==null||t.scrollToTime(o.time,e?e=="fast"?400:1e3:500)}else setTimeout(()=>{console.log("scrollToTime::NO SCROLLY at",i.time,"Trying again...."),this.scrollToTime(i,"slow")},1e3)},confirmTimeChange(i,e,t,o,n,l,r=null){this.$q.dialog({title:i,message:e,cancel:"Cancel",ok:t,options:{type:"radio",model:"",items:[{label:t+" and "+o,value:"ok"},{label:o,value:"alt"}]},class:"overflow-wrap: break-word;",style:""}).onOk(s=>{if(s==""){console.log("confirmTimeChange onOk with no selection >>onDismiss"),this.doNotify("No selection made...Leaving as is","info"),r?r():console.log("confirmTimeChange:: No Dismiss func to execute!");return}return n(s)}).onCancel(()=>{l()})},radioChoiceDialog(i,e,t,o,n=null,l=null,r=null){this.$q.dialog({title:i,cancel:!!l,persistent:!0,message:e,seamless:!0,options:{type:"radio",model:o,items:t}}).onOk(s=>{n&&(s===""?this.radioChoiceDialog(i,e,t,o,n,l,r):n(s))}).onCancel(()=>{l&&l()}).onDismiss(()=>{r&&r()})},checkBoxDialog(i,e,t,o=null,n=null,l=null){let r=t.length,s=r>2?2:r;this.$q.dialog({title:i,message:e,options:{type:"checkbox",model:[],isValid:a=>a.length>0&&a.length>=s,items:t},cancel:!0,persistent:!0,class:"overflow-wrap: break-word;",style:""}).onOk(a=>{o(a)}).onCancel(()=>{n&&n()}).onDismiss(()=>{l&&l()})},confirmChoiceDialog(i,e,t,o,n=null,l=null,r=null){this.$q.dialog({title:i,cancel:!!l,persistent:!0,message:e,options:{type:"radio",model:o,items:t}}).onOk(s=>{n&&(s===""?this.confirmChoiceDialog(i,e,t,o,n,l,r):n(s))}).onCancel(()=>{l&&l()}).onDismiss(()=>{r&&r()})},scheduleByDialog(i,e,t,o,n=null,l=null,r=null){this.$q.dialog({component:Lo,componentProps:{title:i,message:e,options:t,selectedO:o}}).onOk(s=>{n&&(s.choice==""?this.scheduleByDialog(i,e,t,o,n,l,r):n(s))}).onCancel(()=>{l&&l()}).onDismiss(()=>{r&&r()})},confirmAction(i,e,t,o,n,l=null){this.$q.dialog({title:i,cancel:!0,ok:t,message:e,multiLine:!0}).onOk(()=>{o()}).onCancel(()=>{n()}).onDismiss(()=>{if(l){l();return}})},confirmCancelAction(i,e,t,o,n,l,r=null){this.$q.dialog({title:i,cancel:o,ok:t,message:e}).onOk(()=>{n()}).onCancel(()=>{l()}).onDismiss(()=>{if(r){r();return}})},doNotifyTimeout(i,e=void 0,t="top",o=null){this.$q.notify({color:e!==void 0?e:"negative",position:t,message:i,icon:e==null?"report_problem":"thumb_up",timeout:o||5e3,multiLine:!0,classes:"myNotification"})},doNotify(i,e=void 0,t="top"){this.$q.notify({color:e!==void 0?e:"negative",position:t,message:i,multiLine:!0,timeout:2e3,icon:e==null?"report_problem":"thumb_up",classes:"myNotification"})},doNotifyCaption(i,e,t=void 0,o="top"){this.$q.notify({color:t!==void 0?t:"negative",position:o,message:i,caption:e,multiLine:!0,icon:t==null?"report_problem":"thumb_up",classes:"myNotification"})},withActionNotify(i,e=null,t=null,o=null,n=null){this.$q.notify({color:t||"negative",position:o||"top",message:i,icon:t?"thumb_up":"report_problem",classes:"myNotification",multiLine:!0,actions:[{label:"Force?",color:"yellow",handler:()=>{e?e():console.log("withActionNotify::ActionHandler::NOTHING...")}},{label:"Dismiss",color:"grey",handler:()=>{n?n():console.log("withActionNotify::dismissHandler::NOTHING...")}}]})}}},zo={class:"subcontent"},Fo={class:"row justify-center"},Go={key:0,class:"q-gutter-md q-pa-sm bg-grey-12"},qo={class:"q-mr-sm text-weight-bold",size:"28px"},Vo=["onDragstart"],Ho={class:"text-weight-bold"},Wo={key:1,class:"text-weight-light text-black"},Uo={class:"instru"},jo={class:"q-pa-md relative-position forMobile"},Jo={class:"q-ma-xs"},Qo={key:0,class:"row q-px-md"},Ko={class:"row justify-center"},Yo={style:{display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"2px","margin-bottom":"5px"}},Xo=["onDragstart","onTouchstart","onTouchmove","onTouchend"],Zo=["onDblclick","onDragstart","onTouchstart","onTouchmove","onTouchend"];function el(i,e,t,o,n,l){const r=Te("scheduleDayLabel"),s=Te("actionBtns"),a=Te("sched-btn"),c=Te("da-instructions"),m=Te("navigation-bar"),h=Te("goaly-end"),T=Te("mobileNoteScore"),g=Te("q-calendar-day"),C=Te("sched-dialog");return W(),oe(Wi,{padding:""},{default:_(()=>[Q("div",zo,[I(Vt,{modelValue:n.splitterPage,"onUpdate:modelValue":e[21]||(e[21]=y=>n.splitterPage=y),limits:l.splitterLimits},_i({before:_(()=>[I(Vt,{modelValue:n.splitterLegend,"onUpdate:modelValue":e[6]||(e[6]=y=>n.splitterLegend=y),horizontal:"",limits:[20,80],style:{height:"100%"}},{before:_(()=>[I(r,{doShow:n.treeGoals.length>0,balanceLabel:l.labelBalance(),scheduleLabel:l.labelScheduled()},null,8,["doShow","balanceLabel","scheduleLabel"]),I(s,{scoreOptions:n.scoreOptions,allMainGPrio:l.allMainGPrio(),defaultBtnLabel:l.defaultBtnLabel,onScoreBtnLabel:l.chosenScoreLabel,onPrioBtnLabel:l.chosenPrioLabel,showReloadBtn:l.scheduleProps.showReloadBtn,showClearBtn:l.scheduleProps.showClearBtn,showActionBtns:l.doShowActionBtns,showTree:n.showTree,inMobile:n.mobile,isDefaultBtnEnabled:l.isDefaultBtnEnabled,isScoreBtnDisabled:l.scheduleProps.disableScoreBtn,isPrioBtnDisabled:l.scheduleProps.disablePrioBtn,onOnReloadSaved:l.onReloadSaved,onOnClearDay:l.onClearDay,onOnLoadDefaults:l.onLoadDefault,onDoReloadWithScore:e[0]||(e[0]=(y,S)=>l.doReload("score",y,S)),onDoReloadWithPrio:e[1]||(e[1]=(y,S)=>l.doReload("prio",y,S)),onOnChoosenScore:l.onChoosenScore,onOnChoosenPrio:l.onChoosenPrio,onOnScheduleOneEach:l.onScheduleOneEach,onDoHideTree:e[2]||(e[2]=()=>n.showTree=!n.showTree)},null,8,["scoreOptions","allMainGPrio","defaultBtnLabel","onScoreBtnLabel","onPrioBtnLabel","showReloadBtn","showClearBtn","showActionBtns","showTree","inMobile","isDefaultBtnEnabled","isScoreBtnDisabled","isPrioBtnDisabled","onOnReloadSaved","onOnClearDay","onOnLoadDefaults","onOnChoosenScore","onOnChoosenPrio","onOnScheduleOneEach"]),Q("div",Fo,[I(a,{"text-label":"SaveSchedule",class:"q-mt-md","text-color":l.saveScheduleDisabled?"grey":"blue",disable:l.saveScheduleDisabled,onDoBtnAction:l.doSaveSchedule,push:"",dense:!1},null,8,["text-color","disable","onDoBtnAction"]),n.showTree||l.isViewingPast()?(W(),oe(a,{key:0,"text-label":n.showTree?"HideTree":"ShowTree",class:"q-mt-md","text-color":"green",onDoBtnAction:e[3]||(e[3]=()=>{n.showTree&&l.resetFilter(),n.showTree=!n.showTree}),push:"",dense:!1},null,8,["text-label"])):se("",!0)]),e[22]||(e[22]=Q("br",null,null,-1))]),after:_(()=>[l.showTreeForm?(W(),ae("div",Go,[I(Fi,{overline:"",header:"",lines:"3"},{default:_(()=>[ye(de(l.isViewingPast()?"Drag&Drop /":"Filter by Mood /")+" Expand & Hover for Moods ",1)]),_:1}),l.isViewingPast()?se("",!0):(W(),oe(Gi,{key:0,label:l.isViewingPast()?"No Filter In Past BUT Can Drag&Drop!!":"je-suis",hint:"Keyword >> Enter","hide-hint":"",ref:"filterRef",modelValue:n.filter,"onUpdate:modelValue":e[4]||(e[4]=y=>n.filter=y),"use-input":"","use-chips":"",multiple:"",disable:l.isViewingPast(),"hide-dropdown-icon":"","input-debounce":"0","new-value-mode":"add-unique",class:"q-gutter-sm"},{"selected-item":_(y=>[I(qi,{removable:"",dense:"",onRemove:S=>y.removeAtIndex(y.index),tabindex:y.tabindex,"text-color":"black",class:"q-ma-none",style:{width:"80px"}},{default:_(()=>[ye(de(y.opt),1)]),_:2},1032,["onRemove","tabindex"])]),append:_(()=>[n.filter.length>0?(W(),oe(wt,{key:0,name:"clear",class:"cursor-pointer",onClick:l.resetFilter},null,8,["onClick"])):se("",!0)]),_:1},8,["label","modelValue","disable"])),I(ji,{nodes:n.treeGoals,"node-key":"label",filter:l.filterString,"filter-method":l.myFilterMethod,expanded:n.expanded,"onUpdate:expanded":e[5]||(e[5]=y=>n.expanded=y),"no-connectors":"",dense:""},{"default-header":_(y=>[Q("div",{class:je(l.classyColor(y.node))},[y.node.isChildren?se("",!0):(W(),oe(wt,{key:0,name:y.expanded?"expand_less":"expand_more",size:"28px",right:""},null,8,["name"])),Q("div",qo,de(y.node.label),1),I(wt,{name:y.node.icon},null,8,["name"])],2)]),"default-body":_(y=>[y.node.isChildren?(W(),ae("div",{key:0,draggable:!0,style:{cursor:"grab"},onDragstart:ke(S=>l.onDragStart(S,"tree-item",y.node),["stop"])},[Q("span",Ho," >> "+de(y.node.details),1),y.node.moods.length>0?(W(),oe(Rt,{key:0},{default:_(()=>[ye(de("Moods::> "+y.node.moods.join(",")),1)]),_:2},1024)):se("",!0)],40,Vo)):(W(),ae("span",Wo,de(y.node.details),1))]),_:1},8,["nodes","filter","filter-method","expanded"]),e[23]||(e[23]=Q("br",null,null,-1)),n.filter.length>0?(W(),oe(a,{key:1,"text-label":"Add Mood Evts",class:"q-mt-xl sched-btn","text-color":"red",onDoBtnAction:l.onMoodAdd},null,8,["onDoBtnAction"])):se("",!0)])):se("",!0)]),_:1},8,["modelValue"]),Q("div",Uo,[I(ui,{modelValue:n.showInstru,"onUpdate:modelValue":e[7]||(e[7]=y=>n.showInstru=y),label:n.showInstru?"Hide Instructions":"Show Instructions",color:"teal",class:"q-pa-md q-mx-xl",align:"center"},null,8,["modelValue","label"]),n.showInstru?(W(),oe(c,{key:0,showRemInstru:l.showRemInstru,showSchedInstru:l.showSchedInstru},null,8,["showRemInstru","showSchedInstru"])):se("",!0)])]),after:_(()=>[Q("div",jo,[I(oo,{position:"top-left",offset:n.fabPos},{default:_(()=>[ze(I($e,{class:je(l.fabClass),fab:"",size:"md",icon:"legend_toggle",align:"evenly",onClick:l.nextMorph,disable:n.draggingFab},null,8,["class","onClick","disable"]),[[Pt,n.morphGroupModel,"btn:mygroup:300",{resize:!0}],[ct,l.moveFab,void 0,{prevent:!0,mouse:!0}]]),ze((W(),oe(At,{class:"q-ma-md bg-grey",style:{width:"59%","border-top-left-radius":"2em"}},{default:_(()=>[I(r,{doShow:n.treeGoals.length>0,balanceLabel:l.labelBalance(),scheduleLabel:l.labelScheduled(),hasUnsaved:l.hasUnsavedChanges()},null,8,["doShow","balanceLabel","scheduleLabel","hasUnsaved"]),I(ht,{align:"around"},{default:_(()=>[I($e,{outline:"",push:"","no-caps":"","no-wrap":"",onClick:l.morphClose,icon:"close",color:"red",align:"between",class:"q-mx-xs"},null,8,["onClick"]),I($e,{elevated:"",push:"",onClick:l.nextMorph,"no-caps":"","no-wrap":"",align:"between",class:"q-mx-xs"},{default:_(()=>e[24]||(e[24]=[ye("Actions >")])),_:1},8,["onClick"])]),_:1}),I(ht,{align:"center"},{default:_(()=>[I($e,{label:"SaveSchedule",color:"","text-color":"white",align:"between",class:"q-mt-md",elevated:"",push:"",dense:!1,"no-wrap":"","no-caps":"",onClick:e[8]||(e[8]=ke(()=>{l.doSaveSchedule(),l.morphClose()},["prevent"]))})]),_:1})]),_:1})),[[Pt,n.morphGroupModel,"card1:mygroup:500",{tween:!0}]]),ze((W(),oe(At,{class:"q-ma-xs",style:{width:"fit-content","border-top-left-radius":"2em"}},{default:_(()=>[e[26]||(e[26]=Q("div",{class:"text-center text-subtitle2 q-ma-sm"}," Reload By ",-1)),I(dt,{color:"red",inset:""}),Q("div",Jo,[I(s,{scoreOptions:n.scoreOptions,allMainGPrio:l.allMainGPrio(),defaultBtnLabel:l.defaultBtnLabel,onScoreBtnLabel:l.chosenScoreLabel,onPrioBtnLabel:l.chosenPrioLabel,showReloadBtn:l.scheduleProps.showReloadBtn,showClearBtn:l.scheduleProps.showClearBtn,showActionBtns:l.doShowActionBtns,showTree:n.showTree,inMobile:n.mobile,isDefaultBtnEnabled:l.isDefaultBtnEnabled,isScoreBtnDisabled:l.scheduleProps.disableScoreBtn,isPrioBtnDisabled:l.scheduleProps.disablePrioBtn,onOnReloadSaved:e[9]||(e[9]=()=>{l.onReloadSaved(),l.morphClose()}),onOnClearDay:e[10]||(e[10]=()=>{l.onClearDay(),l.morphClose()}),onOnLoadDefaults:e[11]||(e[11]=()=>{l.onLoadDefault(),l.morphClose()}),onDoReloadWithScore:e[12]||(e[12]=(y,S)=>{l.doReload("score",y,S),l.morphClose()}),onDoReloadWithPrio:e[13]||(e[13]=(y,S)=>{l.doReload("prio",y,S),l.morphClose()}),onOnChoosenScore:l.onChoosenScore,onOnChoosenPrio:l.onChoosenPrio,onOnScheduleOneEach:e[14]||(e[14]=()=>{l.onScheduleOneEach(),l.morphClose()}),onDoHideTree:e[15]||(e[15]=()=>n.showTree=!n.showTree)},null,8,["scoreOptions","allMainGPrio","defaultBtnLabel","onScoreBtnLabel","onPrioBtnLabel","showReloadBtn","showClearBtn","showActionBtns","showTree","inMobile","isDefaultBtnEnabled","isScoreBtnDisabled","isPrioBtnDisabled","onOnChoosenScore","onOnChoosenPrio"])]),I(ht,{align:"right"},{default:_(()=>[I($e,{flat:"","no-caps":"","no-wrap":"",onClick:l.prevMorph},{default:_(()=>e[25]||(e[25]=[ye(" < Prev ")])),_:1},8,["onClick"]),I($e,{flat:"",label:"Close","no-caps":"","no-wrap":"",onClick:l.nextMorph},null,8,["onClick"])]),_:1})]),_:1})),[[Pt,n.morphGroupModel,"card2:mygroup:500",{tween:!0}]])]),_:1},8,["offset"])]),I(m,{onToday:l.onToday,onPrev:l.onPrev,onNext:l.onNext},null,8,["onToday","onPrev","onNext"]),l.scheduleMoodsLabel?(W(),ae("div",Qo,[e[27]||(e[27]=ye(" By moods: ")),(W(!0),ae(xe,null,Et(l.scheduleMoodsLabel,(y,S)=>(W(),oe(Nt,{key:S,color:y.bg,"multi-line":"",rounded:""},{default:_(()=>[ye(de(y.m),1)]),_:2},1032,["color"]))),128))])):se("",!0),Q("div",Ko,[I(no,{class:"q-gutter-sm",style:{display:"flex","max-width":"800px",width:"90%",height:"90vh"}},{default:_(()=>[I(g,{ref:"calendar",view:"day",modelValue:n.currentDate,"onUpdate:modelValue":e[20]||(e[20]=y=>n.currentDate=y),"drag-enter-func":l.onDragEnter,"drag-over-func":l.onDragOver,"drag-leave-func":l.onDragLeave,"drop-func":l.onDrop,animated:"",bordered:"",hoverable:"","no-active-date":"","transition-next":"slide-left","transition-prev":"slide-right","time-clicks-clamped":"","interval-minutes":15,"interval-count":96,"interval-height":28,"selected-start-end-dates":l.startEndTimes,onChange:l.onChange,onClickDate:l.onClickDate,onClickTime:l.onClickTime,onClickInterval:l.onClickInterval,onClickHeadIntervals:l.onClickHeadIntervals,onClickHeadDay:l.onClickHeadDay,onMousedownTime:l.onMouseDownTime,onMouseupTime:l.onMouseUpTime,onMousemoveTime:l.onMouseMoveTime},{"head-day-event":_(({scope:{timestamp:y}})=>[Q("div",Yo,[(W(!0),ae(xe,null,Et(l.eventsMap[y.date],S=>(W(),ae(xe,{key:S.id},[S.time?(W(),oe(Nt,{key:1,class:je(l.badgeClasses(S,"header")),style:nt([l.badgeStyles(S,"header"),{margin:"1px",width:"10px","max-width":"10px",height:"10px","max-height":"10px",cursor:"pointer"}]),onClick:D=>l.scrollToEvent(S)},{default:_(()=>[I(Rt,null,{default:_(()=>[ye(de("("+S.id+") "+S.title+" - "+S.time+" ("+S.duration+"min) >> "+S.end.time),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"])):(W(),ae("div",{key:0,draggable:!0,style:{width:"100%",cursor:"grab",height:"12px","font-size":"10px",margin:"5px"},class:"heady",onDragstart:ke(D=>l.onDragStart(D,"header-item",S),["stop"]),onTouchstart:D=>l.onTouchHStart(D,"header-item",S),onTouchmove:D=>l.onTouchHEvt(D,S),onTouchend:D=>l.onTouchHEvt(D,S)},[I(Nt,{class:je(l.badgeClasses(S,"header-item"))},{default:_(()=>[ye(de(S.title)+" ",1),I(Rt,null,{default:_(()=>[ye("Drag to schedule >> "+de(S.duration)+"min ",1)]),_:2},1024)]),_:2},1032,["class"])],40,Xo))],64))),128))])]),"day-container":_(({scope:{days:y}})=>[l.hasDate(y)?(W(),ae(xe,{key:0},[Q("div",{class:"day-view-current-time-indicator",style:nt(l.style)},null,4),Q("div",{class:"day-view-current-time-line",style:nt(l.style)},null,4)],64)):se("",!0)]),"day-body":_(({scope:{timestamp:y,timeStartPos:S,timeDurationHeight:D}})=>[(W(!0),ae(xe,null,Et(l.getDateEvents(y.date),p=>(W(),ae(xe,{key:p.id},[p.time?(W(),ae("div",{key:0,class:je(["my-event",l.badgeClasses(p,"body")]),style:nt(l.badgeStyles(p,"body",S,D)),draggable:!0,onDblclick:ke(d=>l.onDblClickEvent(d,p),["prevent"]),onDragstart:ke(d=>l.onDragStart(d,"goal-item",p),["stop"]),onDragend:e[16]||(e[16]=ke((...d)=>l.onDragEnd&&l.onDragEnd(...d),["stop"])),onDrop:e[17]||(e[17]=d=>l.onDrop(d,"goal-item",i.scope)),onDragenter:e[18]||(e[18]=d=>l.onDragEnter(d,"goal-item",i.scope)),onDragover:e[19]||(e[19]=d=>l.onDragOver(d,"goal-item",i.scope)),onTouchstart:d=>l.onTouchStart(d,"goal-item",p),onTouchmove:d=>l.onTouchEvt(d,p),onTouchend:d=>l.onTouchEvt(d,p)},[ze(I(h,{disabledScore:n.daSchedule.isDisabledScoreEdit[p.id],title:p.title,id:p.id,startTime:p.time,score:p.score,details:p.details,notes:p.notes,icon:p.icon,happeningNow:n.daSchedule.hasStarted[p.id]?n.daSchedule.hasStarted[p.id]:!1,onEndNow:l.onEndNow,onSaveScore:l.onUpdateNoteScorey,onAddMins:l.onAddMins,onDeleteNow:d=>l.removeEvtInSchedule(p)},null,8,["disabledScore","title","id","startTime","score","details","notes","icon","happeningNow","onEndNow","onSaveScore","onAddMins","onDeleteNow"]),[[vo,d=>l.onTouchHold(d,p),"400:12:15"]]),l.showEvtMobile(p.id)?(W(),oe(T,{key:0,title:p.title,id:p.id,startTime:p.time,score:p.score,details:p.details,notes:p.notes,"show-dialog":l.showEvtMobile(p.id),onSaveScore:l.onUpdateNoteScorey,onDeleteNow:d=>l.removeEvtInSchedule(p),onEuhHidin:d=>n.daSchedule.euhHidin(p.id)},null,8,["title","id","startTime","score","details","notes","show-dialog","onSaveScore","onDeleteNow","onEuhHidin"])):se("",!0)],46,Zo)):se("",!0)],64))),128))]),_:1},8,["modelValue","drag-enter-func","drag-over-func","drag-leave-func","drop-func","selected-start-end-dates","onChange","onClickDate","onClickTime","onClickInterval","onClickHeadIntervals","onClickHeadDay","onMousedownTime","onMouseupTime","onMousemoveTime"])]),_:1})]),e[28]||(e[28]=Q("br",null,null,-1))]),_:2},[n.mobile?void 0:{name:"separator",fn:_(()=>[I(zi,{color:"primary",class:"q-px-md","text-color":"white",size:"40px",icon:"drag_indicator",style:{position:"relative",top:"70%"}})]),key:"0"}]),1032,["modelValue","limits"]),n.showEvtDialog?(W(),oe(C,{key:0,parentGoals:n.daSchedule.allPGoals(),canBeScheduled:l.canbeScheduled,balance:l.currentBalance,selectedTime:l.selectedTimeInterval(),isTimeRange:l.selectedTimeRange(),onAdHocEvent:l.onAddyHocEvent,onOnPickEvent:l.onPickEvent,onEuhHidin:l.closingDialog},null,8,["parentGoals","canBeScheduled","balance","selectedTime","isTimeRange","onAdHocEvent","onOnPickEvent","onEuhHidin"])):se("",!0)])]),_:1})}var ml=ci(_o,[["render",el],["__scopeId","data-v-7077a54a"]]);export{ml as default};
