import{F as R,a1 as j,r as x,N,G as m,H as b,I as d,O as u,J as n,R as c,S as I,U as k,a2 as z,a3 as w,Q as B,K as C,M as f,a4 as E,L as h,a5 as T,_ as A,a6 as q}from"./index.87766908.js";import{u as H,a as O,Q as U,b as M,c as F}from"./goalStorage.e8ee0d47.js";import{Q as L}from"./QBadge.4c403a8e.js";import{i as W,Q as K}from"./isMobile.48bc25b2.js";import{Q as J}from"./QCalendar.3a412bcc.js";import{t as X,a as v,p as G,b as S,F as Y,N as P,O as Z}from"./QCalendarTask.74585b72.js";import{a as $,b as ee}from"./utiFunc.8d3d5627.js";const te={name:"weekCalendar",components:{NavigationBar:j(()=>A(()=>import("./NavigationBar.a6f91450.js"),["assets/NavigationBar.a6f91450.js","assets/NavigationBar.bf3d18d0.css","assets/index.87766908.js","assets/index.f80becc5.css"])),QCalendar:J},data(){return H(),{store:O(),calendar:x(null),currentDate:x(X()),events:[],mostEvts:5,treeGoals:x([]),expanded:x([]),showTree:x(!1),moods:x({}),mobile:x(!1)}},beforeMount(){this.mobile=W(),this.loadEvts(),this.constructTree()},beforeUnmount(){},computed:{storedGoalsMap(){const s=new Map;let e=this.store.getSubGoals;return e?(e.forEach(t=>{s.set(t.id,t)}),s):(console.log("GoalsMap is empty or null",e),s)},label(){return this.showTree?"Hide Legend":"Show Legend"},allEvents(){return this.store.getAllDates},parentGoalsMap(){const s=new Map;let e=this.store.getMainGoals;return e?(e.forEach(t=>{s.set(t.id,t)}),s):(console.log("parentGoalsMap is empty or null",e),s)},eventsMap(){const s={};return this.events.forEach(e=>{if(s[e.date]||(s[e.date]=[]),e.sortTime=v(S(e.date),{minute:G(e.time)}),s[e.date].push(e),e.days){console.log(`eventsMap multiple days? event for ${e.date}`,e.days);let t=Y(e.date),r=e.days;do t=v(t,{day:1}),s[t.date]||(s[t.date]=[]),s[t.date].push(e);while(--r>0)}}),s}},methods:{classyColor(s){return`row items-center ${s.isChildren?"text-":"text-white bg-"}${s.color} `},loadEvts(){var r,i,l,p;let s=this.parentGoalsMap,e=this.storedGoalsMap,t=this.allEvents;if(e&&s){if(t)for(let y in t){let a=t[y];for(let o in a){let g=e.get(parseInt(o));if(g){let _=s.get(g.parentGoal),Q=v(S(y),{minute:G(a[o].time)}),V=v(Q,{minute:parseInt(a[o].duration)}),D="";a[o].notes!==void 0&&((r=a[o])==null?void 0:r.notes)!==""?D=[`${Q.time} - ${V.time}`,`${(l=(i=a[o])==null?void 0:i.atScore)!=null?l:""} >> ${g.score}`,`${(p=a[o])==null?void 0:p.notes}`].join(`
\r`):D=`${Q.time} - ${V.time}`,a[o].byMood!==void 0&&(this.moods[y]||(this.moods[y]=[]),this.moods[y].push(...a[o].byMood)),this.events.push({id:g.id,title:g.title,details:D,time:a[o].time,duration:a[o].duration,date:y,bgcolor:_.bgcolor})}}}}else{console.log("ERROR--no parent or goals!!REVIEW**");return}},constructTree(){this.treeGoals=this.store.fetchGoalsTree()},getEvents(s){let e=(r,i)=>{let l=Z(r.sortTime,i.sortTime);if(l>0)return-1;if(l==0)return 0;if(l<0)return 1};const t=this.eventsMap[s]||[];if(t.length===1)t[0].side="full";else if(t.length===2){const r=v(S(t[0].date),{minute:G(t[0].time)}),i=v(r,{minute:t[0].duration}),l=v(S(t[1].date),{minute:G(t[1].time)}),p=v(l,{minute:t[1].duration});P(l,r,i,!0)||P(p,r,i,!0)?(t[0].side="left",t[1].side="right"):(t[0].side="full",t[1].side="full")}return t.length>this.mostEvts&&(this.mostEvts=this.mobile?t.length+5:t.length),t.sort(e)},badgeClasses(s,e){return $(s,e)},badgeStyles(s,e,t=void 0,r=void 0){return ee(s,e,t,r)},scrollToEvent(s){this.$refs.calendar.scrollToTime(s.time,350)},onToday(){this.$refs.calendar.moveToToday()},onPrev(){this.$refs.calendar.prev()},onNext(){this.$refs.calendar.next()},onClickHeadDay({scope:s,event:e}){var l,p;let t=s.timestamp.date,r=this.moods[t],i=(p=(l=this.eventsMap[t])==null?void 0:l.length)!=null?p:0;r?this.$q.notify({color:"positive",position:"top",message:`${i} Scheduled with Moods: ${r.join()}`,icon:"tag_faces",multiLine:!0,timeout:3e3}):this.$q.notify({color:"white",textColor:"black",position:"top",message:i>0?`${i} Scheduled without Any Mood!`:"Empty and NO mood!!",icon:i>0?"mood":"sentiment_neutral",iconColor:i>0?"positive":"red",multiLine:!0,timeout:3e3})},onChange(s){this.mostEvts=5}}},se={class:"q-px-md"},ae={class:"row justify-center"},le={class:"q-px-md",style:{display:"flex","max-width":"800px",width:"100%",height:"500px",overflow:"auto"}},oe={style:{display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"2px"}},ie={class:"title q-calendar__ellipsis"},ne={class:"title q-calendar__ellipsis"},de={class:"lineyy"},re={key:0,class:"q-pa-md"},me={key:0,class:"q-pa-md bg-grey-12",style:{"max-width":"400px"}},ue={class:"q-mr-sm text-weight-bold",size:"28px"},ce={key:0},he={class:"text-weight-bold liney"},pe={key:1,class:"text-weight-light text-black liney"},fe={key:1,class:"column justify-center items-center"};function ye(s,e,t,r,i,l){const p=N("navigation-bar"),y=N("q-calendar");return m(),b(U,{padding:""},{default:d(()=>[u("div",se,[n(p,{onToday:l.onToday,onPrev:l.onPrev,onNext:l.onNext},null,8,["onToday","onPrev","onNext"]),e[3]||(e[3]=u("i",{class:"row justify-center q-pa-sm"},"Click on Day header for that day's Moods ",-1)),u("div",ae,[u("div",le,[n(y,{ref:"calendar",modelValue:i.currentDate,"onUpdate:modelValue":e[0]||(e[0]=a=>i.currentDate=a),view:"week",dark:"",animated:"",hoverable:"",bordered:"","transition-prev":"slide-right","transition-next":"slide-left","no-active-date":"","interval-minutes":30,"interval-count":48,"interval-height":i.mostEvts*3,onChange:l.onChange,onClickHeadDay:l.onClickHeadDay},{"head-day-event":d(({scope:{timestamp:a}})=>[u("div",oe,[(m(!0),c(k,null,I(l.eventsMap[a.date],o=>(m(),c(k,{key:o.id},[o.time?(m(),b(L,{key:1,class:E(l.badgeClasses(o,"header")),style:q([l.badgeStyles(o,"header"),{margin:"1px",width:"10px","max-width":"10px",height:"10px","max-height":"10px",cursor:"pointer"}]),onClick:g=>l.scrollToEvent(o)},{default:d(()=>[n(M,null,{default:d(()=>[h(f(o.time+" - "+o.title),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"])):(m(),b(L,{key:0,class:E(l.badgeClasses(o,"header")),style:q([l.badgeStyles(o,"header"),{width:"100%",cursor:"pointer",height:"12px","font-size":"10px",margin:"1px"}])},{default:d(()=>[u("div",ie,[h(f(o.title)+" ",1),n(M,null,{default:d(()=>[h(f(o.details),1)]),_:2},1024)])]),_:2},1032,["class","style"]))],64))),128))])]),"day-body":d(({scope:{timestamp:a,timeStartPos:o,timeDurationHeight:g}})=>[(m(!0),c(k,null,I(l.getEvents(a.date),_=>(m(),c(k,{key:_.id},[_.time!==void 0?(m(),c("div",{key:0,class:E(["my-event",l.badgeClasses(_,"body")]),style:q(l.badgeStyles(_,"body",o,g))},[u("span",ne,[h(f(_.title)+" ",1),n(M,null,{default:d(()=>[u("div",de,f(_.details),1)]),_:2},1024)])],6)):C("",!0)],64))),128))]),_:1},8,["modelValue","interval-height","onChange","onClickHeadDay"])])])]),n(z,{modelValue:i.showTree,"onUpdate:modelValue":e[1]||(e[1]=a=>i.showTree=a),label:l.label,color:"teal",class:"q-pa-md"},null,8,["modelValue","label"]),n(F,null,{default:d(()=>[i.showTree?(m(),c("div",re,[i.treeGoals.length>0?(m(),c("div",me,[e[4]||(e[4]=u("div",{class:"row justify-center"}," Goals & Goal Events ",-1)),n(w),e[5]||(e[5]=u("br",null,null,-1)),n(K,{nodes:i.treeGoals,"node-key":"label",expanded:i.expanded,"onUpdate:expanded":e[2]||(e[2]=a=>i.expanded=a),"no-connectors":"",dense:"",accordion:""},{"default-header":d(a=>[u("div",{class:E(l.classyColor(a.node))},[a.node.isChildren?C("",!0):(m(),b(B,{key:0,name:a.expanded?"expand_less":"expand_more",size:"28px",class:"q-mr-sm"},null,8,["name"])),u("div",ue,f(a.node.label),1),n(B,{name:a.node.icon},null,8,["name"])],2)]),"default-body":d(a=>[a.node.isChildren?(m(),c("div",ce,[u("span",he," >> "+f(a.node.details),1),a.node.moods.length>0?(m(),b(M,{key:0},{default:d(()=>[h(f("Moods::> "+a.node.moods.join(",")),1)]),_:2},1024)):C("",!0)])):(m(),c("span",pe,f(a.node.details),1))]),_:1},8,["nodes","expanded"])])):(m(),c("div",fe,[e[11]||(e[11]=u("br",null,null,-1)),n(T,null,{default:d(()=>e[6]||(e[6]=[h(" 1. Add some Goals first. A schedulable goal is one with a parent Goal--can have multiple related goals with the same parent. ")])),_:1}),n(w),n(T,null,{default:d(()=>e[7]||(e[7]=[h(" 2. Go to Schedule to see a daily schedule. Drag scheduled events to new timeslots or click in calendar to add an event. ")])),_:1}),n(w),n(T,null,{default:d(()=>e[8]||(e[8]=[h(" 3. Reload a saved daily schedule or defaults or choose minimal score events to schedule. Fix any scheduling conflicts. ")])),_:1}),n(w),n(T,null,{default:d(()=>e[9]||(e[9]=[h(" 4. Save the daily schedule (dont forget to update their score as needed!) ")])),_:1}),n(w),n(T,null,{default:d(()=>e[10]||(e[10]=[h(" 5. Check out the summary of all goals here! ")])),_:1})]))])):C("",!0)]),_:1})]),_:1})}var ke=R(te,[["render",ye],["__scopeId","data-v-2e41fd7e"]]);export{ke as default};
