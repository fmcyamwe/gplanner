import{_ as j,$ as z,r as x,L as N,E as c,F as w,G as i,M as u,H as n,O as m,P,R as C,a0 as A,a1 as b,Q as B,I as k,K as f,a2 as E,J as h,a3 as T,a4 as H,a5 as V,a6 as O,a7 as F}from"./index.b9837b95.js";import{u as U,a as W,b as K,c as J,Q as X,d as G,e as Y}from"./goalStorage.940a25a8.js";import{Q as L}from"./QBadge.d0cb5e09.js";import{t as Z,a as v,p as M,b as S,c as $,i as R,d as ee,Q as te}from"./QCalendarTask.662e37e3.js";import{Q as se}from"./QCalendar.c8fbb187.js";const ae={name:"weekCalendar",components:{NavigationBar:z(()=>H(()=>import("./NavigationBar.71117a20.js"),["assets/NavigationBar.71117a20.js","assets/NavigationBar.bf3d18d0.css","assets/index.b9837b95.js","assets/index.4f70e4de.css"])),QCalendar:se},data(){return U(),{store:W(),calendar:x(null),currentDate:x(Z()),events:[],mostEvts:5,treeGoals:x([]),expanded:x([]),showTree:x(!1),moods:x({})}},beforeMount(){this.loadEvts(),this.constructTree()},mounted(){console.log("mounted")},computed:{storedGoalsMap(){const e=new Map;let t=this.store.getSubGoals;return t?(t.forEach(s=>{e.set(s.id,s)}),e):(console.log("GoalsMap is empty or null",t),e)},label(){return this.showTree?"Hide Legend":"Show Legend"},allEvents(){return this.store.getAllDates},parentGoalsMap(){const e=new Map;let t=this.store.getMainGoals;return t?(t.forEach(s=>{e.set(s.id,s)}),e):(console.log("parentGoalsMap is empty or null",t),e)},eventsMap(){const e={};return this.events.forEach(t=>{if(e[t.date]||(e[t.date]=[]),t.sortTime=v(S(t.date),{minute:M(t.time)}),e[t.date].push(t),t.days){console.log(`eventsMap multiple days? event for ${t.date}`,t.days);let s=$(t.date),r=t.days;do s=v(s,{day:1}),e[s.date]||(e[s.date]=[]),e[s.date].push(t);while(--r>0)}}),e}},methods:{classyColor(e){return`row items-center ${e.isChildren?"text-":"text-white bg-"}${e.color} `},loadEvts(){var r,d,o,p;let e=this.parentGoalsMap,t=this.storedGoalsMap,s=this.allEvents;if(t&&e){if(s)for(let y in s){let a=s[y];for(let l in a){let _=t.get(parseInt(l));if(_){let g=e.get(_.parentGoal),D=v(S(y),{minute:M(a[l].time)}),I=v(D,{minute:parseInt(a[l].duration)}),q="";a[l].notes!==void 0&&((r=a[l])==null?void 0:r.notes)!==""?q=[`${D.time} - ${I.time}`,`${(o=(d=a[l])==null?void 0:d.atScore)!=null?o:""} >> ${_.score}`,`${(p=a[l])==null?void 0:p.notes}`].join(`
\r`):q=`${D.time} - ${I.time}`,a[l].byMood!==void 0&&(this.moods[y]||(this.moods[y]=[]),this.moods[y].push(...a[l].byMood)),this.events.push({id:_.id,title:_.title,details:q,time:a[l].time,duration:a[l].duration,date:y,bgcolor:g.bgcolor})}}}}else{console.log("ERROR--no parent or goals!!REVIEW**");return}},constructTree(){this.treeGoals=this.store.fetchGoalsTree()},getEvents(e){let t=(r,d)=>{let o=ee(r.sortTime,d.sortTime);if(o>0)return-1;if(o==0)return 0;if(o<0)return 1};const s=this.eventsMap[e]||[];if(s.length===1)s[0].side="full";else if(s.length===2){const r=v(S(s[0].date),{minute:M(s[0].time)}),d=v(r,{minute:s[0].duration}),o=v(S(s[1].date),{minute:M(s[1].time)}),p=v(o,{minute:s[1].duration});R(o,r,d,!0)||R(p,r,d,!0)?(s[0].side="left",s[1].side="right"):(s[0].side="full",s[1].side="full")}return s.length>this.mostEvts&&(this.mostEvts=s.length),s.sort(t)},badgeClasses(e,t){return K(e,t)},badgeStyles(e,t,s=void 0,r=void 0){return J(e,t,s,r)},scrollToEvent(e){this.$refs.calendar.scrollToTime(e.time,350)},onToday(){this.$refs.calendar.moveToToday()},onPrev(){this.$refs.calendar.prev()},onNext(){this.$refs.calendar.next()},onClickHeadDay({scope:e,event:t}){var o,p;let s=e.timestamp.date,r=this.moods[s],d=(p=(o=this.eventsMap[s])==null?void 0:o.length)!=null?p:0;r?this.$q.notify({color:"positive",position:"top",message:`${d} Scheduled with Moods: ${r.join()}`,icon:"tag_faces",multiLine:!0}):this.$q.notify({color:"white",textColor:"black",position:"top",message:d>0?`${d} Scheduled without Any Mood!`:"Empty and NO mood!!",icon:d>0?"mood":"sentiment_neutral",iconColor:d>0?"positive":"red",multiLine:!0})},onChange(e){this.mostEvts=5,console.log("onChange",e)}}},Q=e=>(O("data-v-c568e700"),e=e(),F(),e),oe={class:"q-px-md"},le=Q(()=>u("i",{class:"row justify-center q-pa-sm"},"Click on Day header for that day's Moods ",-1)),de={class:"row justify-center"},ne={class:"q-px-md",style:{display:"flex","max-width":"800px",width:"100%",height:"500px",overflow:"auto"}},ie={style:{display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"2px"}},re={class:"title q-calendar__ellipsis"},ce={class:"title q-calendar__ellipsis"},ue={class:"lineyy"},me={key:0,class:"q-pa-md"},he={key:0,class:"q-pa-md bg-grey-12",style:{"max-width":"400px"}},pe=Q(()=>u("div",{class:"row justify-center"}," Goals & Goal Events ",-1)),fe=Q(()=>u("br",null,null,-1)),ye={class:"q-mr-sm text-weight-bold",size:"28px"},_e={key:0},ge={class:"text-weight-bold liney"},ve={key:1,class:"text-weight-light text-black liney"},xe={key:1,class:"column justify-center items-center"},we=Q(()=>u("br",null,null,-1));function be(e,t,s,r,d,o){const p=N("navigation-bar"),y=N("q-calendar");return c(),w(X,{padding:""},{default:i(()=>[u("div",oe,[n(p,{onToday:o.onToday,onPrev:o.onPrev,onNext:o.onNext},null,8,["onToday","onPrev","onNext"]),le,u("div",de,[u("div",ne,[n(y,{ref:"calendar",modelValue:d.currentDate,"onUpdate:modelValue":t[0]||(t[0]=a=>d.currentDate=a),view:"week",dark:"",animated:"",hoverable:"",bordered:"","transition-prev":"slide-right","transition-next":"slide-left","no-active-date":"","interval-minutes":30,"interval-count":48,"interval-height":d.mostEvts*3,onChange:o.onChange,onClickHeadDay:o.onClickHeadDay},{"head-day-event":i(({scope:{timestamp:a}})=>[u("div",ie,[(c(!0),m(C,null,P(o.eventsMap[a.date],l=>(c(),m(C,{key:l.id},[l.time?(c(),w(L,{key:1,class:E(o.badgeClasses(l,"header")),style:V([o.badgeStyles(l,"header"),{margin:"1px",width:"10px","max-width":"10px",height:"10px","max-height":"10px",cursor:"pointer"}]),onClick:_=>o.scrollToEvent(l)},{default:i(()=>[n(G,null,{default:i(()=>[h(f(l.time+" - "+l.title),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"])):(c(),w(L,{key:0,class:E(o.badgeClasses(l,"header")),style:V([o.badgeStyles(l,"header"),{width:"100%",cursor:"pointer",height:"12px","font-size":"10px",margin:"1px"}])},{default:i(()=>[u("div",re,[h(f(l.title)+" ",1),n(G,null,{default:i(()=>[h(f(l.details),1)]),_:2},1024)])]),_:2},1032,["class","style"]))],64))),128))])]),"day-body":i(({scope:{timestamp:a,timeStartPos:l,timeDurationHeight:_}})=>[(c(!0),m(C,null,P(o.getEvents(a.date),g=>(c(),m(C,{key:g.id},[g.time!==void 0?(c(),m("div",{key:0,class:E(["my-event",o.badgeClasses(g,"body")]),style:V(o.badgeStyles(g,"body",l,_))},[u("span",ce,[h(f(g.title)+" ",1),n(G,null,{default:i(()=>[u("div",ue,f(g.details),1)]),_:2},1024)])],6)):k("",!0)],64))),128))]),_:1},8,["modelValue","interval-height","onChange","onClickHeadDay"])])])]),n(A,{modelValue:d.showTree,"onUpdate:modelValue":t[1]||(t[1]=a=>d.showTree=a),label:o.label,color:"teal",class:"q-pa-md"},null,8,["modelValue","label"]),n(Y,null,{default:i(()=>[d.showTree?(c(),m("div",me,[d.treeGoals.length>0?(c(),m("div",he,[pe,n(b),fe,n(te,{nodes:d.treeGoals,"node-key":"label",expanded:d.expanded,"onUpdate:expanded":t[2]||(t[2]=a=>d.expanded=a),"no-connectors":"",dense:"",accordion:""},{"default-header":i(a=>[u("div",{class:E(o.classyColor(a.node))},[a.node.isChildren?k("",!0):(c(),w(B,{key:0,name:a.expanded?"expand_less":"expand_more",size:"28px",class:"q-mr-sm"},null,8,["name"])),u("div",ye,f(a.node.label),1),n(B,{name:a.node.icon},null,8,["name"])],2)]),"default-body":i(a=>[a.node.isChildren?(c(),m("div",_e,[u("span",ge," >> "+f(a.node.details),1),a.node.moods.length>0?(c(),w(G,{key:0},{default:i(()=>[h(f("Moods::> "+a.node.moods.join(",")),1)]),_:2},1024)):k("",!0)])):(c(),m("span",ve,f(a.node.details),1))]),_:1},8,["nodes","expanded"])])):(c(),m("div",xe,[we,n(T,null,{default:i(()=>[h(" 1. Add some Goals first. A schedulable goal is one with a parent Goal--can have multiple related goals with the same parent. ")]),_:1}),n(b),n(T,null,{default:i(()=>[h(" 2. Go to Schedule to see a daily schedule. Drag scheduled events to new timeslots or click in calendar to add an event. ")]),_:1}),n(b),n(T,null,{default:i(()=>[h(" 3. Reload a saved daily schedule or defaults or choose minimal score events to schedule. Fix any scheduling conflicts. ")]),_:1}),n(b),n(T,null,{default:i(()=>[h(" 4. Save the daily schedule (dont forget to update their score as needed!) ")]),_:1}),n(b),n(T,null,{default:i(()=>[h(" 5. Check out the summary of all goals here! ")]),_:1})]))])):k("",!0)]),_:1})]),_:1})}var Me=j(ae,[["render",be],["__scopeId","data-v-c568e700"]]);export{Me as default};
