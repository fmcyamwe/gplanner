import{_ as R,$ as B,r as v,L as V,E as r,F as T,G as d,M as u,H as i,O as p,P as q,R as w,a0 as z,a1 as C,Q as A,I as D,K as _,a2 as b,a3 as k,J as f,a4 as L,a5 as S,a6 as j,a7 as F}from"./index.8c8e6158.js";import{a as O,b as U,Q as H,c as M}from"./utiFunc.ac4b7097.js";import{t as W,a as y,p as E,b as G,c as K,i as N,Q as J,d as X,e as Y}from"./QCalendarTask.fef7ec7e.js";import{u as Z,Q as $}from"./goalStorage.fe981a66.js";import{Q as ee}from"./QCalendar.36abdc66.js";const te={name:"weekCalendar",components:{NavigationBar:B(()=>L(()=>import("./NavigationBar.38c5f892.js"),["assets/NavigationBar.38c5f892.js","assets/index.8c8e6158.js","assets/index.ddf7c1e7.css"])),QCalendar:ee},data(){return{store:Z(),calendar:v(null),currentDate:v(W()),events:[],mostEvts:5,treeGoals:v([]),expanded:v([]),showTree:v(!1)}},beforeMount(){this.loadEvts(),this.constructTree()},mounted(){console.log("mounted")},computed:{storedGoalsMap(){const e=new Map;let t=this.store.getSubGoals;return t?(t.forEach(a=>{e.set(a.id,a)}),e):(console.log("GoalsMap is empty or null",t),e)},allEvents(){return this.store.getAllDates},parentGoalsMap(){const e=new Map;let t=this.store.getMainGoals;return t?(t.forEach(a=>{e.set(a.id,a)}),e):(console.log("parentGoalsMap is empty or null",t),e)},storedEvents(){return this.store.getSubGoals},eventsMap(){const e={};return this.events.forEach(t=>{if(e[t.date]||(e[t.date]=[]),t.sortTime=y(G(t.date),{minute:E(t.time)}),e[t.date].push(t),t.days){console.log(`eventsMap multiple days? event for ${t.date}`,t.days);let a=K(t.date),c=t.days;do a=y(a,{day:1}),e[a.date]||(e[a.date]=[]),e[a.date].push(t);while(--c>0)}}),e}},methods:{classyColor(e){return`row items-center ${e.isChildren?"text-":"text-white bg-"}${e.color} `},loadEvts(){var c,n,s;let e=this.parentGoalsMap,t=this.storedGoalsMap,a=this.allEvents;if(t&&e){if(a)for(let g in a){let m=a[g];for(let l in m){let o=t.get(parseInt(l));if(o){let x=e.get(o.parentGoal),h=y(G(g),{minute:E(m[l].time)}),Q=y(h,{minute:parseInt(m[l].duration)}),I="";m[l].notes!==void 0&&((c=m[l])==null?void 0:c.notes)!==""?I=[`${h.time} - ${Q.time}`,`${(n=m[l])==null?void 0:n.atScore} >> ${o.score}`,`${(s=m[l])==null?void 0:s.notes}`].join(`
\r`):I=`${h.time} - ${Q.time}`,this.events.push({id:o.id,title:o.title,details:I,time:m[l].time,duration:m[l].duration,date:g,bgcolor:x.bgcolor})}}}}else{console.log("ERROR--no parent or goals!!REVIEW**");return}},constructTree(){this.treeGoals=this.store.fetchGoalsTree()},getEvents(e){let t=(c,n)=>{let s=X(c.sortTime,n.sortTime);if(s>0)return-1;if(s==0)return 0;if(s<0)return 1};const a=this.eventsMap[e]||[];if(a.length===1)a[0].side="full";else if(a.length===2){const c=y(G(a[0].date),{minute:E(a[0].time)}),n=y(c,{minute:a[0].duration}),s=y(G(a[1].date),{minute:E(a[1].time)}),g=y(s,{minute:a[1].duration});N(s,c,n,!0)||N(g,c,n,!0)?(a[0].side="left",a[1].side="right"):(a[0].side="full",a[1].side="full")}return a.length>this.mostEvts&&(this.mostEvts=a.length),a.sort(t)},badgeClasses(e,t){return O(e,t)},badgeStyles(e,t,a=void 0,c=void 0){return U(e,t,a,c)},scrollToEvent(e){this.$refs.calendar.scrollToTime(e.time,350)},onToday(){this.$refs.calendar.moveToToday()},onPrev(){this.doReset=!0,this.$refs.calendar.prev()},onNext(){this.$refs.calendar.next()},onClickDate(e){console.log("onClickDate",e)},onClickTime(e){console.log("onClickTime",e)},onClickInterval(e){console.log("onClickInterval",e)},onClickHeadIntervals(e){console.log("onClickHeadIntervals",e)},onClickHeadDay(e){console.log("onClickHeadDay",e)},onChange(e){this.mostEvts=5,console.log("onChange",e)}}},P=e=>(j("data-v-3d92074c"),e=e(),F(),e),ae={class:"q-pa-md"},se={class:"row justify-center"},le={class:"q-px-md",style:{display:"flex","max-width":"800px",width:"100%",height:"400px",overflow:"auto"}},oe={style:{display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"2px"}},ne={class:"title q-calendar__ellipsis"},ie={class:"title q-calendar__ellipsis"},de={class:"lineyy"},re={key:0,class:"q-pa-md"},ce={key:0,class:"q-pa-md bg-grey-12",style:{"max-width":"400px"}},ue=P(()=>u("div",{class:"row justify-center"}," Goals & Goal Events ",-1)),me=P(()=>u("br",null,null,-1)),he={class:"q-mr-sm text-weight-bold",size:"28px"},pe={key:0},fe={class:"text-weight-bold liney"},_e={key:1,class:"text-weight-light text-black liney"},ye={key:1,class:"column justify-center items-center"};function ge(e,t,a,c,n,s){const g=V("navigation-bar"),m=V("q-calendar");return r(),T(J,null,{default:d(()=>[u("div",ae,[i(g,{onToday:s.onToday,onPrev:s.onPrev,onNext:s.onNext},null,8,["onToday","onPrev","onNext"]),u("div",se,[u("div",le,[i(m,{ref:"calendar",modelValue:n.currentDate,"onUpdate:modelValue":t[0]||(t[0]=l=>n.currentDate=l),view:"week",dark:"",animated:"",hoverable:"",bordered:"","transition-prev":"slide-right","transition-next":"slide-left","no-active-date":"","interval-minutes":30,"interval-count":48,"interval-height":n.mostEvts*3,onChange:s.onChange,onClickDate:s.onClickDate,onClickTime:s.onClickTime,onClickInterval:s.onClickInterval,onClickHeadIntervals:s.onClickHeadIntervals,onClickHeadDay:s.onClickHeadDay},{"head-day-event":d(({scope:{timestamp:l}})=>[u("div",oe,[(r(!0),p(w,null,q(s.eventsMap[l.date],o=>(r(),p(w,{key:o.id},[o.time?(r(),T(H,{key:1,class:b(s.badgeClasses(o,"header")),style:S([s.badgeStyles(o,"header"),{margin:"1px",width:"10px","max-width":"10px",height:"10px","max-height":"10px",cursor:"pointer"}]),onClick:x=>s.scrollToEvent(o)},{default:d(()=>[i(M,null,{default:d(()=>[f(_(o.time+" - "+o.title),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"])):(r(),T(H,{key:0,class:b(s.badgeClasses(o,"header")),style:S([s.badgeStyles(o,"header"),{width:"100%",cursor:"pointer",height:"12px","font-size":"10px",margin:"1px"}])},{default:d(()=>[u("div",ne,[f(_(o.title)+" ",1),i(M,null,{default:d(()=>[f(_(o.details),1)]),_:2},1024)])]),_:2},1032,["class","style"]))],64))),128))])]),"day-body":d(({scope:{timestamp:l,timeStartPos:o,timeDurationHeight:x}})=>[(r(!0),p(w,null,q(s.getEvents(l.date),h=>(r(),p(w,{key:h.id},[h.time!==void 0?(r(),p("div",{key:0,class:b(["my-event",s.badgeClasses(h,"body")]),style:S(s.badgeStyles(h,"body",o,x))},[u("span",ie,[f(_(h.title)+" ",1),i(M,null,{default:d(()=>[u("div",de,_(h.details),1)]),_:2},1024)])],6)):D("",!0)],64))),128))]),_:1},8,["modelValue","interval-height","onChange","onClickDate","onClickTime","onClickInterval","onClickHeadIntervals","onClickHeadDay"])])])]),i(z,{modelValue:n.showTree,"onUpdate:modelValue":t[1]||(t[1]=l=>n.showTree=l),label:"Tree Legend",color:"teal",class:"q-pa-md"},null,8,["modelValue"]),i($,null,{default:d(()=>[n.showTree?(r(),p("div",re,[n.treeGoals.length>0?(r(),p("div",ce,[ue,i(C),me,i(Y,{nodes:n.treeGoals,"node-key":"label",expanded:n.expanded,"onUpdate:expanded":t[2]||(t[2]=l=>n.expanded=l),"no-connectors":"",dense:"",accordion:""},{"default-header":d(l=>[u("div",{class:b(s.classyColor(l.node))},[l.node.isChildren?D("",!0):(r(),T(A,{key:0,name:l.node.icon||l.expanded?"expand_less":"expand_more",size:"28px",class:"q-mr-sm"},null,8,["name"])),u("div",he,_(l.node.label),1)],2)]),"default-body":d(l=>[l.node.isChildren?(r(),p("div",pe,[u("span",fe," >> "+_(l.node.details),1)])):(r(),p("span",_e,_(l.node.details),1))]),_:1},8,["nodes","expanded"])])):(r(),p("div",ye,[i(k,null,{default:d(()=>[f(" 1. Add some Goals first. A schedulable goal is one with a parent Goal--can have multiple related goals with the same parent. ")]),_:1}),i(C),i(k,null,{default:d(()=>[f(" 2. Go to Schedule to see a daily schedule. Drag scheduled events to new timeslots or click in calendar to add an event. ")]),_:1}),i(C),i(k,null,{default:d(()=>[f(" 3. Reload a saved daily schedule or defaults or choose minimal score events to schedule. Fix any scheduling conflicts. ")]),_:1}),i(C),i(k,null,{default:d(()=>[f(" 4. Save the daily schedule (dont forget to update their score as needed!) ")]),_:1}),i(C),i(k,null,{default:d(()=>[f(" 5. Check out the summary of all goals here! ")]),_:1})]))])):D("",!0)]),_:1})]),_:1})}var we=R(te,[["render",ge],["__scopeId","data-v-3d92074c"]]);export{we as default};
