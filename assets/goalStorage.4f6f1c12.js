import{ab as U,r as Y,c as d}from"./index.7efdc94b.js";import{u as q}from"./use-quasar.711ed255.js";const H=U("allGoals",()=>{const b=Y([{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}]),h=[{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}],i=q(),G=d(()=>h),m=d(()=>{let e=JSON.parse(i.localStorage.getItem("mainGoals"));return S(e)}),p=d(()=>{let e=JSON.parse(i.localStorage.getItem("subGoals"));return S(e)}),v=d(()=>JSON.parse(i.localStorage.getItem("AllDates")));function S(e){return e?[...e]:[]}function y(e,l,t,o){console.log(e+" "+l+" "+t+" "+o);let a=this.getMainGoals;if(!a){console.log("umm no mainGoals...adding"),i.localStorage.set("mainGoals",JSON.stringify([{id:0,title:e,details:l,priority:o,bgcolor:t,icon:"fas fa-utensils"}]));return}let n=a.length+1;for(;a.some(f=>f.id===n);)n=Math.floor(Math.random()*1e3);return a.unshift({id:n,title:e,details:l,priority:o,bgcolor:t,icon:"fas fa-utensils"}),i.localStorage.set("mainGoals",JSON.stringify(a)),console.log("done adding mainGoal",n),n}function D(e,l,t,o,a,n,f){console.log(e+" "+l+" "+t+" "+o+" "+a+" "+n+" "+f);let s=this.getSubGoals;if(!s){i.localStorage.set("subGoals",JSON.stringify([{id:0,parentGoal:e,title:l,score:t,time:o,duration:a,canMove:n,inDefaults:f}]));return}let r=s.length+1;for(;s.some(u=>u.id===r);)r=Math.floor(Math.random()*1e3);return s.unshift({id:r,parentGoal:e,title:l,score:t,time:o,duration:a,canMove:n,inDefaults:f}),i.localStorage.set("subGoals",JSON.stringify(s)),console.log("done adding subGoal",r),r}function O(e,l,t,o,a,n,f){let s=this.getSubGoals;for(var r=0;r<s.length;r++)if(s[r].id===e){s[r].title=l,s[r].score=t,s[r].time=o,s[r].duration=a,s[r].canMove=n,s[r].inDefaults=f,console.log("editSubGoal for",s[r],r);break}i.localStorage.set("subGoals",JSON.stringify(s))}function $(){i.localStorage.remove("mainGoals"),console.log("removed all mainGoal")}function x(){i.localStorage.remove("subGoals"),console.log("removed all subGoals")}function M(){i.localStorage.remove("subGoals"),i.localStorage.remove("mainGoals"),console.log("removed ALL")}function A(e,l=null,t=null){let o=this.getSubGoals;for(var a=0;a<o.length;a++)if(o[a].id===e){o[a].time=l||o[a].time,o[a].score=t||o[a].score;break}i.localStorage.set("subGoals",JSON.stringify(o))}function N(e){let l=this.getSubGoals;for(var t=0;t<l.length;t++)l[t].id===e&&(l.splice(t,1),console.log("removeSubgoal spliced!"));return i.localStorage.set("subGoals",JSON.stringify(l)),l}function I(e,l){let t=this.getMainGoals;for(var o=0;o<t.length;o++)t[o].id===e&&(t.splice(o,1),console.log("removeMaingoal spliced!"));return i.localStorage.set("mainGoals",JSON.stringify(t)),t}function R(e){let l=this.getMainGoals;for(var t=0;t<l.length;t++)if(l[t].title===e)return l[t];return null}function T(e,l=null){let t=this.getAllDates;t?l?t[`${e}`]=l:e in t?delete t[`${e}`]:console.log(`ERROR? deleting schedule of ${e} not found!`):(console.log(`Adding new schedule for ${e}`),t={},t[`${e}`]=l),i.localStorage.set("AllDates",JSON.stringify(t))}function J(e){let l=this.getAllDates;if(l)return l[`${e}`]}function E(e){let l=this.getAllDates;return l?!!l[`${e}`]:!1}function F(){const e=[];let l=function(o){return o.inDefaults&&o.inDefaults},t=this.getSubGoals;return t?(t.forEach(o=>{l(o)&&e.push(o)}),e):(console.log("No subgoals to fetch defaults :("),e)}function L(e=null){let l=this.getMainGoals,t=new Set;if(e)for(var o=0;o<l.length;o++)l[o].priority==e&&t.add(l[o].priority);else l.forEach(a=>{t.add(a.priority)});return t}function w(e){const l=[];let t=function(a){const n=a.split(/on/);return n.length!=2?(console.log(`parseScore error?${a}`,n),-1):n[1]-n[0]},o=this.getSubGoals;return o&&o.forEach(a=>{if(a.score=="")console.log(`no score event added: ${a.title}`,a.score),l.push(a);else{let n=t(a.score);n>-1&&n>=e&&l.push(a)}}),l}function k(e){const t=(e/60).toFixed(2);return parseFloat(t)}function P(){let e=this.getAllDates;if(!e)return console.log("no savedTaskSummary..ERROR"),[];let l=this.getMainGoals,t=this.getSubGoals,o={};for(let s in e){let r=e[s];for(let u in r)o[u]||(o[u]=[]),o[u].push({date:s,logged:k(r[u].duration)})}let a=s=>{let r=[];return t&&t.forEach(u=>{u.parentGoal==s&&r.push(u)}),r},n=(s,r=null)=>{let u={children:[],title:r?`${s.title.trim()}:(${s.score})`:`${s.title.trim()} !P(${s.priority})!`,key:r?`${r}-${s.id}`:s.id,logged:[],expanded:!1};if(r){let c=o[s.id]||[];u.logged=[...c]}return u},f=[];return l.forEach(s=>{let r=n(s),u=a(s.id);for(let c=0;c<u.length;c++){let g=n(u[c],s.id);if(g.logged.length==0){console.log(`Oooh no logged for parent ${s.title}`,g);continue}r.logged.push(...g.logged),r.children.push(g)}f.push(r)}),f}return{headers:h,headerRefs:b,getHeaders:G,getMainGoals:m,getSubGoals:p,getAllDates:v,addMainGoal:y,addSubGoal:D,editSubGoal:O,getGoalByTitle:R,saveSubProp:A,saveDailySchedule:T,resetSub:x,resetMain:$,resetAll:M,removeSubgoal:N,removeMaingoal:I,getEventsForDate:J,hasEventsForDate:E,fetchAllTaskSummary:P,fetchGoalsWithMinScore:w,fetchAllPrio:L,fetchDefaults:F}});export{H as u};
