import{j as V,e as X,h as Z,T as _,l as k,ar as ee,as as te,c as J}from"./index.d5412a32.js";var oe=V({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(c,{slots:T,emit:j}){let $=!1,M,v,p=null,G=null,m,D;function A(){M&&M(),M=null,$=!1,p!==null&&(clearTimeout(p),p=null),G!==null&&(clearTimeout(G),G=null),v!==void 0&&v.removeEventListener("transitionend",m),m=null}function O(f,g,b){g!==void 0&&(f.style.height=`${g}px`),f.style.transition=`height ${c.duration}ms cubic-bezier(.25, .8, .50, 1)`,$=!0,M=b}function N(f,g){f.style.overflowY=null,f.style.height=null,f.style.transition=null,A(),g!==D&&j(g)}function w(f,g){let b=0;v=f,$===!0?(A(),b=f.offsetHeight===f.scrollHeight?0:void 0):(D="hide",f.style.overflowY="hidden"),O(f,b,g),p=setTimeout(()=>{p=null,f.style.height=`${f.scrollHeight}px`,m=y=>{G=null,(Object(y)!==y||y.target===f)&&N(f,"show")},f.addEventListener("transitionend",m),G=setTimeout(m,c.duration*1.1)},100)}function E(f,g){let b;v=f,$===!0?A():(D="show",f.style.overflowY="hidden",b=f.scrollHeight),O(f,b,g),p=setTimeout(()=>{p=null,f.style.height=0,m=y=>{G=null,(Object(y)!==y||y.target===f)&&N(f,"hide")},f.addEventListener("transitionend",m),G=setTimeout(m,c.duration*1.1)},100)}return X(()=>{$===!0&&A()}),()=>Z(_,{css:!1,appear:c.appear,onEnter:w,onLeave:E},T.default)}});function le(){return k(ee)}const ne=te("allGoals",()=>{const c=le(),T=J(()=>{let e=JSON.parse(c.localStorage.getItem("mainGoals"));return v(e)}),j=J(()=>{let e=JSON.parse(c.localStorage.getItem("subGoals"));return v(e)}),$=J(()=>JSON.parse(c.localStorage.getItem("AllDates"))),M=J(()=>JSON.parse(c.localStorage.getItem("Balancey")));function v(e){return e?[...e]:[]}function p(e){c.localStorage.set("Balancey",JSON.stringify(e))}function G(e,l,t=null){E(),c.localStorage.set("mainGoals",JSON.stringify(e)),c.localStorage.set("subGoals",JSON.stringify(l)),t&&c.localStorage.set("AllDates",JSON.stringify(t))}function m(e,l,t,o){let s=this.getMainGoals;if(!s){console.log("umm no mainGoals...adding"),c.localStorage.set("mainGoals",JSON.stringify([{id:0,title:e.trim(),details:l,priority:o,bgcolor:t,icon:"fas fa-utensils"}]));return}let u=s.length+1;for(;s.some(r=>r.id===u);)u=Math.floor(Math.random()*1e3);return s.unshift({id:u,title:e.trim(),details:l,priority:o,bgcolor:t,icon:"fas fa-utensils"}),c.localStorage.set("mainGoals",JSON.stringify(s)),u}function D(e,l,t,o,s){let u=this.getMainGoals;for(var r=0;r<u.length;r++)if(u[r].id===e){u[r].title=l.trim(),u[r].details=t,u[r].bgcolor=o,u[r].priority=s;break}c.localStorage.set("mainGoals",JSON.stringify(u))}function A(e,l,t,o,s,u,r,n,i){let a=this.getSubGoals;if(!a){c.localStorage.set("subGoals",JSON.stringify([{id:0,parentGoal:e,title:l.trim(),score:t,time:o,duration:s,canMove:u,inDefaults:r,isAlternative:n,jeSuis:i||[]}]));return}let d=a.length+1;for(;a.some(S=>S.id===d);)d=Math.floor(Math.random()*1e3);return a.unshift({id:d,parentGoal:e,title:l.trim(),score:t,time:o,duration:s,canMove:u,inDefaults:r,isAlternative:n,jeSuis:i||[]}),c.localStorage.set("subGoals",JSON.stringify(a)),d}function O(e,l,t,o,s,u,r,n,i){let a=this.getSubGoals;for(var d=0;d<a.length;d++)if(a[d].id===e){a[d].title=l.trim(),a[d].score=t,a[d].time=o,a[d].duration=s,a[d].canMove=u,a[d].inDefaults=r,a[d].isAlternative=n,a[d].jeSuis=i||[];break}c.localStorage.set("subGoals",JSON.stringify(a))}function N(){c.localStorage.remove("mainGoals"),console.log("removed all mainGoal")}function w(){c.localStorage.remove("subGoals"),console.log("removed all subGoals")}function E(){c.localStorage.remove("subGoals"),c.localStorage.remove("mainGoals"),c.localStorage.remove("AllDates"),c.localStorage.remove("Balancey"),console.log("removed ALL")}function f(e,l=null,t=null){let o=this.getSubGoals;for(var s=0;s<o.length;s++)if(o[s].id===e){o[s].time=l||o[s].time,o[s].score=t||o[s].score;break}c.localStorage.set("subGoals",JSON.stringify(o))}function g(e){let l=this.getSubGoals;for(var t=0;t<l.length;t++)l[t].id===e&&(l.splice(t,1),console.log("removeSubgoal spliced!"));return c.localStorage.set("subGoals",JSON.stringify(l)),l}function b(e,l){let t=this.getMainGoals;for(var o=0;o<t.length;o++)t[o].id===e&&(t.splice(o,1),console.log("removeMaingoal spliced!"));return c.localStorage.set("mainGoals",JSON.stringify(t)),t}function y(e){var o;let l=this.getMainGoals;for(var t=0;t<l.length;t++)if(((o=l[t])==null?void 0:o.title.trim())===e)return l[t];return null}function L(e,l=null){let t=this.getAllDates;t?l?t[`${e}`]=l:e in t?delete t[`${e}`]:console.log(`ERROR? deleting schedule of ${e} not found!`):(console.log(`Adding new schedule for ${e}`),t={},t[`${e}`]=l),c.localStorage.set("AllDates",JSON.stringify(t))}function x(e){let l=this.getAllDates;if(l)return l[`${e}`]}function F(e){let l=this.getAllDates;return l?!!l[`${e}`]:!1}function R(){const e=[];let l=function(o){return o==null?void 0:o.inDefaults},t=this.getSubGoals;return t?(t.forEach(o=>{l(o)&&e.push(o)}),e):(console.log("No subgoals to fetch defaults :("),e)}function C(e=null){let l=this.getMainGoals,t=new Set;if(e)for(var o=0;o<l.length;o++)l[o].priority==e&&t.add(l[o].priority);else l.forEach(s=>{t.add(s.priority)});return t}function H(){const e=[];let l=this.getSubGoals;return l&&l.forEach(t=>{t!=null&&t.isAlternative&&e.push(t)}),e}function Q(e){const l=[];let t=function(s){const u=s.split(/on/);return u.length!=2?(console.log(`parseScore error?${s}`,u),-1):u[1]-u[0]},o=this.getSubGoals;return o&&o.forEach(s=>{if(s.score=="")console.log(`no score event added: ${s.title}`,s.score),l.push(s);else{let u=t(s.score);u>-1&&u>=e&&l.push(s)}}),l}function Y(e){const t=(e/60).toFixed(2);return parseFloat(t)}function q(){let e=this.getMainGoals,l=this.getSubGoals,t=(r,n)=>{if(r.id>n.id)return 1;if(r.id==n.id)return 0;if(r.id<n.id)return-1},o=r=>{if(!r)return"";let n=r.split(":");return parseInt(n[0])>=12?r+"PM":r+"AM"},s=r=>{let n=[];return l&&l.forEach(i=>{i.parentGoal==r&&n.push(i)}),n},u=[];return e.forEach(r=>{var d,S,B,I;let n={id:r.id,label:`${r.id}) ${r==null?void 0:r.title.trim()}`,details:`${r.details} ==> Prio:${r==null?void 0:r.priority}`,color:`${r==null?void 0:r.bgcolor}`,prio:r==null?void 0:r.priority,children:[]},i=s(r.id);for(let h=0;h<i.length;h++){let z=i[h].inDefaults?"Dft":"#",U=i[h].canMove?"Mv":"#",W=i[h].isAlternative?"Alt":"#",P=[`${o((d=i[h])==null?void 0:d.time)} for ${(S=i[h])==null?void 0:S.duration} mins`,`:: ${z}~${U}~${W}`].join(`
`);n.children.push({id:i[h].id,label:`${i[h].id})- ${(B=i[h])==null?void 0:B.title.trim()} (${(I=i[h])==null?void 0:I.score})`,details:P,color:`${r==null?void 0:r.bgcolor}`,isChildren:!0,moods:i[h].jeSuis||[]})}let a=n.children;a.sort(t),n.children=a,u.push(n)}),u.sort(t),u}function K(){let e=this.getAllDates;if(!e)return[];let l=this.getMainGoals,t=this.getSubGoals,o={};for(let n in e){let i=e[n];for(let a in i)o[a]||(o[a]=[]),o[a].push({date:n,logged:Y(i[a].duration)})}let s=n=>{let i=[];return t&&t.forEach(a=>{a.parentGoal==n&&i.push(a)}),i},u=(n,i=null)=>{let a={children:[],title:i?`${n.title.trim()}(${n.score})`:`${n.title.trim()} !${n.priority}!`,key:i?`${i}-${n.id}`:n.id,logged:[],expanded:!0,color:n==null?void 0:n.bgcolor,isChild:!!i};if(i){let d=o[n.id]||[];a.logged=[...d]}return a},r=[];return l.forEach(n=>{let i=u(n),a=s(n.id);for(let d=0;d<a.length;d++){let S=u(a[d],n.id);S.logged.length!=0&&(i.logged.push(...S.logged),S.children.length<1?delete S.children:console.log("huh children has descendents?!? ERROR?",S),i.children.push(S))}r.push(i)}),r}return{getMainGoals:T,getSubGoals:j,getAllDates:$,getBalance:M,setBalance:p,addMainGoal:m,addSubGoal:A,editSubGoal:O,editMainGoal:D,importGoals:G,getGoalByTitle:y,saveSubProp:f,saveDailySchedule:L,resetSub:w,resetMain:N,resetAll:E,removeSubgoal:g,removeMaingoal:b,getEventsForDate:x,hasEventsForDate:F,fetchAllTaskSummary:K,fetchGoalsWithMinScore:Q,fetchAllPrio:C,fetchDefaults:R,fetchAlternativeEvts:H,fetchGoalsTree:q}});export{oe as Q,le as a,ne as u};
