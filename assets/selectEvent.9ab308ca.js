import{_ as C,E as r,O as m,H as s,G as a,bs as v,M as i,J as h,K as k,a1 as B,F as p,Q as A,I as c,a2 as V,bu as _,aq as b,N as y,a3 as g,a6 as q,a7 as F}from"./index.2c41191f.js";import{Q as x}from"./QSelect.13f9b917.js";import{b as Q,Q as S}from"./QItem.49a304e8.js";import{Q as E}from"./QKnob.85bead69.js";import{Q as P}from"./QSpace.73bd9570.js";import{w as I}from"./utiFunc.66dd79fc.js";import"./touch.70a9dd44.js";import"./goalStorage.b43d9204.js";const w={name:"selectEvent",props:{unscheduled:Array,unscheduledParents:Array,toBalance:Number,at:String},data(){return{doForce:!1,selectedE:null,dura:null,useBalance:!1,allEvts:this.unscheduled,unscheduledP:this.unscheduledParents,selectedP:null,atTime:I(this.at)}},emits:["onPickEvent","doCancel"],computed:{toFilterBy:{get(){return this.selectedP},set(e){this.selectedP=e,this.toAdd&&(this.toAdd=null)}},allunScheduled:{get(){return this.selectedP?this.unscheduled.filter(e=>e.parentGoal==this.selectedP.id):this.allEvts},set(e){this.allEvts=e}},toAdd:{get(){return this.selectedE},set(e){this.selectedE=e,this.dura=(e==null?void 0:e.duration)||0}}},methods:{clear(){this.toFilterBy=null,this.toAdd=null},onAddClicked(){this.$emit("onPickEvent",this.toAdd,this.doForce,this.useBalance,this.dura),this.doForce=!1,this.useBalance=!1,this.toAdd=null},filterFn(e,t,n){t(()=>{const u=e.toLowerCase();this.allunScheduled=this.unscheduled.filter(d=>(d==null?void 0:d.title.toLowerCase().indexOf(u))>-1)})},setModel(e){this.toAdd=e},goalyColor(e){var t,n,u;return this.toAdd==null?"":e=="c"?"bg-"+((t=this.toAdd)==null?void 0:t.color)+" "+((n=this.toAdd)==null?void 0:n.ic):(u=this.toAdd)==null?void 0:u.color},labely(){var e;return this.toAdd==null||this.toAdd==null||this.toAdd==""?" Sub Goal":` Of: ${((e=this.toAdd)==null?void 0:e.pg)||""}`},classy(){return this.toAdd==null||this.toAdd==null||this.toAdd==""?"q-gutter-md q-px-md":"q-px-md"},canBalance(){var t,n;let e=this.toBalance+parseInt((t=this.toAdd)==null?void 0:t.duration)||((n=this.toAdd)==null?void 0:n.isAlternative);return this.toAdd==null?!1:e}}},f=e=>(q("data-v-92052bdc"),e=e(),F(),e),N={class:"q-pa-md"},U=f(()=>i("div",{class:"text-h3 title"},"Select event",-1)),z={class:"q-mx-md do-center"},G={class:"q-mx-md event-select"},T={key:0,class:"q-mx-md event-select"},M={key:1,class:"q-px-md"},O=f(()=>i("br",null,null,-1)),D=f(()=>i("div",{class:"q-mx-md",style:{"text-align":"center"}}," Add ",-1));function K(e,t,n,u,d,l){return r(),m("div",N,[s(g,null,{default:a(()=>[s(v,null,{default:a(()=>[U,i("div",z,[h(" @ "),i("em",null,k(d.atTime),1)])]),_:1}),s(B),i("div",G,[s(x,{modelValue:l.toFilterBy,"onUpdate:modelValue":t[0]||(t[0]=o=>l.toFilterBy=o),options:d.unscheduledP,class:"q-gutter-md q-px-md","option-value":"id","option-label":"title",popupContentClass:"q-px-sm","input-debounce":"0",label:"Filter by Parent Goal",behavior:"menu"},{default:a(()=>[l.toFilterBy?(r(),p(A,{key:0,name:"clear",size:"14px",onClick:l.clear},null,8,["onClick"])):c("",!0)]),_:1},8,["modelValue","options"])]),this.selectedP?(r(),m("div",T,[s(x,{modelValue:l.toAdd,"onUpdate:modelValue":t[1]||(t[1]=o=>l.toAdd=o),options:l.allunScheduled,class:V(l.classy()),"option-value":"id","option-label":"title",popupContentClass:"q-px-sm",label:l.labely(),"options-selected-class":l.goalyColor("c"),"label-color":l.goalyColor("l"),onFilter:l.filterFn,onInputValue:l.setModel,"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",behavior:"menu"},{"no-option":a(()=>[s(Q,null,{default:a(()=>[s(S,{class:"text-grey"},{default:a(()=>[h(" No results ")]),_:1})]),_:1})]),before:a(()=>[l.toAdd?(r(),p(A,{key:0,name:l.toAdd.ic,size:"14px",class:"q-mx-md q-pr-sm"},null,8,["name"])):c("",!0)]),_:1},8,["modelValue","options","class","label","options-selected-class","label-color","onFilter","onInputValue"])])):c("",!0),l.toAdd?(r(),m("div",M,[h(" Duration (min) "),s(E,{min:5,max:120,thickness:.22,step:5,modelValue:d.dura,"onUpdate:modelValue":t[2]||(t[2]=o=>d.dura=o),"show-value":"",size:"75px",color:"teal","track-color":"grey-3",class:"q-ma-md"},null,8,["thickness","modelValue"])])):c("",!0),O,s(_,{align:"center",class:"q-px-xl"},{default:a(()=>[s(b,{dense:"",modelValue:d.doForce,"onUpdate:modelValue":t[3]||(t[3]=o=>d.doForce=o),label:"Force In",color:"teal"},null,8,["modelValue"]),s(P),l.canBalance()?(r(),p(b,{key:0,dense:"",modelValue:d.useBalance,"onUpdate:modelValue":t[4]||(t[4]=o=>d.useBalance=o),label:"Use Balance",color:"brown"},null,8,["modelValue"])):c("",!0)]),_:1}),s(_,{align:"center"},{default:a(()=>[s(y,{flat:"",label:"Cancel",color:"primary",onClick:t[5]||(t[5]=o=>e.$emit("doCancel"))}),s(y,{elevated:"",color:"primary",align:"between",onClick:l.onAddClicked},{default:a(()=>[D]),_:1},8,["onClick"])]),_:1})]),_:1})])}var Z=C(w,[["render",K],["__scopeId","data-v-92052bdc"]]);export{Z as default};
