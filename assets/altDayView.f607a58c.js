import{j as Me,U as _e,W as $e,r as R,c as j,w as pe,n as Be,h as Z,k as ae,ay as ke,D as xe,g as Le,az as Ge,ac as de,v as Ve,aA as Ie,a9 as ee,aC as ve,aa as he,Z as He,_ as Fe,$ as J,L as I,E as w,F as H,G as P,M,H as N,O as A,I as _,N as ye,K as L,J as q,a1 as je,Q as be,a2 as te,bf as Je,P as Ee,R as Q,a5 as K,a4 as z,aU as ce,f as qe,a6 as ze,a7 as We}from"./index.a1cffa07.js";import{w as B,i as se,p as Ue,a as Qe,b as Ke,Q as ie,c as Oe}from"./utiFunc.5349c58b.js";import{T as Ye,Q as Xe,a as Ze}from"./QSelect.e0680041.js";import{t as ne,E as De,b as k,a as D,p as G,i as oe,c as fe,d as V,U as F,V as et,m as ge,l as W,Q as tt,e as it}from"./QCalendarTask.1ee0b907.js";import{c as ue,u as ot,a as lt}from"./goalStorage.7568199c.js";import{a as st}from"./QCalendar.5012333b.js";/* empty css                             */import"./touch.70a9dd44.js";import"./QItem.27ffb624.js";var Ce=Me({name:"QSplitter",props:{..._e,modelValue:{type:Number,required:!0},reverse:Boolean,unit:{type:String,default:"%",validator:o=>["%","px"].includes(o)},limits:{type:Array,validator:o=>o.length!==2||typeof o[0]!="number"||typeof o[1]!="number"?!1:o[0]>=0&&o[0]<=o[1]},emitImmediately:Boolean,horizontal:Boolean,disable:Boolean,beforeClass:[Array,String,Object],afterClass:[Array,String,Object],separatorClass:[Array,String,Object],separatorStyle:[Array,String,Object]},emits:["update:modelValue"],setup(o,{slots:e,emit:t}){const{proxy:{$q:i}}=Le(),l=$e(o,i),s=R(null),n={before:R(null),after:R(null)},r=j(()=>`q-splitter no-wrap ${o.horizontal===!0?"q-splitter--horizontal column":"q-splitter--vertical row"} q-splitter--${o.disable===!0?"disabled":"workable"}`+(l.value===!0?" q-splitter--dark":"")),h=j(()=>o.horizontal===!0?"height":"width"),m=j(()=>o.reverse!==!0?"before":"after"),p=j(()=>o.limits!==void 0?o.limits:o.unit==="%"?[10,90]:[50,1/0]);function b(f){return(o.unit==="%"?f:Math.round(f))+o.unit}const E=j(()=>({[m.value]:{[h.value]:b(o.modelValue)}}));let S,v,C,y,a;function u(f){if(f.isFirst===!0){const T=s.value.getBoundingClientRect()[h.value];S=o.horizontal===!0?"up":"left",v=o.unit==="%"?100:T,C=Math.min(v,p.value[1],Math.max(p.value[0],o.modelValue)),y=(o.reverse!==!0?1:-1)*(o.horizontal===!0?1:i.lang.rtl===!0?-1:1)*(o.unit==="%"?T===0?0:100/T:1),s.value.classList.add("q-splitter--active");return}if(f.isFinal===!0){a!==o.modelValue&&t("update:modelValue",a),s.value.classList.remove("q-splitter--active");return}const g=C+y*(f.direction===S?-1:1)*f.distance[o.horizontal===!0?"y":"x"];a=Math.min(v,p.value[1],Math.max(p.value[0],g)),n[m.value].value.style[h.value]=b(a),o.emitImmediately===!0&&o.modelValue!==a&&t("update:modelValue",a)}const c=j(()=>[[Ye,u,void 0,{[o.horizontal===!0?"vertical":"horizontal"]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function d(f,g){f<g[0]?t("update:modelValue",g[0]):f>g[1]&&t("update:modelValue",g[1])}return pe(()=>o.modelValue,f=>{d(f,p.value)}),pe(()=>o.limits,()=>{Be(()=>{d(o.modelValue,p.value)})}),()=>{const f=[Z("div",{ref:n.before,class:["q-splitter__panel q-splitter__before"+(o.reverse===!0?" col":""),o.beforeClass],style:E.value.before},ae(e.before)),Z("div",{class:["q-splitter__separator",o.separatorClass],style:o.separatorStyle,"aria-disabled":o.disable===!0?"true":void 0},[ke("div",{class:"q-splitter__separator-area absolute-full"},ae(e.separator),"sep",o.disable!==!0,()=>c.value)]),Z("div",{ref:n.after,class:["q-splitter__panel q-splitter__after"+(o.reverse===!0?"":" col"),o.afterClass],style:E.value.after},ae(e.after))];return Z("div",{class:r.value,ref:s},xe(e.default,f))}}}),nt=Ge({name:"touch-hold",beforeMount(o,e){const{modifiers:t}=e;if(t.mouse!==!0&&de.has.touch!==!0)return;const i={handler:e.value,noop:Ve,mouseStart(s){typeof i.handler=="function"&&Ie(s)===!0&&(ee(i,"temp",[[document,"mousemove","move","passiveCapture"],[document,"click","end","notPassiveCapture"]]),i.start(s,!0))},touchStart(s){if(s.target!==void 0&&typeof i.handler=="function"){const n=s.target;ee(i,"temp",[[n,"touchmove","move","passiveCapture"],[n,"touchcancel","end","notPassiveCapture"],[n,"touchend","end","notPassiveCapture"]]),i.start(s)}},start(s,n){i.origin=ve(s);const r=Date.now();de.is.mobile===!0&&(document.body.classList.add("non-selectable"),ue(),i.styleCleanup=h=>{i.styleCleanup=void 0;const m=()=>{document.body.classList.remove("non-selectable")};h===!0?(ue(),setTimeout(m,10)):m()}),i.triggered=!1,i.sensitivity=n===!0?i.mouseSensitivity:i.touchSensitivity,i.timer=setTimeout(()=>{i.timer=void 0,ue(),i.triggered=!0,i.handler({evt:s,touch:n!==!0,mouse:n===!0,position:i.origin,duration:Date.now()-r})},i.duration)},move(s){const{top:n,left:r}=ve(s);i.timer!==void 0&&(Math.abs(r-i.origin.left)>=i.sensitivity||Math.abs(n-i.origin.top)>=i.sensitivity)&&(clearTimeout(i.timer),i.timer=void 0)},end(s){he(i,"temp"),i.styleCleanup!==void 0&&i.styleCleanup(i.triggered),i.triggered===!0?s!==void 0&&He(s):i.timer!==void 0&&(clearTimeout(i.timer),i.timer=void 0)}},l=[600,5,7];if(typeof e.arg=="string"&&e.arg.length>0&&e.arg.split(":").forEach((s,n)=>{const r=parseInt(s,10);r&&(l[n]=r)}),[i.duration,i.touchSensitivity,i.mouseSensitivity]=l,o.__qtouchhold=i,t.mouse===!0){const s=t.mouseCapture===!0||t.mousecapture===!0?"Capture":"";ee(i,"main",[[o,"mousedown","mouseStart",`passive${s}`]])}de.has.touch===!0&&ee(i,"main",[[o,"touchstart","touchStart",`passive${t.capture===!0?"Capture":""}`],[o,"touchend","noop","notPassiveCapture"]])},updated(o,e){const t=o.__qtouchhold;t!==void 0&&e.oldValue!==e.value&&(typeof e.value!="function"&&t.end(),t.handler=e.value)},beforeUnmount(o){const e=o.__qtouchhold;e!==void 0&&(he(e,"main"),he(e,"temp"),e.timer!==void 0&&clearTimeout(e.timer),e.styleCleanup!==void 0&&e.styleCleanup(),delete o.__qtouchhold)}});const rt=()=>!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);let U,$;function at(){U={},$=ot()}function dt(){U.pGoalsMap==null;const o=new Map;let e=Ae();return e?(e.forEach(t=>{o.set(t.id,t)}),U.pGoalsMap=o,o):(console.log("Repo:: parentGoalsMap is empty or null",e),o)}function ht(o){return $.hasEventsForDate(o)}function Te(o){return $.getEventsForDate(o)}function Ae(){return $.getMainGoals}function ct(){return U.subGoals==null&&(U.subGoals=$.getSubGoals),U.subGoals}function ut(){return $.fetchAlternativeEvts()}function ft(){return $.currentBalance()}function gt(){return $.fetchGoalsTree()}function mt(){let o=$.fetchAllPrio();return!o.size>0?(console.log("ERROR...no Priority goals?",o),[]):Array.from(o.values()).sort()}function St(o){return $.fetchGoalsUpToMaxScore(o)}function we(o,e=null,t=null){$.saveSubProp(o,e,t)}function pt(){return $.getGoalByTitle("Misc")}function Re(o){$.setBalance(o)}function Ne(o,e){$.saveDailySchedule(o,e)}function vt(o,e,t,i){return $.addMainGoal(o,e,t,i)}function le(o,e,t,i,l,s,n,r,h){return $.addSubGoal(o,e,t,i,l,s,n,r,h)}function yt(o,e,t=null){let i=o,l=e.id,s=e,n=t,r=o.duration,h=o.time,m=null,p=null;return{id:l,duration:r,time:h,date:()=>m,datey:b,score:E(),getGoal:()=>s,getPGoal:()=>n,data:()=>i,setData:f=>i=f,setMoods:f=>p=f,getMoods:y,setNotes:f=>f,hasNote:S,setDura:f=>r=f,setTime:f=>h=f,setDate:f=>m=f,durationChanged:v,timeChanged:C,parsedScore:a,withPropsEventsTo:c,addPropsEventsTo:d};function b(){return m}function E(){return i.atScore||e.score}function S(){return o.notes!==void 0}function v(){return o.duration!==e.duration}function C(){return o.time!==e.time}function y(){return"byMood"in i&&(p=i.byMood),p}function a(){const f=E().split(/on/);return f.length!=2?-89:f[1]-f[0]}function u(f){if(!f)return"";let g=f.split(":");return parseInt(g[0])>=12?f+"PM":f+"AM"}function c(f,g=null){let O=Object.assign({},{...this});return O.bgcolor=f.bgcolor,O.jeSuis?O.details=`Of '${f.title.trim()}' :: << ${O.jeSuis.join(",")} >>`:O.details=`Of '${f.title.trim()}' :: ${u(O==null?void 0:O.time)} -> ${O==null?void 0:O.duration}min -- ${O!=null&&O.inDefaults?"Dft:":":"}${O!=null&&O.canMove?":Mv:":":"}${O!=null&&O.isAlternative?":Alt":":"}`,console.log("withProps",JSON.parse(JSON.stringify(O)),O.datey(),O.date(),O.title,O.details),O}function d(f){if(!n){console.log("addProps:: ERROR no parentGoal",this.data);return}this.data,getGoal();let g=Object.assign({},{...sav});return g.bgcolor=t.bgcolor,g.jeSuis?g.details=`Of '${t.title.trim()}' :: << ${g.jeSuis.join(",")} >>`:g.details=`Of '${t.title.trim()}' :: ${u(g==null?void 0:g.time)} -> ${g==null?void 0:g.duration}min -- ${g!=null&&g.inDefaults?"Dft:":":"}${g!=null&&g.canMove?":Mv:":":"}${g!=null&&g.isAlternative?":Alt":":"}`,console.log("addProps",JSON.parse(JSON.stringify(g)),g.datey(),g.date(),g.title,g.details),g}}class bt{constructor(e,t){this.showReloadBtn=!1,this.showClearBtn=!1,this.showLoadDefaults=!0,this.showScoreBtn=!0,this.showPrioBtn=!0,this.showOneEachBtn=!1,this.disablePrioBtn=!0,this.disableScoreBtn=!0,this.disableSaveSchedule=!0,this.chosenScore=null,this.chosenPrio=null,this._dailyScheduled=new Map,this._endTimesSet=new Set,this._startTimesSet=new Set,this.savedRawEvts=[],this.actualEvts=[],this.usingMoods={},this.isDisabledScoreEdit={},this.hasStarted={},this.mobileEnableScore={},this.showMobileDialog={},this.currentDate=e,this.mobile=t,at()}allPGoals(){return Ae()}getAllEvts(){return this.actualEvts}showEvtNoteScoreMobile(e){return this.mobileEnableScore[e]&&this.showMobileDialog[e]}toggleEvtNoteScoreMobile(e){console.log("toggleEvtNoteScoreMobile >>",e),(this.isViewingPast()||this.isViewingToday())&&(this.showMobileDialog[e]=!0)}euhHidin(e){console.log("euhHidin >>",e),this.showMobileDialog[e]=!1}getCurrentSchedTimesSets(){return{endSet:this._endTimesSet,startSet:this._startTimesSet}}isViewingPast(){let e=ne();if(this.currentDate&&this.currentDate==e)return!1;let t=De(k(e));return!(De(k(this.currentDate))>=t)}isViewingToday(){return ne()==this.currentDate}toggle(){this.showReloadBtn=!this.showReloadBtn}getProps(){return{showReloadBtn:this.showReloadBtn,showClearBtn:this.showClearBtn,showLoadDefaults:this.showLoadDefaults,showScoreBtn:this.showScoreBtn,showPrioBtn:this.showPrioBtn,showOneEachBtn:this.showOneEachBtn,disablePrioBtn:this.disablePrioBtn,disableScoreBtn:this.disableScoreBtn,chosenScore:this.chosenScore,chosenPrio:this.chosenPrio}}saveBtnEnabled(){return this.disableSaveSchedule}fetchGoalsTree(){return gt()}getCurrentBalance(){return ft()}getAllPrio(){return mt()}getSubGoals(){return ct()}getCurrentMoods(){return this.usingMoods}getSubGoalByID(e){let t=this.getSubGoals(),i=parseInt(e);for(let l=0;l<t.length;l++)if(t[l].id===i)return t[l];return null}getAltEvts(){return ut()}getEventsForDate(e){return Te(e)}updateDaySchedule(e,t){Ne(e,t)}parentGoalsMap(){return dt()}parentGoalById(e){return this.parentGoalsMap().has(e)?this.parentGoalsMap().get(e):null}findEvent(e){return this._dailyScheduled.has(e)?this._dailyScheduled.get(e):null}findSchedEvent(e){for(let t=0;t<this.actualEvts.length;t++)if(this.actualEvts[t].id===e)return this.actualEvts[t];return null}hasEventsForDate(){return ht(this.currentDate)}getDateEvents(e){let t=(l,s)=>{let n=V(l.sortTime,s.sortTime);if(n>0)return-1;if(n==0)return 0;if(n<0)return 1};const i=this.currentSchedEventsMap()[e]||[];if(i.length===1)i[0].side="full";else if(i.length===2){const l=D(k(i[0].date),{minute:G(i[0].time)}),s=D(l,{minute:i[0].duration}),n=D(k(i[1].date),{minute:G(i[1].time)}),r=D(n,{minute:i[1].duration});oe(n,l,s,!0)||oe(r,l,s,!0)?(console.log("getDateEvents...LENGTH==2..LEFT/RIGHT 'TWIX"),i[0].side="left",i[1].side="right"):(i[0].side="full",i[1].side="full")}return i.sort(t)}currentSchedEventsMap(){const e={};return this.actualEvts.forEach(t=>{let i=t.date;if(e[i]||(e[i]=[]),e[i].push(t),t.days){console.log(`currentSchedEventsMap multiple days? event for ${t.date}`,t.days);let l=fe(t.date),s=t.days;do l=D(l,{day:1}),map[l.date]||(map[l.date]=[]),map[l.date].push(t);while(--s>0)}}),e}enrichAddToSchedule(){let e={},t=this.isViewingToday();console.log("enrichAddToSchedule",Object.keys(this.savedRawEvts).length,"overlapCheck:"+t);for(let i in this.savedRawEvts){let l=this.savedRawEvts[i],s=this.getSubGoalByID(i);if(!s){console.log(`enrichAddToSchedule:: No goal found for key: ${i}...skipping!`);continue}let n=this.parentGoalById(s.parentGoal),r=yt(l,s,n),h=this.addToSchedule(r,t,!0);h?Array.isArray(h)&&(e[s.id]=h):console.log("enrichAddToSchedule..ERROR?!? not added",h,s)}return this.massageOverlapObj(e)}loadEvtsForDay(e){return e||this.resetSchedule(),this.savedRawEvts=Te(this.currentDate),this.savedRawEvts?{overlaps:this.enrichAddToSchedule(),canContinue:!1}:{overlaps:null,canContinue:!0}}onChangeViewDate(e){let t=e==this.currentDate;return this.currentDate=e,this.enableActionBtns(),this.loadEvtsForDay(t)}resetSchedule(){this.savedRawEvts=[],this.actualEvts=[],this._dailyScheduled=new Map,this._endTimesSet=new Set,this._startTimesSet=new Set,this.usingMoods={},this.showReloadBtn=!1,this.showClearBtn=!1,this.disableSaveSchedule=!0}unscheduledDefaults(){return this.getSubGoals().filter(t=>(t==null?void 0:t.inDefaults)&&(t==null?void 0:t.time)!=""&&!this.actualEvts.find(i=>i.id==t.id))}unscheduled(){return this.getSubGoals().filter(t=>!this.actualEvts.find(i=>i.id==t.id))}subGoalsOfParent(e){return this.getSubGoals().filter(i=>i.parentGoal==e)}chosenScoreLabel(){return this.chosenScore==null?"By Score":`Score <= ${this.chosenScore}`}chosenPrioLabel(){return this.chosenPrio==null?"By Priority":`Prio = ${this.chosenPrio}`}onChoosenPrio(e){let t=this.chosenPrio;t&&t==e?this.disablePrioBtn=!0:(this.chosenPrio=e,this.disablePrioBtn=!1)}onChoosenScore(e){let t=this.chosenScore;t&&t==e?this.disableScoreBtn=!0:(this.chosenScore=e,this.disableScoreBtn=!1)}scheduleByScore(e){const t=()=>{let n=[];return this.actualEvts.forEach(r=>{let h=se(r.score);h>-1&&h<=this.chosenScore&&n.push(r)}),n};let i=[];if(e=="filter")i=t(),this.resetSchedule();else{const n=St(this.chosenScore);e=="add"?i=n.filter(r=>!this.actualEvts.find(h=>h.id==r.id)):(i=n,this.resetSchedule())}if(console.log(`scheduleByScore::AFTER flag ${e} from size: ${this.actualEvts.length} to some evts = ${i.length}`),i.length<1)return console.log(`Empty for Score <= ${this.chosenScore} :(`),this.toggleActionBtns(!1,"byScore"),{overlaps:null,canContinue:!1};let l=this.addGoalsToSchedule(i,this.isViewingToday()),s=Object.keys(l).length;return this.toggleActionBtns(i.length>0,"byScore"),{overlaps:l,canContinue:!(s>0)}}scheduleSamePrio(e){const t=()=>this.actualEvts.filter(n=>{var r;return((r=this.parentGoalById(n.parentGoal))==null?void 0:r.priority)==this.chosenPrio});let i=[];if(e=="filter")i=t(),this.resetSchedule();else{let n=this.getSubGoals();for(let r of n){let h=this.parentGoalById(r.parentGoal);(h==null?void 0:h.priority)==this.chosenPrio&&i.push(r)}e=="add"?i=i.filter(r=>!this.actualEvts.find(h=>h.id==r.id)):this.resetSchedule(),console.log(`scheduleSamePrio...${e} to size: ${this.actualEvts.length} some evts = ${i.length}`,JSON.parse(JSON.stringify(i)))}if(i.length<1)return console.log(`Empty for Priority == ${this.chosenPrio} :(`),this.toggleActionBtns(!1,"byPrio"),{overlaps:null,canContinue:!1};let l=this.addGoalsToSchedule(i,this.isViewingToday()),s=Object.keys(l).length;return this.toggleActionBtns(i.length>0,"byPrio"),{overlaps:l,canContinue:!(s>0)}}massageOverlapObj(e){let t={};for(let i in e){let l=e[i];if(l.length>0){let s=0;do{let n=l[s];t[n.inConflict]||(t[n.inConflict]=[]),t[n.inConflict].push(n),s>0&&(console.log("WOAH WOAH, massageOverlapObj:: multiple overlaps with same obj!"+s,l,n),n.inConflict in t&&(console.log("WOAH deleting inConflict",n.inConflict),delete t[n.inConflict]),l[s-1].inConflict in t&&(console.log("WOAH deleting PREV inConflict",l[s-1].inConflict),delete t[l[s-1].inConflict]),t[n.target]?(t[n.target].push(n),console.log("WOAH obj.id already present?",n.target)):t[n.target]=[n],t[n.target].unshift(l[s-1]),t.withID=!0)}while(++s<l.length)}}return t}massageSingleOverlapArr(e){let t={};for(let i=0;i<e.length;i++){let l=e[i];t[l==null?void 0:l.inConflict]?t[l==null?void 0:l.inConflict].push(l):t[l==null?void 0:l.inConflict]=[l],i>0&&(console.log("WOAH WOAH,massageSingleOverlapArr..multiple overlaps with same target>>",e[i].target),l.inConflict in t&&(console.log("WOAH deleting inConflict",l.inConflict),delete t[l.inConflict]),e[i-1].inConflict in t&&(console.log("WOAH deleting PREV inConflict",e[i-1].inConflict),delete t[e[i-1].inConflict]),t[l.target]?(t[l.target].push(l),console.log("WOAH obj.id already present?",l.target)):t[l.target]=[l],t[l.target].unshift(e[i-1]),t.withID=!0)}return t}scheduleOneEach(e){const t=r=>{let h=[];return this.parentGoalsMap().forEach((m,p,b)=>{let E=this.subGoalsOfParent(m.id);if(E.length>0){let S=null,v=E.length;if(r)S=E[Math.floor(Math.random()*v)];else{let C=0;for(;this.actualEvts.some(y=>E[v].id==y.id);)if(C++,v=Math.floor(Math.random()*E.length),console.log(`selectOneFromP::index ${v} scheduled...new random> At try> `+C,E.length),C>2){console.log("selectOneFromP::random...TOO MANY TRIES..ERROR?",C,v,E.length,E);break}S=E[v],console.log("selectOneFromP::NO Random at index: "+v,C,S)}h.push(S)}else console.log("scheduleOneEach::selectOneFromP...huh no subgoals for parentGoal",m)}),h},i=()=>{let r=this.unscheduled(),h=[];return this.parentGoalsMap().forEach((m,p,b)=>{let E=r.filter(v=>v.parentGoal==m.id),S=E.length;if(S>0){let v=E[Math.floor(Math.random()*S)];h.push(v)}else console.log("scheduleOneEach::No goal for parent!!",p,m==null?void 0:m.title)}),h};let l=[];if(e=="add"?(l=i(),console.log("scheduleOneEach...TOADD!!",l)):(this.resetSchedule(),l=t(!0)),l.length<1)return console.log("Empty for OneEach :("),this.toggleActionBtns(!1,"oneEach"),{overlaps:null,canContinue:!1};let s=this.addGoalsToSchedule(l,this.isViewingToday()),n=Object.keys(s).length;return this.toggleActionBtns(l.length>0,"oneEach"),{overlaps:s,canContinue:!(n>0)}}scheduleByMood(e){var s;let t=[];for(let n=0;n<e.length;n++){let r=this.getSubGoalByID(e[n].id);r&&r.time!=""&&(t.push(r),this.usingMoods[e[n].id]=(s=e[n])==null?void 0:s.mood)}if(t.length<1)return console.log("Empty for Mood :("),this.toggleActionBtns(!1,"ByMood"),{overlaps:null,canContinue:!1};let i=this.addGoalsToSchedule(t,this.isViewingToday()),l=Object.keys(i).length;return l>0&&console.log(`scheduleByMood overlaps!! to ${t.length}. overlaps =${l}`),this.toggleActionBtns(t.length>0,"ByMood"),{overlaps:i,canContinue:!(l>0)}}scheduleDefaults(e){let t=null;e=="add"?t=this.unscheduledDefaults():(this.resetSchedule(),t=this.unscheduledDefaults()),this.showReloadBtn=this.hasEventsForDate(),this.showClearBtn=!this.isViewingPast()&&t.length>0;let i=this.addGoalsToSchedule(t,this.isViewingToday()),l=Object.keys(i).length;return l>0&&console.log(`scheduleDefaults:: Overlaps!! for ${t.length}...overlaps =${l}`),this.toggleActionBtns(t.length>0,"defaults"),{overlaps:i,canContinue:!(l>0)}}schedEvtWithProps(e,t,i){if(!e.getPGoal()){console.log("schedEvtWithProps:: ERROR no parentGoal",e.data);return}let l=e.data(),s=e.getGoal(),n=e.getPGoal(),r={...s};(e.timeChanged()||e.durationChanged())&&(r.time=l.time,r.duration=l.duration),e.setDate(this.currentDate);let h=e.getMoods();if(h){//!==
this.usingMoods[r.id]=h}return r.date=this.currentDate,r.bgcolor=n.bgcolor,r.start=t,r.end=i,r.jeSuis?r.details=`Of '${n.title.trim()}' :: << ${r.jeSuis.join(",")} >>`:r.details=`Of '${n.title.trim()}' :: ${B(r==null?void 0:r.time)} -> ${r==null?void 0:r.duration}min -- ${r!=null&&r.inDefaults?"Dft:":":"}${r!=null&&r.canMove?":Mv:":":"}${r!=null&&r.isAlternative?":Alt":":"}`,e.hasNote()&&(r.notes=l.notes),r}saveNewGoal(e,t,i,l,s){if(console.log(`saveNewGoal:${t} :${l}: from ${e.time}.Duration:${s}`),l=="self"){let n=this.addParentGoal(t,t,"purple-10",2);if(n)return le(n,t,"1on5",e.time,s,!0,!1,s<30);console.log("ERROR? no pID",n)}else if(i){return console.log("with parentGoal "+i.id,i==null?void 0:i.title),le(i.id,t,"1on5",e.time,s,!1,!1,s<30);//!canMove and notInDefaults. isAlternative when duration<30
}else{let n=pt();if(n){return console.log("Woo!! Misc pGoal already exists!",n.id),le(n.id,t,"1on5",e.time,s,!1,!1,s<30);//!canMove and notInDefaults.isAlternative when duration<30
}else{let r=this.addParentGoal("Misc","Miscellaneous","grey-10",2);if(r)return le(r,t,"1on5",e.time,s,!0,!1,s<30)}}return null}addParentGoal(e,t,i="red-14",l=2){let s=[];this.parentGoalsMap().forEach((h,m,p)=>{let b=h.bgcolor;s.push(b)});let n=Ue(),r=s.length;if(r>1){let h=r;for(;s.some(p=>n[h]==p);)console.log("addParentGoal::index with taken color...new random",h,n[h]),h=Math.floor(Math.random()*r);let m=n[h];console.log(`addParentGoal::bgcolor..index ${h} from ${i} to: `,m),i=m||i}return vt(e,t,i,l)}onPickEvent(e,t,i,l){let s=D(t,{minute:e.duration}),n=this.hasOverlappingEvent(e.id,t,s);if(n.length>0)return{overlaps:this.massageSingleOverlapArr(n),canContinue:!1};{if(l){let h=this.getCurrentBalance(),m=h+parseInt(e==null?void 0:e.duration);console.log("onPickEvent...useBalance",h,m),Re(m)}let r=this.addToSchedule({...e,time:t.time},!1);return console.log("onPickEvent::NO overlap",l,r),this.isViewingPast()||l?this.saveDaySchedule():this.toggleActionBtns(!0,"onPickEvt"),{overlaps:r,canContinue:!0}}}onAdHocEvent(e){let t=this.getSubGoalByID(e);if(!t)return{overlaps:null,canContinue:!1};let i=this.addToSchedule(t,!0);return!i||Array.isArray(i)?(console.log("onAdHocEvent::Overlaps!!",JSON.parse(JSON.stringify(i))),{overlaps:i?this.massageSingleOverlapArr(i):null,canContinue:!1}):(this.isViewingPast()?this.saveDaySchedule():this.toggleActionBtns(!0,"onAdHoc"),{overlaps:null,canContinue:!0})}recurChangeTime(e,t,i,l=!1){let s=this.findEvent(e);if(s){let n=G(s.start.time)-G(i.time),r=`${n>0?"DOWN":"UP"}`,h=null;if(n>=0){h=D(i,{minute:parseInt(t.duration)+10});let b=D(i,{minute:parseInt(s.for)+10});console.log(`recurChangeTime::${e}...FORWARD ${r} for ${n} due to evt:${t.id} at ${i.time} 
          
 doAdd?:${l} >`,JSON.parse(JSON.stringify(h.time)),"alt:",b.time);let E=V(b,h);E>0&&(Math.floor(E/1e3/60)<=n?console.log(`recurChangeTime::${e}....with duration:${s.for} vs evtDura:${t.duration}...NOT using alternative!!`):(console.log(`recurChangeTime::DIFFY>>${E}...gonna use Alternative`,b.time),h=b))}else{h=D(i,{minute:-(parseInt(s.for)+10)});let b=D(i,{minute:-(parseInt(t.duration)+10)}),E=V(b,h);console.log(`recurChangeTime::${e}...BACKWARD ${r} for ${n} due to evt:${t.id} at ${i.time}
          
 doAdd?:${l}`,h.time,"alt:"+b.time,"diffy="+E)}let m=this.hasOverlappingEvent(e,h,D(h,{minute:s.for}));if(m.length>0){console.log(`WARNING WARNING::more Overlaps::recurChangeTime ${e} at ${h.time}`,m.length,m);let b=0,E=m.length,S=this.findSchedEvent(e);console.log(S?`Cascading time change while adding '${S==null?void 0:S.title.trim()}' due to "${t.title.trim()}"`:`ERROR::recurChangeTime ${e} not found`);do{if(console.log(`WARNING CASCADING timeChange ${e}-${S==null?void 0:S.title} at: ${h.time} 'gon recurChangeTime::
            OLDie doAdd?:${l} 
 now at: ${s.start.time}  till ${s.end.time}`,m[b]),m[b].inConflict==t.id){console.log(`EUUUH...::recurChangeTime::self overlap?!?${e} ...breaking!`,m[b]);break}this.recurChangeTime(m[b].inConflict,S,h,l)}while(++b<E)}this.changeEvtTime(s,h),console.log(`recurChangeTime::OVERLAPPED: ${e} ${r} to ${h.time} >> doAdd:${l}`);let p=i;console.log(`recurChangeTime::TARGET:(${t.id})${t==null?void 0:t.title.trim()} going ${r}>> doAdd?:${l} to time>> ${p.time}`),l?this.addGoalsToSchedule([{...t,time:p.time}],!1):this.changeEvtTime(t,p)}else console.log("ERROR..ERROR recurChangeTime:: overlapped event not found!",e,t)}hasOverlappingEvent(e,t,i){const l=[];return this._dailyScheduled.forEach((s,n,r)=>{if(n!=e){let h=this.checkOverlapByTime(t,i,s.start,s.end);h&&(this._startTimesSet.has(t.time)&&console.log(`hasOverlappingEvent ${e} same start`,t.time),l.push({target:e,targetStart:t,direction:h,inConflict:n}))}}),l}checkOverlapByTime(e,t,i,l){let s=this.getTimeyNumber(e),n=this.getTimeyNumber(t),r=this.getTimeyNumber(i),h=this.getTimeyNumber(l);if(s===!1||r===!1||n===!1||h===!1)return console.log("ERROR... checkOverlapByTime error",s,n,r,h),!1;let m=!1;return s>r&&s<h&&(m="bas"),n>r&&n<h&&(m="haut"),(r>=s&&n>=h||s>=r&&n<=h)&&(m="surrounding"),m}doProppy(e,t){let i=this.parentGoalById(e.parentGoal);if(!i){console.log("doProppy:: ERROR no Pgoal found ?!?",e);return}let l=D(k(t),{minute:G(e.time)}),s=D(l,{minute:e.duration}),n=Object.assign({},{...e,date:t,bgcolor:i.bgcolor,start:l,end:s});return e.jeSuis?n.details=`Of '${i.title.trim()}' :: << ${e.jeSuis.join(",")} >>`:n.details=`Of '${i.title.trim()}' :: ${B(e==null?void 0:e.time)} -> ${e==null?void 0:e.duration}min -- ${e!=null&&e.inDefaults?"Dft:":":"}${e!=null&&e.canMove?":Mv:":":"}${e!=null&&e.isAlternative?":Alt":":"}`,n.sortTime=l,n}canDropEvent(e,t){let i=D(e,{minute:t.duration}),l=this.hasOverlappingEvent(t.id,e,i);return l.length>0?(console.log("canDropEvent::OVERLAP of size="+l.length,l),{overlaps:this.massageSingleOverlapArr(l),canContinue:!1}):(this.toggleActionBtns(!0,"canDropEvent"),{overlaps:null,canContinue:!0})}toggleActionBtns(e,t){this.disableSaveSchedule=!e,this.showReloadBtn=this.hasEventsForDate(),this.showClearBtn=!this.isViewingPast()&&e}resetChosen(){this.chosenScore=null,this.chosenPrio=null}enableActionBtns(){let e=this.isViewingPast();this.showOneEachBtn=!e,this.showLoadDefaults=!e,this.showScoreBtn=!e,this.showPrioBtn=!e}tooClose(e,t){let i=D(e,{minute:0}),l=this.getTimeNumber(i),s=D(e,{day:1}),n=new Date(s.date);n.setHours(24),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0);let r=F(n),h=Math.floor(V(i,r)/1e3/60);if(h<t)return console.log("tooClose to midnight eh...:(",h),!0;let m=!1;return this._dailyScheduled.forEach((p,b,E)=>{let v=this.getTimeNumber(p.start)-l,C=V(i,p.start);Math.floor(C/1e3/60)<=10&&v>0&&(m=b)}),m}changeEvtTime(e,t,i){return i=="ok"&&we(e.id,t.time,null),this.doUpdateSchedule(e,t),i}addGoalsToSchedule(e,t){let i={};return e.forEach(l=>{let s=this.addToSchedule(l,t,!1);s?Array.isArray(s)&&(i[l.id]=s):console.log("addGoalsToSchedule::ERROR?!? not added",s,l)}),this.massageOverlapObj(i)}addToSchedule(e,t,i=!1){if(this._dailyScheduled.has(e.id))return console.log("addToSchedule--NOT created>>HAS already!!?",t,e),!1;{let l=D(k(this.currentDate),{minute:G(e.time)}),s=D(l,{minute:e.duration});if(t){let r=this.hasOverlappingEvent(e.id,l,s);if(r.length>0)return r}let n=i?this.schedEvtWithProps(e,l,s):this.doProppy(e,this.currentDate);n.sortTime=l,this.actualEvts.push(n),this._dailyScheduled.set(n.id,{...n,for:n.duration,start:l,end:s,score:n.score}),this._endTimesSet.add(s.time),this._startTimesSet.add(l.time),this.enableNoteScoreEdit(n.id,l,s)}return!0}doUpdateSchedule(e,t){let i=this.findEvent(e.id),l=this.findSchedEvent(e.id);if(!i||!l){console.log("doUpdateSchedule-ERROR NOT found",i,l);return}let s=D(k(l.date),{minute:G(t.time)}),n=D(s,{minute:l.duration});this._endTimesSet.delete(i.end.time)?this._endTimesSet.add(n.time):console.log("doUpdateSchedule-endTimesSet NOT FOUND?!?"),this._startTimesSet.delete(i.start.time)?this._startTimesSet.add(s.time):console.log("doUpdateSchedule-startTimesSet NOT FOUND?!?",e.id,t),this._dailyScheduled.set(e.id,{...i,for:i.duration,start:s,end:n}),l.time=t.time,l.sortTime=s,this.enableNoteScoreEdit(e.id,s,n)}saveDaySchedule(){let e={};this._dailyScheduled.size<1?e=null:this._dailyScheduled.forEach((t,i,l)=>{e[i]={time:t.start.time,duration:t.duration},this.usingMoods[i]&&(e[i].byMood=this.usingMoods[i]),t.notes!==void 0&&(t==null?void 0:t.notes)!==""&&(e[i].atScore=t==null?void 0:t.score,e[i].notes=t==null?void 0:t.notes)}),console.log("saveDaySchedule",e?Object.keys(e).length:"CLEARED"),Ne(this.currentDate,e),this.disableSaveSchedule=!0,this.showReloadBtn=!1,this.showClearBtn=e!=null&&!this.isViewingPast()}updateMinEndNowBtn(e,t,i){for(let[l,s]of this._dailyScheduled)(t?s.end.time:s.start.time)==e&&(this.hasStarted[l]=!t,this.isDisabledScoreEdit[l]=!t,this.mobile&&(console.log(`updateMinEndNowBtn..MOBILE::good?>>${i}::${t}`,e),this.showMobileDialog[l]=!t))}reduceEvtDuration(e,t){let i=this.findEvent(e);if(!i){console.log("ERROR:: reduceEvtDuration Evt not found!!!",e);return}const l=F(new Date);let s=i.start,n=i.end;this._dailyScheduled.set(e,{...i,for:t,duration:t,end:l}),this._endTimesSet.delete(n.time)||console.log("ERROR endTimesSet item does not exist?!?",i,this._endTimesSet),this._endTimesSet.add(l.time);let r=this.findSchedEvent(e);r.duration=t,this.updateEvtMinsEndNowBtns(e,s,l),this.saveDaySchedule()}updateEvtMinsEndNowBtns(e,t,i){const l=F(new Date);let s=D(l,{minute:0}),n=this.getTimeNumber(s),r=this.getTimeNumber(t),h=this.getTimeNumber(i);if(r!==!1&&h!==!1){let m=n>=r&&n<h,p=n>=h;m&&(this.hasStarted[e]=!0),p&&this.disableEvtScoreEdit(e,p)}else console.log(`ERROR?!:${e} has no start/end?.`)}canEndNow(e){let t=this.findEvent(e);if(!t)return console.log("ERROR canEndNow Evt not found!!!",e),!1;const i=F(new Date);let l=t.start,s=t.end;if(!oe(i,l,s,!0))return console.log("umm aint in the middle of this event! Nothing to do...canEndNow::ERROR?",i.time,l.time,s.time),!1;let n=this.getTimeNumber(s)-this.getTimeNumber(l),r=this.getTimeNumber(i)-this.getTimeNumber(l);return console.log(`canEndNow:: ${e} duration from ${n} to:`,r),r<10?r:this.reduceEvtDuration(e,r)}updateNoteScore(e,t,i=""){let l=this.findEvent(e);if(l){let s=l.score==t;s||(console.log("updateNoteScore::Score change!!",s),we(e,null,t));let n=this.findSchedEvent(e);n?(l.score,n.score=t):console.log("onSaveScore ERROR not found",n,e),i!==""&&(l.notes=i,n.notes=i,this.saveDaySchedule())}else console.log(`ERROR ERROR::updateNoteScore could not find event ${e}?!?`)}addMinsToEvt(e,t){let i=this.findEvent(e);if(!i){console.log("ERROR addMinsToEvt EVT not found!!!",e);return}let l=i.end,s=D(l,{minute:parseInt(t)}),n=parseInt(t)+i.for;console.log(`addMinsToEvt::${e} add ${t} from ${i.for} to> ${n}`,l.time,s.time);let r=this.hasOverlappingEvent(e,i.start,s);if(r.length>0)return console.log("addMinsToEvt::huh some OVERLAPS",r),{overlaps:this.massageSingleOverlapArr(r),canContinue:!1};{console.log(`Great, ${e} Ending at:${s.time}`);let h=this.findSchedEvent(e);return h.duration=n,this._dailyScheduled.set(e,{...i,duration:n,for:n,end:s}),this._endTimesSet.delete(l.time)||console.log("ERROR endTimesSet item does not exist?!?",i,this._endTimesSet),this._endTimesSet.add(s.time),this.saveDaySchedule(),{overlaps:null,canContinue:!0}}}deleteEvtMood(e){this.usingMoods[e]?(delete this.usingMoods[e],console.log("deleteEvtMood::>"+e)):console.log("deleteEvtMood>>NO mood by "+e)}removeScheduledEvt(e,t=!1){let i=this.getAllEvts().length;if(!e){console.log("ERROR doRemove, NO evt to delete?!?",e);return}let l=0;for(l;l<i;l++)if(this.actualEvts[l].id==e.id){this.actualEvts.splice(l,1);let s=null;if(this._dailyScheduled.has(e.id)?(s=this._dailyScheduled.get(e.id),this._dailyScheduled.delete(e.id)):console.log("removeScheduledEvt ::> dailyScheduled has no such evt?@? ERROR",e),s){let n=this._startTimesSet.delete(s.start.time),r=this._endTimesSet.delete(s.end.time);(!n||!r)&&console.log(`removeScheduledEvt ::> ERROR? scheduleSets has no such evt?@? start:${n}...end:${r}`,s,e.id+" "+(e==null?void 0:e.title.trim())+" "+(e==null?void 0:e.details)),t&&(console.log("removeScheduledEvt::Mood Remove...",this.usingMoods[e.id]),delete this.usingMoods[e.id])}break}}addToBalance(e){let i=this.getCurrentBalance()-parseInt(e==null?void 0:e.duration);Re(i)}disableAllScoreEdit(e){this._dailyScheduled.forEach((t,i,l)=>{this.isDisabledScoreEdit[i]=e})}disableEvtScoreEdit(e,t){this.isDisabledScoreEdit[e]=!t,this.mobileEnableScore[e]=t}enableNoteScoreEdit(e,t,i){const l=F(new Date);let s=V(l,i),n=D(l,{minute:0});this.getTimeNumber(n),s>0?(this.isDisabledScoreEdit[e]=!0,this.mobileEnableScore[e]=!1):(this.hasStarted[e]=!1,this.mobile&&(this.showMobileDialog[e]=!1),this.mobileEnableScore[e]=!0,this.isDisabledScoreEdit[e]=!1),oe(l,t,i,!0)?this.hasStarted[e]=!0:this.hasStarted[e]=!1}getTimeyNumber(e){return e!==null?et(e):!1}getTimeNumber(e){return e!==null?ge(e):!1}}function Pe(o){return o.button===0}const Et={name:"altDayCalendar",components:{NavigationBar:J(()=>z(()=>import("./NavigationBar.757abb6e.js"),["assets/NavigationBar.757abb6e.js","assets/index.a1cffa07.js","assets/index.ddf7c1e7.css"])),QCalendarDay:st,GoalyEnd:J(()=>z(()=>import("./goalyEnd.bcd18adb.js"),["assets/goalyEnd.bcd18adb.js","assets/goalyEnd.a72927db.css","assets/utiFunc.5349c58b.js","assets/index.a1cffa07.js","assets/index.ddf7c1e7.css","assets/goalStorage.7568199c.js","assets/QSelect.e0680041.js","assets/touch.70a9dd44.js","assets/QItem.27ffb624.js"])),schedBtn:J(()=>z(()=>import("./schedBtn.96bfa353.js"),["assets/schedBtn.96bfa353.js","assets/schedBtn.32a55c93.css","assets/index.a1cffa07.js","assets/index.ddf7c1e7.css"])),dropDwnBtn:J(()=>z(()=>import("./dropDwnBtn.5314337f.js"),["assets/dropDwnBtn.5314337f.js","assets/dropDwnBtn.35a7a0b5.css","assets/QItem.27ffb624.js","assets/index.a1cffa07.js","assets/index.ddf7c1e7.css","assets/QList.536076d7.js","assets/QSelect.e0680041.js","assets/touch.70a9dd44.js","assets/goalStorage.7568199c.js","assets/utiFunc.5349c58b.js"])),schedDialog:J(()=>z(()=>import("./schedDialog.7d93c4d2.js"),["assets/schedDialog.7d93c4d2.js","assets/schedDialog.f43cf2d3.css","assets/index.a1cffa07.js","assets/index.ddf7c1e7.css","assets/QSpace.de21ddc0.js"])),mobileNoteScore:J(()=>z(()=>import("./onScoreEditDialog.84f46657.js"),["assets/onScoreEditDialog.84f46657.js","assets/onScoreEditDialog.fb734b20.css","assets/index.a1cffa07.js","assets/index.ddf7c1e7.css"]))},data(){return lt(),R(null),R(null),R(null),R(null),{splitterPage:R(35),splitterLegend:R(40),timeStartPos:R(0),showTree:R(!1),treeGoals:R([]),expanded:R([]),filter:R([]),filterRef:R(null),calendar:R(null),addEventDialog:R(!1),currentDate:R(ne()),scoreOptions:R([1,2,3,4,5,6]),anchorTimestamp:R(null),otherTimestamp:R(null),mouseDown:R(!1),mobile:R(!0),daSchedule:R(null)}},beforeMount(){this.mobile=rt(),this.daSchedule=new bt(this.currentDate,this.mobile),this.constructTree()},mounted(){this.adjustCurrentTime(),this.intervalId=setInterval(()=>{this.adjustCurrentTime()},6e4)},beforeUnmount(){clearInterval(this.intervalId)},computed:{chosenScoreLabel(){return this.daSchedule.chosenScoreLabel()},chosenPrioLabel(){return this.daSchedule.chosenPrioLabel()},style(){return{top:this.timeStartPos+"px"}},defaultLabels(){let e=this.daSchedule.unscheduled().filter(t=>(t==null?void 0:t.inDefaults)&&(t==null?void 0:t.time)!="").length;return e>0?e+" Defaults":"Defaults"},saveScheduleDisabled(){return this.daSchedule.saveBtnEnabled()},showTreeForm(){return this.showTree||this.constructTree(),this.showTree},filterString(){return this.filter.join()},currentBalance(){return this.daSchedule.getCurrentBalance()},canbeScheduled(){let o=this.daSchedule.unscheduled(),e=(t,i)=>{if(t.parentGoal>i.parentGoal)return 1;if(t.parentGoal==i.parentGoal)return 0;if(t.parentGoal<i.parentGoal)return-1};if(o.length==0){let t=this.daSchedule.getSubGoals();return t.sort(e),t}return o.sort(e),o},scheduleMoodsLabel(){let o="",e=this.daSchedule.getCurrentMoods();if(!Object.keys(e).length>0)return o;let t=new Set;for(let l in e)t.add(e[l].join());let i=0;for(let l of t)i<1?o=l:o=o+", "+l,i++;return Object.keys(e).length!=t.size&&console.log("scheduleMoodsLabel..prob change!",JSON.parse(JSON.stringify(e)),t,o),o},startEndTimes(){const o=[];return this.anchorDayTimeIdentifier!==!1&&this.otherDayTimeIdentifier!==!1&&(this.anchorDayTimeIdentifier<=this.otherDayTimeIdentifier?o.push(W(this.anchorTimestamp),W(this.otherTimestamp)):o.push(W(this.otherTimestamp),W(this.anchorTimestamp))),o},anchorDayTimeIdentifier(){return this.anchorTimestamp!==null?ge(this.anchorTimestamp):!1},otherDayTimeIdentifier(){return this.otherTimestamp!==null?ge(this.otherTimestamp):!1},eventsMap(){return this.daSchedule.currentSchedEventsMap()},showDefaultBtn(){return this.daSchedule.unscheduledDefaults().length>0&&!this.isViewingPast()}},methods:{showEvtMobile(o){return this.daSchedule.showEvtNoteScoreMobile(o)},klikaj(o){console.log("klikaj...",this.currentDate,o)},adjustCurrentTime(){const o=F(new Date);if(this.currentDate!==o.date){this.timeStartPos=-10,this.currentTime="";return}this.currentDate=o.date,this.currentTime=o.time,this.timeStartPos=this.$refs.calendar.timeStartPos(o.time,!1);let e=this.daSchedule.getCurrentSchedTimesSets(),t=e.endSet&&e.endSet.has(o.time),i=e.startSet&&e.startSet.has(o.time);(t||i)&&(this.daSchedule.updateMinEndNowBtn(this.currentTime,t,i),i&&this.doNotify("Event Starting :)","positive","bottom"))},hasDate(o){return this.currentDate?o.find(e=>e.date===this.currentDate):!1},getDateEvents(o){let e=(i,l)=>{let s=V(i.sortTime,l.sortTime);if(s>0)return-1;if(s==0)return 0;if(s<0)return 1};const t=this.eventsMap[o]||[];return t.length===1?t[0].side="full":t.length,t.sort(e)},constructTree(){this.treeGoals=this.daSchedule.fetchGoalsTree()},resetGoalEvts(){return this.daSchedule.getSubGoals()},allMainGPrio(){return this.daSchedule.getAllPrio()},resetFilter(){var o;this.filter=[],(o=this.filterRef)==null||o.focus()},myFilterMethod(o,e){if(o.isChildren&&(o==null?void 0:o.moods.length)>0){const t=this.filter.map(l=>l.toLowerCase());let i=o==null?void 0:o.moods.some(l=>t.indexOf(l.toLowerCase())>-1);return o.label&&i}},labelGoals(o){let e=0;if(o=="s"){for(const i in this.treeGoals)e+=this.treeGoals[i].children.length;return`Scheduled => ${this.daSchedule.getAllEvts().length} out of ${e} 
`}return`Balance: ${this.daSchedule.getCurrentBalance()||0} 
`},badgeClasses(o,e){return Qe(o,e)},badgeStyles(o,e,t=void 0,i=void 0){return Ke(o,e,t,i)},classyColor(o){return`row items-center ${o.isChildren?"text-":"text-white bg-"}${o.color} `},isViewingPast(){return this.daSchedule.isViewingPast()},onMoodAdd(){let o=[];const e=this.filter.map(t=>t.toLowerCase());if(this.treeGoals.filter(t=>{if(t.children.length>0)return t.children.find(i=>{if((i==null?void 0:i.moods.length)>0&&(i==null?void 0:i.moods.some(l=>e.indexOf(l.toLowerCase())>-1))){let l=i==null?void 0:i.moods.filter(s=>{if(e.indexOf(s.toLowerCase())>-1)return s});return o.push({id:i.id,mood:l}),i}})}),o.length>0)if(o=o.filter(t=>!this.daSchedule.getAllEvts().find(i=>i.id==t.id)),o.length>0){let t=this.daSchedule.scheduleByMood(o);console.log("onMoodAdd>>>",e,t,o),t.canContinue?this.doNotify("Add by Mood...doSave eh","positive"):(console.log("onMoodAdd::OVERLAPS?",JSON.parse(JSON.stringify(t))),t.overlaps&&Object.keys(t.overlaps).length>0?this.handleOverlaps(t.overlaps,null,"byMood"):this.doNotify("Empty as no Moods :(","warning","bottom"))}else this.doNotify(`Evts of Mood '${this.filterString}' already scheduled!`,"warning","top");else this.doNotify("Nothing to add :(","warning","top")},onScheduleOneEach(){let o=t=>{let i=this.daSchedule.scheduleOneEach(t);console.log("onScheduleOneEach::ACTION!!!",JSON.parse(JSON.stringify(i))),i.canContinue?this.doNotify("Add by OneEach ...doSave eh","positive"):i.overlaps&&Object.keys(i.overlaps).length>0?this.handleOverlaps(i.overlaps,null,"oneEach"):this.doNotify("Empty for OneEach :(","warning","bottom")},e=()=>{console.log("onScheduleOneEach..Aborting",this.daSchedule.getAllEvts()),this.reset()};if(this.daSchedule.getAllEvts().length>0){let t=[{label:"Add one Evt from Each parent Goals",value:"add"},{label:"Overwrite current with one random Evt from Each parent Goals",value:"overwrite"}];this.radioChoiceDialog("Warning!!",`Date: ${this.currentDate} already have scheduled Events...`,t,"",o,e)}else o("overwrite")},onReloadSaved(){let o=this.daSchedule.hasEventsForDate();console.log("onReloadSaved",o);let e=()=>{console.log("Aborting",this.currentDate,this.scheduledEvents,o)},t=()=>{this.daSchedule.loadEvtsForDay(!1),this.reset()};if(this.daSchedule.getAllEvts().length>0&&!this.isViewingPast()){let i=o?"Reload? saved schedule of: "+this.currentDate:"Overwrite current Evts?";this.confirmAction(i,"OK",t,e)}else t()},onClearDay(){let o=this.daSchedule.hasEventsForDate();if(this.isViewingPast()){this.doNotify("Editing past is no no!");return}this.daSchedule.resetSchedule();let e=o?"Cleared...Can still Reload saved":"Resetting...";this.doNotify(e,"warning","top"),this.reset(),this.daSchedule.toggleActionBtns(o,"view")},onLoadDefault(){let o=()=>{console.log("Aborting",this.currentDate)},e=t=>{let i=this.daSchedule.scheduleDefaults(t);console.log("onLoadDefault",t,i),i.canContinue?this.doNotify("Add of Defaults ...doSave eh","positive"):i.overlaps&&Object.keys(i.overlaps).length>0?this.handleOverlaps(i.overlaps,null,"byDefaults"):this.doNotify("Empty as no Defaults:(","warning","bottom")};if(this.daSchedule.getAllEvts().length>0){let t=this.daSchedule.unscheduledDefaults();console.log("unscheduledDefaults",t,t==null?void 0:t.length);let i=[{label:`Add ${t==null?void 0:t.length} Default Evts to current day schedule`,value:"add"},{label:"Overwrite and only schedule Defaults",value:"overwrite"}];this.radioChoiceDialog("Warning!!",`Date: ${this.currentDate} already have scheduled Events...`,i,"",function(l){e(l)},o)}else e("overwrite")},onChoosenPrio(o){this.daSchedule.onChoosenPrio(o)},onChoosenScore(o){this.daSchedule.onChoosenScore(o)},doReloadWithPrio(){if(this.daSchedule.chosenPrio==null){this.doNotify("Ayo select a priority!");return}let o=()=>{console.log("doReloadWithPrio..cancelling"),this.reset()},e=i=>{let l=this.daSchedule.scheduleSamePrio(i);l.canContinue?this.doNotify(`Add with Priority == ${this.daSchedule.chosenPrio} ...doSave eh`,"positive"):l.overlaps&&Object.keys(l.overlaps).length>0?this.handleOverlaps(l.overlaps,null,"byPrio"):this.doNotify(`Empty for Priority == ${this.daSchedule.chosenPrio} :(`,"warning","bottom")},t=this.daSchedule.chosenPrio;if(this.daSchedule.getAllEvts().length>0){let i=[{label:`Filter current Evts by priority == ${t}`,value:"filter"},{label:`Add to schedule Evts with priority == ${t}`,value:"add"},{label:`Overwrite current and schedule All of priority == ${t}`,value:"overwrite"}];this.radioChoiceDialog("","Schedule change...",i,"",e,o)}else e("overwrite");this.daSchedule.disablePrioBtn=!0},doReloadWithScore(){if(this.daSchedule.chosenScore==null){this.doNotify("Ayo select a score!");return}let o=()=>{console.log("doReloadWithScore..cancelling",this.daSchedule.getAllEvts()),this.reset()},e=i=>{let l=this.daSchedule.scheduleByScore(i);l.canContinue?this.doNotify(`Add with Score <= ${this.daSchedule.chosenScore} ...doSave eh`,"positive"):l.overlaps&&Object.keys(l.overlaps).length>0?this.handleOverlaps(l.overlaps,null,"byScore"):this.doNotify(`Empty for Score <= ${this.daSchedule.chosenScore} :(`,"warning","bottom")},t=this.daSchedule.chosenScore;if(this.daSchedule.getAllEvts().length>0){let i=[{label:`Filter current Evts by Interval Score <= ${t}`,value:"filter"},{label:`Add to schedule Evts with Interval Score <= ${t}`,value:"add"},{label:`Overwrite current and schedule All of Interval Score <= ${t}`,value:"overwrite"}];this.radioChoiceDialog("","Schedule change...",i,"",e,o)}else e("overwrite");this.daSchedule.disableScoreBtn=!0},doSaveSchedule(){this.daSchedule.saveDaySchedule(),this.doNotify(`Schedule saved for ${this.currentDate}`,"positive","top")},doDroppy(o,e,t){if(e&&t){let i=this.daSchedule.tooClose(e,t.duration);if(i&&(console.log("doDroppy::tooClose to>>",i),i===!0)){this.doNotify("Dropping event TOO close to midnight!"),this.reset();return}let l=this.daSchedule.canDropEvent(e,t);if(l.canContinue)if((t==null?void 0:t.inDefaults)||!(t!=null&&t.canMove)){let n=t!=null&&t.inDefaults?"Default at ":"Cannot Move from",r=[`Evt "${t.title.trim()}" ${n} ${B(t.time)}.
\u2800
`,`
\u2800
`,`Also update to new time ${B(e.time)}? 
\u2800
`,`
\u2800
`,`Cancel or Dismiss to undo!
\u2800
`,`
\u2800
`,`No selection to keep default ${B(t.time)}`].join(`
`);const h=this.daSchedule;this.confirmTimeChange("Moving Evt's time",r,"Change","Temp.Move",function(m){h.changeEvtTime(t,e,m)},function(){console.log(`changeEventTime::onCancel..>doing nothing for ${t.id})'${t.title.trim()}'`)},function(){console.log(`changeEventTime::onDismiss..keep as is>> ${t.id})'${t.title.trim()}'`)})}else this.daSchedule.changeEvtTime(t,e,!1);else console.log("doDroppy::can NOT Drop",JSON.parse(JSON.stringify(l))),this.handleOverlaps(l.overlaps,!0,"onDrop")}else{console.log("doDroppy null ERROR?",e,this.targetDrop,t,this.selectedItem);return}},reset(){this.selectedItem=null,this.targetDrop=null,this.touchedItem=null,this.daSchedule.resetChosen(),this.possibleRange=null},closingDialog(){this.addEventDialog=!1},onPickEvent(o,e,t){if(this.addEventDialog=!1,!o){console.log("onPickEvent...ERROR nothing!",o,e,t),this.doNotify("No Goal selected..."),this.reset();return}let i=this.daSchedule.isViewingPast()?!0:e,l=this.daSchedule.tooClose(this.targetDrop.timestamp,o.duration);if(l){if(console.log("onPickEvent::tooClose check FAIL!",l),l===!0){this.doNotify("Picking event TOO close to midnight!"),this.reset();return}if(i)this.doNotify(`'${o.title.trim()}' TOO close to a scheduled Evt Buuut..FORCING!`);else{this.doNotify(`'${o.title.trim()}' Not added as TOO close to a scheduled Evt`),this.reset();return}}let s=this.daSchedule.onPickEvent(o,this.targetDrop.timestamp,i,t);s.canContinue?t&&(console.log("onPickEvent::NO OVERLAPS"),this.doNotify("What is Owed PAID! gg!","positive","top")):(console.log("onPickEvent::OVERLAPS!",JSON.parse(JSON.stringify(s))),s.overlaps&&Object.keys(s.overlaps).length>0?this.handleOverlaps(s.overlaps,null,"onPickEvt"):this.doNotify("Error onPickEvt :(","warning","bottom"))},onAddHocEvent(o,e,t,i,l){if(this.possibleRange||(this.possibleRange=this.startEndTimes),o.trim()==""){this.doNotify("Empty Goal title..."),this.addEventDialog=!1,this.reset();return}let s=fe(this.possibleRange[0]),n=i>15?D(s,{minute:parseInt(i)}):D(fe(this.possibleRange[1]),{minute:15}),r=Math.floor(V(s,n)/1e3/60),h=this.daSchedule.tooClose(s,r);if(h){console.log("onAddHocEvent::tooClose check FAIL!!",h),h===!0?this.doNotify(`'${o}' Not added as over midnight!`):this.doNotify(`'${o}' Not added as too close to a scheduled Evt!!`),this.addEventDialog=!1;return}let m=this.daSchedule.saveNewGoal(s,o,e,t,r);if(this.addEventDialog=!1,m){let p=this.daSchedule.onAdHocEvent(m);if(p.canContinue)this.constructTree(),this.reset();else if(console.log("onAddHocEvent::OVERLAPS?",p,Object.keys(p.overlaps).length),p.overlaps==null){this.doNotify("Error Adding this event :(","negative"),console.log("onAddHocEvent::ERROR?",p);return}else this.handleOverlaps(p.overlaps,null,"adHocEvt")}else console.log("BOO ERROR no subID:(",m),this.doNotify("Error creating and adding this event :(","negative")},handleOverlaps(o,e=null,t=""){var y;console.log("handleOverlaps >>",JSON.parse(JSON.stringify(o)),"from:"+t);const i=(a,u)=>{if(a!=null&&a.parentGoal){let c=this.daSchedule.parentGoalById(a.parentGoal);return u?`Of '${c==null?void 0:c.title.trim()}' (${c==null?void 0:c.priority})`:`Of '${c==null?void 0:c.title.trim()}'`}return console.log("prioLabel..ERROR no PARENT found?",a),""},l=(a,u)=>{switch(u){case"score":return`${i(a,!1)} > "${a.title.trim()}" with Score:: ${a.score} = ${se(a.score)}`;case"prio":return`"${a.title.trim()}" ${i(a,!0)}`;default:return`"${a.title.trim()}" ${i(a,!0)} && Score:: ${a.score} for ${a.duration} mins`}},s=(a,u=!1)=>{this.doNotify(a,u?"warning":"positive","top")},n=a=>{let u=this.daSchedule.getCurrentMoods()[a.id];console.log(`handleOverlaps::doRemove ${a.id}:${a.title}`),this.daSchedule.removeScheduledEvt(a,u)},r=(a,u,c)=>{if(console.log(`handleOverlaps::removeReplace >> replacing>> ${a.id}) '${a.title.trim()}' WITH ${u.id}) ${u.title.trim()}`,c,"from>"+t),e){if(console.log("handleOverlaps::removeReplace...OVERRIDE from>>"+t),t=="onDrop"){n(a);return}console.log("handleOverlaps::removeReplace....OVERRIDE updating..."+t),this.daSchedule.doUpdateSchedule(u,c.targetStart);return}n(a);let d=this.daSchedule.addGoalsToSchedule([{...u,time:c.targetStart.time}],!0),f=Object.keys(d).length;if(f>0)return console.log(`${t}>handleOverlaps::removeReplace:: OVERLAPS again from adding ${u.id} overlaps =${f}`,u,JSON.parse(JSON.stringify(d))),this.doNotify(`Extra Overlaps while adding ${u[0].title.trim()}`,"warning","top"),this.handleOverlaps(d,e,t+"nah")},h=(a,u,c)=>{if(console.log(`handleOverlaps::forceAdd:${t} >>${u.id})'${u.title}' at ${u.time}.
          
Changing >>${a.id} from ${a.time} `,c.targetStart.time),c.direction!=="surrounding")this.daSchedule.recurChangeTime(a.id,u,c.targetStart,t!="onDrop");else{console.log("handleOverlaps::forceAdd: gonna overlapCheckEvtsAdd....");let d=this.daSchedule.addGoalsToSchedule([{...u,time:c.targetStart.time}],!0),f=Object.keys(d).length;if(f>0)return console.log(`handleOverlaps::forceAdd:: OVERLAPS again of size:${f} from >${t}>`+u.title,JSON.parse(JSON.stringify(d))),this.doNotify(`Extra Overlaps while adding '${u.title.trim()}' `,"warning","top"),this.handleOverlaps(d,e,t+"nah")}this.daSchedule.toggleActionBtns(!0,t)};let m=(a,u,c,d,f)=>{v.push(u),u==c.id?(r(d,c,f),s(`by ${a}, Adding '${c.title.trim()}'`,!0)):(console.log(`onOkChoice::by ${a},chose scheduled ${u} ...with override?`,e,t),s(`by ${a}, Keeping '${d.title.trim()}'`),t.indexOf("byMood")>-1&&console.log("handleOverlaps::onOkChoice::Moood!! updates? from: "+t,c.title.trim()),e&&n(c))},p=(a,u)=>{if(e){if(console.log("handleOverlaps::cancelChoice::OVERRIDE...coolios!!from:"+t,a.title.trim()),t=="onDrop"){s("Umm...not moving then...."),this.daSchedule.toggleActionBtns(!1,"view");return}n(a),s(`Keeping '${u.title.trim()}'`);return}t.indexOf("byMood")>-1&&console.log("handleOverlaps::cancelChoice >>Mood!!!!updates? from: "+t,a.title.trim()),this.daSchedule.toggleActionBtns(!0,"view"),s(`Keeping scheduled '${u.title.trim()}'`)},b=(a,u)=>{v[0]==u?this.daSchedule.toggleActionBtns(!0,t):console.log("onDismissy::no change "+t,a,v[0],u)};const E=(a,u,c,d)=>{if(a=="opt3"){let f="Pick one event...",g=[{label:l(u,"def"),value:u.id,color:"secondary"},{label:l(c,"def"),value:c.id}];this.radioChoiceDialog("",f,g,"",function(T){m("Event",T,u,c,d)},null,function(){b("resolveChoice::byEvent... dismissing",u.id)})}else if(a=="opt2"){let f="Pick event by Score",g=[{label:l(u,"score"),value:u.id,color:"secondary"},{label:l(c,"score"),value:c.id}];this.radioChoiceDialog("",f,g,"",function(T){m("Score",T,u,c,d)},null,function(){b("resolveChoice::byScore... dismissing",u.id)})}else if(a=="opt1"){let f="Pick event by Priority",g=[{label:l(u,"prio"),value:u.id,color:"secondary"},{label:l(c,"prio"),value:c.id}];this.radioChoiceDialog("",f,g,"",function(T){m("Priority",T,u,c,d)},null,function(){b("resolveChoice::byPriority... dismissing",u.id)})}else a=="opt0"?(console.log("resolveChoice::it's a dropppp...keeping as is...."),p(u,c)):h(c,u,d)},S=(a,u,c,d,f)=>{d.direction!=="surrounding"&&!f&&(t.indexOf("nah")>-1?console.log("handleOverlaps::manualSolve NOT adding Force as from "+t):a.push({label:`Force in '${u.title.trim()}'`,value:"opt4"}));let g=`Adding '${u.title.trim()}' at ${B(d.targetStart.time)} Overlaps with Scheduled '${c.title.trim()}' at ${B(c==null?void 0:c.time)}.
          
Cancel to keep '${c.title.trim()}' `,T=f?"Choose Auto Resolution":"Resolve Overlapping Events";this.radioChoiceDialog(T,g,a,"opt1",function(O){E(O,u,c,d)},function(){console.log("handleOverlaps>>manualSolve::cancelChoice>> from: "+t,v[0]),p(u,c)})};let v=[],C=Object.keys(o).length;for(let a in o){if(!o[a]||!o[a][0]){console.log("handleOverlaps...skipping unknown key",a);continue}let u=[{label:"Choose one event",value:"opt3"}];t=="byScore"?u.unshift({label:"Choose by Priority",value:"opt1",color:"secondary"}):t=="byPrio"?u.unshift({label:"Choose by Score",value:"opt2"}):t=="onDrop"?u.unshift({label:"Leave as is!",value:"opt0"},{label:"Choose by Priority",value:"opt1",color:"secondary"},{label:"Choose by Score",value:"opt2"}):u.unshift({label:"Choose by Priority",value:"opt1",color:"secondary"},{label:"Choose by Score",value:"opt2"});let c=o[a];if(c.length>1){"withID"in o?(console.log("handleOverlaps::WOAH WOAH...using fixMultiConflicts!",JSON.parse(JSON.stringify(c))),this.fixMultiConflicts(c,e,t)):(console.log("handleOverlaps::WOAH WOAH...using multiConflicts!",JSON.parse(JSON.stringify(c))),this.multiConflicts(c,e,t));continue}const d=c.pop();let f=this.daSchedule.getSubGoalByID(d.target),g=this.daSchedule.findSchedEvent(d.inConflict);if(!g||!f){console.log("handleOverlaps...ERROR ERROR no evts found!!!",d);return}console.log(`handleOverlaps::ToAdd ${f.id}:${f.title.trim()}(${f.time})++${f.duration} AT >> ${(y=d==null?void 0:d.targetStart)==null?void 0:y.time} 
 -- ${d.direction} ---
        Scheduled ${g.id}:${g.title.trim()}(${g.time})++${g.duration}`,e,"from:"+t,"toHandle="+C);let T=f.title.trim().toLowerCase().includes(g.title.trim().toLowerCase()),O=g.title.trim().toLowerCase().includes(f.title.trim().toLowerCase()),x=this.daSchedule.parentGoalById(f.parentGoal),Y=this.daSchedule.parentGoalById(g.parentGoal),X=f.title.trim().toLowerCase().includes(Y.title.trim().toLowerCase()),me=g.title.trim().toLowerCase().includes(x.title.trim().toLowerCase());(X||me)&&console.log("handleOverlaps:: WOAH PARENT AUTO schedule?--TODO",X,me,"Normal AUTO>>",T,O,"direction == surrounding? >>",d.direction=="surrounding"),T||O?(console.log("handleOverlaps:: can AUTO schedule",T,O,"direction == surrounding? >>",d.direction=="surrounding"),this.scrollToTime(d==null?void 0:d.targetStart,"slow"),this.confirmAction(`"${f.title.trim()}" at ${B(f.time)} related to Scheduled "${g.title.trim()}" at ${B(g.time)}.
          
Auto resolve Overlap?
          
Cancel/Dismiss to manually choose.`,"Auto",function(){var Se;T?(console.log("Auto resolve::removeReplace..with TIMES>>",f.time,g.time,(Se=d==null?void 0:d.targetStart)==null?void 0:Se.time),r(g,f,d),s(`Removing Scheduled to Add '${f.title.trim()}'`,!0),v.push(f.id)):(console.log("Auto resolve::cancelChoice >> from: ",t),p(f,g),v.push(g.id))},function(){S(u,f,g,d,!0)},function(){b("Auto-dismiss",v[0])})):S(u,f,g,d,!1)}},fixMultiConflicts(o,e=null,t=""){var y;let i="",l=null,s=[],n=[],r=new Map,h=null,m=[{label:"Pick one event",value:"opt3"}];const p=a=>this.findhighestPrio(a);let b=a=>this.getSmallestScoreInterval(a),E=(a,u)=>{let c=[];if(u.forEach((d,f,g)=>{if(a.find(T=>T.id==d.id))if(d.id==l.id)if(console.log("removeConflicts::toAdd kept!>"+h.time,d==null?void 0:d.title.trim(),"at orig: "+(d==null?void 0:d.time),t),t=="onDrop")console.log("removeConflicts...NOTHING to do as from"+t);else{let T=r.has(d.id)?r.get(d.id):"",O=this.daSchedule.addGoalsToSchedule([{...d,time:h.time}],!1);if(Object.keys(O).length>0)console.log("removeConflicts::OVERLAP on add",O,d,h.time),c.push(O);else{console.log("removeConflicts::Great NO overlap",d==null?void 0:d.title.trim());let x=`${T} Adding '${d==null?void 0:d.title.trim()}' at ${B(h.time)}`;this.doNotify(x,"positive","top")}}else{console.log("fixMultiConflicts::removeConflicts....Keeping scheduled Evt!!",h,d.id);let T=`${r.has(d.id)?r.get(d.id):""} Keeping scheduled '${d==null?void 0:d.title.trim()}'`;this.doNotify(T,"positive","top")}else if(d.id!=l.id){console.log("removeConflicts::removing scheduled...doNotify?",d.id,d.title,d.time);let T=this.daSchedule.getCurrentMoods()[d.id];this.daSchedule.removeScheduledEvt(d,T),this.doNotify(`Removed scheduled '${d==null?void 0:d.title.trim()}'`,"warning","bottom")}else console.log("removeConflicts::NOT adding original target",l.id)}),c.length>0)return console.log(`${t}> fixMultiConflicts::removeConflict:: OVERLAPS again=${c.length}`,c),this.doNotify("More Overlaps to fix!!!","warning","top"),this.handleOverlaps(c[0],e,t+"nah")};const S=(a,u)=>{console.log(`At ${u.date}:${u.time} forceAdd:${a.id} ${a.title} from ${a.time} >>`+t,JSON.parse(JSON.stringify(l)),s.length,s[s.length-1]);let c=this.daSchedule.addGoalsToSchedule([{...a,time:u.time}],!0),d=Object.keys(c).length;if(d>0)return console.log(`${t} >fixMultiConflicts::forceAdd:: OVERLAPS again from ${l.length} overlaps =${d}`,JSON.parse(JSON.stringify(c))),this.doNotify(`Extra Overlaps while adding '${a.title.trim()}'`,"warning","top"),this.handleOverlaps(c,e,t+"nah")};let v=a=>{this.radioChoiceDialog("","Choose which Event to schedule",a.map(this.getEvtLabel),"",function(u){let c=a.find(d=>d.id==u);if(c)n.push(c),r.set(c.id,"By pick,");else{console.log("chooseEvt::ERROR NOT FOUND!!",u);return}return console.log(`chooseEvt::onOk >>${u} >> ${c==null?void 0:c.title.trim()}`),c},null,function(){n.length>0&&(console.log("chooseEvt::onDismiss >>set removeConflicts out of total="+a.length,JSON.parse(JSON.stringify(n))),setTimeout(()=>{E(n,a)},0))})};t=="byScore"?m.unshift({label:"Resolve by Highest Priority",value:"opt1",color:"secondary"}):t=="byPrio"?m.unshift({label:"Resolve by Smallest Score Interval (low Score)",value:"opt2"}):m.unshift({label:"Resolve by Highest Priority",value:"opt1",color:"secondary"},{label:"Resolve by Smallest Score Interval (low Score)",value:"opt2"});for(let a of o){console.log("fixMultiConflicts::Handling:> "+t,JSON.parse(JSON.stringify(a)));let u=this.daSchedule.findSchedEvent(a.inConflict);if(!u){console.log("fixMultiConflicts...ERROR ERROR no evts found!!!",a);return}s.push(u),i+=` '${u==null?void 0:u.title.trim()}',
`,h?h.time!=((y=a==null?void 0:a.targetStart)==null?void 0:y.time)&&console.log("fixMultiConflicts...ERROR Not same targetStart?!?",h,a==null?void 0:a.targetStart,a.direction):h=a==null?void 0:a.targetStart;let c=this.daSchedule.getSubGoalByID(a.target);if(!c){console.log("fixMultiConflicts...ERROR ERROR local evt not found!!!",a);return}l=c,a.direction!=="surrounding"&&m.length<3&&m.push({label:`Force in '${l.title.trim()}'`,value:"opt4"})}let C=`'${l==null?void 0:l.title.trim()}' conflicts with scheduled ${i} 
`;s.unshift(l),this.radioChoiceDialog("Solve Overlaps!!",C,m,"",function(a){if(a=="opt3")v(s);else if(a=="opt2"){let u=b(s);console.log("fixMultiConflicts::ByScore",u.id,u==null?void 0:u.title.trim(),u.score),n.push(u),r.set(u.id,`By smallest score interval (${u.score}),`)}else if(a=="opt1"){let u=p(s);console.log("fixMultiConflicts::ByPriority",u.id,u==null?void 0:u.title.trim()),n.push(u),r.set(u.id,"By highest priority,")}else console.log("fixMultiConflicts::forceAdd..."),S(l,h)},null,function(){n.length>0&&(console.log("fixMultiConflicts::onDismiss Main >> removeConflicts from total="+s.length,JSON.parse(JSON.stringify(n))),setTimeout(()=>{E(n,s)},0))})},multiConflicts(o,e=null,t=""){var u;let i="",l=[],s=null,n=[],r=null,h=new Map,m=new Map,p=[{label:"Pick one event",value:"opt3"}];const b=c=>this.findhighestPrio(c);let E=c=>this.getSmallestScoreInterval(c),S=(c,d)=>{console.log(`multiConflicts::removeConflicts with toKeep=${c.length} out of total:${d.length}`);let f=[];if(d.forEach((g,T,O)=>{if(c.find(x=>x.id==g.id)){let x=m.has(g.id)?m.get(g.id):"";if(console.log("multiConflicts::removeConflicts:KEEEP..TIME? by>"+x,g.id,g==null?void 0:g.title.trim(),g==null?void 0:g.time,r),g.id!=s.id){let Y=this.daSchedule.addGoalsToSchedule([{...g,time:r}],!0);if(Object.keys(Y).length>0)f.push(Y);else{console.log("multiConflicts::removeConflicts--no other overlap",g==null?void 0:g.title.trim());let X=`${x} Adding '${g==null?void 0:g.title.trim()}' at ${B(r)}`;this.doNotify(X,"positive","top")}}else console.log("multiConflicts::removeConflicts...already scheduled!!",g==null?void 0:g.title.trim()),this.doNotify(`${x} Keeping scheduled '${g==null?void 0:g.title.trim()}' `,"positive","top")}else if(g.id==s.id){console.log("multiConflicts::removeConflicts...removing scheduled!!",g.id,g.title);let x=this.daSchedule.getCurrentMoods()[g.id];this.daSchedule.removeScheduledEvt(g,x)}}),f.length>0)return console.log(`${t}>multiConflicts::removeConflicts:: OVERLAPS again from ${c.length} overlaps =${f.length}`,f),this.doNotify("More Overlaps to fix!!!","warning","top"),this.handleOverlaps(f[0],e,t+"nah")},v=c=>{this.radioChoiceDialog("","Choose which Event to schedule",c.map(this.getEvtLabel),"",function(d){let f=c.find(g=>g.id==d);if(f)n.push(f),m.set(f.id,"By pick,");else{console.log("chooseEvt::ERROR NOT FOUND!!",d);return}return console.log(`chooseEvt::onOk >>${d} >> ${f==null?void 0:f.title.trim()}`),f},null,function(){n.length>0&&(console.log("chooseEvt::onDismiss >> LAST?",JSON.parse(JSON.stringify(n))),setTimeout(()=>{S(n,c)},0))})};const C=c=>{c.forEach(d=>{if(s.id==d.id)console.log("multiConflicts::forceAdd...SKIP scheduled",s.title);else{let f=h.has(d.id)?h.get(d.id):null;console.log(`multiConflicts::forceAdd...NEW:${d.id} '${d.title.trim()}' origAt: ${d.time}`,f.time);let g=this.daSchedule.addGoalsToSchedule([{...d,time:f.time}],!0),T=Object.keys(g).length;T>0&&(console.log(`${t} >multiConflicts::forceAdd:: OVERLAPS again from ${c.length} overlaps =${T}`,JSON.parse(JSON.stringify(g)),d),this.doNotify(`Extra Overlaps while adding '${d.title.trim()}'`,"warning","top"))}}),this.daSchedule.saveDaySchedule()};t=="byScore"?p.unshift({label:"Resolve by Highest Priority",value:"opt1",color:"secondary"}):t=="byPrio"?p.unshift({label:"Resolve by Smallest Score Interval (low Score)",value:"opt2"}):p.unshift({label:"Resolve by Highest Priority",value:"opt1",color:"secondary"},{label:"Resolve by Smallest Score Interval (low Score)",value:"opt2"});let y=!1;for(let c of o){console.log("multiConflicts....handling:>"+t,JSON.parse(JSON.stringify(c)));let d=this.daSchedule.findSchedEvent(c.inConflict);if(!d){console.log("multiConflicts...ERROR ERROR no evts found!!!",c);return}s?s.id!=d.id&&console.log("multiConflicts...ERROR Not same inConflict",s.id,d.id):(s=d,r=(u=c==null?void 0:c.targetStart)==null?void 0:u.time);let f=this.daSchedule.getSubGoalByID(c.target);if(!f){console.log("multiConflicts...ERROR ERROR local evt not found!!!",c);return}i+=` '${f==null?void 0:f.title.trim()}',
`,l.push(f),h.set(c.target,c==null?void 0:c.targetStart),c.direction=="surrounding"?y=!0:y=y}y||p.push({label:"Force Schedule them in",value:"opt4"});let a=`${i} conflicts with scheduled '${s==null?void 0:s.title.trim()}' at ${B(s==null?void 0:s.time)}.
`;l.unshift(s),this.radioChoiceDialog("Solve Overlaps!!",a,p,"",function(c){if(c=="opt3")v(l);else if(c=="opt2"){let d=E(l);console.log("multiConflicts::ByScore",d.id,d==null?void 0:d.title.trim(),d.score),n.push(d),m.set(d.id,`By smallest score interval (${d.score}),`)}else if(c=="opt1"){let d=b(l);console.log("multiConflicts::ByPriority",d.id,d==null?void 0:d.title.trim()),n.push(d),m.set(d.id,"By highest priority,")}else C(l)},null,function(){n.length>0&&(console.log("multiConflicts::onDismiss Main >> LAST?",n),setTimeout(()=>{S(n,l)},0))})},onEndNow(o){const e=()=>{console.log("onEndNow::removing and saving!",o);let l=this.daSchedule.findSchedEvent(o);this.daSchedule.removeScheduledEvt(l),this.daSchedule.saveDaySchedule()},t=l=>{console.log("onEndNow::reducing!!!",o,Number.isInteger(l)),this.daSchedule.reduceEvtDuration(o,l)};let i=this.daSchedule.canEndNow(o);i?this.confirmAction(`Less than 10mins remove?
 Cancel to just EndNow`,"OK",e,function(){t(i)}):console.log("onEndNow...",o,i,Number.isInteger(i))},onSaveScore(o,e,t=""){let i=se(o);if(i<-1){i==-89?(console.log("onSaveScore parsing error",i,o),this.doNotify("Score Parsing Error... YOU FOO! ")):this.doNotify("Score Error: higher# on lower#");return}this.daSchedule.updateNoteScore(e,o,t)},onAddMins(o,e){console.log("onAddMins",o,e);let t=this.daSchedule.addMinsToEvt(o,e);t.canContinue||(console.log("onAddMins::OVERLAPS?",t),t.overlaps&&Object.keys(t.overlaps).length>0?this.handleOverlaps(t.overlaps,null,"onAddMins"):this.doNotify("Add mins ERROR:(","warning","bottom"))},removeEvtInSchedule(o){let e=!1,t=()=>{if(this.daSchedule.removeScheduledEvt(o,e),e){console.log("removeEvtInSchedule..autoSave for: "+o.title),this.daSchedule.saveDaySchedule();return}this.daSchedule.toggleActionBtns(!0,"view")};if(this.daSchedule.isViewingPast()){if(o.duration<30){this.doNotify("Removing from the past... Check BALANCE!"),this.daSchedule.addToBalance(o),e=!0,t();return}this.chooseAlternatives(o);return}if(!this.daSchedule.isViewingToday()&&!this.mobile){e=this.daSchedule.getCurrentMoods()[o.id],t(),console.log("Removed future evt");return}let i=`Remove "${o.title}" from schedule?`,l=this.daSchedule.getCurrentMoods()[o.id];l&&(console.log("removeEvtInSchedule with MOOD?!?",l),e=!0,i=i+" With Mood "+l),this.confirmAction(i,"Remove",t,function(){console.log("Cancelled remove")})},getEvtLabel(o){let e=this.daSchedule.parentGoalById(o.parentGoal);return{label:`Of '${e==null?void 0:e.title.trim()}' "${o.title.trim()}" (${o.score}) for ${o==null?void 0:o.duration} mins`,value:o.id}},getSmallestScoreInterval(o){let e=9,t=null;for(let i of o){let l=se(i.score);l>-1&&l<=e&&(e=l,t=i)}if(t)return console.log("getSmallestScoreInterval::score interval",t.id,t==null?void 0:t.title.trim(),t.score),t;console.log("ERROR ERROR getSmallestScoreInterval::highestScore...no current set?",e,t,o)},findhighestPrio(o){let e=0,t=null;for(let i of o)if(i.parentGoal){let l=this.daSchedule.parentGoalById(i.parentGoal);l?l.priority>e&&(e=l.priority,t=i):console.log("findhighestPrio::ERROR no PARENT found?",i)}else console.log("findhighestPrio::ERROR EVT not found?",i);return t},chooseAlternatives(o){let e=this.daSchedule.getAltEvts(),t=F(new Date);console.log("chooseAlternatives >>ALTS:",JSON.parse(JSON.stringify(e)));let i=o.time,l=t.date;const s=m=>m.filter(p=>!this.daSchedule.getAllEvts().find(b=>b.id==p.id)),n=m=>{let p=D(k(l),{day:0}),b=D(k(p.date),{day:1}),E=this.daSchedule.getEventsForDate(p.date),S={},v=null;E?S=E:console.log("addInFutur EMPTY for >>...",p.date),m.forEach(C=>{if(v=this.daSchedule.getSubGoalByID(C),S[C]){console.log("addInFutur...ALREADY PRESENT",C,p.date,v==null?void 0:v.title.trim()),this.doNotify(`Alternative '${v==null?void 0:v.title.trim()}' already present on ${p.date}. Moving it to next day`,"warning");let y=this.daSchedule.getEventsForDate(b.date);if(y)if(!y[C])y[C]={duration:v==null?void 0:v.duration,time:i};else{console.log("addInFutur...STILL PRESENT in next day:"+b.date,v.title.trim()),this.doNotify(`Booo! Alt '${v==null?void 0:v.title.trim()}' also present on ${b.date} :(( ...Check BALANCE!`),this.daSchedule.addToBalance(v);return}else console.log("addInFutur next day EMPTY for >>...",b.date),y={},y[C]={duration:v.duration,time:i};this.daSchedule.updateDaySchedule(b.date,y),this.doNotify(`Saving ${v.title} in ${b.date}`,"positive","bottom")}else S[C]={duration:v.duration,time:i}}),console.log("addInFutur>>>",p.date,JSON.parse(JSON.stringify(S))),this.daSchedule.updateDaySchedule(p.date,S)},r=m=>{this.daSchedule.removeScheduledEvt(o);let p=e.find(S=>S.id==m);console.log("remReplace...Add at:",i,p.title,"usually at:"+p.time);let b=this.daSchedule.addGoalsToSchedule([{...p,time:i}],!0),E=Object.keys(b).length;if(E>0)return console.log(`chooseAlternatives::removeReplace:: OVERLAPS again from ${p.length} overlaps =${E}`,p,b),this.doNotify(`Extra Overlaps while adding ${p[0].title.trim()}`,"warning","top"),this.handleOverlaps(b,null,"alts");this.daSchedule.saveDaySchedule(),this.doNotify(`Added Alt replacement '${p==null?void 0:p.title}' at ${i}`,"positive","bottom")},h=m=>{this.doNotify(m)};if(e=s(e),e.length==0){h("Removing not allowed! Alternatives already present!");return}this.checkBoxDialog("Gotta pick alternatives","Select the first Evt to replace the removed and an Extra evt for later day (today)!",e.map(this.getEvtLabel),e[0].id,function(m){console.log("chooseAlternatives::opt",m),r(m.shift()),m.length>0?n(m):(console.log("chooseAlternatives::onOk...nothing to add?!?",e.length,m.length,e.length-m.length),h("No Alternative scheduled later :("))},function(){console.log("chooseAlternatives::onCancel")})},onPrev(){let o=()=>{this.$refs.calendar.prev()},e=()=>{setTimeout(o,1e3),this.doSaveSchedule()};this.saveScheduleDisabled?o():this.confirmAction(`Save day: ${this.currentDate} changes?`,"Save",e,o)},onToday(){let o=()=>{this.$refs.calendar.moveToToday()},e=()=>{setTimeout(o,1e3),this.doSaveSchedule()};this.saveScheduleDisabled?o():this.confirmAction(`Save day: ${this.currentDate} changes?`,"Save",e,o)},onNext(){let o=()=>{this.$refs.calendar.next()},e=()=>{setTimeout(o,1e3),this.doSaveSchedule()};this.saveScheduleDisabled?o():this.confirmAction(`Save day: ${this.currentDate} changes?`,"Save",e,o)},onChange(){let o=this.daSchedule.onChangeViewDate(this.currentDate);o.canContinue?this.doNotify("Empty for currentDay :(","warning","bottom"):o.overlaps&&Object.keys(o.overlaps).length>0?this.handleOverlaps(o.overlaps,null,"view"):(this.doNotify(`Loaded schedule for ${this.currentDate}`,"positive","bottom"),(this.isViewingPast()||this.currentDate!==ne())&&this.adjustCurrentTime())},onDragStart(o,e){if(this.daSchedule.isViewingPast()){this.doNotify("Editing past is no no!"),o.preventDefault();return}this.selectedItem=e},onDragEnter(o,e,t){return e==="goal-item"||(this.targetDrop=t),o.preventDefault(),!0},onDragOver(o,e,t){return o.preventDefault(),!0},onDragLeave(o,e,t){return!1},onDragEnd(o){},onDrop(o,e,t){let i=this.daSchedule.findSchedEvent(this.selectedItem.id);if(!i){console.log("onDrop ERROR",i,this.selectedItem);return}let l=null;if(e==="interval")l=t.timestamp;else if(e==="goal-item"&&this.targetDrop)l=this.targetDrop.timestamp;else{console.log("Cannot drop here YO!!",o,e,t,this.targetDrop);return}if(!l){console.log("ERROR...no timestamp YO!!",o,e,t,this.targetDrop);return}this.doDroppy("onDrop",l,this.selectedItem)},onClickTime(o){this.addEventDialog=!0,this.targetDrop=o.scope},onClickDate(o){console.log("onClickDate",o)},onClickInterval(o){console.log("onClickInterval",o)},onClickHeadIntervals(o){console.log("onClickHeadIntervals",o)},onClickHeadDay(o){console.log("onClickHeadDay",o)},onMouseEnter(o){console.log("onMouseAt",o)},onMouseLeave(o){console.log("onMouseLeave",JSON.stringify(o))},onMouseDownTime({scope:o,event:e}){if(Pe(e)){if(this.mobile===!0&&this.anchorTimestamp!==null&&this.otherTimestamp!==null&&W(this.anchorTimestamp)===W(this.otherTimestamp)){this.otherTimestamp=o.timestamp,this.mouseDown=!1;return}this.mouseDown=!0,this.anchorTimestamp=o.timestamp,this.otherTimestamp=o.timestamp}},onMouseUpTime({scope:o,event:e}){if(this.mobile!==!0&&Pe(e)&&(this.otherTimestamp=o.timestamp,this.mouseDown=!1),!this.mousedown){let t=this.startEndTimes;if(t[1]==t[0])return;this.possibleRange=t,console.log("onMouseUpTime range change",this.possibleRange)}},onMouseMoveTime({scope:o,event:e}){this.mobile!==!0&&this.mouseDown===!0&&(this.otherTimestamp=o.timestamp)},onDblClickEvent(o,e){if(this.isViewingPast()){if(e.duration<30){console.log("onDblClickEvent..baah too smoll smoll",e.title,e.duration),this.doNotify("umm Removing from the past..Soo Check BALANCE!"),this.daSchedule.addToBalance(e),this.daSchedule.removeScheduledEvt(e);return}this.chooseAlternatives(e),o.preventDefault();return}this.removeEvtInSchedule(e),o.preventDefault()},onTouchStart(o,e){if(o.type=="touchstart"){this.selectedItem=e;let t=document.elementFromPoint(o.changedTouches[0].clientX,o.changedTouches[0].clientY);if(t.parentNode.classList.contains("my-event"))console.log("onTouchStart >>my-event-drag","isDisabledScoreEdit>> "+this.daSchedule.isDisabledScoreEdit[e.id],"showMobileDialog>> "+this.daSchedule.showMobileDialog[e.id]),t.parentNode.classList.add("my-event-drag"),this.touchedItem=t;else{let i=t.closest(".my-event");if(t=t.parentNode,t.parentNode.classList.contains("my-event"))console.log("onTouchStart >>PHEW..FOUND","isDisabledScoreEdit>> "+this.daSchedule.isDisabledScoreEdit[e.id],i),t.parentNode.classList.add("my-event-drag"),this.touchedItem=t;else{this.touchedItem=!1;return}}return o.preventDefault(),!0}console.log("onTouchStart::ERROR...UNKNOWN",o)},onTouchEvt(o,e){const t=l=>{let s=l.split(" "),n=s[s.length-2],r=D(k(this.currentDate),{minute:G(n)});return s[s.length-1]=="PM"?r.hour==12?r:D(k(this.currentDate),{hour:12,minute:G(n)}):r.hour==12?D(k(this.currentDate),{hour:-12,minute:G(n)}):r};let i=l=>{let s=l.closest(".my-event");s.classList.contains("my-event-drag")?s.classList.toggle("my-event-drag"):console.log("onTouchEvt::resetClass...AINT THERE!",s,l)};if(this.selectedItem||(console.log("onTouchEvt NULL Item ?!? >> "+o.type,this.selectedItem,this.touchedItem),e=this.selectedItem),o.type=="touchmove"){if(this.isViewingPast()){this.doNotify("Editing past is no no!"),o.preventDefault(),o.stopPropagation();return}let l=document.elementFromPoint(o.changedTouches[0].clientX,o.changedTouches[0].clientY);if(l.ariaLabel){let s=t(l.ariaLabel);if(this.targetDrop){let n=V(this.targetDrop,s);if(JSON.stringify(this.targetDrop)===JSON.stringify(s)&&n==0)return}this.targetDrop=s,o.preventDefault();return}else{let s=l.closest(".my-event");s&&!s.classList.contains("my-event-drag")&&console.log("onTouchEvt::move >>TO ADD AGAIN?!?",s,l,this.touchedItem)}return}if(o.type=="touchend"){let l=document.elementFromPoint(o.changedTouches[0].clientX,o.changedTouches[0].clientY);if(this.isViewingPast()){this.doNotify("Editing past is no no!"),i(this.touchedItem),o.preventDefault(),o.stopPropagation();return}if(this.touchedItem)if(l.parentNode.classList.contains("my-event-drag"))console.log("onTouchEvt::END >>removing my-event-drag","isDisabledScoreEdit>> "+this.daSchedule.isDisabledScoreEdit[e.id],"mobileEnableScore>> "+this.daSchedule.mobileEnableScore[e.id]),l.parentNode.classList.remove("my-event-drag");else{let s=this.touchedItem.parentNode.classList.contains("my-event-drag");s?this.touchedItem.parentNode.classList.remove("my-event-drag"):console.log("onTouchEvt::END... target NO my-event-drag?",s,l,l.parentNode)}else return;if(l.ariaLabel){let s=t(l.ariaLabel);this.targetDrop=s,this.doDroppy("onTouch",this.targetDrop,this.selectedItem)}else console.log("onTouchEvt::END>>ERROR?OVERLAP?",o,l,l.parentNode,this.mobile,this.daSchedule.isDisabledScoreEdit[e.id]),l.classList.contains("title")&&(console.log("onTouchEvt::END--has title!",this.targetDrop),this.doDroppy("onTouch",this.targetDrop,this.selectedItem));o.preventDefault(),o.stopPropagation();return}console.log("onTouchEvt::UNKNOWN",o)},onTouchHold({evt:o,...e},t){if(!this.mobile)return console.log("onTouchHold>>NOT MOBILE",o.type,"mobileEnableScore>> "+this.daSchedule.mobileEnableScore[t.id]),!0;let i=document.elementFromPoint(o.changedTouches[0].clientX,o.changedTouches[0].clientY);this.daSchedule.toggleEvtNoteScoreMobile(t.id);let l=i.closest(".my-event");i.classList.contains("title")&&i.parentNode.classList.contains("my-event-drag")?(console.log("onTouchHold...REMOVING my-event-drag",l),i.parentNode.classList.remove("my-event-drag")):l&&l.classList.contains("my-event-drag")?l.classList.toggle("my-event-drag"):(console.log("onTouchHold::class not found on Target!!",i,this.touchedItem),this.touchedItem&&(l=this.touchedItem.closest(".my-event"),l&&l.classList.contains("my-event-drag")?l.classList.toggle("my-event-drag"):console.log("ERROR...onTouchHold--class not found on Target!!",i,this.touchedItem))),this.daSchedule.isDisabledScoreEdit[t.id]&&!this.daSchedule.mobileEnableScore[t.id]&&(console.log("onTouchHold::dblClicking!",this.daSchedule.showEvtNoteScoreMobile(t.id)),this.onDblClickEvent(o,t))},scrollToEvent(o){this.$refs.calendar.scrollToTime(o.time,350)},scrollToTime(o,e=null){var t;if(this.$refs.calendar){let i=D(o,{minute:-30});console.log("scrollToTime::gonna SCROLL",o.time,i.time,e),(t=this.$refs.calendar)==null||t.scrollToTime(i.time,e?e=="fast"?400:1e3:500)}else console.log("scrollToTime::NO SCROLLY",o.time,JSON.parse(JSON.stringify(this.$refs)))},confirmTimeChange(o,e,t,i,l,s,n=null){this.$q.dialog({title:o,message:e,cancel:!1,ok:t,options:{type:"radio",model:"",items:[{label:t+" and "+i,value:"ok"},{label:i,value:"alt"}]},class:"overflow-wrap: break-word;",style:""}).onOk(r=>{if(r==""){console.log("confirmTimeChange onOk with no selection >>onDismiss"),this.doNotify("No selection made...Defaulting","positive","bottom"),n?n():console.log("confirmTimeChange:: No Dismiss func to execute!");return}return l(r)}).onCancel(()=>{console.log("confirmTimeChange>> executeCancel..."),s()})},radioChoiceDialog(o,e,t,i,l=null,s=null,n=null){this.$q.dialog({title:o,cancel:!!s,persistent:!0,message:e,options:{type:"radio",model:i,items:t}}).onOk(r=>{l&&(r==""?this.radioChoiceDialog(o,e,t,i,l,s,n):l(r))}).onCancel(()=>{s&&s()}).onDismiss(()=>{n&&n()})},checkBoxDialog(o,e,t,i,l=null,s=null,n=null){let r=t.length,h=r>2?2:r;this.$q.dialog({title:o,message:e,options:{type:"checkbox",model:[],isValid:m=>m.length>0&&m.length==h,items:t},cancel:!0,persistent:!0}).onOk(m=>{l(m)}).onCancel(()=>{s&&s()}).onDismiss(()=>{n&&n()})},confirmAction(o,e,t,i,l=null){this.$q.dialog({title:"Warning",cancel:!0,ok:e,message:o}).onOk(()=>{t()}).onCancel(()=>{i()}).onDismiss(()=>{if(l){l();return}})},doNotify(o,e=void 0,t="top"){this.$q.notify({color:e!==void 0?e:"negative",position:t,message:o,icon:e==null?"report_problem":"thumb_up"})},withDismissNotify(o,e=void 0,t="top",i=null,l=null){this.$q.notify({color:e!==void 0?e:"negative",position:t,message:o,icon:e==null?"report_problem":"thumb_up",timeout:i!=null?i:5e3,closeBtn:"Okey",onDismiss:l})}}},re=o=>(ze("data-v-a7d4bea0"),o=o(),We(),o),Ot={class:"subcontent"},Dt={class:"q-px-md boxy"},Ct={key:0},Tt={key:1},wt={key:2},Rt={key:3},Nt={key:4},Pt={key:5},At={class:"row justify-center"},Mt=re(()=>M("br",null,null,-1)),_t=re(()=>M("br",null,null,-1)),$t={key:0,class:"q-pa-sm bg-grey-12",style:{"max-width":"400px"}},Bt={class:"q-pa-sm row justify-center"},kt={class:"row justify-center"},xt=re(()=>M("br",null,null,-1)),Lt={key:0,class:"q-gutter-md"},Gt={class:"q-mr-sm text-weight-bold",size:"28px"},Vt={key:0},It={class:"text-weight-bold"},Ht={key:1,class:"text-weight-light text-black"},Ft={key:1,class:"q-pa-md q-gutter-sm bg-grey-12",style:{"max-width":"400px"}},jt={key:0,class:"row"},Jt={class:"row justify-center"},qt={class:"q-gutter-md",style:{display:"flex","max-width":"800px",width:"100%",height:"600px"}},zt={style:{display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"2px"}},Wt={class:"heady q-calendar__ellipsis"},Ut=["onDblclick","onDragstart","onTouchstart","onTouchmove","onTouchend"],Qt=re(()=>M("br",null,null,-1));function Kt(o,e,t,i,l,s){const n=I("sched-btn"),r=I("drop-dwn-btn"),h=I("navigation-bar"),m=I("goaly-end"),p=I("mobileNoteScore"),b=I("q-calendar-day"),E=I("sched-dialog");return w(),H(tt,{padding:""},{default:P(()=>[M("div",Ot,[N(Ce,{modelValue:l.splitterPage,"onUpdate:modelValue":e[9]||(e[9]=S=>l.splitterPage=S),limits:[30,70]},{before:P(()=>[N(Ce,{modelValue:l.splitterLegend,"onUpdate:modelValue":e[3]||(e[3]=S=>l.splitterLegend=S),horizontal:"",limits:[20,80],style:{height:"100%"}},{before:P(()=>[M("div",Dt,[l.daSchedule.getProps().showReloadBtn?(w(),A("div",Ct,[N(n,{"text-label":"Reload",class:"sched-btn","text-color":"green",onDoBtnAction:s.onReloadSaved},null,8,["onDoBtnAction"])])):_("",!0),l.daSchedule.getProps().showClearBtn?(w(),A("div",Tt,[N(n,{"text-label":"Clear",class:"sched-btn","text-color":"lime-5",onDoBtnAction:s.onClearDay},null,8,["onDoBtnAction"])])):_("",!0),s.showDefaultBtn?(w(),A("div",wt,[N(n,{textLabel:s.defaultLabels,class:"sched-btn","text-color":"blue",onDoBtnAction:s.onLoadDefault},null,8,["textLabel","onDoBtnAction"])])):_("",!0),l.daSchedule.getProps().showScoreBtn?(w(),A("div",Rt,[N(r,{class:"sched-drop-btn","text-color":"teal",disableBtn:l.daSchedule.disableScoreBtn,optionLabel:s.chosenScoreLabel,daOptions:l.scoreOptions,onDoReload:s.doReloadWithScore,onChooseOption:s.onChoosenScore},null,8,["disableBtn","optionLabel","daOptions","onDoReload","onChooseOption"])])):_("",!0),l.daSchedule.getProps().showPrioBtn?(w(),A("div",Nt,[N(r,{class:"sched-drop-btn","text-color":"teal",disableBtn:l.daSchedule.getProps().disablePrioBtn,optionLabel:s.chosenPrioLabel,daOptions:s.allMainGPrio(),onDoReload:s.doReloadWithPrio,onChooseOption:s.onChoosenPrio},null,8,["disableBtn","optionLabel","daOptions","onDoReload","onChooseOption"])])):_("",!0),l.daSchedule.getProps().showOneEachBtn?(w(),A("div",Pt,[N(n,{"text-label":"One Each",class:"sched-btn","text-color":"brown",onDoBtnAction:s.onScheduleOneEach},null,8,["onDoBtnAction"])])):_("",!0)]),M("div",At,[N(ye,{class:"q-mt-md","text-color":s.saveScheduleDisabled?"grey":"blue",elevated:"",push:"",align:"evenly",label:"SaveSchedule",disable:s.saveScheduleDisabled,onClick:s.doSaveSchedule,"no-caps":""},null,8,["text-color","disable","onClick"]),N(ye,{class:"q-mt-md","text-color":"green",elevated:"",push:"",align:"evenly",label:"TreeLegend",onClick:e[0]||(e[0]=S=>l.showTree=!l.showTree),"no-caps":""})]),Mt]),after:P(()=>[_t,l.treeGoals.length>0?(w(),A("div",$t,[M("div",Bt,L(s.labelGoals("s")),1),M("div",kt,[N(ie,{color:"secondary","multi-line":""},{default:P(()=>[q(L(s.labelGoals("b"))+" mins ",1)]),_:1})]),N(je),xt,s.showTreeForm?(w(),A("div",Lt,[N(Xe,{label:"'je-suis'",hint:"Keyword >> Enter","hide-hint":"",ref:"filterRef",modelValue:l.filter,"onUpdate:modelValue":e[1]||(e[1]=S=>l.filter=S),"use-input":"","use-chips":"",multiple:"",disable:s.isViewingPast(),"hide-dropdown-icon":"","input-debounce":"0","new-value-mode":"add-unique",class:"q-gutter-sm"},{"selected-item":P(S=>[N(Ze,{removable:"",dense:"",onRemove:v=>S.removeAtIndex(S.index),tabindex:S.tabindex,"text-color":"black",class:"q-ma-none",style:{width:"80px"}},{default:P(()=>[q(L(S.opt),1)]),_:2},1032,["onRemove","tabindex"])]),append:P(()=>[l.filter.length>0?(w(),H(be,{key:0,name:"clear",class:"cursor-pointer",onClick:s.resetFilter},null,8,["onClick"])):_("",!0)]),_:1},8,["modelValue","disable"]),N(it,{nodes:l.treeGoals,"node-key":"label",filter:s.filterString,"filter-method":s.myFilterMethod,expanded:l.expanded,"onUpdate:expanded":e[2]||(e[2]=S=>l.expanded=S),"no-connectors":"",dense:""},{"default-header":P(S=>[M("div",{class:te(s.classyColor(S.node))},[S.node.isChildren?_("",!0):(w(),H(be,{key:0,name:S.node.icon||S.expanded?"expand_less":"expand_more",size:"28px",right:""},null,8,["name"])),M("div",Gt,L(S.node.label),1)],2)]),"default-body":P(S=>[S.node.isChildren?(w(),A("div",Vt,[M("span",It," >> "+L(S.node.details),1)])):(w(),A("span",Ht,L(S.node.details),1))]),_:1},8,["nodes","filter","filter-method","expanded"])])):_("",!0),l.filter.length>0?(w(),A("div",Ft,[N(n,{"text-label":"Add Moods",class:"q-mt-xl sched-btn","text-color":"red",onDoBtnAction:s.onMoodAdd},null,8,["onDoBtnAction"])])):_("",!0)])):_("",!0)]),_:1},8,["modelValue"])]),separator:P(()=>[N(Je,{color:"primary",class:"q-px-md","text-color":"white",size:"40px",icon:"drag_indicator",style:{position:"relative",top:"70%"}})]),after:P(()=>[N(h,{onToday:s.onToday,onPrev:s.onPrev,onNext:s.onNext},null,8,["onToday","onPrev","onNext"]),s.scheduleMoodsLabel!=""?(w(),A("div",jt,[N(ie,{color:"secondary","multi-line":""},{default:P(()=>[q(L(s.scheduleMoodsLabel),1)]),_:1})])):_("",!0),M("div",Jt,[M("div",qt,[N(b,{ref:"calendar",view:"day",modelValue:l.currentDate,"onUpdate:modelValue":e[8]||(e[8]=S=>l.currentDate=S),"drag-enter-func":s.onDragEnter,"drag-over-func":s.onDragOver,"drag-leave-func":s.onDragLeave,"drop-func":s.onDrop,animated:"",bordered:"",hoverable:"","no-active-date":"","transition-next":"slide-left","transition-prev":"slide-right","time-clicks-clamped":"","interval-minutes":15,"interval-count":96,"interval-height":28,"selected-start-end-dates":s.startEndTimes,onChange:s.onChange,onClickDate:s.onClickDate,onClickTime:s.onClickTime,onClickInterval:s.onClickInterval,onClickHeadIntervals:s.onClickHeadIntervals,onClickHeadDay:s.onClickHeadDay,onMousedownTime:s.onMouseDownTime,onMouseupTime:s.onMouseUpTime,onMousemoveTime:s.onMouseMoveTime},{"head-day-event":P(({scope:{timestamp:S}})=>[M("div",zt,[(w(!0),A(Q,null,Ee(s.eventsMap[S.date],v=>(w(),A(Q,{key:v.id},[v.time?(w(),H(ie,{key:1,class:te(s.badgeClasses(v,"header")),style:K([s.badgeStyles(v,"header"),{margin:"1px",width:"10px","max-width":"10px",height:"10px","max-height":"10px",cursor:"pointer"}]),onClick:C=>s.scrollToEvent(v)},{default:P(()=>[N(Oe,null,{default:P(()=>[q(L("("+v.id+") "+v.title+" - "+v.time+" >> "+v.duration+"min"),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"])):(w(),H(ie,{key:0,class:te(s.badgeClasses(v,"header")),style:K([s.badgeStyles(v,"header"),{width:"100%",cursor:"pointer",height:"12px","font-size":"10px",margin:"1px"}])},{default:P(()=>[M("div",Wt,[q(L(v.title)+" ",1),N(Oe,null,{default:P(()=>[q(L(v.details),1)]),_:2},1024)])]),_:2},1032,["class","style"]))],64))),128))])]),"day-container":P(({scope:{days:S}})=>[s.hasDate(S)?(w(),A(Q,{key:0},[M("div",{class:"day-view-current-time-indicator",style:K(s.style)},null,4),M("div",{class:"day-view-current-time-line",style:K(s.style)},null,4)],64)):_("",!0)]),"day-body":P(({scope:{timestamp:S,timeStartPos:v,timeDurationHeight:C}})=>[(w(!0),A(Q,null,Ee(s.getDateEvents(S.date),y=>(w(),A(Q,{key:y.id},[y.time!==void 0?(w(),A("div",{key:0,class:te(["my-event",s.badgeClasses(y,"body")]),style:K(s.badgeStyles(y,"body",v,C)),draggable:!0,onDblclick:ce(a=>s.onDblClickEvent(a,y),["prevent"]),onDragstart:ce(a=>s.onDragStart(a,y),["stop"]),onDragend:e[4]||(e[4]=ce((...a)=>s.onDragEnd&&s.onDragEnd(...a),["stop"])),onDrop:e[5]||(e[5]=a=>s.onDrop(a,"goal-item",o.scope)),onDragenter:e[6]||(e[6]=a=>s.onDragEnter(a,"goal-item",o.scope)),onDragover:e[7]||(e[7]=a=>s.onDragOver(a,"goal-item",o.scope)),onTouchstart:a=>s.onTouchStart(a,y),onTouchmove:a=>s.onTouchEvt(a,y),onTouchend:a=>s.onTouchEvt(a,y)},[qe(N(m,{disabledScore:l.daSchedule.isDisabledScoreEdit[y.id],title:y.title,id:y.id,startTime:y.time,score:y.score,details:y.details,notes:y.notes,happeningNow:l.daSchedule.hasStarted[y.id]?l.daSchedule.hasStarted[y.id]:!1,onEndNow:s.onEndNow,onSaveScore:s.onSaveScore,onAddMins:s.onAddMins,onDeleteNow:a=>s.removeEvtInSchedule(y)},null,8,["disabledScore","title","id","startTime","score","details","notes","happeningNow","onEndNow","onSaveScore","onAddMins","onDeleteNow"]),[[nt,a=>s.onTouchHold(a,y),"400:12:15"]]),s.showEvtMobile(y.id)?(w(),H(p,{key:0,title:y.title,id:y.id,startTime:y.time,score:y.score,details:y.details,notes:y.notes,"show-dialog":s.showEvtMobile(y.id),onSaveScore:s.onSaveScore,onDeleteNow:a=>s.removeEvtInSchedule(y),onEuhHidin:a=>l.daSchedule.euhHidin(y.id)},null,8,["title","id","startTime","score","details","notes","show-dialog","onSaveScore","onDeleteNow","onEuhHidin"])):_("",!0)],46,Ut)):_("",!0)],64))),128))]),_:1},8,["modelValue","drag-enter-func","drag-over-func","drag-leave-func","drop-func","selected-start-end-dates","onChange","onClickDate","onClickTime","onClickInterval","onClickHeadIntervals","onClickHeadDay","onMousedownTime","onMouseupTime","onMousemoveTime"])])]),Qt]),_:1},8,["modelValue"]),l.addEventDialog?(w(),H(E,{key:0,parentGoals:l.daSchedule.allPGoals(),canBeScheduled:s.canbeScheduled,balance:s.currentBalance,onAdHocEvent:s.onAddHocEvent,onOnPickEvent:s.onPickEvent,onEuhHidin:s.closingDialog},null,8,["parentGoals","canBeScheduled","balance","onAdHocEvent","onOnPickEvent","onEuhHidin"])):_("",!0)])]),_:1})}var ni=Fe(Et,[["render",Kt],["__scopeId","data-v-a7d4bea0"]]);export{ni as default};
