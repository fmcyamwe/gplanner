import{j as O,r as p,c as j,ar as A,n as D,aG as I,h as f,g as R,J as d,z as P,d as U,A as H,K as T,I as v,F as q,G as w,D as n,Q as z,C as c,a3 as y,a6 as G,a5 as F,bA as M,ba as N,bC as K,aX as J}from"./index.1bde7470.js";import{b as W}from"./goalStorage.eaf7c117.js";import{c as X}from"./QSelect.7bad7c28.js";import"./utiFunc.f569f737.js";import"./touch.9135741d.js";import"./QItem.9c617eab.js";function S(e,t=new WeakMap){if(Object(e)!==e)return e;if(t.has(e))return t.get(e);const o=e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):e instanceof Set?new Set:e instanceof Map?new Map:typeof e.constructor!="function"?Object.create(null):e.prototype!==void 0&&typeof e.prototype.constructor=="function"?e:new e.constructor;if(typeof e.constructor=="function"&&typeof e.valueOf=="function"){const a=e.valueOf();if(Object(a)!==a){const i=new e.constructor(a);return t.set(e,i),i}}return t.set(e,o),e instanceof Set?e.forEach(a=>{o.add(S(a,t))}):e instanceof Map&&e.forEach((a,i)=>{o.set(i,S(a,t))}),Object.assign(o,...Object.keys(e).map(a=>({[a]:S(e[a],t)})))}var x=O({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","beforeShow","show","beforeHide","hide"],setup(e,{slots:t,emit:o}){const{proxy:a}=R(),{$q:i}=a,u=p(null),r=p(""),l=p("");let g=!1;const E=j(()=>A({initialValue:r.value,validate:e.validate,set:h,cancel:m,updatePosition:C},"value",()=>l.value,s=>{l.value=s}));function h(){e.validate(l.value)!==!1&&(b()===!0&&(o("save",l.value,r.value),o("update:modelValue",l.value)),V())}function m(){b()===!0&&o("cancel",l.value,r.value),V()}function C(){D(()=>{u.value.updatePosition()})}function b(){return I(l.value,r.value)===!1}function V(){g=!0,u.value.hide()}function k(){g=!1,r.value=S(e.modelValue),l.value=S(e.modelValue),o("beforeShow")}function B(){o("show")}function $(){g===!1&&b()===!0&&(e.autoSave===!0&&e.validate(l.value)===!0?(o("save",l.value,r.value),o("update:modelValue",l.value)):o("cancel",l.value,r.value)),o("beforeHide")}function Q(){o("hide")}function _(){const s=t.default!==void 0?[].concat(t.default(E.value)):[];return e.title&&s.unshift(f("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},e.title)),e.buttons===!0&&s.push(f("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[f(d,{flat:!0,color:e.color,label:e.labelCancel||i.lang.label.cancel,onClick:m}),f(d,{flat:!0,color:e.color,label:e.labelSet||i.lang.label.set,onClick:h})])),s}return Object.assign(a,{set:h,cancel:m,show(s){u.value!==null&&u.value.show(s)},hide(s){u.value!==null&&u.value.hide(s)},updatePosition:C}),()=>{if(e.disable!==!0)return f(X,{ref:u,class:"q-popup-edit",cover:e.cover,onBeforeShow:k,onShow:B,onBeforeHide:$,onHide:Q,onEscapeKey:m},_)}}});const L=U({name:"GoalyEnd",props:{disabledScore:Boolean,title:String,id:Number,startTime:String,details:String,notes:String,score:String,happeningNow:Boolean,icon:String},data(){const e=p(""),t=p(!1);return{note:this.notes,daScore:this.score,daIcon:this.icon,errorMessageScore:e,errorScore:t}},emits:["saveScore","endNow","deleteNow","addMins"],computed:{aScore:{get(){return this.daScore},set(e){this.aScorey(e)?this.daScore=e:console.log("setting invalid aScore?",e,this.daScore),this.daScore=e},cancel(){console.log("aScore remove?",this.id)}},aNote:{get(){return this.note},set(e){this.note=e}},userIconStyle(){return{color:this.disabledScore===!0?"red":"blue",cursor:"pointer"}},ClassNStyle(){let e="title q-calendar__ellipsis";return this.disabledScore===!1&&this.happeningNow===!0?e+" mooh":e},showBtnStyle(){return{display:this.disabledScore===!0&&this.happeningNow===!0?"flex":"none","text-align":"center","margin-left":"1em",height:"auto"}}},watch:{title(e){console.log("titleValue:",e)}},methods:{onDelete(){this.$emit("deleteNow")},onSave(){if(this.errorMessageScore!=""||this.errorScore){console.log("ERROR saveScore",this.aScore,this.errorMessageScore);return}this.$emit("saveScore",this.id,this.aScore,this.aNote)},wannaEnd(){this.$emit("endNow",this.id)},wannaAdd(e){this.$emit("addMins",this.id,e)},aScorey(e){var t=/^\don\d$/g,o=e.match(t)||[];return o&&e!==o[0]?(this.errorScore=!0,this.errorMessageScore=`Error: ${e} Unsaved.Must format as: #on#`,!1):(this.errorScore=!1,this.errorMessageScore="",!0)},reset(){this.errorScore=!1,this.errorMessageScore=""}}}),Y={class:"title q-calendar__ellipsis"},Z={class:"q-pl-sm"},ee={class:"q-gutter-md q-ma-md inputBtn text-weight-bold"};function te(e,t,o,a,i,u){return H(),T("div",Y,[v("div",Z,[q(w(` ${e.title} (${e.score})`)+" ",1),n(z,{name:e.daIcon},null,8,["name"])]),n(W,null,{default:c(()=>[q(w("("+e.id+") "+e.details),1)]),_:1}),v("div",{style:G(e.showBtnStyle)},[n(d,{"no-caps":"",label:"Add5",align:"between",onClick:t[0]||(t[0]=r=>e.wannaAdd(5))}),n(d,{"no-caps":"",label:"Add10",align:"between",class:"q-mx-md poppy",onClick:t[1]||(t[1]=r=>e.wannaAdd(10))}),n(y,{vertical:!0}),n(d,{"no-caps":"",label:"End-Now",align:"between",onClick:e.wannaEnd},null,8,["onClick"])],4),n(x,{modelValue:e.aScore,"onUpdate:modelValue":t[3]||(t[3]=r=>e.aScore=r),disable:e.disabledScore,"auto-save":"","touch-position":""},{default:c(r=>[n(F,{class:"bg-secondary text-white"},{default:c(()=>[t[5]||(t[5]=v("div",{class:"title"},":: NoteyOnScore ::",-1)),v("div",ee,w(e.title),1),n(M,{class:"q-gutter-md"},{default:c(()=>[n(N,{modelValue:r.value,"onUpdate:modelValue":l=>r.value=l,dense:"","label-slot":"",hint:"format: #on#",error:e.errorScore,"error-message":e.errorMessageScore},{label:c(()=>t[4]||(t[4]=[v("div",{class:"row items-center all-pointer-events q-mx-xs"}," Score ",-1)])),_:2},1032,["modelValue","onUpdate:modelValue","error","error-message"])]),_:2},1024),n(M,{class:"q-gutter-md"},{default:c(()=>[n(N,{filled:"",modelValue:e.aNote,"onUpdate:modelValue":t[2]||(t[2]=l=>e.aNote=l),label:"Note",autogrow:"","lazy-rules":"","item-aligned":"",rules:[l=>l&&l.length>0||"Add a note..."]},null,8,["modelValue","rules"])]),_:1}),n(y,{dark:""}),n(K,{class:"q-gutter-md q-mx-md inputBtn"},{default:c(()=>[n(d,{label:"Save",flat:"",dense:"",color:"positive",icon:"check_circle",onClick:[J(r.set,["stop","prevent"]),e.onSave]},null,8,["onClick"]),n(y,{vertical:!0}),n(d,{label:"Del",flat:"",dense:"",color:"negative",icon:"delete_forever",onClick:e.onDelete},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue","disable"])])}var ie=P(L,[["render",te],["__scopeId","data-v-4815ccc0"]]);export{ie as default};
