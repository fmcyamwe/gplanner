import{ab as U,r as Y,c as d}from"./index.dfe0cbf5.js";import{u as q}from"./use-quasar.47598782.js";const H=U("allGoals",()=>{const G=Y([{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}]),S=[{text:"",sortable:!1},{text:"#",sortable:!1},{text:"TITLE",value:"title",sortable:!1},{text:"Goal",value:"subGoal",sortable:!1},{text:"PRIORITY",value:"priority",sortable:!1},{text:"DURATION",value:"duration",sortable:!1}],i=q(),b=d(()=>S),m=d(()=>{let l=JSON.parse(i.localStorage.getItem("mainGoals"));return h(l)}),p=d(()=>{let l=JSON.parse(i.localStorage.getItem("subGoals"));return h(l)}),v=d(()=>JSON.parse(i.localStorage.getItem("AllDates")));function h(l){return l?[...l]:[]}function y(l,t,e,o){console.log(l+" "+t+" "+e+" "+o);let a=this.getMainGoals;if(!a){console.log("umm no mainGoals...adding"),i.localStorage.set("mainGoals",JSON.stringify([{id:0,title:l,details:t,priority:o,bgcolor:e,icon:"fas fa-utensils"}]));return}let r=a.length+1;for(;a.some(n=>n.id===r);)r=Math.floor(Math.random()*1e3);return a.unshift({id:r,title:l,details:t,priority:o,bgcolor:e,icon:"fas fa-utensils"}),i.localStorage.set("mainGoals",JSON.stringify(a)),console.log("done adding mainGoal",r),r}function D(l,t,e,o,a,r){console.log(l+" "+t+" "+e+" "+o+" "+a+" "+r);let n=this.getSubGoals;if(!n){i.localStorage.set("subGoals",JSON.stringify([{id:0,parentGoal:l,title:t,score:e,time:o,duration:a,canMove:r}]));return}let s=n.length+1;for(;n.some(u=>u.id===s);)s=Math.floor(Math.random()*1e3);return n.unshift({id:s,parentGoal:l,title:t,score:e,time:o,duration:a,canMove:r}),i.localStorage.set("subGoals",JSON.stringify(n)),console.log("done adding subGoal",s),s}function O(l,t,e,o,a,r){let n=this.getSubGoals;for(var s=0;s<n.length;s++)if(n[s].id===l){n[s].title=t,n[s].score=e,n[s].time=o,n[s].duration=a,n[s].canMove=r,console.log("editSubGoal for",n[s],s);break}i.localStorage.set("subGoals",JSON.stringify(n))}function x(){i.localStorage.remove("mainGoals"),console.log("removed all mainGoal")}function A(){i.localStorage.remove("subGoals"),console.log("removed all subGoals")}function M(){i.localStorage.remove("subGoals"),i.localStorage.remove("mainGoals"),console.log("removed ALL")}function N(l,t=null,e=null){let o=this.getSubGoals;for(var a=0;a<o.length;a++)if(o[a].id===l){o[a].time=t||o[a].time,o[a].score=e||o[a].score;break}i.localStorage.set("subGoals",JSON.stringify(o))}function I(l){let t=this.getSubGoals;for(var e=0;e<t.length;e++)t[e].id===l&&(t.splice(e,1),console.log("removeSubgoal spliced!"));return i.localStorage.set("subGoals",JSON.stringify(t)),t}function J(l,t){let e=this.getMainGoals;for(var o=0;o<e.length;o++)e[o].id===l&&(e.splice(o,1),console.log("removeMaingoal spliced!"));return i.localStorage.set("mainGoals",JSON.stringify(e)),e}function T(l){let t=this.getMainGoals;for(var e=0;e<t.length;e++)if(t[e].title===l)return t[e];return null}function $(l,t){let e=this.getAllDates;e?(e[`${l}`]=t,i.localStorage.set("AllDates",JSON.stringify(e))):(console.log(`Adding new schedule for ${l}`),e={},e[`${l}`]=t,i.localStorage.set("AllDates",JSON.stringify(e)))}function R(l){let t=this.getAllDates;if(t)return t[`${l}`]}function E(l){let t=this.getAllDates;return t?!!t[`${l}`]:!1}function F(l=null){let t=this.getMainGoals,e=new Set;if(l)for(var o=0;o<t.length;o++)t[o].priority==l&&e.add(t[o].priority);else t.forEach(a=>{e.add(a.priority)});return e}function L(l){const t=[];let e=function(a){const r=a.split(/on/);return r.length!=2?(console.log(`parseScore error?${a}`,r),-1):r[1]-r[0]},o=this.getSubGoals;return o&&o.forEach(a=>{if(a.score=="")console.log(`no score event added: ${a.title}`,a.score),t.push(a);else{let r=e(a.score);r>-1&&r>=l&&t.push(a)}}),t}function k(l){const e=(l/60).toFixed(2);return parseFloat(e)}function w(){let l=this.getAllDates;if(!l)return console.log("no savedTaskSummary..ERROR"),[];let t=this.getMainGoals,e=this.getSubGoals,o={};for(let s in l){let u=l[s];for(let c in u)o[c]||(o[c]=[]),o[c].push({date:s,logged:k(u[c].duration)})}let a=s=>{let u=[];return e&&e.forEach(c=>{c.parentGoal==s&&u.push(c)}),u},r=(s,u=null)=>{let c={children:[],title:u?`${s.title}:(${s.score})`:s.title,key:u?`${u}-${s.id}`:s.id,logged:[],expanded:!1};if(u){let f=o[s.id]||[];c.logged=[...f]}return c},n=[];return t.forEach(s=>{let u=r(s),c=a(s.id);for(let f=0;f<c.length;f++){let g=r(c[f],s.id);if(g.logged.length==0){console.log(`Oooh no logged for parent ${s.title}`,g);continue}u.logged.push(...g.logged),u.children.push(g)}n.push(u)}),n}return{headers:S,headerRefs:G,getHeaders:b,getMainGoals:m,getSubGoals:p,getAllDates:v,addMainGoal:y,addSubGoal:D,editSubGoal:O,getGoalByTitle:T,saveSubProp:N,saveDailySchedule:$,resetSub:A,resetMain:x,resetAll:M,removeSubgoal:I,removeMaingoal:J,getEventsForDate:R,hasEventsForDate:E,fetchAllTaskSummary:w,fetchGoalsWithMinScore:L,fetchAllPrio:F}});export{H as u};
