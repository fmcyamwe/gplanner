import{j as re,r as $,c as X,aj as Le,n as Ie,at as _e,h as L,g as Pe,Q as k,d as oe,_ as U,F as A,M as B,K as N,V,I as E,H as P,J as x,P as te,W as Y,au as Ae,av as ne,G as I,k as Ne,aw as Me,a5 as xe,ax as Fe,ay as qe,w as we,b as He,S as ge,ao as Je,al as We,az as ze,aA as je,Z as Ue,N as me,O as z,f as Qe,aB as Ce,U as G,X as de,Y as he,aC as Be,aD as pe,ah as Oe,as as ae,E as H,aE as Ke,R as ie}from"./index.3e746479.js";import{c as Se,a as Ye,b as Xe,p as Ze,Q as se}from"./utiFunc.5f90a045.js";import{Q as ke,a as et,b as tt,c as ot,d as it,e as ve,f as st,g as lt,h as nt,i as at}from"./goalForm.c360d389.js";import{N as rt,t as j,p as ue,a as M,j as Q,k as fe,T as dt,b as W,c as _,i as le,C as $e,U as q,V as K,Q as ht}from"./NavigationBar.f4f20197.js";import{u as ct,Q as Re}from"./goalStorage.2fa30136.js";import{a as ut}from"./QCalendar.a0c74f53.js";/* empty css                             */import{u as ft}from"./use-quasar.ae4e9323.js";const gt=()=>!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);function ee(t,o=new WeakMap){if(Object(t)!==t)return t;if(o.has(t))return o.get(t);const i=t instanceof Date?new Date(t):t instanceof RegExp?new RegExp(t.source,t.flags):t instanceof Set?new Set:t instanceof Map?new Map:typeof t.constructor!="function"?Object.create(null):t.prototype!==void 0&&typeof t.prototype.constructor=="function"?t:new t.constructor;if(typeof t.constructor=="function"&&typeof t.valueOf=="function"){const s=t.valueOf();if(Object(s)!==s){const l=new t.constructor(s);return o.set(t,l),l}}return o.set(t,i),t instanceof Set?t.forEach(s=>{i.add(ee(s,o))}):t instanceof Map&&t.forEach((s,l)=>{i.set(l,ee(s,o))}),Object.assign(i,...Object.keys(t).map(s=>({[s]:ee(t[s],o)})))}var mt=re({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","beforeShow","show","beforeHide","hide"],setup(t,{slots:o,emit:i}){const{proxy:s}=Pe(),{$q:l}=s,n=$(null),a=$(""),r=$("");let h=!1;const c=X(()=>Le({initialValue:a.value,validate:t.validate,set:d,cancel:p,updatePosition:y},"value",()=>r.value,u=>{r.value=u}));function d(){t.validate(r.value)!==!1&&(v()===!0&&(i("save",r.value,a.value),i("update:modelValue",r.value)),R())}function p(){v()===!0&&i("cancel",r.value,a.value),R()}function y(){Ie(()=>{n.value.updatePosition()})}function v(){return _e(r.value,a.value)===!1}function R(){h=!0,n.value.hide()}function D(){h=!1,a.value=ee(t.modelValue),r.value=ee(t.modelValue),i("beforeShow")}function T(){i("show")}function C(){h===!1&&v()===!0&&(t.autoSave===!0&&t.validate(r.value)===!0?(i("save",r.value,a.value),i("update:modelValue",r.value)):i("cancel",r.value,a.value)),i("beforeHide")}function b(){i("hide")}function g(){const u=o.default!==void 0?[].concat(o.default(c.value)):[];return t.title&&u.unshift(L("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},t.title)),t.buttons===!0&&u.push(L("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[L(k,{flat:!0,color:t.color,label:t.labelCancel||l.lang.label.cancel,onClick:p}),L(k,{flat:!0,color:t.color,label:t.labelSet||l.lang.label.set,onClick:d})])),u}return Object.assign(s,{set:d,cancel:p,show(u){n.value!==null&&n.value.show(u)},hide(u){n.value!==null&&n.value.hide(u)},updatePosition:y}),()=>{if(t.disable!==!0)return L(ke,{ref:n,class:"q-popup-edit",cover:t.cover,onBeforeShow:D,onShow:T,onBeforeHide:C,onHide:b,onEscapeKey:p},g)}}});const pt=oe({name:"GoalyEnd",props:{disabledScore:Boolean,title:String,id:Number,startTime:String,details:String,score:String,happeningNow:Boolean},data(){const t=$(""),o=$(!1);return{errorMessageScore:t,errorScore:o}},emits:["saveScore","endNow","deleteNow","addMins"],computed:{aScore:{get(){return this.score},set(t){this.aScorey(t)&&this.$emit("saveScore",t,this.id)},cancel(){console.log("aScore remove?",this.id)}},userIconStyle(){return{color:this.disabledScore===!0?"red":"blue",cursor:"pointer"}},endNowBtnStyle(){return{display:this.disabledScore===!0&&this.happeningNow===!0?"flex":"none","text-align":"center","margin-left":"32em",height:"auto"}}},watch:{title(t){console.log("titleValue:",t)}},methods:{onDelete(){this.$emit("deleteNow",this.id)},wannaEnd(){this.$emit("endNow",this.id)},wannaAdd(t){this.$emit("addMins",this.id,t)},aScorey(t){return t.length<4||!t.includes("on")?(this.errorScore=!0,this.errorMessageScore=`Error: ${t} Unsaved.Must format as: #on#`,!1):(this.errorScore=!1,this.errorMessageScore="",!0)}}}),St={class:"title q-calendar__ellipsis"},vt={class:"q-pl-md"};function yt(t,o,i,s,l,n){return A(),B("div",St,[N("div",vt,V(` ${t.title} (${t.score})`),1),E(Se,null,{default:P(()=>[x(V("("+t.id+") "+t.details),1)]),_:1}),N("div",{style:Y(t.endNowBtnStyle)},[E(k,{"no-caps":"",label:"Add5",onClick:o[0]||(o[0]=a=>t.wannaAdd(5))}),E(k,{"no-caps":"",label:"Add10",class:"q-mx-md",onClick:o[1]||(o[1]=a=>t.wannaAdd(10))}),E(te,{vertical:!0}),E(k,{"no-caps":"",label:"End-Now",onClick:t.wannaEnd},null,8,["onClick"])],4),E(mt,{modelValue:t.aScore,"onUpdate:modelValue":o[2]||(o[2]=a=>t.aScore=a),disable:t.disabledScore,"auto-save":""},{default:P(a=>[E(Ae,{modelValue:a.value,"onUpdate:modelValue":r=>a.value=r,dense:"",hint:"format: #on#",error:t.errorScore,"error-message":t.errorMessageScore},{after:P(()=>[E(k,{flat:"",dense:"",color:"positive",icon:"check_circle",onClick:ne(a.set,["stop","prevent"])},null,8,["onClick"]),E(te,{vertical:!0}),E(k,{label:"Del",flat:"",dense:"",color:"negative",icon:"delete_forever",onClick:t.onDelete},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","error","error-message"])]),_:1},8,["modelValue","disable"])])}var Et=U(pt,[["render",yt],["__scopeId","data-v-c867a700"]]);const bt=oe({name:"schedBtn",props:{textLabel:String},emits:["doBtnAction"],methods:{onClicked(){this.$emit("doBtnAction")}}});function wt(t,o,i,s,l,n){return A(),I(k,{color:"",elevated:"",onClick:t.onClicked,"no-caps":""},{default:P(()=>[N("div",null,V(t.textLabel),1)]),_:1},8,["onClick"])}var Ct=U(bt,[["render",wt],["__scopeId","data-v-f8dc388e"]]),Ot=re({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(t,{slots:o}){const i=X(()=>{const s=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(l=>t[l]===!0).map(l=>`q-btn-group--${l}`).join(" ");return`q-btn-group row no-wrap${s.length>0?" "+s:""}`+(t.spread===!0?" q-btn-group--spread":" inline")});return()=>L("div",{class:i.value},Ne(o.default))}});const $t=Object.keys(Me),Rt=t=>$t.reduce((o,i)=>{const s=t[i];return s!==void 0&&(o[i]=s),o},{});var Dt=re({name:"QBtnDropdown",props:{...Me,...xe,modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String},emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(t,{slots:o,emit:i}){const{proxy:s}=Pe(),l=$(t.modelValue),n=$(null),a=Fe(),r=X(()=>{const u={"aria-expanded":l.value===!0?"true":"false","aria-haspopup":"true","aria-controls":a,"aria-label":t.toggleAriaLabel||s.$q.lang.label[l.value===!0?"collapse":"expand"](t.label)};return(t.disable===!0||t.split===!1&&t.disableMainBtn===!0||t.disableDropdown===!0)&&(u["aria-disabled"]="true"),u}),h=X(()=>"q-btn-dropdown__arrow"+(l.value===!0&&t.noIconAnimation===!1?" rotate-180":"")+(t.split===!1?" q-btn-dropdown__arrow-container":"")),c=X(()=>qe(t)),d=X(()=>Rt(t));we(()=>t.modelValue,u=>{n.value!==null&&n.value[u?"show":"hide"]()}),we(()=>t.split,g);function p(u){l.value=!0,i("beforeShow",u)}function y(u){i("show",u),i("update:modelValue",!0)}function v(u){l.value=!1,i("beforeHide",u)}function R(u){i("hide",u),i("update:modelValue",!1)}function D(u){i("click",u)}function T(u){Je(u),g(),i("click",u)}function C(u){n.value!==null&&n.value.toggle(u)}function b(u){n.value!==null&&n.value.show(u)}function g(u){n.value!==null&&n.value.hide(u)}return Object.assign(s,{show:b,hide:g,toggle:C}),He(()=>{t.modelValue===!0&&b()}),()=>{const u=[L(ge,{class:h.value,name:t.dropdownIcon||s.$q.iconSet.arrow.dropdown})];return t.disableDropdown!==!0&&u.push(L(ke,{ref:n,id:a,class:t.contentClass,style:t.contentStyle,cover:t.cover,fit:!0,persistent:t.persistent,noRouteDismiss:t.noRouteDismiss,autoClose:t.autoClose,anchor:t.menuAnchor,self:t.menuSelf,offset:t.menuOffset,separateClosePopup:!0,transitionShow:t.transitionShow,transitionHide:t.transitionHide,transitionDuration:t.transitionDuration,onBeforeShow:p,onShow:y,onBeforeHide:v,onHide:R},o.default)),t.split===!1?L(k,{class:"q-btn-dropdown q-btn-dropdown--simple",...d.value,...r.value,disable:t.disable===!0||t.disableMainBtn===!0,noWrap:!0,round:!1,onClick:D},{default:()=>Ne(o.label,[]).concat(u),loading:o.loading}):L(Ot,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:t.rounded,square:t.square,...c.value,glossy:t.glossy,stretch:t.stretch},()=>[L(k,{class:"q-btn-dropdown--current",...d.value,disable:t.disable===!0||t.disableMainBtn===!0,noWrap:!0,round:!1,onClick:T},{default:o.label,loading:o.loading}),L(k,{class:"q-btn-dropdown__arrow-container q-anchor--skip",...r.value,...c.value,disable:t.disable===!0||t.disableDropdown===!0,rounded:t.rounded,color:t.color,textColor:t.textColor,dense:t.dense,size:t.size,padding:t.padding,ripple:t.ripple},()=>u)])}}});function De(t){if(t===!1)return 0;if(t===!0||t===void 0)return 1;const o=parseInt(t,10);return isNaN(o)?0:o}var Tt=We({name:"close-popup",beforeMount(t,{value:o}){const i={depth:De(o),handler(s){i.depth!==0&&setTimeout(()=>{const l=ze(t);l!==void 0&&je(l,s,i.depth)})},handlerKey(s){Ue(s,13)===!0&&i.handler(s)}};t.__qclosepopup=i,t.addEventListener("click",i.handler),t.addEventListener("keyup",i.handlerKey)},updated(t,{value:o,oldValue:i}){o!==i&&(t.__qclosepopup.depth=De(o))},beforeUnmount(t){const o=t.__qclosepopup;t.removeEventListener("click",o.handler),t.removeEventListener("keyup",o.handlerKey),delete t.__qclosepopup}});const Pt=oe({name:"schedDropBtn",props:{optionLabel:String,disableBtn:Boolean,daOptions:Array},emits:["doReload","chooseOption"],methods:{onClicked(){this.$emit("doReload")},onSelect(t){this.$emit("chooseOption",t)}}});function At(t,o,i,s,l,n){return A(),I(Dt,{split:"",color:"",elevated:"","disable-main-btn":t.disableBtn,label:t.optionLabel,onClick:t.onClicked,"no-caps":""},{default:P(()=>[E(et,{bordered:"",padding:""},{default:P(()=>[(A(!0),B(z,null,me(t.daOptions,a=>Qe((A(),I(tt,{key:a,clickable:"",onClick:r=>t.onSelect(a)},{default:P(()=>[E(ot,{style:{"text-align":"center"}},{default:P(()=>[E(it,null,{default:P(()=>[x(V(a),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[Tt]])),128))]),_:1})]),_:1},8,["disable-main-btn","label","onClick"])}var Nt=U(Pt,[["render",At],["__scopeId","data-v-33aa88cc"]]);const Mt=L("div",{class:"q-space"});var ye=re({name:"QSpace",setup(){return()=>Mt}});const Bt={name:"adHocEvent",props:{mainGoals:Array},data(){return{aTitle:"",daP:null,own:"misc",duration:15}},emits:["saveEvent","doCancel"],computed:{pGoals:{get(){return this.mainGoals}},evName:{get(){return this.aTitle},set(t){this.aTitle=t}},labely:{get(){return this.own=="misc"?this.daP==null?"Defaut Misc. PGoal":"Of Parent Goal":"Select Parent Goal"}}},methods:{goalyColor(t){return this.daP==null?"":t=="c"?"bg-"+this.daP.bgcolor:this.daP.bgcolor},onClicked(){this.$emit("saveEvent",this.aTitle,this.daP,this.own,this.duration),this.own="own",this.daP=null,this.duration=15}}},kt=t=>(de("data-v-d5b4b8b4"),t=t(),he(),t),Gt=kt(()=>N("div",{class:"text-h3"},"Ad hoc Event",-1)),Vt={class:"q-ml-md"},Lt={class:"radio-select"},It={key:0},_t={class:"q-mx-md",style:{"text-align":"center"}};function xt(t,o,i,s,l,n){return A(),B(z,null,[Gt,E(ye),E(te),N("div",Vt,[E(Ae,{modelValue:n.evName,"onUpdate:modelValue":o[0]||(o[0]=a=>n.evName=a),filled:"",label:"A Goal","lazy-rules":"","item-aligned":"",rules:[a=>a&&a.length>0||"Please type a goal"]},null,8,["modelValue","rules"]),N("div",Lt,[E(Ce,{class:"q-mx-md",modelValue:l.own,"onUpdate:modelValue":o[1]||(o[1]=a=>l.own=a),val:"misc",label:"Misc"},null,8,["modelValue"]),E(Ce,{class:"q-mx-md",modelValue:l.own,"onUpdate:modelValue":o[2]||(o[2]=a=>l.own=a),val:"self",label:"By Self"},null,8,["modelValue"])]),n.pGoals?(A(),B("div",It,[E(ve,{class:"q-gutter-md",modelValue:l.daP,"onUpdate:modelValue":o[3]||(o[3]=a=>l.daP=a),options:n.pGoals,"option-value":"id","option-label":"title",disable:l.own!="misc",label:n.labely,popupContentClass:"q-px-md","options-selected-class":n.goalyColor("c"),"label-color":n.goalyColor("l")},null,8,["modelValue","options","disable","label","options-selected-class","label-color"])])):G("",!0),N("div",null,[x(" duration "),E(st,{min:15,max:120,thickness:.22,step:5,modelValue:l.duration,"onUpdate:modelValue":o[4]||(o[4]=a=>l.duration=a),"show-value":"",label:"Duration",size:"75px",color:"teal","track-color":"grey-3",class:"q-ma-md"},null,8,["thickness","modelValue"])])]),N("div",_t,[E(k,{flat:"",align:"center",label:"Cancel",color:"primary",onClick:o[5]||(o[5]=a=>t.$emit("doCancel"))}),E(k,{elevated:"",color:"primary",onClick:n.onClicked},{default:P(()=>[x(" Add ")]),_:1},8,["onClick"])])],64)}var Ft=U(Bt,[["render",xt],["__scopeId","data-v-d5b4b8b4"]]);const qt={name:"selectEvent",props:{canBeScheduled:Array,toBalance:Number},data(){return{doForce:!1,toAddE:null,useBalance:!1}},emits:["onPickEvent","doCancel"],computed:{allScheduled:{get(){return this.canBeScheduled}},toAdd:{get(){return this.toAddE},set(t){this.toAddE=t}}},methods:{onAddClicked(){this.$emit("onPickEvent",this.toAdd,this.doForce,this.useBalance),this.doForce=!1,this.useBalance=!1,this.toAdd=null},goalyColor(t){var o,i;return this.toAdd==null?"":t=="c"?"bg-"+((o=this.toAdd)==null?void 0:o.color):(i=this.toAdd)==null?void 0:i.color},labely(){var t;return this.toAdd==null?"Sub Goal":"Of: "+((t=this.toAdd)==null?void 0:t.pg)},canBalance(){var o,i,s,l;let t=this.toBalance+parseInt((o=this.toAdd)==null?void 0:o.duration)||((i=this.toAdd)==null?void 0:i.isAlternative);return console.log("canBalance",t),this.toAdd==null?!1:this.toBalance+parseInt((s=this.toAdd)==null?void 0:s.duration)||((l=this.toAdd)==null?void 0:l.isAlternative)}}},Ge=t=>(de("data-v-fea0dde2"),t=t(),he(),t),Ht={class:"q-pa-md row items-start"},Jt=Ge(()=>N("div",{class:"text-h3"},"Select event",-1)),Wt={class:"q-mx-md event-select"},zt=Ge(()=>N("div",{class:"q-mx-md",style:{"text-align":"center"}}," Add ",-1));function jt(t,o,i,s,l,n){return A(),B("div",Ht,[E(ae,null,{default:P(()=>[E(Be,null,{default:P(()=>[Jt]),_:1}),E(te),N("div",Wt,[E(ve,{modelValue:n.toAdd,"onUpdate:modelValue":o[0]||(o[0]=a=>n.toAdd=a),options:n.allScheduled,class:"q-gutter-md","option-value":"id","option-label":"title",popupContentClass:"q-px-md scheduly",label:n.labely(),"options-selected-class":n.goalyColor("c"),"label-color":n.goalyColor("l")},null,8,["modelValue","options","label","options-selected-class","label-color"])]),E(pe,{align:"center",class:"q-px-xl"},{default:P(()=>[E(Oe,{dense:"",modelValue:l.doForce,"onUpdate:modelValue":o[1]||(o[1]=a=>l.doForce=a),label:"Force",color:"teal"},null,8,["modelValue"]),E(ye),n.canBalance?(A(),I(Oe,{key:0,dense:"",modelValue:l.useBalance,"onUpdate:modelValue":o[2]||(o[2]=a=>l.useBalance=a),label:"Use Balance",color:"brown"},null,8,["modelValue"])):G("",!0)]),_:1}),E(pe,{align:"center"},{default:P(()=>[E(k,{flat:"",label:"Cancel",color:"primary",onClick:o[3]||(o[3]=a=>t.$emit("doCancel"))}),E(k,{elevated:"",color:"primary",onClick:n.onAddClicked},{default:P(()=>[zt]),_:1},8,["onClick"])]),_:1})]),_:1})])}var Ut=U(qt,[["render",jt],["__scopeId","data-v-fea0dde2"]]);const Qt=oe({name:"schedDialog",components:{adHocEvent:Ft,selectEvent:Ut},props:{parentGoals:Array,canBeScheduled:Array,balance:Number},data(){return{showPickDialog:$(!1),showAdHocDialog:$(!1),show:$(!0)}},emits:["addAdHocEvent","onPickEvent","euhHidin"],computed:{showDefaultOption:{get(){return this.show},set(t){this.show=t}},showPickyDialog:{get(){return this.showPickDialog},set(t){this.showPickDialog=t}},showAddyDialog:{get(){return this.showAdHocDialog},set(t){this.showAdHocDialog=t}},allScheduled:{get(){return this.canBeScheduled.forEach(t=>{let o=this.parentGoals.find(i=>i.id==t.parentGoal);o?t.color=o.bgcolor:t.color="",t.pg=o==null?void 0:o.title.trim()}),this.canBeScheduled}}},methods:{onAddClicked(t,o,i){this.$emit("onPickEvent",t,o,i),this.reset()},adHocNewEvent(t,o,i,s){this.$emit("addAdHocEvent",t,o,i,s),this.reset()},onChooseExisting(){this.showPickyDialog=!this.showPickyDialog},onChooseAdHoc(){this.showAddyDialog=!this.showAddyDialog},gonHide(){this.$emit("euhHidin")},onCancelBtn(){let t=this.showPickyDialog;this.showAddyDialog,t?this.showPickyDialog=!this.showPickyDialog:this.showAddyDialog=!this.showAddyDialog},reset(){this.showAddyDialog=!1,this.showPickyDialog=!1}}}),Kt=t=>(de("data-v-554dc47a"),t=t(),he(),t),Yt={class:"q-ma-md event-select"},Xt={class:"q-ma-md event-select"},Zt=Kt(()=>N("div",{class:"text-h6"},"Ad hoc or Existing event",-1));function eo(t,o,i,s,l,n){const a=H("select-event"),r=H("ad-hoc-event");return A(),I(Ke,{modelValue:t.showDefaultOption,"onUpdate:modelValue":o[0]||(o[0]=h=>t.showDefaultOption=h),"transition-show":"rotate","transition-hide":"rotate","no-esc-dismiss":"",onBeforeHide:t.gonHide},{default:P(()=>[t.showPickyDialog?(A(),I(ae,{key:0},{default:P(()=>[N("div",Yt,[E(a,{canBeScheduled:t.allScheduled,toBalance:t.balance,onOnPickEvent:t.onAddClicked,onDoCancel:t.onCancelBtn},null,8,["canBeScheduled","toBalance","onOnPickEvent","onDoCancel"])])]),_:1})):t.showAddyDialog?(A(),I(ae,{key:1},{default:P(()=>[N("div",Xt,[E(r,{mainGoals:t.parentGoals,onSaveEvent:t.adHocNewEvent,onDoCancel:t.onCancelBtn},null,8,["mainGoals","onSaveEvent","onDoCancel"]),E(ye)])]),_:1})):(A(),I(ae,{key:2},{default:P(()=>[E(Be,null,{default:P(()=>[Zt]),_:1}),E(pe,{align:"center"},{default:P(()=>[E(k,{flat:"",label:"Add hoc",color:"primary",onClick:t.onChooseAdHoc},null,8,["onClick"]),E(k,{flat:"",label:"Existing",color:"primary",onClick:t.onChooseExisting},null,8,["onClick"])]),_:1})]),_:1}))]),_:1},8,["modelValue","onBeforeHide"])}var to=U(Qt,[["render",eo],["__scopeId","data-v-554dc47a"]]);function Te(t){return t.button===0}const oo=oe({name:"dayCalendar",components:{NavigationBar:rt,QCalendarDay:ut,addGoalForm:lt,GoalyEnd:Et,schedBtn:Ct,schedDropBtn:Nt,schedDialog:to},data(){return $(null),$(null),$(null),$(null),$(null),ft(),{filter:$([]),filterRef:$(null),currentDate:$(j()),scoreOptions:$([1,2,3,4,5,6]),chosenScore:$(null),chosenPrio:$(null),scheduledEvents:[],dailyScheduled:$(new Map),endTimesSet:$(new Set),startTimesSet:$(new Set),disablePrioBtn:$(!0),disableScoreBtn:$(!0),calendar:$(null),store:ct(),anchorTimestamp:$(null),otherTimestamp:$(null),mouseDown:$(!1),mobile:$(!0),usingMoods:$({}),timeStartPos:$(0),showGoalForm:$(!1),addEventDialog:$(!1),disabledScoreEvts:$({}),hasStarted:$({}),disableSaveSchedule:$(!0),showReloadBtn:$(!1),showLoadDefaults:$(!0),showOneEach:$(!1),showScoreBtn:$(!1),showPrio:$(!1),showClearBtn:$(!1),splitterPage:$(35),splitterLegend:$(40),treeGoals:$([]),expanded:$([]),parentGs:$(null)}},beforeMount(){this.mobile=gt(),this.resetGoalEvts(!0),this.constructTree()},beforeUnmount(){clearInterval(this.intervalId)},mounted(){this.adjustCurrentTime(),this.intervalId=setInterval(()=>{this.adjustCurrentTime()},6e4)},computed:{scheduleMoodsLabel(){let t="";if(!Object.keys(this.usingMoods).length>0)return t;let o=new Set;for(let s in this.usingMoods)o.add(this.usingMoods[s].join());let i=0;for(let s of o)i<1?t=s:t=t+", "+s,i++;return Object.keys(this.usingMoods).length!=o.size&&console.log("scheduleMoodsLabel..prob change!",JSON.parse(JSON.stringify(this.usingMoods)),o,t),t},chosenScoreLabel(){return this.chosenScore==null?"By Score":`Score >= ${this.chosenScore}`},chosenPrioLabel(){return this.chosenPrio==null?"By Priority":`Prio = ${this.chosenPrio}`},style(){return{top:this.timeStartPos+"px"}},showForm(){return this.showGoalForm||this.constructTree(),this.showGoalForm},doDisableSaveSchedule(){return this.disableSaveSchedule},hasEventsForDate(){return this.store.hasEventsForDate(this.currentDate)},eventsMap(){const t={};return this.scheduledEvents.forEach(o=>{if(t[o.date]||(t[o.date]=[]),t[o.date].push(o),o.days){console.log(`eventsMap multiple days? event for ${o.date}`,o.days);let i=ue(o.date),s=o.days;do i=M(i,{day:1}),t[i.date]||(t[i.date]=[]),t[i.date].push(o);while(--s>0)}}),t},canbeScheduled(){let t=this.deepCopy(this.storedEvents),o=t.filter(s=>!this.scheduledEvents.find(l=>l.id==s.id)),i=(s,l)=>{if(s.parentGoal>l.parentGoal)return 1;if(s.parentGoal==l.parentGoal)return 0;if(s.parentGoal<l.parentGoal)return-1};return o.length==0?(t.sort(i),t):(o.sort(i),o)},storedEvents(){return this.store.getSubGoals},storedAlternatives(){return this.store.fetchAlternativeEvts()},startEndTimes(){const t=[];return this.anchorDayTimeIdentifier!==!1&&this.otherDayTimeIdentifier!==!1&&(this.anchorDayTimeIdentifier<=this.otherDayTimeIdentifier?t.push(Q(this.anchorTimestamp),Q(this.otherTimestamp)):t.push(Q(this.otherTimestamp),Q(this.anchorTimestamp))),t},anchorDayTimeIdentifier(){return this.anchorTimestamp!==null?fe(this.anchorTimestamp):!1},otherDayTimeIdentifier(){return this.otherTimestamp!==null?fe(this.otherTimestamp):!1},storedCompPG(){return this.storedPG()},currentBalance(){return this.store.getBalance},filterString(){return this.filter.join()},defaultLabels(){let t=this.allEvents.filter(o=>(o==null?void 0:o.inDefaults)&&(o==null?void 0:o.time)!=""&&!this.scheduledEvents.find(i=>i.id==o.id)).length;return t>0?t+" Defaults":"Defaults"}},methods:{parentGoalsMap(){const t=new Map;let o=this.storedPG();return o?(o.forEach(i=>{t.set(i.id,i)}),t):(console.log("parentGoalsMap is empty or null",o),t)},storedPG(){return this.parentGs==this.store.getMainGoals?(console.log("storedPG SAME!!!!"),this.parentGs):(this.parentGs=this.store.getMainGoals,this.parentGs)},constructTree(){this.treeGoals=this.store.fetchGoalsTree()},badgeClasses(t,o){return Ye(t,o)},badgeStyles(t,o,i=void 0,s=void 0){return Xe(t,o,i,s)},classyColor(t){return`row items-center ${t.isChildren?"text-":"text-white bg-"}${t.color} `},resetFilter(){var t;this.filter=[],(t=this.filterRef)==null||t.focus()},myFilterMethod(t,o){if(t.isChildren&&(t==null?void 0:t.moods.length)>0){const i=this.filter.map(l=>l.toLowerCase());let s=t==null?void 0:t.moods.some(l=>i.indexOf(l.toLowerCase())>-1);return t.label&&s}},getTimeNumber(t){return t!==null?fe(t):!1},getTimeyNumber(t){return t!==null?dt(t):!1},labelGoals(t){let o=0;if(t=="s"){for(const i in this.treeGoals)o+=this.treeGoals[i].children.length;return`Scheduled => ${this.scheduledEvents.length} out of ${o} 
`}return`Balance: ${this.currentBalance} 
`},getDateEvents(t){const o=this.eventsMap[t]||[];if(o.length===1)o[0].side="full";else if(o.length===2){const i=M(_(o[0].date),{minute:W(o[0].time)}),s=M(i,{minute:o[0].duration}),l=M(_(o[1].date),{minute:W(o[1].time)}),n=M(l,{minute:o[1].duration});le(l,i,s,!0)||le(n,i,s,!0)?(console.log("getDateEvents...LENGTH==2..LEFT/RIGHT 'TWIX"),o[0].side="left",o[1].side="right"):(o[0].side="full",o[1].side="full")}return o},hasDate(t){return this.currentDate?t.find(o=>o.date===this.currentDate):!1},getEventsForDate(t){return this.store.getEventsForDate(t)},isViewingToday(){return j()==this.currentDate},isViewingPast(){let t=j();if(this.currentDate&&this.currentDate==t)return!1;let o=$e(_(t));return!($e(_(this.currentDate))>=o)},adjustCurrentTime(){const t=q(new Date);if(this.currentDate!==t.date){this.timeStartPos=-10,this.currentTime="";return}this.currentDate=t.date,this.currentTime=t.time,this.timeStartPos=this.$refs.calendar.timeStartPos(t.time,!1);let o=this.endTimesSet&&this.endTimesSet.has(t.time),i=this.startTimesSet&&this.startTimesSet.has(t.time);(o||i)&&this.doEnableEndNowBtn(this.currentTime,o,i)},allMainGPrio(){let t=this.store.fetchAllPrio();return!t.size>0?(console.log("ERROR...no Priority goals?",t),[]):Array.from(t.values()).sort()},resetGoalEvts(t=!1){if(this.scheduledEvents==this.allEvents&&console.log("resetGoalEvts SAME"),t){let o=this.deepCopy(this.storedEvents);return this.allEvents=[...o],o}return this.allEvents},getLocalEvt(t){for(let o=0;o<this.allEvents.length;o++)if(this.allEvents[o].id===t)return this.allEvents[o];return null},getScheduledEvent(t){for(let o=0;o<this.scheduledEvents.length;o++)if(this.scheduledEvents[o].id==t)return this.scheduledEvents[o];return null},doSaveEvtProp(t,o=null,i=null){this.store.saveSubProp(t,o,i)},evtStartedOrPassed(t){const o=[];let i=M(t,{minute:0}),s=this.getTimeNumber(i);return this.dailyScheduled.forEach((l,n,a)=>{let r=this.getTimeNumber(l.start),h=this.getTimeNumber(l.end);if(r!==!1&&h!==!1){let c=s>=r&&s<h,d=s>=h;(c||d)&&o.push(n),c&&(this.hasStarted[n]=!0),this.enableEvtScoreEdit(n,d)}else console.log(`ERROR?!:${n} has no start/end?.`,l)}),o},allowScoreEdit(t){this.dailyScheduled.forEach((o,i,s)=>{this.disabledScoreEvts[i]=!t})},enableEvtScoreEdit(t,o){this.disabledScoreEvts[t]=!o},canEnableEditScore(t,o){const i=q(new Date);K(i,o)>0?this.disabledScoreEvts[t]=!0:(this.disabledScoreEvts[t]=!1,this.hasStarted[t]=!1)},parseScore(t){const o=t.split(/on/);return o.length!=2?(console.log(`parseScore error?${t}`,o),-1):o[1]-o[0]},doEnableEndNowBtn(t,o,i){for(let[s,l]of this.dailyScheduled)(o?l.end.time:l.start.time)==t&&(this.hasStarted[s]=!o,this.disabledScoreEvts[s]=!o)},enableEndNowBtn(t,o,i){const s=q(new Date);le(s,o,i,!0)?this.hasStarted[t]=!0:this.hasStarted[t]=!1},retrieveSameStart(t){let o=[];for(let[i,s]of this.dailyScheduled)s.start.time==t&&o.push(i);return o},confirmTimeChange(t,o,i,s,l,n,a=null){this.$q.dialog({title:t,message:o,cancel:!1,ok:i,options:{type:"radio",model:"",items:[{label:i+" and "+s,value:"ok"},{label:s,value:"alt"}]},class:"overflow-wrap: break-word;",style:""}).onOk(r=>{if(r==""){console.log("confirmTimeChange onOk with no selection >>onDismiss"),this.doNotify("No selection made...Defaulting","positive","bottom"),a?a():console.log("confirmTimeChange:: No Dismiss func to execute!");return}return l(r)}).onCancel(()=>{console.log("confirmTimeChange>> executeCancel..."),n()})},confirmAction(t,o,i,s,l=null){this.$q.dialog({title:"Warning",cancel:!0,ok:o,message:t}).onOk(()=>{i()}).onCancel(()=>{s()}).onDismiss(()=>{if(l){console.log("confirmAction with dismiss!!"),l();return}})},radioChoiceDialog(t,o,i,s,l=null,n=null,a=null){this.$q.dialog({title:t,cancel:!!n,persistent:!0,message:o,options:{type:"radio",model:s,items:i}}).onOk(r=>{l&&(r==""?this.radioChoiceDialog(t,o,i,s,l,n,a):l(r))}).onCancel(()=>{n&&n()}).onDismiss(()=>{a&&a()})},checkBoxDialog(t,o,i,s,l=null,n=null,a=null){let r=i.length,h=r>2?2:r;this.$q.dialog({title:t,message:o,options:{type:"checkbox",model:[],isValid:c=>c.length>0&&c.length==h,items:i},cancel:!0,persistent:!0}).onOk(c=>{l(c)}).onCancel(()=>{n&&n()}).onDismiss(()=>{a&&a()})},doNotify(t,o=void 0,i="top"){this.$q.notify({color:o!==void 0?o:"negative",position:i,message:t,icon:o==null?"report_problem":"thumb_up"})},useGroupNotify(t,o=void 0,i="top",s=!1,l=5e3){this.$q.notify({color:o!==void 0?o:"negative",position:i,message:t,icon:o==null?"report_problem":"thumb_up",group:s,timeout:l})},updateButtons(t=null,o=null,i=null){this.showLoadDefaults=t!=null?t:this.showLoadDefaults,this.showScoreBtn=o!=null?o:this.showScoreBtn,this.showPrio=i!=null?i:this.showPrio,this.showOneEach=i!=null?i:this.showOneEach},doRemove(t){let o=this.scheduledEvents.length;if(!t){console.log("ERROR doRemove, NO item to delete?!?",t);return}let i=0;for(i;i<o;i++)if(this.scheduledEvents[i].id==t.id){this.scheduledEvents.splice(i,1);let s=null;if(this.dailyScheduled.has(t.id)?(s=this.dailyScheduled.get(t.id),this.dailyScheduled.delete(t.id)):console.log("doRemove ::> dailyScheduled has no such item?@? ERROR",t),s){let l=this.startTimesSet.delete(s.start.time),n=this.endTimesSet.delete(s.end.time);(!l||!n)&&console.log(`doRemove ::> ERROR? scheduleSets has no such item?@? start:${l}...end:${n}`,s,t.id+" "+(t==null?void 0:t.title.trim())+" "+(t==null?void 0:t.details))}break}},addToBalance(t){let i=this.currentBalance-parseInt(t==null?void 0:t.duration);this.store.setBalance(i)},chooseAlternatives(t){let o=this.storedAlternatives,i=q(new Date),s=t.time,l=i.date;const n=d=>{let p=this.parentGoalsMap().get(d.parentGoal);return{label:`Of '${p==null?void 0:p.title.trim()}' "${d.title.trim()}" (${d.score}) for ${d==null?void 0:d.duration} mins`,value:d.id}},a=d=>d.filter(p=>!this.scheduledEvents.find(y=>y.id==p.id)),r=d=>{let p=M(_(l),{day:0}),y=M(_(p.date),{day:1}),v=this.getEventsForDate(p.date),R={},D=null;v?R=v:console.log("addInFutur EMPTY for >>...",p.date),d.forEach(T=>{if(D=this.getLocalEvt(T),R[T]){console.log("addInFutur...ALREADY PRESENT",T,p.date,D==null?void 0:D.title.trim()),this.doNotify(`Alternative '${D==null?void 0:D.title.trim()}' already present on ${p.date}. Moving it to next day`,"warning");let C=this.getEventsForDate(y.date);if(C)if(!C[T])C[T]={duration:D.duration,time:s};else{console.log("addInFutur...STILL PRESENT in next day:"+y.date,D.title.trim()),this.doNotify(`Boo Alt '${D==null?void 0:D.title.trim()}' also present on ${y.date} :(( ...Check BALANCE!`),this.addToBalance(D);return}else console.log("addInFutur next day EMPTY for >>...",y.date),C={},C[T]={duration:D.duration,time:s};this.store.saveDailySchedule(y.date,C),this.doNotify(`Saving ${D.title} in ${y.date}`,"positive","bottom")}else R[T]={duration:D.duration,time:s}}),console.log("addInFutur>>>",p.date,JSON.parse(JSON.stringify(R))),this.store.saveDailySchedule(p.date,R)},h=d=>{this.doRemove(t);let p=o.find(D=>D.id==d);console.log("remReplace...Add at:",s,p.title,"usually at:"+p.time),p=this.addPropsEventsTo(this.currentDate,[{...p,time:s}]);let y=this.overlapCheckEvtsAdd(p),v=Object.keys(y).length;if(v>0)return console.log(`chooseAlternatives::removeReplace:: OVERLAPS again from ${p.length} overlaps =${v}`,p,y),this.doNotify(`Extra Overlaps while adding ${p[0].title.trim()}`,"warning","top"),this.fixyOverlaps(y,null,"alts");let R=this.updateCurrentSchedule();console.log("chooseAlternatives::remReplace:SAMESTART",R),R.size>0&&this.fixSameStart(R),this.doSaveSchedule(),this.doNotify(`Added Alt replacement '${p[0].title}' at ${s}`,"positive","bottom")},c=d=>{this.doNotify(d)};if(o=a(o),o.length==0){c("Removing not allowed! Alternatives already present!");return}this.checkBoxDialog("Gotta pick alternatives","Select the first Evt to replace the removed and an Extra evt for later day (today)!",o.map(n),o[0].id,function(d){console.log("chooseAlternatives::opt",d),h(d.shift()),d.length>0?r(d):(console.log("chooseAlternatives::onOk...nothing to add?!?",o.length,d.length,o.length-d.length),c("No Alternative scheduled later :("))},function(){console.log("chooseAlternatives::onCancel")})},removeEvtInSchedule(t){let o=!1,i=()=>{if(this.doRemove(t),o){console.log("removeEvtInSchedule..autoSave for: "+t.title),delete this.usingMoods[t.id],this.doSaveSchedule(),this.disableSaveSchedule=!0;return}this.disableSaveSchedule=!1,this.showReloadBtn=this.hasEventsForDate};if(this.isViewingPast()){if(t.duration<30){this.doNotify("Removing from the past... Check BALANCE!"),this.addToBalance(t),o=!0,i();return}this.chooseAlternatives(t);return}if(!this.isViewingToday()){o=this.usingMoods[t.id],i(),console.log("Removed future evt");return}let s=`Remove "${t.title}" from schedule?`;this.usingMoods[t.id]&&(console.log("removeEvtInSchedule with MOOD?!?",this.usingMoods[t.id]),o=!0,s=s+" With Mood "+this.usingMoods[t.id]),this.confirmAction(s,"Remove",i,function(){console.log("Cancelled remove")})},updateCurrentSchedule(){const t=new Map;let o=new Set,i=new Set,s=new Set;return this.scheduledEvents.length<1?(this.dailyScheduled=t,this.endTimesSet=o,this.startTimesSet=s,i):(this.scheduledEvents.forEach(l=>{let n=M(_(l.date),{minute:W(l.time)}),a=M(n,{minute:l.duration});t.set(l.id,{start:n,end:a,on:l.date,originalAt:l.time,for:l.duration,score:l.score}),o.add(a.time),s.has(n.time)?i.add({at:n.time,id:l.id}):s.add(n.time),(this.currentDate==j()||!this.isViewingPast())&&(this.canEnableEditScore(l.id,a),this.enableEndNowBtn(l.id,n,a))}),this.dailyScheduled=t,this.endTimesSet=o,this.startTimesSet=s,i)},addEvtPropsIntoSchedule(t){!this.addEvtInScheduleMaps(t)||this.scheduledEvents.push(t)},addEvtInScheduleMaps(t){if(this.dailyScheduled.has(t.id))return!1;let o=M(_(t.date),{minute:W(t.time)}),i=M(o,{minute:t.duration});return this.dailyScheduled.set(t.id,{on:t.date,originalAt:t.time,for:t.duration,start:o,end:i,score:t.score}),this.endTimesSet.add(i.time),this.startTimesSet.add(o.time),(this.currentDate==j()||!this.isViewingPast())&&(this.canEnableEditScore(t.id,i),this.enableEndNowBtn(t.id,o,i)),!0},updateEvtInScheduleMaps(t,o){if(this.dailyScheduled.has(t)){let i=this.dailyScheduled.get(t),s=i.for,l=i.originalAt,n=i.start,a=i.end,r=M(o,{minute:s}),h=i.score;return this.dailyScheduled.set(t,{on:o.date,originalAt:l,for:s,start:o,end:r,score:h}),this.endTimesSet.delete(a.time)?this.endTimesSet.add(r.time):console.log("updateEvtInScheduleMaps-endTimesSet NOT FOUND?!?"),this.startTimesSet.delete(n.time)?this.startTimesSet.add(o.time):console.log("updateEvtInScheduleMaps-startTimesSet NOT FOUND?!?",t,o),(this.currentDate==j()||!this.isViewingPast())&&(this.canEnableEditScore(t,r),this.enableEndNowBtn(t,o,r)),!0}else return console.log("updateEvtInScheduleMaps--euh not found?ERROR?",t,o),!1},evtIsOverlappingTimes(t,o,i,s){let l=this.getTimeyNumber(t),n=this.getTimeyNumber(o),a=this.getTimeyNumber(i),r=this.getTimeyNumber(s);if(l===!1||a===!1||n===!1||r===!1)return console.log("ERROR... evtIsOverlappingTimes error",l,n,a,r),!1;let h=!1;return l>a&&l<=r&&(h="bas"),n>a&&n<=r&&(h="haut"),(a>=l&&n>=r||l>a&&n<r)&&(h="surrounding"),h},hasOverlappingEvent(t,o,i){const s=[];let l=o,n=M(l,{minute:i});return this.dailyScheduled.forEach((a,r,h)=>{if(r!=t){let c=this.evtIsOverlappingTimes(l,n,a.start,a.end);c&&s.push({target:t,targetStart:l,direction:c,inConflict:r})}}),s},overlapCheckEvtsAdd(t){let o={};for(let i=0;i<t.length;i++){let s=t[i],l=M(_(s.date),{minute:W(s.time)}),n=this.hasOverlappingEvent(s.id,l,s.duration);if(n.length>0){let a=0;do{let r=n[a];o[r.inConflict]||(o[r.inConflict]=[]),o[r.inConflict].push(r),a>0&&(console.log("WOAH WOAH, multiple overlaps with same obj!"+a,s,n),r.inConflict in o&&(console.log("WOAH deleting inConflict",r.inConflict),delete o[r.inConflict]),n[a-1].inConflict in o&&(console.log("WOAH deleting PREV inConflict",n[a-1].inConflict),delete o[n[a-1].inConflict]),o[s.id]?(o[s.id].push(r),console.log("WOAH obj.id already present?",s.id)):o[s.id]=[r],o[s.id].unshift(n[a-1]),o.withID=!0)}while(++a<n.length)}else this.addEvtPropsIntoSchedule(s)}return o},updatedEvtDetails(t){let o=s=>{if(!s)return"";let l=s.split(":");return parseInt(l[0])>=12?s+"PM":s+"AM"},i=this.parentGoalsMap().get(t.parentGoal);return i?(t.bgcolor=i.bgcolor,t.jeSuis?t.details=`Of '${i.title.trim()}' :: << ${t.jeSuis.join(",")} >>`:t.details=`Of '${i.title.trim()}' :: ${o(t==null?void 0:t.time)} -> ${t==null?void 0:t.duration}min -- ${t!=null&&t.inDefaults?"Dft:":":"}${t!=null&&t.canMove?":Mv:":":"}${t!=null&&t.isAlternative?":Alt":":"}`):(console.log("ERROR?!? no parent goal for:",JSON.parse(JSON.stringify(t))),t.bgcolor="grey",t.title=`Ad-hoc:${t==null?void 0:t.title} (${this.parseScore(t==null?void 0:t.score)})`,t.details=`${t==null?void 0:t.title}: ${o(t==null?void 0:t.time)} -- ${t==null?void 0:t.duration}min`),t},addPropsEventsTo(t,o){if(!o)return this.doNotify("addPropsEventsTo BUT no goals to schedule..."),[];let i=[];return o.forEach(s=>{let l=this.getLocalEvt(s.id);l?(l.duration=s.duration,l.time=s.time,l.date=t,i.push(this.updatedEvtDetails(l))):console.log("ERROR in addPropsEventsTo...Evt:not present!",s)}),i},changeEvtTime(t,o,i,s=!1){let l=this.getScheduledEvent(t),n=null;if(l)n=l.time;else if(s){if(l=this.getLocalEvt(t),!l)return console.log("ERROR in changeEvtTime STILL NOT found?!?",e,t,o,s),!1;n=l.time}else return console.log("ERROR in changeEvtTime not found, not adding!",t,o,s),!1;let a=(d,p)=>{if(console.log(`changeEventTime::DoUpdateEvt:: ${p?"DOADD":"NOAdd"} (${d.id})'${d.title.trim()}' from ${n} to ${o.time} 
        
canMove:${d==null?void 0:d.canMove}, inDef:${d==null?void 0:d.inDefaults},skip? ${i}`),p){let y=this.addPropsEventsTo(this.currentDate,[{...d,time:o.time}]);this.addEvtPropsIntoSchedule(y[0]),this.showDefBtn(this.isViewingPast());return}this.updateEvtInScheduleMaps(t,o),d.time=o.time,this.updatedEvtDetails(d)},r=(d,p)=>{if(console.log(`changeEventTime::KeepAsIs (${t})'${d.title.trim()}' to ${n} with ${p?"DOADD":"NOAdd"}`,o.time,"canMove:"+(d==null?void 0:d.canMove),"inDef:"+(d==null?void 0:d.inDefaults),"skip?"+i),p){if(n==""){this.doNotify(`'${d.title.trim()}' have unset default time! Not adding...`);return}let y=this.addPropsEventsTo(this.currentDate,[{...d,time:n}]);console.log("KeepAsIs::doAddy afterProps",JSON.parse(JSON.stringify(y))),this.addEvtPropsIntoSchedule(y[0]),this.showDefBtn(this.isViewingPast());return}else this.updateEvtInScheduleMaps(t,n),d.time=n,this.updatedEvtDetails(d),console.log("changeEventTime::keepAsIs:: !NOT! doAdd afterProps..",t,d.id)},h=(d,p,y)=>(console.log(`changeEvtTime::userChoice ${d} >> ${p.id} to ${o.time}...`),d=="ok"&&this.doSaveEvtProp(t,o.time,null),a(p,y),d),c=d=>{if(!d)return"";let p=d.split(":");return parseInt(p[0])>=12?d+"PM":d+"AM"};if((l==null?void 0:l.inDefaults)||!(l!=null&&l.canMove))if(i)a(l,s);else{if(n==o.time){console.log(`SAME TIME (${l.id})'${l.title.trim()}'..ASKIN with doAdd? ${s} for updateEvt...`,n,o.time),s&&a(l,s);return}let p=[`Evt "${l.title.trim()}" by default at ${c(n)}.
\u2800
`,`Also Change default time to ${c(o.time)}? 
\u2800
`,`Cancel or Dismiss to undo!
\u2800
`,`
\u2800
`,`No selection to schedule at default ${c(n)}`].join(`
`);this.confirmTimeChange("Default Time Change!",p,"Change",`Temp.${s?"Add":"Move"}`,function(y){h(y,l,s)},function(){console.log(`changeEventTime::onCancel...>doing nothing for ${l.id})'${l.title.trim()}'`,s)},function(){r(l,s)})}else if(l!=null&&l.canMove)a(l,s);else{if(n==o.time){console.log(`SAME TIME! BEWARE~~ (${l.id})'${l.title.trim()}'...doAdd?${s}..skipAsk?:${i}..returning!!`,n);return}let p=[`Evt "${l.title.trim()}" Aint move from ${c(n)}.
\u2800
`,`
\u2800
`,`Also Move time to ${c(o.time)}? 
\u2800
`,`
\u2800
`,`Cancel or Dismiss to undo!
\u2800
`,`
\u2800
`,`No selection to add at default ${c(n)}`].join(`
`);this.confirmTimeChange("Moving Evt's time",p,"Change",`Temp.${s?"Add":"Move"}`,function(y){h(y,l,s)},function(){console.log(`changeEventTime::onCancel..>doing nothing for ${l.id})'${l.title.trim()}'`,s)},function(){console.log(`changeEventTime::onDismiss..keep as is>> ${l.id})'${l.title.trim()}'`,s),r(l,s)})}},recurChangeTime(t,o,i,s=!1,l=!1){let n=this.dailyScheduled.get(t);if(n){let a=W(n.start.time)-W(i.time),r=`${a>0?"DOWN":"UP"}`,h=null;if(a>=0){h=M(i,{minute:parseInt(o.duration)+10});let p=M(i,{minute:parseInt(n.for)+10});console.log(`recurChangeTime::${t}...FORWARD ${r} for ${a} due to evt:${o.id} at ${i.time} 
        
 doAdd?:${l}, skipAsk:${s} > New>`,JSON.parse(JSON.stringify(h.time)),"alt:",p.time);let y=K(p,h);y>0&&(Math.floor(y/1e3/60)<=a?console.log(`recurChangeTime::${t}....with duration:${n.for} vs evtDura:${o.duration}...NOT using alternative!!`):(console.log(`recurChangeTime::DIFFY>>${y}...gonna use Alternative`,p.time),h=p))}else{h=M(i,{minute:-(parseInt(n.for)+10)});let p=M(i,{minute:-(parseInt(o.duration)+10)}),y=K(p,h);console.log(`recurChangeTime::${t}...BACKWARD ${r} for ${a} due to evt:${o.id} at ${i.time}
        
 doAdd?:${l}, skipAsk:${s} > New`,h.time,"alt:"+p.time,"diffy="+y)}let c=this.hasOverlappingEvent(t,h,n.for);if(c.length>0){let p=0,y=c.length,v=this.getScheduledEvent(t);v?this.doNotify(`Cascading time change while adding '${v==null?void 0:v.title.trim()}' due to "${o.title.trim()}"`,"warning","top"):console.log(`ERROR::recurChangeTime ${t} not found`);do{if(console.log(`WARNING CASCADING timeChange ${t}-${v==null?void 0:v.title} at: ${h.time} 'gon recurChangeTime::
          OLDie doAdd?:${l}, OLDie skipAsk:${s}..gon be true 
 now at: ${n.start.time}  till ${n.end.time}`,c[p]),c[p].inConflict==o.id){console.log(`EUUUH...::recurChangeTime::self overlap?!?${t} ...breaking!`,c[p]);break}this.scrollToTime(h),this.recurChangeTime(c[p].inConflict,v,h,!0)}while(++p<y)}this.changeEvtTime(t,h,s),console.log(`recurChangeTime::OVERLAPPED: ${t} ${r} to ${h.time} ...skipAsk:${s} >> doAdd:${l}`);let d=i;console.log(`recurChangeTime::TARGET:(${o.id})${o==null?void 0:o.title.trim()} going ${r} skipAsk:${s} >> doAdd:${l} to time>> ${d.time}`),this.changeEvtTime(o.id,d,s,l)}else console.log("ERROR..ERROR recurChangeTime:: overlapped event not found!",t)},fixyOverlaps(t,o=null,i=""){var b;const s=(g,u)=>{if(g!=null&&g.parentGoal){let f=this.parentGoalsMap().get(g.parentGoal);return u?`Of '${f==null?void 0:f.title.trim()}' with Prio(${f==null?void 0:f.priority})`:`Of '${f==null?void 0:f.title.trim()}'`}return console.log("prioLabel..ERROR no PARENT found?",g),""},l=(g,u)=>{switch(u){case"score":return`${s(g,!1)} > "${g.title.trim()}" with Score:: ${g.score} = ${this.parseScore(g.score)}`;case"prio":return`"${g.title.trim()}" ${s(g,!0)}`;default:return`"${g.title.trim()}" ${s(g,!0)} && Score:: ${g.score}`}},n=g=>{this.doNotify(g,"positive","top")},a=g=>{this.usingMoods[g]?(delete this.usingMoods[g],console.log("fixyOverlaps::updateMoodLabel>>..."+g,this.scheduleMoodsLabel)):console.log("fixyOverlaps::updateMoodLabel>>NO mood by "+g,i)},r=g=>{console.log(`fixyOverlaps::doRem ${g.id}:${g.title}`),a(g.id),this.doRemove(g)},h=(g,u,f)=>{if(console.log(`fixyOverlaps::removeReplace >> replacing>> ${g.id}) '${g.title.trim()}' WITH ${u.id}) ${u.title.trim()}`,f,"from>"+i),u=this.addPropsEventsTo(f.targetStart.date,[{...u,time:f.targetStart.time}]),o){if(console.log("fixyOverlaps::removeReplace...OVERRIDE from>>"+i),i=="onDrop"){r(g);return}console.log("fixyOverlaps::removeReplace....OVERRIDE updating..."+i),this.updateEvtInScheduleMaps(u[0].id,f.targetStart),console.log("fixyOverlaps",this.startTimesSet,this.endTimesSet,JSON.parse(JSON.stringify(this.scheduledEvents)));return}r(g);let S=this.overlapCheckEvtsAdd(u),m=Object.keys(S).length;if(m>0)return console.log(`${i}>fixyOverlaps::removeReplace:: OVERLAPS again from adding ${u.length} overlaps =${m}`,u,JSON.parse(JSON.stringify(S))),this.doNotify(`Extra Overlaps while adding ${u[0].title.trim()}`,"warning","top"),this.fixyOverlaps(S,o,i+"nah");let O=this.updateCurrentSchedule();O.size>0&&(console.log("fixyOverlaps::removeReplace::SameStart?!?",O),this.fixSameStart(O))},c=(g,u,f)=>{const S=M(_(this.currentDate),{minute:W(g.time)});if(console.log(`from:${i}--forceAdd: ${u.id})'${u.title}' at ${u.time}.
        
Changing >>${g.id} from ${g.time} `,f.targetStart.time),console.log(f,S),f.direction!=="surrounding")this.recurChangeTime(g.id,u,f.targetStart,!0,!0);else{console.log("fixyOverlaps::forceAdd: gonna overlapCheckEvtsAdd...."),u=this.addPropsEventsTo(f.targetStart.date,[{...u,time:f.targetStart.time}]);let O=this.overlapCheckEvtsAdd(u),w=Object.keys(O).length;if(w>0)return console.log(`from:${i}>fixyOverlaps::forceAdd:: OVERLAPS again of size:${w} from > `+u[0].title,JSON.parse(JSON.stringify(O))),this.doNotify(`Extra Overlaps while adding '${u[0].title.trim()}' `,"warning","top"),this.fixyOverlaps(O,o,i+"nah")}let m=this.updateCurrentSchedule();m.size>0&&(console.log("fixyOverlaps::forceAdd::SameStart?!?",m),this.fixSameStart(m)),this.disableSaveSchedule=!1,this.showDefBtn(this.isViewingPast())};let d=(g,u,f,S,m)=>{v.push(u),u==f.id?(h(S,f,m),n(`by ${g}, Scheduling '${f.title.trim()}'`)):(console.log(`by ${g},chose scheduled ${u} ...with override?`,o,i),n(`by ${g}, Keeping scheduled '${S.title.trim()}'`),i.indexOf("byMood")>-1&&a(f.id),o&&r(f))},p=(g,u)=>{if(o){if(console.log("fixyOverlaps::cancelChoice::OVERRIDE...coolios!!from:"+i,g.title.trim()),i=="onDrop"){n("Umm...not moving then...."),this.disableSaveSchedule=!0,this.showReloadBtn=!1,this.showClearBtn=!1;return}r(g),n(`Keeping scheduled '${u.title.trim()}'`);return}i.indexOf("byMood")>-1&&(console.log("fixyOverlaps::cancelChoice::moody? from: "+i,g.title.trim()),a(g.id)),n(`Keeping scheduled '${u.title.trim()}'`)},y=g=>{console.log(g,"from>>"+i,this.scheduledEvents.length),this.showDefBtn(this.isViewingPast())},v=[],R=Object.keys(t).length;const D=(g,u,f,S)=>{if(g=="opt3"){let m="Pick one event...",O=[{label:l(u,"def"),value:u.id,color:"secondary"},{label:l(f,"def"),value:f.id}];this.radioChoiceDialog("",m,O,"",function(w){d("Event",w,u,f,S)},null,function(){y("fixyOverlaps::resolveChoice opt3>> by Event... dismissing")})}else if(g=="opt2"){let m="Pick event by Score",O=[{label:l(u,"score"),value:u.id,color:"secondary"},{label:l(f,"score"),value:f.id}];this.radioChoiceDialog("",m,O,"",function(w){d("Score",w,u,f,S)},null,function(){y("fixyOverlaps::resolveChoice opt2>> by Score... dismissing")})}else if(g=="opt1"){let m="Pick event by Priority",O=[{label:l(u,"prio"),value:u.id,color:"secondary"},{label:l(f,"prio"),value:f.id}];this.radioChoiceDialog("",m,O,"",function(w){d("Priority",w,u,f,S)},null,function(){y("fixyOverlaps::resolveChoice opt1>> by Priority... dismissing")})}else g=="opt0"?(console.log("resolveChoice::it's a dropppp...keeping as is...."),p(u,f)):c(f,u,S)};let T=g=>{if(!g)return"";let u=g.split(":");return parseInt(u[0])>=12?g+"PM":g+"AM"};const C=(g,u,f,S,m)=>{S.direction!=="surrounding"&&!m?i.indexOf("nah")>-1?console.log("fixyOverlaps::manualSolve NOT adding Force as from "+i):g.push({label:`Force in '${u.title.trim()}'`,value:"opt4"}):console.log("fixyOverlaps::manualSolve NO force option...direction!==surrounding?",S.direction!=="surrounding","autoSolve?: "+m,i);let O=` '${u.title.trim()}' Overlaps with Scheduled '${f.title.trim()}'.
        
Cancel to keep '${f.title.trim()}' at ${T(f==null?void 0:f.time)}`;this.radioChoiceDialog("Resolve Overlapping Events",O,g,"opt1",function(w){D(w,u,f,S)},function(){console.log("fixyOverlaps::manualSolve::cancelChoice>> from: "+i,v),p(u,f)},function(){console.log("fixyOverlaps::onDismiss >"+i,v)})};for(let g in t){if(!t[g]||!t[g][0]){console.log("fixyOverlaps...unknown key found",g);continue}let u=t[g];if(u.length>1){console.log("fixyOverlaps::WOAH WOAH...multiple overlaps!!"),"withID"in t?this.fixMultiConflicts(u,o,i):this.multiConflicts(u,o,i);continue}let f=[{label:"Choose one event",value:"opt3"}];i=="reloadScore"?f.unshift({label:"Choose by Priority",value:"opt1",color:"secondary"}):i=="findSamePrio"?f.unshift({label:"Choose by Score",value:"opt2"}):i=="onDrop"?f.unshift({label:"Leave as is!",value:"opt0"},{label:"Choose by Priority",value:"opt1",color:"secondary"},{label:"Choose by Score",value:"opt2"}):f.unshift({label:"Choose by Priority",value:"opt1",color:"secondary"},{label:"Choose by Score",value:"opt2"});const S=u.pop();let m=this.getLocalEvt(S.target),O=this.getScheduledEvent(S.inConflict);if(!O||!m){console.log("fixyOverlaps...ERROR ERROR no evts found!!!",S);return}console.log(`fixyOverlaps::adding ${m.id}:${m.title.trim()}(${m.time})++${m.duration} AT >> ${(b=S==null?void 0:S.targetStart)==null?void 0:b.time} -- ${S.direction} 
      Overlap with ${O.id}:${O.title.trim()}(${O.time})++${O.duration}`,o,"from:"+i,"toHandle="+R);let w=m.title.trim().includes(O.title.trim()),F=O.title.trim().includes(m.title.trim());w||F?(console.log("fixyOverlaps:: can AUTO schedule",w,F,"direction == surrounding? >>",S.direction=="surrounding"),this.scrollToTime(S==null?void 0:S.targetStart,"slow"),this.confirmAction(`"${m.title.trim()}" related to Scheduled "${O.title.trim()}".
        
Auto resolve Overlap?
        
Cancel/Dismiss for manual resolution.`,"Auto",function(){var Z;if(w){console.log("auto schedule with removeReplace..with ORIG TIMES>>",m.time,O.time,(Z=S==null?void 0:S.targetStart)==null?void 0:Z.time),h(O,m,S),n(`Scheduling Evt '${m.title.trim()}'`);return}else{console.log("auto schedule with cancelChoice >> from: ",i),p(m,O);return}},function(){console.log("Cancelling Auto-Solve...doing manual"),C(f,m,O,S,!0)})):C(f,m,O,S,!1)}},multiConflicts(t,o=null,i=""){var u;let s="",l=[],n=null,a=[],r=null,h=new Map,c=new Map,d=[{label:"Pick one event",value:"opt3"}];const p=f=>{let S=this.parentGoalsMap().get(f.parentGoal);return{label:`Of '${S==null?void 0:S.title.trim()}' "${f.title.trim()}" (${f.score}) for ${f==null?void 0:f.duration} mins`,value:f.id}},y=f=>{let S=0,m=null;for(let O of f)if(O.parentGoal){let w=this.parentGoalsMap().get(O.parentGoal);w?w.priority>S&&(S=w.priority,m=O):console.log("multiConflicts::findhighestPrio..ERROR no PARENT found?",O)}else console.log("multiConflicts::findhighestPrio..ERROR EVT not found?",O);return c.set(m.id,`By highest priority (${S}),`),m};let v=f=>{let S=0,m=null;for(let O of f){let w=this.parseScore(O.score);w>-1&&w>=S&&(S=w,m=O)}if(m)return console.log("multiConflicts::Largest Score interval",m.id,m==null?void 0:m.title.trim(),m.score),m;console.log("ERROR ERROR multiConflicts::highestScore...no current set?",S,m,f)},R=(f,S)=>{console.log(`multiConflicts::removeConflicts with toKeep=${f.length} out of total:${S.length}`);let m=[];if(S.forEach((w,F,Z)=>{if(f.find(J=>J.id==w.id)){let J=c.has(w.id)?c.get(w.id):"";if(console.log("multiConflicts::removeConflicts:KEEEP..TIME? by>"+J,w.id,w==null?void 0:w.title.trim(),w==null?void 0:w.time,r),w.id!=n.id){let ce=this.addPropsEventsTo(this.currentDate,[{...w,time:r}]),be=this.overlapCheckEvtsAdd(ce);if(Object.keys(be).length>0)m.push(be);else{console.log("multiConflicts::removeConflicts--no other overlap",w==null?void 0:w.title.trim());let Ve=`${J} Adding '${w==null?void 0:w.title.trim()}' at ${C(r)}`;this.doNotify(Ve,"positive","top")}}else console.log("multiConflicts::removeConflicts...already scheduled!!",w==null?void 0:w.title.trim()),this.doNotify(`${J} Keeping scheduled '${w==null?void 0:w.title.trim()}' `,"positive","top")}else w.id==n.id&&(console.log("multiConflicts::removeConflicts...removing scheduled!!",w.id,w.title),this.usingMoods[w.id]&&(delete this.usingMoods[w.id],console.log("multiConflicts::removeConflicts>>deleting Moody..."+w.id,this.scheduleMoodsLabel)),this.doRemove(w))}),m.length>0)return console.log(`${i}>multiConflicts::removeConflicts:: OVERLAPS again from ${f.length} overlaps =${m.length}`,m),this.doNotify("More Overlaps to fix!!!","warning","top"),this.fixyOverlaps(m[0],o,i+"nah");let O=this.updateCurrentSchedule();O.size>0&&(console.log("multiConflicts::removeConflicts::SAMESTART!!",O),this.fixSameStart(O))},D=f=>{this.radioChoiceDialog("","Choose the event to schedule",f.map(p),"",function(S){let m=f.find(O=>O.id==S);if(m)a.push(m),c.set(m.id,"By pick,");else{console.log("chooseEvt::ERROR NOT FOUND!!",S);return}return console.log(`chooseEvt::onOk >>${S} >> ${m==null?void 0:m.title.trim()}`),m},null,function(){a.length>0&&(console.log("chooseEvt::LAST LAST?",JSON.parse(JSON.stringify(a))),setTimeout(()=>{R(a,f)},0))})};const T=f=>{f.forEach(m=>{if(n.id==m.id)console.log("multiConflicts::forceAdd...SKIP scheduled",n.title);else{let O=h.has(m.id)?h.get(m.id):null;console.log(`multiConflicts::forceAdd...NEW:${m.id} '${m.title.trim()}' origAt: ${m.time}`,O.time),this.recurChangeTime(n.id,m,O,!0,!0)}});let S=this.updateCurrentSchedule();console.log("multiConflicts::forceAdd::DONE >>"+f.length+" addySize="+h.size,S,this.dailyScheduled),S.size>0&&this.fixSameStart(S)};let C=f=>{if(!f)return"";let S=f.split(":");return parseInt(S[0])>=12?f+"PM":f+"AM"};i=="reloadScore"?d.unshift({label:"Resolve by Highest Priority",value:"opt1",color:"secondary"}):i=="findSamePrio"?d.unshift({label:"Resolve by Largest Score Interval (low Score)",value:"opt2"}):d.unshift({label:"Resolve by Highest Priority",value:"opt1",color:"secondary"},{label:"Resolve by Largest Score Interval (low Score)",value:"opt2"});let b=!1;for(let f of t){console.log("multiConflicts....handling:>",JSON.parse(JSON.stringify(f)));let S=this.getScheduledEvent(f.inConflict);if(!S){console.log("multiConflicts...ERROR ERROR no evts found!!!",f);return}n?n.id!=S.id&&console.log("multiConflicts...ERROR Not same inConflict",n.id,S.id):(n=S,r=(u=f==null?void 0:f.targetStart)==null?void 0:u.time);let m=this.getLocalEvt(f.target);if(!m){console.log("multiConflicts...ERROR ERROR local evt not found!!!",f);return}s+=` '${m==null?void 0:m.title.trim()}',`,l.push(m),h.set(f.target,f==null?void 0:f.targetStart),f.direction=="surrounding"?b=!0:b=b}b||d.push({label:"Force Schedule them in",value:"opt4"});let g=`${s} conflicts with scheduled '${n==null?void 0:n.title.trim()}' at ${C(n==null?void 0:n.time)}.
    
Choose how to solve this...`;l.unshift(n),this.radioChoiceDialog("Overlap warning!!",g,d,"",function(f){if(f=="opt3")D(l);else if(f=="opt2"){let S=v(l);console.log("multiConflicts::ByScore",S.id,S==null?void 0:S.title.trim(),S.score),a.push(S),c.set(S.id,`By largest score interval (${S.score}),`)}else if(f=="opt1"){let S=y(l);console.log("multiConflicts::ByPriority",S.id,S==null?void 0:S.title.trim()),a.push(S)}else T(l)},null,function(){a.length>0&&(console.log("multiConflicts::MAIN LAST LAST?",a),setTimeout(()=>{R(a,l)},0))})},fixMultiConflicts(t,o=null,i=""){var b;let s="",l=null,n=[],a=[],r=new Map,h=null,c=[{label:"Pick one event",value:"opt3"}];const d=g=>{let u=this.parentGoalsMap().get(g.parentGoal);return{label:`Of '${u==null?void 0:u.title.trim()}' "${g.title.trim()}" (${g.score}) for ${g==null?void 0:g.duration} mins`,value:g.id}},p=g=>{let u=0,f=null;for(let S of g)if(S.parentGoal){let m=this.parentGoalsMap().get(S.parentGoal);m?m.priority>u&&(u=m.priority,f=S):console.log("fixMultiConflicts::findhighestPrio..ERROR no PARENT found?",S)}else console.log("fixMultiConflicts::findhighestPrio..ERROR EVT not found?",S);return r.set(f.id,`By highest priority (${u}),`),f};let y=g=>{let u=0,f=null;for(let S of g){let m=this.parseScore(S.score);m>-1&&m>=u&&(u=m,f=S)}if(f)return console.log("fixMultiConflicts::Largest score interval",f.id,f==null?void 0:f.title.trim(),f.score),f;console.log("ERROR ERROR fixMultiConflicts::highestScoreInterval...no current?",u,f,g)},v=g=>{if(!g)return"";let u=g.split(":");return parseInt(u[0])>=12?g+"PM":g+"AM"},R=(g,u)=>{let f=[];if(u.forEach((m,O,w)=>{if(g.find(F=>F.id==m.id))if(m.id==l.id)if(console.log("fixMultiConflicts::removeConflicts:inKeep toAdd at >"+h.time,m.id,m==null?void 0:m.title.trim(),m==null?void 0:m.time),i=="onDrop")console.log("removeConflicts...NOTHING to do as from"+i);else{let F=this.addPropsEventsTo(this.currentDate,[{...m,time:h.time}]),Z=r.has(m.id)?r.get(m.id):"",J=this.overlapCheckEvtsAdd(F);if(Object.keys(J).length>0)f.push(J);else{console.log("fixMultiConflicts::removeConflicts--no other overlap adding",m==null?void 0:m.title.trim());let ce=`${Z} Adding '${m==null?void 0:m.title.trim()}' at ${v(h.time)}`;this.doNotify(ce,"positive","top")}}else{console.log("fixMultiConflicts::removeConflicts....Keeping scheduled Evt!!",h,m.id);let F=`${r.has(m.id)?r.get(m.id):""} Keeping scheduled '${m==null?void 0:m.title.trim()}'`;this.doNotify(F,"positive","top")}else m.id!=l.id?(console.log("fixMultiConflicts::removing scheduled...doNotify?",m.id,m.title,m.time),this.usingMoods[m.id]&&(delete this.usingMoods[m.id],console.log("fixMultiConflicts::removeConflicts>>deleting Moody..."+m.id,this.scheduleMoodsLabel)),this.doRemove(m)):console.log("fixMultiConflicts::NOT adding original target",l.id)}),f.length>0)return console.log(`${i}> fixMultiConflicts::removeConflict:: OVERLAPS again=${f.length}`,f),this.doNotify("More Overlaps to fix!!!","warning","top"),this.fixyOverlaps(f[0],o,i+"nah");let S=this.updateCurrentSchedule();S.size>0&&(console.log("fixMultiConflicts::removeConflicts::SAMESTART",S),this.fixSameStart(S))};const D=(g,u)=>{console.log(`At ${u.date}:${u.time} forceAdding:${g.id} ${g.title} from ${g.time} >>`+i,JSON.parse(JSON.stringify(l)),n.length,n[n.length-1]);let f=this.addPropsEventsTo(u.date,[{...g,time:u.time}]),S=this.overlapCheckEvtsAdd(f),m=Object.keys(S).length;if(m>0)return console.log(`${i} >fixMultiConflicts::forceAdd:: OVERLAPS again from ${l.length} overlaps =${m}`,JSON.parse(JSON.stringify(S))),this.doNotify(`Extra Overlaps while adding '${f[0].title.trim()}'`,"warning","top"),this.fixyOverlaps(S,o,i+"nah")};let T=g=>{this.radioChoiceDialog("","Choose the event to schedule",g.map(d),"",function(u){let f=g.find(S=>S.id==u);if(f)a.push(f),r.set(f.id,"By pick,");else{console.log("chooseEvt::ERROR NOT FOUND!!",u);return}return console.log(`chooseEvt::onOk >>${u} >> ${f==null?void 0:f.title.trim()}`),f},null,function(){a.length>0&&(console.log("chooseEvt::gon removeConflicts out of total="+g.length,JSON.parse(JSON.stringify(a))),setTimeout(()=>{R(a,g)},0))})};i=="reloadScore"?c.unshift({label:"Resolve by Highest Priority",value:"opt1",color:"secondary"}):i=="findSamePrio"?c.unshift({label:"Resolve by Largest Score Interval (low Score)",value:"opt2"}):c.unshift({label:"Resolve by Highest Priority",value:"opt1",color:"secondary"},{label:"Resolve by Largest Score Interval (low Score)",value:"opt2"});for(let g of t){console.log("fixMultiConflicts....handling:>",JSON.parse(JSON.stringify(g)));let u=this.getScheduledEvent(g.inConflict);if(!u){console.log("fixMultiConflicts...ERROR ERROR no evts found!!!",g);return}n.push(u),s+=` '${u==null?void 0:u.title.trim()}',`,h?h.time!=((b=g==null?void 0:g.targetStart)==null?void 0:b.time)&&console.log("fixMultiConflicts...ERROR Not same targetStart?!?",h,g==null?void 0:g.targetStart,g.direction):h=g==null?void 0:g.targetStart;let f=this.getLocalEvt(g.target);if(!f){console.log("fixMultiConflicts...ERROR ERROR local evt not found!!!",g);return}l=f,g.direction!=="surrounding"&&c.length<3&&c.push({label:`Force in '${l.title.trim()}'`,value:"opt4"})}let C=`'${l==null?void 0:l.title.trim()}' conflicts with scheduled ${s} 

      Choose how to solve this...`;n.unshift(l),this.radioChoiceDialog("Overlap warning!!",C,c,"",function(g){if(g=="opt3")T(n);else if(g=="opt2"){let u=y(n);console.log("fixMultiConflicts::ByScore",u.id,u==null?void 0:u.title.trim(),u.score),a.push(u),r.set(u.id,`By largest score interval (${u.score}),`)}else if(g=="opt1"){let u=p(n);console.log("fixMultiConflicts::ByPriority",u.id,u==null?void 0:u.title.trim()),a.push(u)}else console.log("fixMultiConflicts::forceAdd..."),D(l,h)},null,function(){a.length>0&&(console.log("fixMultiConflicts::MAIN gon removeConflicts from total="+n.length,JSON.parse(JSON.stringify(a))),setTimeout(()=>{R(a,n)},0))})},fixSameStart(t){const o=h=>{let c=0,d=null;for(let p of h){let y=this.getScheduledEvent(p);if(y){let v=this.parentGoalsMap().get(y.parentGoal);v?v.priority>c&&(c=v.priority,d=y):console.log("findhighestPrio..ERROR no PARENT found?",y)}else console.log("findhighestPrio..ERROR EVT not found?",p)}return a.set(d.id,`By highest priority (${c}),`),d},i=h=>{let c=this.parentGoalsMap().get(h.parentGoal);return{label:`Of '${c==null?void 0:c.title.trim()}' "${h.title.trim()}" (${h.score}) for ${h==null?void 0:h.duration} mins`,value:h.id}};let s=h=>{if(!h)return"";let c=h.split(":");return parseInt(c[0])>=12?h+"PM":h+"AM"},l=[],n=new Set,a=new Map,r=[{label:"Resolve by Highest Priority",value:"opt1",color:"secondary"},{label:"Resolve by Largest Score Interval (low Score)",value:"opt2"},{label:"Pick event",value:"opt3"}];for(let h of t){let c=this.retrieveSameStart(h.at);console.log("fixSameStart:conflict",JSON.parse(JSON.stringify(h)),JSON.parse(JSON.stringify(c)));let d=[],p="";for(let C of c){let b=this.getScheduledEvent(C);b?(d.push(b),p+=` '${b==null?void 0:b.title.trim()}',`,n.has(b)?console.log(`Set already contain ${b.id}~${b.title}..skipping`):n.add(b)):console.log("fixSameStart...ERROR not found?",C)}let y=C=>{let b=this.getScheduledEvent(C);return b?(l.push(b),a.set(b.id,"By pick,"),b):(console.log("fixSameStart::onOk:: ERROR ERROR?!?! Not found",C),b=this.getLocalEvt(C),b?(l.push(b),a.set(b.id,"By pick,"),b):(console.log("fixSameStart::onOk:: ERROR ERROR..still not found!!!",C),!1))},v=()=>{let C=0,b=null;for(let g of d){let u=this.parseScore(g.score);u>-1&&u>=C&&(C=u,b=g)}if(b)return console.log("fixSameStart::highestScore",b.id,b==null?void 0:b.title.trim(),b.score),l.push(b),a.set(b.id,`By largest score interval (${b.score}),`),b;console.log("ERROR ERROR fixSameStart::highestScore..nothing set?",C,e)},R=()=>{this.radioChoiceDialog("","Choose the event to schedule",d.map(i),"",function(C){let b=y(C);return console.log(`fixSameStart--chooseEvt::onOk >>${C} >> ${b==null?void 0:b.title.trim()}`),b},null,function(){l.length==t.size&&(console.log("fixSameStart--chooseEvt::onDismiss...PICKLAST"+l.length,l),setTimeout(()=>{D(l,n)},0))})},D=(C,b)=>{b.forEach((u,f,S)=>{if(C.find(m=>m.id==u.id)){console.log("fixSameStart::removeConflicts:KEEEP",u.id,u==null?void 0:u.title.trim());let O=`${a.has(u.id)?a.get(u.id):""} Keeping '${u==null?void 0:u.title.trim()}' at ${s(u==null?void 0:u.time)}`;this.doNotify(O,"positive","top")}else this.usingMoods[u.id]&&(delete this.usingMoods[u.id],console.log("fixSameStart::removeConflicts>>deleting Moody..."+u.id,this.scheduleMoodsLabel)),this.doRemove(u)});let g=this.updateCurrentSchedule();g.size>0&&(console.log("fixSameStart::removeConflicts::SAMESTART",g),this.fixSameStart(g)),this.disableSaveSchedule=!1},T=`${p} scheduled at same ${s(h.at)}.

      Choose how to solve this...`;this.radioChoiceDialog("Same start time!!",T,r,"opt1",function(C){if(C=="opt3")R();else{if(C=="opt2")return v();{let b=o(c);l.push(b)}}},null,function(){l.length==t.size&&(console.log("fixSameStart::onDismiss Main with size="+l.length,"conflicts="+n.size),setTimeout(()=>{D(l,n)},0))})}return!0},showDefBtn(t){let o=this.allEvents.some(i=>(i==null?void 0:i.inDefaults)&&(i==null?void 0:i.time)!=""&&!this.scheduledEvents.find(s=>s.id==i.id));this.updateButtons(t?!1:o,!t,!t)},loadForDate(t,o,i){let s=(a,r)=>("byMood"in r&&(this.usingMoods[a]=r.byMood),{id:parseInt(a),duration:r.duration,time:r.time}),l=()=>{let a=this.getEventsForDate(t);if(!a){console.log(`ERROR no evts found for ${t}...`,a);return}console.log(`doLoadNotPresent ${t}::evts=${Object.keys(a).length}`);let r=Object.keys(a).map(c=>s(c,a[c]));this.scheduledEvents=this.addPropsEventsTo(t,r);let h=this.updateCurrentSchedule();h.size>0&&!i?(console.log(`doLoadNotPresent..OVERLAPS in past?${i} on ${t}`,h.size),this.doNotify(`${t} with conflicts to fix!`,"warning","bottom"),this.fixSameStart(h)):(this.showReloadBtn=!1,this.disableSaveSchedule=!0,this.doNotify(`Loaded schedule for ${i?"past":"future"}:: ${t}`,"positive","bottom"))},n=()=>{let a=this.getEventsForDate(t);if(!a){console.log(`ERROR no evts found for today:${t} ?!?`,a);return}let r=Object.keys(a).map(d=>s(d,a[d])),h=this.addPropsEventsTo(t,r);console.log(`OverlapCheckLoadToday ${t} loading:${h.length} into current:${this.scheduledEvents.length}`);let c=this.overlapCheckEvtsAdd(h);return Object.keys(c).length>0?this.doNotify(`${t} with Some overlaps to fix!`,"warning","bottom"):this.doNotify(`Loaded schedule for ${t}`,"positive","bottom"),c};if(this.scheduledEvents=[],this.usingMoods={},this.updateCurrentSchedule(),o)if(this.isViewingToday()){let a=n();if(Object.keys(a).length>0){console.log("Overlaps toHandle >>",JSON.parse(JSON.stringify(a))),this.fixyOverlaps(a),this.showReloadBtn=o,this.showClearBtn=o,this.disableSaveSchedule=!1,this.evtStartedOrPassed(q(new Date)),this.showDefBtn(i);return}this.evtStartedOrPassed(q(new Date)),this.disableSaveSchedule=!0,this.showReloadBtn=!1,this.showClearBtn=o}else l(),this.allowScoreEdit(i),this.showClearBtn=!i;else this.showReloadBtn=!1,this.showClearBtn=!1,this.disableSaveSchedule=!0;(i||t!==j())&&this.adjustCurrentTime(),this.reset(),this.showDefBtn(i)},reset(){this.draggedItem=null,this.targetDrop=null,this.chosenScore=null,this.chosenPrio=null,this.possibleRange=null},deepCopy(t){if(t===null||typeof t!="object")return t;if(Array.isArray(t))return t.map(i=>this.deepCopy(i));const o={};for(let i in t)t.hasOwnProperty(i)&&(o[i]=this.deepCopy(t[i]));return o},onRefresh(t){setTimeout(()=>{this.scheduledEvents=[],this.updateCurrentSchedule(),this.resetGoalEvts(!0),this.loadForDate(this.currentDate,this.hasEventsForDate,this.isViewingPast()),t()},1e3)},doSaveSchedule(){let t={};this.dailyScheduled.size<1?t=null:this.dailyScheduled.forEach((o,i,s)=>{t[i]={time:o.start.time,duration:o.for},this.usingMoods[i]&&(t[i].byMood=this.usingMoods[i])}),this.store.saveDailySchedule(this.currentDate,t),this.disableSaveSchedule=!0,this.showReloadBtn=!1,this.showClearBtn=t!=null,this.doNotify(`Schedule saved for ${this.currentDate}`,"positive","top")},addParentGoal(t,o,i="red-14",s=2){let l=[];this.parentGoalsMap().forEach((r,h,c)=>{let d=r.bgcolor;l.push(d)});let n=Ze(),a=l.length;if(a>1){let r=a;for(;l.some(c=>n[r]==c);)console.log("addParentGoal::index with taken color...new random",r,n[r]),r=Math.floor(Math.random()*a);let h=n[r];i=h||i}return this.store.addMainGoal(t,o,i,s)},onAddHocEvent(t,o,i,s){if(this.possibleRange||(console.log("umm onAddHocEvent... not a range selection",this.startEndTimes),this.possibleRange=this.startEndTimes),t.trim()==""){this.doNotify("Empty Goal title..."),this.addEventDialog=!1,this.reset();return}let l=ue(this.possibleRange[0]),n=s>15?M(l,{minute:parseInt(s)}):M(ue(this.possibleRange[1]),{minute:15}),a=Math.floor(K(l,n)/1e3/60);console.log(`onAddHocEvent:${t} :${i}: from ${l.time} till ${n.time}.Duration:${a}`,s);let r=null;if(i=="self"){let h=this.addParentGoal(t,t,"purple-10",2);h?r=this.store.addSubGoal(h,t,"1on5",l.time,a,!0,!1,a<30):console.log("ERROR? no pID",h)}else if(o){console.log("with parentGoal "+o.id,o==null?void 0:o.title),r=this.store.addSubGoal(o.id,t,"1on5",l.time,a,!1,!1,a<30);//!canMove and notInDefaults. isAlternative when duration<30
}else{let h=this.store.getGoalByTitle("Misc");if(h){console.log("Woo!! Misc pGoal already exists!",h.id),r=this.store.addSubGoal(h.id,t,"1on5",l.time,a,!1,!1,a<30);//!canMove and notInDefaults.isAlternative when duration<30
}else{let c=this.addParentGoal("Misc","Miscellaneous","grey-10",2);c&&(console.log("NEW Misc pGoal created",c),r=this.store.addSubGoal(c,t,"1on5",l.time,a,!0,!1,a<30))}}if(r){this.resetGoalEvts(!0);let h=this.tooClose(l,a);if(h){console.log("onAddHocEvent::tooClose check FAIL!!",h),h===!0?this.doNotify(`'${t}' created But Not added as over midnight!`):this.doNotify(`'${t}' created But Not added as too close to a scheduled Evt!!`),this.addEventDialog=!1;return}let c=this.hasOverlappingEvent(r,l,a);if(c.length>0){let d={};for(let p=0;p<c.length;p++){let y=c[p];d[y==null?void 0:y.inConflict]?d[y==null?void 0:y.inConflict].push(y):d[y==null?void 0:y.inConflict]=[y],p>0&&(console.log(p+" WOAH WOAH,onAddHocEvent.. multiple overlaps with same target!",c[p].target),y.inConflict in d&&(console.log("WOAH deleting inConflict",y.inConflict),delete d[y.inConflict]),c[p-1].inConflict in d&&(console.log("WOAH deleting PREV inConflict",c[p-1].inConflict),delete d[c[p-1].inConflict]),d[y.target]?(d[y.target].push(y),console.log("WOAH obj.id already present?",y.target)):d[y.target]=[y],d[y.target].unshift(c[p-1]),d.withID=!0)}console.log("onAddHocEvent:: OVERLAPS >>",JSON.parse(JSON.stringify(d))),this.fixyOverlaps(d,null,"addNew")}else{let d=this.addPropsEventsTo(this.currentDate,[{id:r,time:l.time,title:t,score:"2on5",duration:a,canMove:!o}]);console.log(`onAddHocEvent, addEvtPropsIntoSchedule: ${r} at ${l.time}`),this.addEvtPropsIntoSchedule(d[0])}this.disableSaveSchedule=!1,this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!this.isViewingPast(),this.constructTree()}else console.log("BOO ERROR no subID:(",r),this.doNotify("Error creating and adding this event :(","negative");this.addEventDialog=!1},tooClose(t,o){let i=M(t,{minute:0}),s=this.getTimeNumber(i),l=M(t,{day:1}),n=new Date(l.date);n.setHours(24),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0);let a=q(n),r=Math.floor(K(i,a)/1e3/60);if(r<o)return console.log("tooClose to midnight eh...:(",r),!0;let h=!1;return this.dailyScheduled.forEach((c,d,p)=>{let v=this.getTimeNumber(c.start)-s,R=K(i,c.start);Math.floor(R/1e3/60)<=10&&v>0&&(h=d)}),h},onPickEvent(t,o,i){if(this.addEventDialog=!1,!t){console.log("onPickEvent...ERROR nothing!",t,o,i),this.doNotify("No Goal selected..."),this.reset();return}let s=()=>{if(this.isViewingPast()){console.log("onPickEvent...inPast auto saveSchedule"),this.doSaveSchedule(),this.disableSaveSchedule=!0;return}if(n>0){if(console.log("onPickEvent::saveSchedule..overlaps: "+n,"useBalance?"+i),i){let r=this.currentBalance,h=r+parseInt(l==null?void 0:l.duration);console.log("onPickEvent::saveSchedule...useBalance",r,h),this.doNotify("oooh What is Owed PAID!gg! >>"+h,"positive","right"),this.store.setBalance(h),this.doSaveSchedule(),this.disableSaveSchedule=!0}}else console.log("onPickEvent::saveSchedule...no overlaps so no auto-save!!",n,i),this.disableSaveSchedule=!1},l=null,n=0;if(l){console.log("onPickEvent...NOT NEW?!?ERROR!",l,t);return}else{l=t;let a=this.isViewingPast()?!0:o;console.log(`onPickEvent::(${l.id})'${l.title.trim()}' from ${l.time} to ${this.targetDrop.timestamp.time} with force?${o} BUT Forcing?:${a}`);let r=this.tooClose(this.targetDrop.timestamp,l.duration);if(r){if(console.log("onPickEvent::tooClose check FAIL!",r),r===!0){this.doNotify("Picking event TOO close to midnight!"),this.reset();return}if(a)this.doNotify(`'${l.title.trim()}' TOO close to a scheduled Evt Buuut..FORCING!`);else{this.doNotify(`'${l.title.trim()}' Not added as TOO close to a scheduled Evt`),this.reset();return}}let h=this.hasOverlappingEvent(l.id,this.targetDrop.timestamp,l.duration);if(n=h.length,n>0){let c={};for(let d=0;d<n;d++){let p=h[d];c[p==null?void 0:p.inConflict]?c[p==null?void 0:p.inConflict].push(p):c[p==null?void 0:p.inConflict]=[p],d>0&&(console.log(d+" WOAH WOAH,onPickEvent.. multiple overlaps with same target?",h[d].target),p.inConflict in c&&(console.log("WOAH deleting inConflict",p.inConflict),delete c[p.inConflict]),h[d-1].inConflict in c&&(console.log("WOAH deleting PREV inConflict",h[d-1].inConflict),delete c[h[d-1].inConflict]),c[p.target]?(c[p.target].push(p),console.log("WOAH obj.id already present?",p.target)):c[p.target]=[p],c[p.target].unshift(h[d-1]),c.withID=!0)}console.log(`onPickEvent::OVERLAPS of size: ${n} and force:${a}`,JSON.parse(JSON.stringify(c))),this.fixyOverlaps(c,null,"onPickEvt")}else{if(i){let c=this.currentBalance,d=c+parseInt(l==null?void 0:l.duration);console.log("onPickEvent...useBalance",c,d),this.doNotify("oooh What is Owed PAID!gg! >>"+d,"positive","center"),this.store.setBalance(d)}this.changeEvtTime(l.id,this.targetDrop.timestamp,a,!0)}}setTimeout(s,n>0?5e3:0),this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!this.isViewingPast()},closingDialog(){this.addEventDialog=!1,this.reset()},onEndNow(t){const o=q(new Date);let i=this.hasEventsForDate;if(this.dailyScheduled.has(t)){let s=this.dailyScheduled.get(t),l=s.start,n=s.end;if(le(o,l,n,!0)){let a=this.getTimeNumber(n)-this.getTimeNumber(l),r=this.getTimeNumber(o)-this.getTimeNumber(l);console.log(`onEndNow::${t}`,l.time,n.time,r);const h=()=>{console.log(`Great, ${t} REDUCING duration from ${a} to:`,r);for(let d=0;d<this.scheduledEvents.length;d++){let p=this.scheduledEvents[d];p.id===t&&(p.duration=r)}this.dailyScheduled.set(t,{...s,for:r,end:o}),this.endTimesSet.delete(n.time)||console.log("ERROR endTimesSet item does not exist?!?",s,this.endTimesSet),this.endTimesSet.add(o.time),this.disabledScoreEvts[t]=!1,this.doSaveSchedule(),this.disableSaveSchedule=!0,this.showReloadBtn=i,this.showClearBtn=!this.isViewingPast&&this.scheduledEvents.length>0},c=()=>{console.log("onEndNow::removing and saving!"),this.doRemove(this.getLocalEvt(t)),this.doSaveSchedule()};r<10?(console.log(`onEndNow:: ${r} less than 10 mins...REMOVE?`),this.confirmAction(`Less than 10mins remove?
 Cancel to just EndNow`,"OK",c,h)):h()}else console.log("umm aint in the middle of this event! Nothing to do...ERROR?",o.time,l.time,n.time)}else{console.log("ERROR doEndNow not found!!!",t);return}},onSaveScore(t,o){let i=this.dailyScheduled.get(o);if(i){if(this.getLocalEvt(o),this.parseScore(t)<-1){this.doNotify("Score Error: higher# on lower#");return}i.score=t,this.doSaveEvtProp(o,null,t);let l=this.getScheduledEvent(o);l?l.score=t:console.log("onSaveScore ERROR not found",l,o)}else console.log(`ERROR onSaveScore could not find event ${o}?!?`)},onAddMins(t,o){if(this.dailyScheduled.has(t)){let i=this.dailyScheduled.get(t),s=i.end,l=M(s,{minute:parseInt(o)}),n=parseInt(o)+i.for;console.log(`onAddMins::${t} add ${o} from ${i.for} to> ${n}`,s.time,l.time);let a=this.hasOverlappingEvent(t,i.start,n);if(a.length>0){console.log("onAddMins::huh some OVERLAPS",a);let r={};for(let h=0;h<a.length;h++){let c=a[h];r[c==null?void 0:c.inConflict]?r[c==null?void 0:c.inConflict].push(c):r[c==null?void 0:c.inConflict]=[c],h>0&&(console.log(h+" WOAH WOAH,onAddMins..ERROR?!? multiple overlaps with same target?",a[h].target),c.inConflict in r&&(console.log("WOAH deleting inConflict",c.inConflict),delete r[c.inConflict]),a[h-1].inConflict in r&&(console.log("WOAH deleting PREV inConflict",a[h-1].inConflict),delete r[a[h-1].inConflict]),r[c.target]?(r[c.target].push(c),console.log("WOAH obj.id already present?",c.target)):r[c.target]=[c],r[c.target].unshift(a[h-1]),r.withID=!0)}console.log("onAddMins:: OVERLAPS >>",JSON.parse(JSON.stringify(r))),this.fixyOverlaps(r,null,"addMins")}else{for(let r=0;r<this.scheduledEvents.length;r++){let h=this.scheduledEvents[r];h.id===t&&(h.duration=n)}this.dailyScheduled.set(t,{...i,for:n,end:l}),this.endTimesSet.delete(s.time)||console.log("ERROR endTimesSet item does not exist?!?",i,this.endTimesSet),this.endTimesSet.add(l.time),this.doSaveSchedule()}}else{console.log("ERROR onAddMins EVT not found!!!",t);return}},onClearDay(){if(this.isViewingPast()){this.doNotify("Editing past is no no!");return}let t=this.hasEventsForDate;this.scheduledEvents=[],this.updateCurrentSchedule(),this.resetGoalEvts(!0);let o=t?"Cleared...Can still reload saved":"Cleared daily schedule";this.doNotify(o,"warning","top"),this.reset(),this.showReloadBtn=t,this.showLoadDefaults=!0,this.showClearBtn=!1,this.disableSaveSchedule=!t},onReloadSaved(){let t=this.hasEventsForDate,o=()=>{console.log("Aborting",this.currentDate,this.scheduledEvents,t),this.showReloadBtn=!this.isViewingPast()||t},i=()=>{this.scheduledEvents=[],this.updateCurrentSchedule(),this.loadForDate(this.currentDate,t,this.isViewingPast()),this.reset()};if(this.scheduledEvents.length>0&&!this.isViewingPast()){let s=t?"Reload? saved schedule of: "+this.currentDate:"Overwrite current Evts?";this.confirmAction(s,"OK",i,o)}else i();this.showReloadBtn=!1,this.showClearBtn=!this.isViewingPast()},onMoodAdd(){console.log("onMoodAdd>>>",this.filterString);let t=[];const o=this.filter.map(i=>i.toLowerCase());this.treeGoals.filter(i=>{if(i.children.length>0)return i.children.find(s=>{if((s==null?void 0:s.moods.length)>0&&(s==null?void 0:s.moods.some(l=>o.indexOf(l.toLowerCase())>-1))){let l=s==null?void 0:s.moods.filter(n=>{if(o.indexOf(n.toLowerCase())>-1)return n});return t.push({id:s.id,mood:l}),s}})}),t.length>0?(t=t.filter(i=>!this.scheduledEvents.find(s=>s.id==i.id)),t.length>0?this.scheduleByMood(t):this.doNotify(`Evts of Mood '${this.filterString}' already scheduled!`,"warning","top")):this.doNotify("Nothing to add :(","warning","top")},scheduleByMood(t){var l;let o=[];for(let n=0;n<t.length;n++){let a=this.getLocalEvt(t[n].id);a&&a.time!=""?(o.push(a),this.usingMoods[t[n].id]=(l=t[n])==null?void 0:l.mood):(console.log("scheduleByMood>>>no time eh >>"+(a==null?void 0:a.title)),this.doNotify(`Evts '${a==null?void 0:a.title}' has no set time for scheduling, Manually Add them.`,"warning","top"))}o=this.addPropsEventsTo(this.currentDate,o);let i=this.overlapCheckEvtsAdd(o);Object.keys(i).length>0&&this.fixyOverlaps(i,null,"byMood"),this.disableSaveSchedule=!o.length>0,this.showReloadBtn=o.length>0&&this.hasEventsForDate,this.showClearBtn=!this.isViewingPast()},unscheduledDefaults(){return this.resetGoalEvts(!0),this.allEvents.filter(t=>(t==null?void 0:t.inDefaults)&&(t==null?void 0:t.time)!=""&&!this.scheduledEvents.find(o=>o.id==t.id))},scheduleDefaults(t){const o=n=>{if(n.some(a=>a.time=="")){let a="";n=n.filter(r=>{if(r.time!="")return r;a+=`'${r==null?void 0:r.title}'. `}),this.doNotify(`Evts ${a} without set time not scheduled, Manually Add them.`,"warning","top")}return n};let i=this.deepCopy(this.store.fetchDefaults()),s=this.unscheduledDefaults();console.log("unscheduledDefaults",s);let l=this.isViewingPast();if(this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!l&&i.length>0,this.isViewingToday()){let n=this.addPropsEventsTo(this.currentDate,i);if(t=="add"){let h=n.length;n=n.filter(c=>!this.scheduledEvents.find(d=>d.id==c.id)),console.log(`scheduleDefaults..ADDIN from ${h} to ${n.length}`)}else this.scheduledEvents=[],this.updateCurrentSchedule();n=o(n),console.log(`scheduleDefaults:${this.currentDate} with '${t}'`,n.length,this.scheduledEvents.length);let a=this.overlapCheckEvtsAdd(n),r=Object.keys(a).length;r>0&&(console.log(`scheduleDefaults overlaps on:${this.currentDate} from ${i.length} to ${n.length}. overlaps =${r}`),this.fixyOverlaps(a,null,"byDefaults")),this.evtStartedOrPassed(q(new Date)),this.showDefBtn(l),this.disableSaveSchedule=!(n.length>0);return}else{let n=this.addPropsEventsTo(this.currentDate,i);if(n=o(n),t=="add"){let r=n.length;n=n.filter(c=>!this.scheduledEvents.find(d=>d.id==c.id)),console.log(`scheduleDefaults..ADDIN to ${this.currentDate} of ${this.scheduledEvents.length} from ${r} to `,n.length);let h=this.scheduledEvents.concat(n);this.scheduledEvents=h}else this.scheduledEvents=n;let a=this.updateCurrentSchedule();a.size>0&&console.log("scheduleDefaults..sameStart="+a.size),l?this.allowScoreEdit(!0):this.allowScoreEdit(!1)}this.showDefBtn(l),this.disableSaveSchedule=!(i.length>0)},onLoadDefault(){let t=()=>{console.log("Aborting",this.currentDate)},o=i=>{this.scheduleDefaults(i)};if(this.scheduledEvents.length>0){let i=this.unscheduledDefaults(),s=[{label:`Add ${i==null?void 0:i.length} Default Evts to current day schedule`,value:"add"},{label:"Overwrite and only schedule Defaults",value:"overwrite"}];this.radioChoiceDialog("Warning!!",`Date: ${this.currentDate} already have scheduled Events...`,s,"",function(l){o(l)},t)}else o("overwrite")},onChoosenPrio(t){let o=this.chosenPrio;o&&o==t?this.disablePrioBtn=!0:(this.chosenPrio=t,this.disablePrioBtn=!1)},onChoosenScore(t){let o=this.chosenScore;o&&o==t?this.disableScoreBtn=!0:(this.chosenScore=t,this.disableScoreBtn=!1)},scheduleOneEach(t){let o=this.deepCopy(this.storedEvents),i=o.filter(h=>!this.scheduledEvents.find(c=>c.id==h.id));const s=h=>o.filter(c=>c.parentGoal==h),l=h=>{if(h.some(c=>c.time=="")){let c="";h=h.filter(d=>{if(d.time!="")return d;c+=`'${d==null?void 0:d.title}'. `}),this.doNotify(`Evts ${c} without set time not scheduled, Manually Add them.`,"warning","top")}return h},n=h=>{let c=[];return this.parentGoalsMap().forEach((d,p,y)=>{let v=s(d.id);if(v){let R=null,D=v.length;if(h)R=v[Math.floor(Math.random()*D)];else{let T=0;for(;this.scheduledEvents.some(C=>v[D].id==C.id);)if(T++,D=Math.floor(Math.random()*v.length),console.log(`selectOneFromP::index ${D} scheduled...new random> At try> `+T,v.length),T>2){console.log("selectOneFromP::random...TOO MANY TRIES..ERROR?",T,D,v.length,v);break}R=v[D],console.log("selectOneFromP::NO Random at index: "+D,T,R)}c.push(R)}else console.log("scheduleOneEach::selectOneFromP...huh no subgoals for",d)}),c};let a=this.isViewingToday(),r=[];if(t=="add"?(this.parentGoalsMap().forEach((h,c,d)=>{let p=i.find(y=>y.parentGoal==h.id);p?r.push(p):this.useGroupNotify(`No SubGoals for Parent: '${h==null?void 0:h.title}'`,h==null?void 0:h.bgcolor,"bottom")}),r=this.addPropsEventsTo(this.currentDate,r),r=l(r)):(this.scheduledEvents=[],this.updateCurrentSchedule(),r=n(!0),r=this.addPropsEventsTo(this.currentDate,r),r=l(r)),a){let h=this.overlapCheckEvtsAdd(r),c=Object.keys(h).length;c>0&&(console.log(`scheduleOneEach:: Overlaps on:${this.currentDate} from ${i.length} to ${r.length}. overlaps =${c}`),this.fixyOverlaps(h,null,"oneEach"))}else{let h=t=="overwrite";if(h)this.scheduledEvents=r;else{let d=this.scheduledEvents.concat(r);this.scheduledEvents=d}let c=this.updateCurrentSchedule();console.log("scheduleOneEach....sameStart="+c.size),c.size>0&&a&&this.fixSameStart(h)}this.isViewingPast()?this.allowScoreEdit(!0):this.allowScoreEdit(!1),this.disableSaveSchedule=!1,this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!0},onScheduleOneEach(){if(this.scheduledEvents.length>0){let t=[{label:"Add one Evt from Each parent Goals",value:"add"},{label:"Overwrite current with one random Evt from Each parent Goals",value:"overwrite"}];this.radioChoiceDialog("Warning!!",`Date: ${this.currentDate} already have scheduled Events...`,t,"",this.scheduleOneEach,function(){console.log("One of Each....Aborting")})}else this.scheduleOneEach("overwrite")},scheduleSamePrio(t){const o=()=>this.scheduledEvents.filter(n=>{var a;return((a=this.parentGoalsMap().get(n.parentGoal))==null?void 0:a.priority)==this.chosenPrio}),i=n=>{if(n.some(a=>a.time=="")){let a="";n=n.filter(r=>{if(r.time!="")return r;a+=`'${r==null?void 0:r.title}'. `}),this.doNotify(`Evts ${a} without set time not scheduled, Manually Add them.`,"warning","top")}return n};let s=[],l=this.isViewingToday();if(t=="overwrite"||t=="add"){let n=this.deepCopy(this.storedEvents);for(let a of n){let r=this.parentGoalsMap().get(a.parentGoal);(r==null?void 0:r.priority)==this.chosenPrio&&s.push(a)}t=="add"?s=s.filter(a=>!this.scheduledEvents.find(r=>r.id==a.id)):(this.scheduledEvents=[],this.updateCurrentSchedule()),console.log(`scheduleSamePrio...${t} to size: ${this.scheduledEvents.length} some evts = ${s.length}`)}else s=o(),console.log("scheduleSamePrio..filtering!!",this.chosenPrio,s);if(l&&t!="filter"){s=this.addPropsEventsTo(this.currentDate,s),s=i(s);let n=this.overlapCheckEvtsAdd(s);if(Object.keys(n).length>0)console.log(`scheduleSamePrio:${this.chosenPrio}...overlaps`,JSON.parse(JSON.stringify(n))),this.fixyOverlaps(n,null,"findSamePrio");else{if(console.log("scheduleSamePrio >>No overlaps!!...",s.length),s.length<1){this.disableSaveSchedule=!0,this.showReloadBtn=!1,this.showClearBtn=!1;return}this.updateCurrentSchedule()}}else{if(t=="filter")this.scheduledEvents=s;else if(s=this.addPropsEventsTo(this.currentDate,s),s=i(s),t=="add"){let n=this.scheduledEvents.concat(s);this.scheduledEvents=n}else this.scheduledEvents=s;this.updateCurrentSchedule()}if(!this.scheduledEvents.length>0){this.doNotify(`Empty for Priority == ${this.chosenPrio} :(`,"warning","bottom"),this.disableSaveSchedule=!0,this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!1;return}this.disableSaveSchedule=!1,this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!0},doReloadWithPrio(){if(this.chosenPrio==null){this.doNotify("Ayo select a priority!");return}let t=()=>{console.log("doReloadWithPrio..cancelling"),this.reset()};if(this.scheduledEvents.length>0){let o=[{label:`Filter current Evts by priority == ${this.chosenPrio}`,value:"filter"},{label:`Add to schedule Evts with priority == ${this.chosenPrio}`,value:"add"},{label:`Overwrite current and schedule All of priority == ${this.chosenPrio}`,value:"overwrite"}];this.radioChoiceDialog("","Schedule change...",o,"",this.scheduleSamePrio,t)}else this.scheduleSamePrio("overwrite");this.showDefBtn(this.isViewingPast()),this.disablePrioBtn=!0},scheduleByScore(t){const o=()=>{let n=[];return this.scheduledEvents.forEach(a=>{let r=this.parseScore(a.score);r>-1&&r>=this.chosenScore&&n.push(a)}),n},i=n=>{if(n.some(a=>a.time=="")){let a="";n=n.filter(r=>{if(r.time!="")return r;a+=`'${r==null?void 0:r.title}'. `}),this.doNotify(`Evts ${a} without set time not scheduled, Manually Add them.`,"warning","top")}return n};let s=[],l=this.isViewingToday();if(t=="overwrite"||t=="add"){const n=this.store.fetchGoalsWithMinScore(this.chosenScore);t=="add"?s=n.filter(a=>!this.scheduledEvents.find(r=>r.id==a.id)):(s=n,this.scheduledEvents=[],this.updateCurrentSchedule())}else s=o(),console.log(`scheduleByScore AFTER flag ${t}`,this.scheduledEvents.length,JSON.parse(JSON.stringify(s))),JSON.parse(JSON.stringify(this.scheduledEvents));if(l&&t!="filter"){s=this.addPropsEventsTo(this.currentDate,s),s=i(s),console.log(`scheduleByScore::addPropsEventsTo today for '${t}'`,this.scheduledEvents.length,JSON.parse(JSON.stringify(s)));let n=this.overlapCheckEvtsAdd(s);if(Object.keys(n).length>0)console.log(`scheduleByScore ${this.chosenScore}...overlaps!!`,JSON.parse(JSON.stringify(n))),this.fixyOverlaps(n,!1,"reloadScore");else{if(console.log("scheduleByScore >>NO OVERLAPS!!!..."),s.length<1){this.disableSaveSchedule=!0,this.showReloadBtn=!1,this.showClearBtn=!1;return}this.updateCurrentSchedule()}}else{if(console.log(`scheduleByScore... with flag '${t}' on>`,this.currentDate,JSON.parse(JSON.stringify(this.scheduledEvents.length)),JSON.parse(JSON.stringify(s))),t=="filter")this.scheduledEvents=s;else if(s=this.addPropsEventsTo(this.currentDate,s),s=i(s),t=="add"){let n=this.scheduledEvents.concat(s);this.scheduledEvents=n}else this.scheduledEvents=s;this.updateCurrentSchedule()}if(!this.scheduledEvents.length>0){this.doNotify(`Empty for Score >= ${this.chosenScore} :(`,"warning","bottom"),this.disableSaveSchedule=!0,this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!1;return}this.disableSaveSchedule=!1,this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!0},doReloadWithScore(){if(this.chosenScore==null){this.doNotify("Ayo select a score!");return}let t=()=>{console.log("doReloadWithScore..cancelling",this.scheduledEvents),this.reset()};if(this.scheduledEvents.length>0){let o=[{label:`Filter current Evts by Interval Score >= ${this.chosenScore}`,value:"filter"},{label:`Add to schedule Evts with Interval Score >= ${this.chosenScore}`,value:"add"},{label:`Overwrite current and schedule All of Interval Score >= ${this.chosenScore}`,value:"overwrite"}];this.radioChoiceDialog("","Schedule change...",o,"",this.scheduleByScore,t)}else this.scheduleByScore("overwrite");this.showDefBtn(this.isViewingPast()),this.disableScoreBtn=!0},onChange(t){this.loadForDate(t.start,this.hasEventsForDate,this.isViewingPast())},onDragStart(t,o){if(this.isViewingPast()){this.doNotify("Editing past is no no!"),t.preventDefault();return}this.draggedItem=o},onDragEnter(t,o,i){return o==="goal-item"||(this.targetDrop=i),t.preventDefault(),!0},onDragOver(t,o,i){return t.preventDefault(),!0},onDragLeave(t,o,i){return!1},onDragEnd(t){console.log("onDragEnd",t)},onDrop(t,o,i){let s=this.getScheduledEvent(this.draggedItem.id);if(!s){console.log("onDrop ERROR",s,this.draggedItem);return}let l=null;if(o==="interval")l=i.timestamp;else if(o==="goal-item"&&this.targetDrop)l=this.targetDrop.timestamp;else{console.log("Cannot drop here YO!!",t,o,i,this.targetDrop);return}if(!l){console.log("ERROR...no timestamp YO!!",t,o,i,this.targetDrop);return}let n=this.tooClose(l,s.duration);if(n&&(console.log("onDrop::tooClose to>>",n),n===!0)){this.doNotify("Dropping event TOO close to midnight!"),this.reset();return}let a=this.hasOverlappingEvent(s.id,l,s.duration),r={},h=a.length;if(h>0){let c=0;do{if(a[c].inConflict==a[c].target){console.log("EUUUH...self overlap?!?",a[c]);break}console.log("onDrop...OVERLAP handlin::size="+h,a[c].direction);let d=a[c];r[d==null?void 0:d.inConflict]?r[d==null?void 0:d.inConflict].push(d):r[d==null?void 0:d.inConflict]=[d],c>0&&(console.log(c+" WOAH WOAH,onDrop.. multiple overlaps with same target!",a[c].target),d.inConflict in r&&(console.log("WOAH deleting inConflict",d.inConflict),delete r[d.inConflict]),a[c-1].inConflict in r&&(console.log("WOAH deleting PREV inConflict",a[c-1].inConflict),delete r[a[c-1].inConflict]),r[d.target]?(r[d.target].push(d),console.log("WOAH obj.id already present?",d.target)):r[d.target]=[d],r[d.target].unshift(a[c-1]),r.withID=!0)}while(++c<h);console.log("onDrop...OVERLAP with fixOverlap",r),this.fixyOverlaps(r,!0,"onDrop")}else this.changeEvtTime(s.id,l,!1),console.log(`onDrop with No overlap complete (${s.id}) to ${l.time}`);this.disableSaveSchedule=!1,this.showReloadBtn=this.hasEventsForDate,this.showClearBtn=!0,this.reset()},onDblClickEvent(t,o){if(this.isViewingPast()){if(o.duration<30){console.log("onDblClickEvent..baah too smoll smoll",o.title,o.duration),this.doNotify("umm Removing from the past..Soo Check BALANCE!"),this.addToBalance(o),this.doRemove(o);return}this.chooseAlternatives(o),t.preventDefault();return}this.removeEvtInSchedule(o)},onClickDate(t){console.log("onClickDate",t)},onClickTime(t){console.log("onClickTime..event",t),this.addEventDialog=!0,this.targetDrop=t.scope},onClickInterval(t){console.log("onClickInterval",t)},onClickHeadIntervals(t){console.log("onClickHeadIntervals",t)},onClickHeadDay(t){console.log("onClickHeadDay",t)},onMouseEnter(t){console.log("onMouseAt",t)},onMouseLeave(t){console.log("onMouseLeave",JSON.stringify(t))},onMouseDownTime({scope:t,event:o}){if(Te(o)){if(this.mobile===!0&&this.anchorTimestamp!==null&&this.otherTimestamp!==null&&Q(this.anchorTimestamp)===Q(this.otherTimestamp)){this.otherTimestamp=t.timestamp,this.mouseDown=!1;return}this.mouseDown=!0,this.anchorTimestamp=t.timestamp,this.otherTimestamp=t.timestamp}},onMouseUpTime({scope:t,event:o}){if(this.mobile!==!0&&Te(o)&&(this.otherTimestamp=t.timestamp,this.mouseDown=!1),!this.mousedown){let i=this.startEndTimes;if(i[1]==i[0])return;this.possibleRange=i,console.log("onMouseUpTime range change",this.possibleRange)}},onMouseMoveTime({scope:t,event:o}){this.mobile!==!0&&this.mouseDown===!0&&(this.otherTimestamp=t.timestamp)},scrollToEvent(t){this.$refs.calendar.scrollToTime(t.time,350)},scrollToTime(t,o=null){var i;if(this.$refs.calendar){let s=M(t,{minute:-30});console.log("scrollToTime::gonna SCROLL",t.time,s.time,o),(i=this.$refs.calendar)==null||i.scrollToTime(s.time,o?o=="fast"?400:1e3:500)}else console.log("scrollToTime::NO SCROLLY",t.time,JSON.parse(JSON.stringify(this.$refs)))},onToday(){let t=()=>{this.$refs.calendar.moveToToday()},o=()=>{setTimeout(t,1e3),this.doSaveSchedule()};this.disableSaveSchedule?t():this.confirmAction(`Save day: ${this.currentDate} changes?`,"Save",o,t)},onPrev(){let t=()=>{this.$refs.calendar.prev()},o=()=>{setTimeout(t,1e3),this.doSaveSchedule()};this.disableSaveSchedule?t():this.confirmAction(`Save day: ${this.currentDate} changes?`,"Save",o,t)},onNext(){let t=()=>{this.$refs.calendar.next()},o=()=>{setTimeout(t,1e3),this.doSaveSchedule()};this.disableSaveSchedule?t():this.confirmAction(`Save day: ${this.currentDate} changes?`,"Save",o,t)}}}),Ee=t=>(de("data-v-7e8b05b2"),t=t(),he(),t),io={key:0,class:"q-gutter-md"},so={key:1,class:"subcontent"},lo={class:"q-px-md boxy"},no={key:0},ao={key:1},ro={key:2},ho={key:3},co={key:4},uo={key:5},fo=Ee(()=>N("br",null,null,-1)),go=Ee(()=>N("br",null,null,-1)),mo={key:0,class:"q-pa-sm bg-grey-12",style:{"max-width":"400px"}},po={class:"row justify-center"},So={class:"row justify-center"},vo={class:"q-mr-sm text-weight-bold",size:"28px"},yo={key:0},Eo={class:"text-weight-bold"},bo={key:1,class:"text-weight-light text-black"},wo={key:1,class:"q-pa-md q-gutter-sm bg-grey-12",style:{"max-width":"400px"}},Co={key:0,class:"row"},Oo={class:"row justify-center"},$o={class:"q-gutter-md",style:{display:"flex","max-width":"800px",width:"100%",height:"500px"}},Ro={style:{display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"2px"}},Do={class:"title q-calendar__ellipsis"},To=["onDblclick","onDragstart"],Po={class:"row justify-center"},Ao=Ee(()=>N("br",null,null,-1));function No(t,o,i,s,l,n){const a=H("add-goal-form"),r=H("sched-btn"),h=H("sched-drop-btn"),c=H("navigation-bar"),d=H("goaly-end"),p=H("q-calendar-day"),y=H("sched-dialog");return A(),B(z,null,[t.showForm?(A(),B("div",io,[E(k,{class:"q-pl-xl justify-center",color:"","text-color":"green",elevated:"",label:"HideForm",onClick:o[0]||(o[0]=v=>t.showGoalForm=!t.showGoalForm),"no-caps":""}),E(a)])):G("",!0),t.showForm?G("",!0):(A(),B("div",so,[E(Re,{modelValue:t.splitterPage,"onUpdate:modelValue":o[10]||(o[10]=v=>t.splitterPage=v),limits:[30,70]},{before:P(()=>[E(Re,{modelValue:t.splitterLegend,"onUpdate:modelValue":o[3]||(o[3]=v=>t.splitterLegend=v),horizontal:"",limits:[20,80],style:{height:"100%"}},{before:P(()=>[N("div",lo,[t.showReloadBtn?(A(),B("div",no,[E(r,{"text-label":"Reload",class:"sched-btn","text-color":"green",onDoBtnAction:t.onReloadSaved},null,8,["onDoBtnAction"])])):G("",!0),t.showClearBtn?(A(),B("div",ao,[E(r,{"text-label":"Clear",class:"sched-btn","text-color":"lime-5",onDoBtnAction:t.onClearDay},null,8,["onDoBtnAction"])])):G("",!0),t.showLoadDefaults?(A(),B("div",ro,[E(r,{textLabel:t.defaultLabels,class:"sched-btn","text-color":"blue",onDoBtnAction:t.onLoadDefault},null,8,["textLabel","onDoBtnAction"])])):G("",!0),t.showScoreBtn?(A(),B("div",ho,[E(h,{class:"sched-drop-btn","text-color":"teal",disableBtn:t.disableScoreBtn,optionLabel:t.chosenScoreLabel,daOptions:t.scoreOptions,onDoReload:t.doReloadWithScore,onChooseOption:t.onChoosenScore},null,8,["disableBtn","optionLabel","daOptions","onDoReload","onChooseOption"])])):G("",!0),t.showPrio?(A(),B("div",co,[E(h,{class:"sched-drop-btn","text-color":"teal",disableBtn:t.disablePrioBtn,optionLabel:t.chosenPrioLabel,daOptions:t.allMainGPrio(),onDoReload:t.doReloadWithPrio,onChooseOption:t.onChoosenPrio},null,8,["disableBtn","optionLabel","daOptions","onDoReload","onChooseOption"])])):G("",!0),t.showOneEach?(A(),B("div",uo,[E(r,{"text-label":"One Each",class:"sched-btn","text-color":"brown",onDoBtnAction:t.onScheduleOneEach},null,8,["onDoBtnAction"])])):G("",!0)]),fo]),after:P(()=>[go,t.treeGoals.length>0?(A(),B("div",mo,[N("div",po,V(t.labelGoals("s")),1),N("div",So,[E(se,{color:"secondary","multi-line":""},{default:P(()=>[x(V(t.labelGoals("b"))+" mins ",1)]),_:1})]),E(te),E(ve,{label:"Moods: 'je-suis'",ref:"filterRef",filled:"",modelValue:t.filter,"onUpdate:modelValue":o[1]||(o[1]=v=>t.filter=v),"use-input":"","use-chips":"",multiple:"",disable:t.isViewingPast(),"hide-dropdown-icon":"","input-debounce":"0","new-value-mode":"add-unique",class:"q-pa-sm q-gutter-sm"},{"selected-item":P(v=>[E(nt,{removable:"",dense:"",onRemove:R=>v.removeAtIndex(v.index),tabindex:v.tabindex,"text-color":"black",class:"q-ma-none",style:{width:"80px"}},{default:P(()=>[x(V(v.opt),1)]),_:2},1032,["onRemove","tabindex"])]),append:P(()=>[t.filter.length>0?(A(),I(ge,{key:0,name:"clear",class:"cursor-pointer",onClick:t.resetFilter},null,8,["onClick"])):G("",!0)]),_:1},8,["modelValue","disable"]),E(ht,{nodes:t.treeGoals,"node-key":"label",filter:t.filterString,"filter-method":t.myFilterMethod,expanded:t.expanded,"onUpdate:expanded":o[2]||(o[2]=v=>t.expanded=v),"no-connectors":"",dense:"","default-expand-all":""},{"default-header":P(v=>[N("div",{class:ie(t.classyColor(v.node))},[v.node.isChildren?G("",!0):(A(),I(ge,{key:0,name:v.node.icon||v.expanded?"expand_less":"expand_more",size:"28px",right:""},null,8,["name"])),N("div",vo,V(v.node.label),1)],2)]),"default-body":P(v=>[v.node.isChildren?(A(),B("div",yo,[N("span",Eo," >> "+V(v.node.details),1)])):(A(),B("span",bo,V(v.node.details),1))]),_:1},8,["nodes","filter","filter-method","expanded"])])):G("",!0),t.filter.length>0?(A(),B("div",wo,[E(r,{"text-label":"Add Moods",class:"q-mt-xl sched-btn","text-color":"red",onDoBtnAction:t.onMoodAdd},null,8,["onDoBtnAction"])])):G("",!0)]),_:1},8,["modelValue"])]),after:P(()=>[E(at,{onRefresh:t.onRefresh},{default:P(()=>[E(c,{onToday:t.onToday,onPrev:t.onPrev,onNext:t.onNext},null,8,["onToday","onPrev","onNext"])]),_:1},8,["onRefresh"]),t.scheduleMoodsLabel!=""?(A(),B("div",Co,[E(se,{color:"secondary","multi-line":""},{default:P(()=>[x(V(t.scheduleMoodsLabel),1)]),_:1})])):G("",!0),N("div",Oo,[N("div",$o,[E(p,{ref:"calendar",view:"day",modelValue:t.currentDate,"onUpdate:modelValue":o[8]||(o[8]=v=>t.currentDate=v),"drag-enter-func":t.onDragEnter,"drag-over-func":t.onDragOver,"drag-leave-func":t.onDragLeave,"drop-func":t.onDrop,animated:"",bordered:"",hoverable:"","no-active-date":"","transition-next":"slide-left","transition-prev":"slide-right","time-clicks-clamped":"","interval-minutes":15,"interval-count":96,"interval-height":28,"selected-start-end-dates":t.startEndTimes,onChange:t.onChange,onClickDate:t.onClickDate,onClickTime:t.onClickTime,onClickInterval:t.onClickInterval,onClickHeadIntervals:t.onClickHeadIntervals,onClickHeadDay:t.onClickHeadDay,onMousedownTime:t.onMouseDownTime,onMouseupTime:t.onMouseUpTime,onMousemoveTime:t.onMouseMoveTime},{"head-day-event":P(({scope:{timestamp:v}})=>[N("div",Ro,[(A(!0),B(z,null,me(t.eventsMap[v.date],R=>(A(),B(z,{key:R.id},[R.time?(A(),I(se,{key:1,class:ie(t.badgeClasses(R,"header")),style:Y([t.badgeStyles(R,"header"),{margin:"1px",width:"10px","max-width":"10px",height:"10px","max-height":"10px",cursor:"pointer"}]),onClick:D=>t.scrollToEvent(R)},{default:P(()=>[E(Se,null,{default:P(()=>[x(V("("+R.id+") "+R.title+" - "+R.time+" >> "+R.duration+"min"),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"])):(A(),I(se,{key:0,class:ie(t.badgeClasses(R,"header")),style:Y([t.badgeStyles(R,"header"),{width:"100%",cursor:"pointer",height:"12px","font-size":"10px",margin:"1px"}])},{default:P(()=>[N("div",Do,[x(V(R.title)+" ",1),E(Se,null,{default:P(()=>[x(V(R.details),1)]),_:2},1024)])]),_:2},1032,["class","style"]))],64))),128))])]),"day-container":P(({scope:{days:v}})=>[t.hasDate(v)?(A(),B(z,{key:0},[N("div",{class:"day-view-current-time-indicator",style:Y(t.style)},null,4),N("div",{class:"day-view-current-time-line",style:Y(t.style)},null,4)],64)):G("",!0)]),"day-body":P(({scope:{timestamp:v,timeStartPos:R,timeDurationHeight:D}})=>[(A(!0),B(z,null,me(t.getDateEvents(v.date),T=>(A(),B(z,{key:T.id},[T.time!==void 0?(A(),B("div",{key:0,class:ie(["my-event",t.badgeClasses(T,"body")]),style:Y(t.badgeStyles(T,"body",R,D)),draggable:!0,onDblclick:ne(C=>t.onDblClickEvent(C,T),["prevent"]),onDragstart:ne(C=>t.onDragStart(C,T),["stop"]),onDragend:o[4]||(o[4]=ne((...C)=>t.onDragEnd&&t.onDragEnd(...C),["stop"])),onDrop:o[5]||(o[5]=C=>t.onDrop(C,"goal-item",t.scope)),onDragenter:o[6]||(o[6]=C=>t.onDragEnter(C,"goal-item",t.scope)),onDragover:o[7]||(o[7]=C=>t.onDragOver(C,"goal-item",t.scope))},[E(d,{disabledScore:t.disabledScoreEvts[T.id],title:T.title,id:T.id,startTime:T.time,score:T.score,details:T.details,happeningNow:t.hasStarted[T.id]?t.hasStarted[T.id]:!1,onEndNow:t.onEndNow,onSaveScore:t.onSaveScore,onAddMins:t.onAddMins,onDeleteNow:C=>t.removeEvtInSchedule(T)},null,8,["disabledScore","title","id","startTime","score","details","happeningNow","onEndNow","onSaveScore","onAddMins","onDeleteNow"])],46,To)):G("",!0)],64))),128))]),_:1},8,["modelValue","drag-enter-func","drag-over-func","drag-leave-func","drop-func","selected-start-end-dates","onChange","onClickDate","onClickTime","onClickInterval","onClickHeadIntervals","onClickHeadDay","onMousedownTime","onMouseupTime","onMousemoveTime"])]),t.addEventDialog?(A(),I(y,{key:0,parentGoals:t.storedCompPG,canBeScheduled:t.canbeScheduled,balance:t.currentBalance,onAddAdHocEvent:t.onAddHocEvent,onOnPickEvent:t.onPickEvent,onEuhHidin:t.closingDialog},null,8,["parentGoals","canBeScheduled","balance","onAddAdHocEvent","onOnPickEvent","onEuhHidin"])):G("",!0)]),N("div",Po,[E(k,{class:"q-mt-xl",color:"Green","text-color":"blue",elevated:"",label:"SaveSchedule",disable:t.doDisableSaveSchedule,onClick:t.doSaveSchedule,"no-caps":""},null,8,["disable","onClick"]),E(k,{class:"q-mt-xl",color:"","text-color":"green",elevated:"",label:"ShowForm",onClick:o[9]||(o[9]=v=>t.showGoalForm=!t.showGoalForm),"no-caps":""})]),Ao]),_:1},8,["modelValue"])]))],64)}var xo=U(oo,[["render",No],["__scopeId","data-v-7e8b05b2"]]);export{xo as default};
